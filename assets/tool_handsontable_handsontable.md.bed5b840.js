import{d as bL,m as Cz,c as HE,i as _z,o as LE,_ as Oz,j as $v,e as An,k as wL,u as Rz,t as Ez,g as SL}from"./app.6dffa13c.js";var oc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function CL(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Tz(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}),r}var Ef=function(e){return e&&e.Math===Math&&e},vt=Ef(typeof globalThis=="object"&&globalThis)||Ef(typeof window=="object"&&window)||Ef(typeof self=="object"&&self)||Ef(typeof oc=="object"&&oc)||Ef(typeof oc=="object"&&oc)||function(){return this}()||Function("return this")(),jn={},Fe=function(e){try{return!!e()}catch{return!0}},Pz=Fe,Vt=!Pz(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),kz=Fe,Dd=!kz(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),$z=Dd,Av=Function.prototype.call,Gt=$z?Av.bind(Av):function(){return Av.apply(Av,arguments)},Nd={},_L={}.propertyIsEnumerable,OL=Object.getOwnPropertyDescriptor,Az=OL&&!_L.call({1:2},1);Nd.f=Az?function(t){var r=OL(this,t);return!!r&&r.enumerable}:_L;var Hd=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},RL=Dd,EL=Function.prototype,zC=EL.call,Iz=RL&&EL.bind.bind(zC,zC),Ve=RL?Iz:function(e){return function(){return zC.apply(e,arguments)}},TL=Ve,Mz=TL({}.toString),xz=TL("".slice),Fn=function(e){return xz(Mz(e),8,-1)},Dz=Ve,Nz=Fe,Hz=Fn,hw=Object,Lz=Dz("".split),Ld=Nz(function(){return!hw("z").propertyIsEnumerable(0)})?function(e){return Hz(e)==="String"?Lz(e,""):hw(e)}:hw,vn=function(e){return e==null},jz=vn,Fz=TypeError,Er=function(e){if(jz(e))throw new Fz("Can't call method on "+e);return e},Bz=Ld,Vz=Er,Fr=function(e){return Bz(Vz(e))},dw=typeof document=="object"&&document.all,Et=typeof dw>"u"&&dw!==void 0?function(e){return typeof e=="function"||e===dw}:function(e){return typeof e=="function"},Wz=Et,Nt=function(e){return typeof e=="object"?e!==null:Wz(e)},vw=vt,Uz=Et,zz=function(e){return Uz(e)?e:void 0},jo=function(e,t){return arguments.length<2?zz(vw[e]):vw[e]&&vw[e][t]},Yz=Ve,Ri=Yz({}.isPrototypeOf),za=typeof navigator<"u"&&String(navigator.userAgent)||"",PL=vt,yw=za,gP=PL.process,mP=PL.Deno,pP=gP&&gP.versions||mP&&mP.version,bP=pP&&pP.v8,an,Tg;bP&&(an=bP.split("."),Tg=an[0]>0&&an[0]<4?1:+(an[0]+an[1]));!Tg&&yw&&(an=yw.match(/Edge\/(\d+)/),(!an||an[1]>=74)&&(an=yw.match(/Chrome\/(\d+)/),an&&(Tg=+an[1])));var jd=Tg,wP=jd,Gz=Fe,Kz=vt,qz=Kz.String,hf=!!Object.getOwnPropertySymbols&&!Gz(function(){var e=Symbol("symbol detection");return!qz(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&wP&&wP<41}),Xz=hf,kL=Xz&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Zz=jo,Jz=Et,Qz=Ri,eY=kL,tY=Object,Fd=eY?function(e){return typeof e=="symbol"}:function(e){var t=Zz("Symbol");return Jz(t)&&Qz(t.prototype,tY(e))},rY=String,df=function(e){try{return rY(e)}catch{return"Object"}},nY=Et,oY=df,iY=TypeError,Ya=function(e){if(nY(e))return e;throw new iY(oY(e)+" is not a function")},aY=Ya,lY=vn,Ga=function(e,t){var r=e[t];return lY(r)?void 0:aY(r)},gw=Gt,mw=Et,pw=Nt,sY=TypeError,$L=function(e,t){var r,n;if(t==="string"&&mw(r=e.toString)&&!pw(n=gw(r,e))||mw(r=e.valueOf)&&!pw(n=gw(r,e))||t!=="string"&&mw(r=e.toString)&&!pw(n=gw(r,e)))return n;throw new sY("Can't convert object to primitive value")},AL={exports:{}},uY=!1,SP=vt,fY=Object.defineProperty,jE=function(e,t){try{fY(SP,e,{value:t,configurable:!0,writable:!0})}catch{SP[e]=t}return t},cY=vt,hY=jE,CP="__core-js_shared__",dY=cY[CP]||hY(CP,{}),FE=dY,_P=FE;(AL.exports=function(e,t){return _P[e]||(_P[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.35.0",mode:"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.35.0/LICENSE",source:"https://github.com/zloirock/core-js"});var vf=AL.exports,vY=Er,yY=Object,Tr=function(e){return yY(vY(e))},gY=Ve,mY=Tr,pY=gY({}.hasOwnProperty),At=Object.hasOwn||function(t,r){return pY(mY(t),r)},bY=Ve,wY=0,SY=Math.random(),CY=bY(1 .toString),Vm=function(e){return"Symbol("+(e===void 0?"":e)+")_"+CY(++wY+SY,36)},_Y=vt,OY=vf,OP=At,RY=Vm,EY=hf,TY=kL,Fl=_Y.Symbol,bw=OY("wks"),PY=TY?Fl.for||Fl:Fl&&Fl.withoutSetter||RY,St=function(e){return OP(bw,e)||(bw[e]=EY&&OP(Fl,e)?Fl[e]:PY("Symbol."+e)),bw[e]},kY=Gt,RP=Nt,EP=Fd,$Y=Ga,AY=$L,IY=St,MY=TypeError,xY=IY("toPrimitive"),IL=function(e,t){if(!RP(e)||EP(e))return e;var r=$Y(e,xY),n;if(r){if(t===void 0&&(t="default"),n=kY(r,e,t),!RP(n)||EP(n))return n;throw new MY("Can't convert object to primitive value")}return t===void 0&&(t="number"),AY(e,t)},DY=IL,NY=Fd,Wm=function(e){var t=DY(e,"string");return NY(t)?t:t+""},HY=vt,TP=Nt,YC=HY.document,LY=TP(YC)&&TP(YC.createElement),Um=function(e){return LY?YC.createElement(e):{}},jY=Vt,FY=Fe,BY=Um,ML=!jY&&!FY(function(){return Object.defineProperty(BY("div"),"a",{get:function(){return 7}}).a!==7}),VY=Vt,WY=Gt,UY=Nd,zY=Hd,YY=Fr,GY=Wm,KY=At,qY=ML,PP=Object.getOwnPropertyDescriptor;jn.f=VY?PP:function(t,r){if(t=YY(t),r=GY(r),qY)try{return PP(t,r)}catch{}if(KY(t,r))return zY(!WY(UY.f,t,r),t[r])};var mr={},XY=Vt,ZY=Fe,xL=XY&&ZY(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),JY=Nt,QY=String,eG=TypeError,Ht=function(e){if(JY(e))return e;throw new eG(QY(e)+" is not an object")},tG=Vt,rG=ML,nG=xL,Iv=Ht,kP=Wm,oG=TypeError,ww=Object.defineProperty,iG=Object.getOwnPropertyDescriptor,Sw="enumerable",Cw="configurable",_w="writable";mr.f=tG?nG?function(t,r,n){if(Iv(t),r=kP(r),Iv(n),typeof t=="function"&&r==="prototype"&&"value"in n&&_w in n&&!n[_w]){var o=iG(t,r);o&&o[_w]&&(t[r]=n.value,n={configurable:Cw in n?n[Cw]:o[Cw],enumerable:Sw in n?n[Sw]:o[Sw],writable:!1})}return ww(t,r,n)}:ww:function(t,r,n){if(Iv(t),r=kP(r),Iv(n),rG)try{return ww(t,r,n)}catch{}if("get"in n||"set"in n)throw new oG("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var aG=Vt,lG=mr,sG=Hd,Ka=aG?function(e,t,r){return lG.f(e,t,sG(1,r))}:function(e,t,r){return e[t]=r,e},DL={exports:{}},GC=Vt,uG=At,NL=Function.prototype,fG=GC&&Object.getOwnPropertyDescriptor,BE=uG(NL,"name"),cG=BE&&(function(){}).name==="something",hG=BE&&(!GC||GC&&fG(NL,"name").configurable),Bd={EXISTS:BE,PROPER:cG,CONFIGURABLE:hG},dG=Ve,vG=Et,KC=FE,yG=dG(Function.toString);vG(KC.inspectSource)||(KC.inspectSource=function(e){return yG(e)});var HL=KC.inspectSource,gG=vt,mG=Et,$P=gG.WeakMap,LL=mG($P)&&/native code/.test(String($P)),pG=vf,bG=Vm,AP=pG("keys"),zm=function(e){return AP[e]||(AP[e]=bG(e))},Vd={},wG=LL,jL=vt,SG=Nt,CG=Ka,Ow=At,Rw=FE,_G=zm,OG=Vd,IP="Object already initialized",qC=jL.TypeError,RG=jL.WeakMap,Pg,Tc,kg,EG=function(e){return kg(e)?Tc(e):Pg(e,{})},TG=function(e){return function(t){var r;if(!SG(t)||(r=Tc(t)).type!==e)throw new qC("Incompatible receiver, "+e+" required");return r}};if(wG||Rw.state){var mn=Rw.state||(Rw.state=new RG);mn.get=mn.get,mn.has=mn.has,mn.set=mn.set,Pg=function(e,t){if(mn.has(e))throw new qC(IP);return t.facade=e,mn.set(e,t),t},Tc=function(e){return mn.get(e)||{}},kg=function(e){return mn.has(e)}}else{var il=_G("state");OG[il]=!0,Pg=function(e,t){if(Ow(e,il))throw new qC(IP);return t.facade=e,CG(e,il,t),t},Tc=function(e){return Ow(e,il)?e[il]:{}},kg=function(e){return Ow(e,il)}}var Fo={set:Pg,get:Tc,has:kg,enforce:EG,getterFor:TG},VE=Ve,PG=Fe,kG=Et,Mv=At,XC=Vt,$G=Bd.CONFIGURABLE,AG=HL,FL=Fo,IG=FL.enforce,MG=FL.get,MP=String,Fy=Object.defineProperty,xG=VE("".slice),DG=VE("".replace),NG=VE([].join),HG=XC&&!PG(function(){return Fy(function(){},"length",{value:8}).length!==8}),LG=String(String).split("String"),jG=DL.exports=function(e,t,r){xG(MP(t),0,7)==="Symbol("&&(t="["+DG(MP(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!Mv(e,"name")||$G&&e.name!==t)&&(XC?Fy(e,"name",{value:t,configurable:!0}):e.name=t),HG&&r&&Mv(r,"arity")&&e.length!==r.arity&&Fy(e,"length",{value:r.arity});try{r&&Mv(r,"constructor")&&r.constructor?XC&&Fy(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=IG(e);return Mv(n,"source")||(n.source=NG(LG,typeof t=="string"?t:"")),e};Function.prototype.toString=jG(function(){return kG(this)&&MG(this).source||AG(this)},"toString");var BL=DL.exports,FG=Et,BG=mr,VG=BL,WG=jE,Xr=function(e,t,r,n){n||(n={});var o=n.enumerable,i=n.name!==void 0?n.name:t;if(FG(r)&&VG(r,i,n),n.global)o?e[t]=r:WG(t,r);else{try{n.unsafe?e[t]&&(o=!0):delete e[t]}catch{}o?e[t]=r:BG.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},qa={},UG=Math.ceil,zG=Math.floor,YG=Math.trunc||function(t){var r=+t;return(r>0?zG:UG)(r)},GG=YG,Ei=function(e){var t=+e;return t!==t||t===0?0:GG(t)},KG=Ei,qG=Math.max,XG=Math.min,Ym=function(e,t){var r=KG(e);return r<0?qG(r+t,0):XG(r,t)},ZG=Ei,JG=Math.min,Xa=function(e){return e>0?JG(ZG(e),9007199254740991):0},QG=Xa,yn=function(e){return QG(e.length)},e3=Fr,t3=Ym,r3=yn,xP=function(e){return function(t,r,n){var o=e3(t),i=r3(o),a=t3(n,i),l;if(e&&r!==r){for(;i>a;)if(l=o[a++],l!==l)return!0}else for(;i>a;a++)if((e||a in o)&&o[a]===r)return e||a||0;return!e&&-1}},WE={includes:xP(!0),indexOf:xP(!1)},n3=Ve,Ew=At,o3=Fr,i3=WE.indexOf,a3=Vd,DP=n3([].push),VL=function(e,t){var r=o3(e),n=0,o=[],i;for(i in r)!Ew(a3,i)&&Ew(r,i)&&DP(o,i);for(;t.length>n;)Ew(r,i=t[n++])&&(~i3(o,i)||DP(o,i));return o},UE=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],l3=VL,s3=UE,u3=s3.concat("length","prototype");qa.f=Object.getOwnPropertyNames||function(t){return l3(t,u3)};var Wd={};Wd.f=Object.getOwnPropertySymbols;var f3=jo,c3=Ve,h3=qa,d3=Wd,v3=Ht,y3=c3([].concat),WL=f3("Reflect","ownKeys")||function(t){var r=h3.f(v3(t)),n=d3.f;return n?y3(r,n(t)):r},NP=At,g3=WL,m3=jn,p3=mr,UL=function(e,t,r){for(var n=g3(t),o=p3.f,i=m3.f,a=0;a<n.length;a++){var l=n[a];!NP(e,l)&&!(r&&NP(r,l))&&o(e,l,i(t,l))}},b3=Fe,w3=Et,S3=/#|\.prototype\./,Ud=function(e,t){var r=_3[C3(e)];return r===R3?!0:r===O3?!1:w3(t)?b3(t):!!t},C3=Ud.normalize=function(e){return String(e).replace(S3,".").toLowerCase()},_3=Ud.data={},O3=Ud.NATIVE="N",R3=Ud.POLYFILL="P",Gm=Ud,Tw=vt,E3=jn.f,T3=Ka,P3=Xr,k3=jE,$3=UL,A3=Gm,Me=function(e,t){var r=e.target,n=e.global,o=e.stat,i,a,l,s,u,f;if(n?a=Tw:o?a=Tw[r]||k3(r,{}):a=(Tw[r]||{}).prototype,a)for(l in t){if(u=t[l],e.dontCallGetSet?(f=E3(a,l),s=f&&f.value):s=a[l],i=A3(n?l:r+(o?".":"#")+l,e.forced),!i&&s!==void 0){if(typeof u==typeof s)continue;$3(u,s)}(e.sham||s&&s.sham)&&T3(u,"sham",!0),P3(a,l,u,e)}},I3=St,M3=I3("toStringTag"),zL={};zL[M3]="z";var zE=String(zL)==="[object z]",x3=zE,D3=Et,By=Fn,N3=St,H3=N3("toStringTag"),L3=Object,j3=By(function(){return arguments}())==="Arguments",F3=function(e,t){try{return e[t]}catch{}},Km=x3?By:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=F3(t=L3(e),H3))=="string"?r:j3?By(t):(n=By(t))==="Object"&&D3(t.callee)?"Arguments":n},B3=Km,V3=String,Wt=function(e){if(B3(e)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return V3(e)},YE={},W3=VL,U3=UE,zd=Object.keys||function(t){return W3(t,U3)},z3=Vt,Y3=xL,G3=mr,K3=Ht,q3=Fr,X3=zd;YE.f=z3&&!Y3?Object.defineProperties:function(t,r){K3(t);for(var n=q3(r),o=X3(r),i=o.length,a=0,l;i>a;)G3.f(t,l=o[a++],n[l]);return t};var Z3=jo,YL=Z3("document","documentElement"),J3=Ht,Q3=YE,HP=UE,eK=Vd,tK=YL,rK=Um,nK=zm,LP=">",jP="<",ZC="prototype",JC="script",GL=nK("IE_PROTO"),Pw=function(){},KL=function(e){return jP+JC+LP+e+jP+"/"+JC+LP},FP=function(e){e.write(KL("")),e.close();var t=e.parentWindow.Object;return e=null,t},oK=function(){var e=rK("iframe"),t="java"+JC+":",r;return e.style.display="none",tK.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(KL("document.F=Object")),r.close(),r.F},xv,Vy=function(){try{xv=new ActiveXObject("htmlfile")}catch{}Vy=typeof document<"u"?document.domain&&xv?FP(xv):oK():FP(xv);for(var e=HP.length;e--;)delete Vy[ZC][HP[e]];return Vy()};eK[GL]=!0;var Za=Object.create||function(t,r){var n;return t!==null?(Pw[ZC]=J3(t),n=new Pw,Pw[ZC]=null,n[GL]=t):n=Vy(),r===void 0?n:Q3.f(n,r)},GE={},iK=Ve,Ti=iK([].slice),aK=Fn,lK=Fr,qL=qa.f,sK=Ti,XL=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],uK=function(e){try{return qL(e)}catch{return sK(XL)}};GE.f=function(t){return XL&&aK(t)==="Window"?uK(t):qL(lK(t))};var BP=BL,fK=mr,Yd=function(e,t,r){return r.get&&BP(r.get,t,{getter:!0}),r.set&&BP(r.set,t,{setter:!0}),fK.f(e,t,r)},KE={},cK=St;KE.f=cK;var hK=vt,ZL=hK,VP=ZL,dK=At,vK=KE,yK=mr.f,qE=function(e){var t=VP.Symbol||(VP.Symbol={});dK(t,e)||yK(t,e,{value:vK.f(e)})},gK=Gt,mK=jo,pK=St,bK=Xr,JL=function(){var e=mK("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=pK("toPrimitive");t&&!t[n]&&bK(t,n,function(o){return gK(r,this)},{arity:1})},wK=mr.f,SK=At,CK=St,WP=CK("toStringTag"),Gd=function(e,t,r){e&&!r&&(e=e.prototype),e&&!SK(e,WP)&&wK(e,WP,{configurable:!0,value:t})},_K=Fn,OK=Ve,Kd=function(e){if(_K(e)==="Function")return OK(e)},UP=Kd,RK=Ya,EK=Dd,TK=UP(UP.bind),qd=function(e,t){return RK(e),t===void 0?e:EK?TK(e,t):function(){return e.apply(t,arguments)}},PK=Fn,yf=Array.isArray||function(t){return PK(t)==="Array"},kK=Ve,$K=Fe,QL=Et,AK=Km,IK=jo,MK=HL,ej=function(){},xK=[],tj=IK("Reflect","construct"),XE=/^\s*(?:class|function)\b/,DK=kK(XE.exec),NK=!XE.test(ej),Tf=function(t){if(!QL(t))return!1;try{return tj(ej,xK,t),!0}catch{return!1}},rj=function(t){if(!QL(t))return!1;switch(AK(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return NK||!!DK(XE,MK(t))}catch{return!0}};rj.sham=!0;var qm=!tj||$K(function(){var e;return Tf(Tf.call)||!Tf(Object)||!Tf(function(){e=!0})||e})?rj:Tf,zP=yf,HK=qm,LK=Nt,jK=St,FK=jK("species"),YP=Array,BK=function(e){var t;return zP(e)&&(t=e.constructor,HK(t)&&(t===YP||zP(t.prototype))?t=void 0:LK(t)&&(t=t[FK],t===null&&(t=void 0))),t===void 0?YP:t},VK=BK,ZE=function(e,t){return new(VK(e))(t===0?0:t)},WK=qd,UK=Ve,zK=Ld,YK=Tr,GK=yn,KK=ZE,GP=UK([].push),zo=function(e){var t=e===1,r=e===2,n=e===3,o=e===4,i=e===6,a=e===7,l=e===5||i;return function(s,u,f,c){for(var h=YK(s),d=zK(h),v=GK(d),g=WK(u,f),p=0,w=c||KK,S=t?w(s,v):r||a?w(s,0):void 0,C,P;v>p;p++)if((l||p in d)&&(C=d[p],P=g(C,p,h),e))if(t)S[p]=P;else if(P)switch(e){case 3:return!0;case 5:return C;case 6:return p;case 2:GP(S,C)}else switch(e){case 4:return!1;case 7:GP(S,C)}return i?-1:n||o?o:S}},Ja={forEach:zo(0),map:zo(1),filter:zo(2),some:zo(3),every:zo(4),find:zo(5),findIndex:zo(6),filterReject:zo(7)},Xm=Me,Xd=vt,JE=Gt,qK=Ve,is=Vt,as=hf,XK=Fe,Qt=At,ZK=Ri,QC=Ht,Zm=Fr,QE=Wm,JK=Wt,e_=Hd,ls=Za,nj=zd,QK=qa,oj=GE,e4=Wd,ij=jn,aj=mr,t4=YE,lj=Nd,kw=Xr,r4=Yd,e0=vf,n4=zm,sj=Vd,KP=Vm,o4=St,i4=KE,a4=qE,l4=JL,s4=Gd,uj=Fo,Jm=Ja.forEach,_r=n4("hidden"),Qm="Symbol",Pc="prototype",u4=uj.set,qP=uj.getterFor(Qm),Gr=Object[Pc],Ra=Xd.Symbol,ic=Ra&&Ra[Pc],f4=Xd.RangeError,c4=Xd.TypeError,$w=Xd.QObject,fj=ij.f,Ea=aj.f,cj=oj.f,h4=lj.f,hj=qK([].push),xo=e0("symbols"),Zd=e0("op-symbols"),d4=e0("wks"),t_=!$w||!$w[Pc]||!$w[Pc].findChild,dj=function(e,t,r){var n=fj(Gr,t);n&&delete Gr[t],Ea(e,t,r),n&&e!==Gr&&Ea(Gr,t,n)},r_=is&&XK(function(){return ls(Ea({},"a",{get:function(){return Ea(this,"a",{value:7}).a}})).a!==7})?dj:Ea,Aw=function(e,t){var r=xo[e]=ls(ic);return u4(r,{type:Qm,tag:e,description:t}),is||(r.description=t),r},ep=function(t,r,n){t===Gr&&ep(Zd,r,n),QC(t);var o=QE(r);return QC(n),Qt(xo,o)?(n.enumerable?(Qt(t,_r)&&t[_r][o]&&(t[_r][o]=!1),n=ls(n,{enumerable:e_(0,!1)})):(Qt(t,_r)||Ea(t,_r,e_(1,ls(null))),t[_r][o]=!0),r_(t,o,n)):Ea(t,o,n)},t0=function(t,r){QC(t);var n=Zm(r),o=nj(n).concat(gj(n));return Jm(o,function(i){(!is||JE(n_,n,i))&&ep(t,i,n[i])}),t},v4=function(t,r){return r===void 0?ls(t):t0(ls(t),r)},n_=function(t){var r=QE(t),n=JE(h4,this,r);return this===Gr&&Qt(xo,r)&&!Qt(Zd,r)?!1:n||!Qt(this,r)||!Qt(xo,r)||Qt(this,_r)&&this[_r][r]?n:!0},vj=function(t,r){var n=Zm(t),o=QE(r);if(!(n===Gr&&Qt(xo,o)&&!Qt(Zd,o))){var i=fj(n,o);return i&&Qt(xo,o)&&!(Qt(n,_r)&&n[_r][o])&&(i.enumerable=!0),i}},yj=function(t){var r=cj(Zm(t)),n=[];return Jm(r,function(o){!Qt(xo,o)&&!Qt(sj,o)&&hj(n,o)}),n},gj=function(e){var t=e===Gr,r=cj(t?Zd:Zm(e)),n=[];return Jm(r,function(o){Qt(xo,o)&&(!t||Qt(Gr,o))&&hj(n,xo[o])}),n};as||(Ra=function(){if(ZK(ic,this))throw new c4("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:JK(arguments[0]),r=KP(t),n=function(o){var i=this===void 0?Xd:this;i===Gr&&JE(n,Zd,o),Qt(i,_r)&&Qt(i[_r],r)&&(i[_r][r]=!1);var a=e_(1,o);try{r_(i,r,a)}catch(l){if(!(l instanceof f4))throw l;dj(i,r,a)}};return is&&t_&&r_(Gr,r,{configurable:!0,set:n}),Aw(r,t)},ic=Ra[Pc],kw(ic,"toString",function(){return qP(this).tag}),kw(Ra,"withoutSetter",function(e){return Aw(KP(e),e)}),lj.f=n_,aj.f=ep,t4.f=t0,ij.f=vj,QK.f=oj.f=yj,e4.f=gj,i4.f=function(e){return Aw(o4(e),e)},is&&(r4(ic,"description",{configurable:!0,get:function(){return qP(this).description}}),kw(Gr,"propertyIsEnumerable",n_,{unsafe:!0})));Xm({global:!0,constructor:!0,wrap:!0,forced:!as,sham:!as},{Symbol:Ra});Jm(nj(d4),function(e){a4(e)});Xm({target:Qm,stat:!0,forced:!as},{useSetter:function(){t_=!0},useSimple:function(){t_=!1}});Xm({target:"Object",stat:!0,forced:!as,sham:!is},{create:v4,defineProperty:ep,defineProperties:t0,getOwnPropertyDescriptor:vj});Xm({target:"Object",stat:!0,forced:!as},{getOwnPropertyNames:yj});l4();s4(Ra,Qm);sj[_r]=!0;var y4=hf,mj=y4&&!!Symbol.for&&!!Symbol.keyFor,g4=Me,m4=jo,p4=At,b4=Wt,pj=vf,w4=mj,Iw=pj("string-to-symbol-registry"),S4=pj("symbol-to-string-registry");g4({target:"Symbol",stat:!0,forced:!w4},{for:function(e){var t=b4(e);if(p4(Iw,t))return Iw[t];var r=m4("Symbol")(t);return Iw[t]=r,S4[r]=t,r}});var C4=Me,_4=At,O4=Fd,R4=df,E4=vf,T4=mj,XP=E4("symbol-to-string-registry");C4({target:"Symbol",stat:!0,forced:!T4},{keyFor:function(t){if(!O4(t))throw new TypeError(R4(t)+" is not a symbol");if(_4(XP,t))return XP[t]}});var P4=Dd,bj=Function.prototype,ZP=bj.apply,JP=bj.call,Qa=typeof Reflect=="object"&&Reflect.apply||(P4?JP.bind(ZP):function(){return JP.apply(ZP,arguments)}),k4=Ve,QP=yf,$4=Et,ek=Fn,A4=Wt,tk=k4([].push),I4=function(e){if($4(e))return e;if(QP(e)){for(var t=e.length,r=[],n=0;n<t;n++){var o=e[n];typeof o=="string"?tk(r,o):(typeof o=="number"||ek(o)==="Number"||ek(o)==="String")&&tk(r,A4(o))}var i=r.length,a=!0;return function(l,s){if(a)return a=!1,s;if(QP(this))return s;for(var u=0;u<i;u++)if(r[u]===l)return s}}},M4=Me,wj=jo,Sj=Qa,x4=Gt,Jd=Ve,Cj=Fe,rk=Et,nk=Fd,_j=Ti,D4=I4,N4=hf,H4=String,ui=wj("JSON","stringify"),Dv=Jd(/./.exec),ok=Jd("".charAt),L4=Jd("".charCodeAt),j4=Jd("".replace),F4=Jd(1 .toString),B4=/[\uD800-\uDFFF]/g,ik=/^[\uD800-\uDBFF]$/,ak=/^[\uDC00-\uDFFF]$/,lk=!N4||Cj(function(){var e=wj("Symbol")("stringify detection");return ui([e])!=="[null]"||ui({a:e})!=="{}"||ui(Object(e))!=="{}"}),sk=Cj(function(){return ui("\uDF06\uD834")!=='"\\udf06\\ud834"'||ui("\uDEAD")!=='"\\udead"'}),V4=function(e,t){var r=_j(arguments),n=D4(t);if(!(!rk(n)&&(e===void 0||nk(e))))return r[1]=function(o,i){if(rk(n)&&(i=x4(n,this,H4(o),i)),!nk(i))return i},Sj(ui,null,r)},W4=function(e,t,r){var n=ok(r,t-1),o=ok(r,t+1);return Dv(ik,e)&&!Dv(ak,o)||Dv(ak,e)&&!Dv(ik,n)?"\\u"+F4(L4(e,0),16):e};ui&&M4({target:"JSON",stat:!0,arity:3,forced:lk||sk},{stringify:function(t,r,n){var o=_j(arguments),i=Sj(lk?V4:ui,null,o);return sk&&typeof i=="string"?j4(i,B4,W4):i}});var U4=Me,z4=hf,Y4=Fe,Oj=Wd,G4=Tr,K4=!z4||Y4(function(){Oj.f(1)});U4({target:"Object",stat:!0,forced:K4},{getOwnPropertySymbols:function(t){var r=Oj.f;return r?r(G4(t)):[]}});var q4=Me,X4=Vt,Z4=vt,Nv=Ve,J4=At,Q4=Et,e6=Ri,t6=Wt,r6=Yd,n6=UL,to=Z4.Symbol,Ii=to&&to.prototype;if(X4&&Q4(to)&&(!("description"in Ii)||to().description!==void 0)){var uk={},Hv=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:t6(arguments[0]),r=e6(Ii,this)?new to(t):t===void 0?to():to(t);return t===""&&(uk[r]=!0),r};n6(Hv,to),Hv.prototype=Ii,Ii.constructor=Hv;var o6=String(to("description detection"))==="Symbol(description detection)",i6=Nv(Ii.valueOf),a6=Nv(Ii.toString),l6=/^Symbol\((.*)\)[^)]+$/,s6=Nv("".replace),u6=Nv("".slice);r6(Ii,"description",{configurable:!0,get:function(){var t=i6(this);if(J4(uk,t))return"";var r=a6(t),n=o6?u6(r,7,-1):s6(r,l6,"$1");return n===""?void 0:n}}),q4({global:!0,constructor:!0,forced:!0},{Symbol:Hv})}var f6=qE;f6("iterator");var c6=Vt,h6=Bd.EXISTS,Rj=Ve,d6=Yd,Ej=Function.prototype,v6=Rj(Ej.toString),Tj=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,y6=Rj(Tj.exec),g6="name";c6&&!h6&&d6(Ej,g6,{configurable:!0,get:function(){try{return y6(Tj,v6(this))[1]}catch{return""}}});var m6=Fe,r0=!m6(function(){return Object.isExtensible(Object.preventExtensions({}))}),Pj={exports:{}},p6=Fe,b6=p6(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),w6=Fe,S6=Nt,C6=Fn,fk=b6,Wy=Object.isExtensible,_6=w6(function(){Wy(1)}),O6=_6||fk?function(t){return!S6(t)||fk&&C6(t)==="ArrayBuffer"?!1:Wy?Wy(t):!0}:Wy,R6=Me,E6=Ve,T6=Vd,P6=Nt,n0=At,k6=mr.f,ck=qa,$6=GE,o0=O6,A6=Vm,I6=r0,kj=!1,Do=A6("meta"),M6=0,i0=function(e){k6(e,Do,{value:{objectID:"O"+M6++,weakData:{}}})},x6=function(e,t){if(!P6(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!n0(e,Do)){if(!o0(e))return"F";if(!t)return"E";i0(e)}return e[Do].objectID},D6=function(e,t){if(!n0(e,Do)){if(!o0(e))return!0;if(!t)return!1;i0(e)}return e[Do].weakData},N6=function(e){return I6&&kj&&o0(e)&&!n0(e,Do)&&i0(e),e},H6=function(){L6.enable=function(){},kj=!0;var e=ck.f,t=E6([].splice),r={};r[Do]=1,e(r).length&&(ck.f=function(n){for(var o=e(n),i=0,a=o.length;i<a;i++)if(o[i]===Do){t(o,i,1);break}return o},R6({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:$6.f}))},L6=Pj.exports={enable:H6,fastKey:x6,getWeakData:D6,onFreeze:N6};T6[Do]=!0;var Qd=Pj.exports,j6=Me,F6=r0,B6=Fe,V6=Nt,W6=Qd.onFreeze,o_=Object.freeze,U6=B6(function(){o_(1)});j6({target:"Object",stat:!0,forced:U6,sham:!F6},{freeze:function(t){return o_&&V6(t)?o_(W6(t)):t}});var z6=St,Y6=Za,G6=mr.f,i_=z6("unscopables"),a_=Array.prototype;a_[i_]===void 0&&G6(a_,i_,{configurable:!0,value:Y6(null)});var ev=function(e){a_[i_][e]=!0},tv={},K6=Fe,$j=!K6(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),q6=At,X6=Et,Z6=Tr,J6=zm,Q6=$j,hk=J6("IE_PROTO"),l_=Object,e8=l_.prototype,rv=Q6?l_.getPrototypeOf:function(e){var t=Z6(e);if(q6(t,hk))return t[hk];var r=t.constructor;return X6(r)&&t instanceof r?r.prototype:t instanceof l_?e8:null},t8=Fe,r8=Et,n8=Nt,dk=rv,o8=Xr,i8=St,s_=i8("iterator"),Aj=!1,Aa,Mw,xw;[].keys&&(xw=[].keys(),"next"in xw?(Mw=dk(dk(xw)),Mw!==Object.prototype&&(Aa=Mw)):Aj=!0);var a8=!n8(Aa)||t8(function(){var e={};return Aa[s_].call(e)!==e});a8&&(Aa={});r8(Aa[s_])||o8(Aa,s_,function(){return this});var Ij={IteratorPrototype:Aa,BUGGY_SAFARI_ITERATORS:Aj},l8=Ij.IteratorPrototype,s8=Za,u8=Hd,f8=Gd,c8=tv,h8=function(){return this},d8=function(e,t,r,n){var o=t+" Iterator";return e.prototype=s8(l8,{next:u8(+!n,r)}),f8(e,o,!1),c8[o]=h8,e},v8=Ve,y8=Ya,g8=function(e,t,r){try{return v8(y8(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},m8=Nt,p8=function(e){return m8(e)||e===null},b8=p8,w8=String,S8=TypeError,C8=function(e){if(b8(e))return e;throw new S8("Can't set "+w8(e)+" as a prototype")},_8=g8,O8=Ht,R8=C8,a0=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=_8(Object.prototype,"__proto__","set"),r(t,[]),e=t instanceof Array}catch{}return function(o,i){return O8(o),R8(i),e?r(o,i):o.__proto__=i,o}}():void 0),E8=Me,T8=Gt,Mj=Bd,P8=Et,k8=d8,vk=rv,yk=a0,$8=Gd,A8=Ka,Dw=Xr,I8=St,M8=tv,xj=Ij,x8=Mj.PROPER,D8=Mj.CONFIGURABLE,gk=xj.IteratorPrototype,Lv=xj.BUGGY_SAFARI_ITERATORS,Pf=I8("iterator"),mk="keys",kf="values",pk="entries",N8=function(){return this},l0=function(e,t,r,n,o,i,a){k8(r,t,n);var l=function(w){if(w===o&&h)return h;if(!Lv&&w&&w in f)return f[w];switch(w){case mk:return function(){return new r(this,w)};case kf:return function(){return new r(this,w)};case pk:return function(){return new r(this,w)}}return function(){return new r(this)}},s=t+" Iterator",u=!1,f=e.prototype,c=f[Pf]||f["@@iterator"]||o&&f[o],h=!Lv&&c||l(o),d=t==="Array"&&f.entries||c,v,g,p;if(d&&(v=vk(d.call(new e)),v!==Object.prototype&&v.next&&(vk(v)!==gk&&(yk?yk(v,gk):P8(v[Pf])||Dw(v,Pf,N8)),$8(v,s,!0))),x8&&o===kf&&c&&c.name!==kf&&(D8?A8(f,"name",kf):(u=!0,h=function(){return T8(c,this)})),o)if(g={values:l(kf),keys:i?h:l(mk),entries:l(pk)},a)for(p in g)(Lv||u||!(p in f))&&Dw(f,p,g[p]);else E8({target:t,proto:!0,forced:Lv||u},g);return f[Pf]!==h&&Dw(f,Pf,h,{name:o}),M8[t]=h,g},s0=function(e,t){return{value:e,done:t}},H8=Fr,u0=ev,bk=tv,Dj=Fo,L8=mr.f,j8=l0,jv=s0,F8=Vt,Nj="Array Iterator",B8=Dj.set,V8=Dj.getterFor(Nj),W8=j8(Array,"Array",function(e,t){B8(this,{type:Nj,target:H8(e),index:0,kind:t})},function(){var e=V8(this),t=e.target,r=e.index++;if(!t||r>=t.length)return e.target=void 0,jv(void 0,!0);switch(e.kind){case"keys":return jv(r,!1);case"values":return jv(t[r],!1)}return jv([r,t[r]],!1)},"values"),wk=bk.Arguments=bk.Array;u0("keys");u0("values");u0("entries");if(F8&&wk.name!=="values")try{L8(wk,"name",{value:"values"})}catch{}var U8=zE,z8=Km,Y8=U8?{}.toString:function(){return"[object "+z8(this)+"]"},G8=zE,K8=Xr,q8=Y8;G8||K8(Object.prototype,"toString",q8,{unsafe:!0});var X8=St,Z8=tv,J8=X8("iterator"),Q8=Array.prototype,Hj=function(e){return e!==void 0&&(Z8.Array===e||Q8[J8]===e)},e5=Km,Sk=Ga,t5=vn,r5=tv,n5=St,o5=n5("iterator"),f0=function(e){if(!t5(e))return Sk(e,o5)||Sk(e,"@@iterator")||r5[e5(e)]},i5=Gt,a5=Ya,l5=Ht,s5=df,u5=f0,f5=TypeError,Lj=function(e,t){var r=arguments.length<2?u5(e):t;if(a5(r))return l5(i5(r,e));throw new f5(s5(e)+" is not iterable")},c5=Gt,Ck=Ht,h5=Ga,jj=function(e,t,r){var n,o;Ck(e);try{if(n=h5(e,"return"),!n){if(t==="throw")throw r;return r}n=c5(n,e)}catch(i){o=!0,n=i}if(t==="throw")throw r;if(o)throw n;return Ck(n),r},d5=qd,v5=Gt,y5=Ht,g5=df,m5=Hj,p5=yn,_k=Ri,b5=Lj,w5=f0,Ok=jj,S5=TypeError,Uy=function(e,t){this.stopped=e,this.result=t},Rk=Uy.prototype,c0=function(e,t,r){var n=r&&r.that,o=!!(r&&r.AS_ENTRIES),i=!!(r&&r.IS_RECORD),a=!!(r&&r.IS_ITERATOR),l=!!(r&&r.INTERRUPTED),s=d5(t,n),u,f,c,h,d,v,g,p=function(S){return u&&Ok(u,"normal",S),new Uy(!0,S)},w=function(S){return o?(y5(S),l?s(S[0],S[1],p):s(S[0],S[1])):l?s(S,p):s(S)};if(i)u=e.iterator;else if(a)u=e;else{if(f=w5(e),!f)throw new S5(g5(e)+" is not iterable");if(m5(f)){for(c=0,h=p5(e);h>c;c++)if(d=w(e[c]),d&&_k(Rk,d))return d;return new Uy(!1)}u=b5(e,f)}for(v=i?e.next:u.next;!(g=v5(v,u)).done;){try{d=w(g.value)}catch(S){Ok(u,"throw",S)}if(typeof d=="object"&&d&&_k(Rk,d))return d}return new Uy(!1)},C5=Ri,_5=TypeError,h0=function(e,t){if(C5(t,e))return e;throw new _5("Incorrect invocation")},O5=St,Fj=O5("iterator"),Bj=!1;try{var R5=0,Ek={next:function(){return{done:!!R5++}},return:function(){Bj=!0}};Ek[Fj]=function(){return this},Array.from(Ek,function(){throw 2})}catch{}var Vj=function(e,t){try{if(!t&&!Bj)return!1}catch{return!1}var r=!1;try{var n={};n[Fj]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},E5=Et,T5=Nt,Tk=a0,d0=function(e,t,r){var n,o;return Tk&&E5(n=t.constructor)&&n!==r&&T5(o=n.prototype)&&o!==r.prototype&&Tk(e,o),e},P5=Me,k5=vt,$5=Ve,Pk=Gm,A5=Xr,I5=Qd,M5=c0,x5=h0,D5=Et,N5=vn,Nw=Nt,Hw=Fe,H5=Vj,L5=Gd,j5=d0,tp=function(e,t,r){var n=e.indexOf("Map")!==-1,o=e.indexOf("Weak")!==-1,i=n?"set":"add",a=k5[e],l=a&&a.prototype,s=a,u={},f=function(w){var S=$5(l[w]);A5(l,w,w==="add"?function(P){return S(this,P===0?0:P),this}:w==="delete"?function(C){return o&&!Nw(C)?!1:S(this,C===0?0:C)}:w==="get"?function(P){return o&&!Nw(P)?void 0:S(this,P===0?0:P)}:w==="has"?function(P){return o&&!Nw(P)?!1:S(this,P===0?0:P)}:function(P,R){return S(this,P===0?0:P,R),this})},c=Pk(e,!D5(a)||!(o||l.forEach&&!Hw(function(){new a().entries().next()})));if(c)s=r.getConstructor(t,e,n,i),I5.enable();else if(Pk(e,!0)){var h=new s,d=h[i](o?{}:-0,1)!==h,v=Hw(function(){h.has(1)}),g=H5(function(w){new a(w)}),p=!o&&Hw(function(){for(var w=new a,S=5;S--;)w[i](S,S);return!w.has(-0)});g||(s=t(function(w,S){x5(w,l);var C=j5(new a,w,s);return N5(S)||M5(S,C[i],{that:C,AS_ENTRIES:n}),C}),s.prototype=l,l.constructor=s),(v||p)&&(f("delete"),f("has"),n&&f("get")),(p||d)&&f(i),o&&l.clear&&delete l.clear}return u[e]=s,P5({global:!0,constructor:!0,forced:s!==a},u),L5(s,e),o||r.setStrong(s,e,n),s},F5=Xr,v0=function(e,t,r){for(var n in t)F5(e,n,t[n],r);return e},B5=jo,V5=Yd,W5=St,U5=Vt,kk=W5("species"),Wj=function(e){var t=B5(e);U5&&t&&!t[kk]&&V5(t,kk,{configurable:!0,get:function(){return this}})},$k=Za,z5=Yd,Ak=v0,Y5=qd,G5=h0,K5=vn,q5=c0,X5=l0,Fv=s0,Z5=Wj,$f=Vt,Ik=Qd.fastKey,Uj=Fo,Mk=Uj.set,Lw=Uj.getterFor,zj={getConstructor:function(e,t,r,n){var o=e(function(u,f){G5(u,i),Mk(u,{type:t,index:$k(null),first:void 0,last:void 0,size:0}),$f||(u.size=0),K5(f)||q5(f,u[n],{that:u,AS_ENTRIES:r})}),i=o.prototype,a=Lw(t),l=function(u,f,c){var h=a(u),d=s(u,f),v,g;return d?d.value=c:(h.last=d={index:g=Ik(f,!0),key:f,value:c,previous:v=h.last,next:void 0,removed:!1},h.first||(h.first=d),v&&(v.next=d),$f?h.size++:u.size++,g!=="F"&&(h.index[g]=d)),u},s=function(u,f){var c=a(u),h=Ik(f),d;if(h!=="F")return c.index[h];for(d=c.first;d;d=d.next)if(d.key===f)return d};return Ak(i,{clear:function(){for(var f=this,c=a(f),h=c.first;h;)h.removed=!0,h.previous&&(h.previous=h.previous.next=void 0),h=h.next;c.first=c.last=void 0,c.index=$k(null),$f?c.size=0:f.size=0},delete:function(u){var f=this,c=a(f),h=s(f,u);if(h){var d=h.next,v=h.previous;delete c.index[h.index],h.removed=!0,v&&(v.next=d),d&&(d.previous=v),c.first===h&&(c.first=d),c.last===h&&(c.last=v),$f?c.size--:f.size--}return!!h},forEach:function(f){for(var c=a(this),h=Y5(f,arguments.length>1?arguments[1]:void 0),d;d=d?d.next:c.first;)for(h(d.value,d.key,this);d&&d.removed;)d=d.previous},has:function(f){return!!s(this,f)}}),Ak(i,r?{get:function(f){var c=s(this,f);return c&&c.value},set:function(f,c){return l(this,f===0?0:f,c)}}:{add:function(f){return l(this,f=f===0?0:f,f)}}),$f&&z5(i,"size",{configurable:!0,get:function(){return a(this).size}}),o},setStrong:function(e,t,r){var n=t+" Iterator",o=Lw(t),i=Lw(n);X5(e,t,function(a,l){Mk(this,{type:n,target:a,state:o(a),kind:l,last:void 0})},function(){for(var a=i(this),l=a.kind,s=a.last;s&&s.removed;)s=s.previous;return!a.target||!(a.last=s=s?s.next:a.state.first)?(a.target=void 0,Fv(void 0,!0)):Fv(l==="keys"?s.key:l==="values"?s.value:[s.key,s.value],!1)},r?"entries":"values",!r,!0),Z5(t)}},J5=tp,Q5=zj;J5("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Q5);var y0=Ve,e7=Ei,t7=Wt,r7=Er,n7=y0("".charAt),xk=y0("".charCodeAt),o7=y0("".slice),Dk=function(e){return function(t,r){var n=t7(r7(t)),o=e7(r),i=n.length,a,l;return o<0||o>=i?e?"":void 0:(a=xk(n,o),a<55296||a>56319||o+1===i||(l=xk(n,o+1))<56320||l>57343?e?n7(n,o):a:e?o7(n,o,o+2):(a-55296<<10)+(l-56320)+65536)}},g0={codeAt:Dk(!1),charAt:Dk(!0)},i7=g0.charAt,a7=Wt,Yj=Fo,l7=l0,Nk=s0,Gj="String Iterator",s7=Yj.set,u7=Yj.getterFor(Gj);l7(String,"String",function(e){s7(this,{type:Gj,string:a7(e),index:0})},function(){var t=u7(this),r=t.string,n=t.index,o;return n>=r.length?Nk(void 0,!0):(o=i7(r,n),t.index+=o.length,Nk(o,!1))});var Kj={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},f7=Um,jw=f7("span").classList,Hk=jw&&jw.constructor&&jw.constructor.prototype,qj=Hk===Object.prototype?void 0:Hk,Lk=vt,Xj=Kj,c7=qj,ac=W8,jk=Ka,h7=Gd,d7=St,Fw=d7("iterator"),Bw=ac.values,Zj=function(e,t){if(e){if(e[Fw]!==Bw)try{jk(e,Fw,Bw)}catch{e[Fw]=Bw}if(h7(e,t,!0),Xj[t]){for(var r in ac)if(e[r]!==ac[r])try{jk(e,r,ac[r])}catch{e[r]=ac[r]}}}};for(var Vw in Xj)Zj(Lk[Vw]&&Lk[Vw].prototype,Vw);Zj(c7,"DOMTokenList");var v7=Me,y7=WE.includes,g7=Fe,m7=ev,p7=g7(function(){return!Array(1).includes()});v7({target:"Array",proto:!0,forced:p7},{includes:function(t){return y7(this,t,arguments.length>1?arguments[1]:void 0)}});m7("includes");var Fk=df,b7=TypeError,Jj=function(e,t){if(!delete e[t])throw new b7("Cannot delete property "+Fk(t)+" of "+Fk(e))},Bk=Ti,w7=Math.floor,u_=function(e,t){var r=e.length;if(r<8)for(var n=1,o,i;n<r;){for(i=n,o=e[n];i&&t(e[i-1],o)>0;)e[i]=e[--i];i!==n++&&(e[i]=o)}else for(var a=w7(r/2),l=u_(Bk(e,0,a),t),s=u_(Bk(e,a),t),u=l.length,f=s.length,c=0,h=0;c<u||h<f;)e[c+h]=c<u&&h<f?t(l[c],s[h])<=0?l[c++]:s[h++]:c<u?l[c++]:s[h++];return e},S7=u_,C7=Fe,gf=function(e,t){var r=[][e];return!!r&&C7(function(){r.call(null,t||function(){return 1},1)})},_7=za,Vk=_7.match(/firefox\/(\d+)/i),O7=!!Vk&&+Vk[1],R7=za,E7=/MSIE|Trident/.test(R7),T7=za,Wk=T7.match(/AppleWebKit\/(\d+)\./),P7=!!Wk&&+Wk[1],k7=Me,Qj=Ve,$7=Ya,A7=Tr,Uk=yn,I7=Jj,zk=Wt,m0=Fe,M7=S7,x7=gf,Yk=O7,D7=E7,Gk=jd,Kk=P7,ii=[],qk=Qj(ii.sort),N7=Qj(ii.push),H7=m0(function(){ii.sort(void 0)}),L7=m0(function(){ii.sort(null)}),j7=x7("sort"),eF=!m0(function(){if(Gk)return Gk<70;if(!(Yk&&Yk>3)){if(D7)return!0;if(Kk)return Kk<603;var e="",t,r,n,o;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(o=0;o<47;o++)ii.push({k:r+o,v:n})}for(ii.sort(function(i,a){return a.v-i.v}),o=0;o<ii.length;o++)r=ii[o].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),F7=H7||!L7||!j7||!eF,B7=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:zk(t)>zk(r)?1:-1}};k7({target:"Array",proto:!0,forced:F7},{sort:function(t){t!==void 0&&$7(t);var r=A7(this);if(eF)return t===void 0?qk(r):qk(r,t);var n=[],o=Uk(r),i,a;for(a=0;a<o;a++)a in r&&N7(n,r[a]);for(M7(n,B7(t)),i=Uk(n),a=0;a<i;)r[a]=n[a++];for(;a<o;)I7(r,a++);return r}});var V7=Vt,W7=yf,U7=TypeError,z7=Object.getOwnPropertyDescriptor,Y7=V7&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),G7=Y7?function(e,t){if(W7(e)&&!z7(e,"length").writable)throw new U7("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},K7=TypeError,q7=9007199254740991,tF=function(e){if(e>q7)throw K7("Maximum allowed index exceeded");return e},X7=Wm,Z7=mr,J7=Hd,nv=function(e,t,r){var n=X7(t);n in e?Z7.f(e,n,J7(0,r)):e[n]=r},Q7=Fe,e9=St,t9=jd,r9=e9("species"),ov=function(e){return t9>=51||!Q7(function(){var t=[],r=t.constructor={};return r[r9]=function(){return{foo:1}},t[e](Boolean).foo!==1})},n9=Me,o9=Tr,i9=Ym,a9=Ei,l9=yn,s9=G7,u9=tF,f9=ZE,c9=nv,Ww=Jj,h9=ov,d9=h9("splice"),v9=Math.max,y9=Math.min;n9({target:"Array",proto:!0,forced:!d9},{splice:function(t,r){var n=o9(this),o=l9(n),i=i9(t,o),a=arguments.length,l,s,u,f,c,h;for(a===0?l=s=0:a===1?(l=0,s=o-i):(l=a-2,s=y9(v9(a9(r),0),o-i)),u9(o+l-s),u=f9(n,s),f=0;f<s;f++)c=i+f,c in n&&c9(u,f,n[c]);if(u.length=s,l<s){for(f=i;f<o-s;f++)c=f+s,h=f+l,c in n?n[h]=n[c]:Ww(n,h);for(f=o;f>o-s+l;f--)Ww(n,f-1)}else if(l>s)for(f=o-s;f>i;f--)c=f+s-1,h=f+l-1,c in n?n[h]=n[c]:Ww(n,h);for(f=0;f<l;f++)n[f+i]=arguments[f+2];return s9(n,o-s+l),u}});var g9=Nt,m9=Math.floor,p9=Number.isInteger||function(t){return!g9(t)&&isFinite(t)&&m9(t)===t},b9=Me,w9=p9;b9({target:"Number",stat:!0},{isInteger:w9});var S9=Ve,rF=S9(1 .valueOf),nF=`	
\v\f\r                　\u2028\u2029\uFEFF`,C9=Ve,_9=Er,O9=Wt,f_=nF,Xk=C9("".replace),R9=RegExp("^["+f_+"]+"),E9=RegExp("(^|[^"+f_+"])["+f_+"]+$"),Uw=function(e){return function(t){var r=O9(_9(t));return e&1&&(r=Xk(r,R9,"")),e&2&&(r=Xk(r,E9,"$1")),r}},oF={start:Uw(1),end:Uw(2),trim:Uw(3)},T9=Me,iF=uY,P9=Vt,aF=vt,lF=ZL,sF=Ve,k9=Gm,Zk=At,$9=d0,A9=Ri,I9=Fd,uF=IL,M9=Fe,x9=qa.f,D9=jn.f,N9=mr.f,H9=rF,L9=oF.trim,rp="Number",Ul=aF[rp];lF[rp];var p0=Ul.prototype,j9=aF.TypeError,F9=sF("".slice),Bv=sF("".charCodeAt),B9=function(e){var t=uF(e,"number");return typeof t=="bigint"?t:V9(t)},V9=function(e){var t=uF(e,"number"),r,n,o,i,a,l,s,u;if(I9(t))throw new j9("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=L9(t),r=Bv(t,0),r===43||r===45){if(n=Bv(t,2),n===88||n===120)return NaN}else if(r===48){switch(Bv(t,1)){case 66:case 98:o=2,i=49;break;case 79:case 111:o=8,i=55;break;default:return+t}for(a=F9(t,2),l=a.length,s=0;s<l;s++)if(u=Bv(a,s),u<48||u>i)return NaN;return parseInt(a,o)}}return+t},b0=k9(rp,!Ul(" 0o1")||!Ul("0b1")||Ul("+0x1")),W9=function(e){return A9(p0,e)&&M9(function(){H9(e)})},np=function(t){var r=arguments.length<1?0:Ul(B9(t));return W9(this)?$9(Object(r),this,np):r};np.prototype=p0;b0&&!iF&&(p0.constructor=np);T9({global:!0,constructor:!0,wrap:!0,forced:b0},{Number:np});var U9=function(e,t){for(var r=P9?x9(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,o;r.length>n;n++)Zk(t,o=r[n])&&!Zk(e,o)&&N9(e,o,D9(t,o))};(b0||iF)&&U9(lF[rp],Ul);var z9=Me,Jk=yf,Y9=qm,G9=Nt,Qk=Ym,K9=yn,q9=Fr,X9=nv,Z9=St,J9=ov,Q9=Ti,eq=J9("slice"),tq=Z9("species"),zw=Array,rq=Math.max;z9({target:"Array",proto:!0,forced:!eq},{slice:function(t,r){var n=q9(this),o=K9(n),i=Qk(t,o),a=Qk(r===void 0?o:r,o),l,s,u;if(Jk(n)&&(l=n.constructor,Y9(l)&&(l===zw||Jk(l.prototype))?l=void 0:G9(l)&&(l=l[tq],l===null&&(l=void 0)),l===zw||l===void 0))return Q9(n,i,a);for(s=new(l===void 0?zw:l)(rq(a-i,0)),u=0;i<a;i++,u++)i in n&&X9(s,u,n[i]);return s.length=u,s}});var nq=Me,oq=Fe,iq=yf,aq=Nt,lq=Tr,sq=yn,e$=tF,t$=nv,uq=ZE,fq=ov,cq=St,hq=jd,fF=cq("isConcatSpreadable"),dq=hq>=51||!oq(function(){var e=[];return e[fF]=!1,e.concat()[0]!==e}),vq=function(e){if(!aq(e))return!1;var t=e[fF];return t!==void 0?!!t:iq(e)},yq=!dq||!fq("concat");nq({target:"Array",proto:!0,arity:1,forced:yq},{concat:function(t){var r=lq(this),n=uq(r,0),o=0,i,a,l,s,u;for(i=-1,l=arguments.length;i<l;i++)if(u=i===-1?r:arguments[i],vq(u))for(s=sq(u),e$(o+s),a=0;a<s;a++,o++)a in u&&t$(n,o,u[a]);else e$(o+1),t$(n,o++,u);return n.length=o,n}});var gq=Tr,r$=Ym,mq=yn,pq=function(t){for(var r=gq(this),n=mq(r),o=arguments.length,i=r$(o>1?arguments[1]:void 0,n),a=o>2?arguments[2]:void 0,l=a===void 0?n:r$(a,n);l>i;)r[i++]=t;return r},bq=Me,wq=pq,Sq=ev;bq({target:"Array",proto:!0},{fill:wq});Sq("fill");var Cq=Me,_q=Ja.map,Oq=ov,Rq=Oq("map");Cq({target:"Array",proto:!0,forced:!Rq},{map:function(t){return _q(this,t,arguments.length>1?arguments[1]:void 0)}});var Eq=Ht,cF=function(){var e=Eq(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},w0=Fe,Tq=vt,S0=Tq.RegExp,C0=w0(function(){var e=S0("a","y");return e.lastIndex=2,e.exec("abcd")!==null}),Pq=C0||w0(function(){return!S0("a","y").sticky}),kq=C0||w0(function(){var e=S0("^r","gy");return e.lastIndex=2,e.exec("str")!==null}),_0={BROKEN_CARET:kq,MISSED_STICKY:Pq,UNSUPPORTED_Y:C0},$q=Fe,Aq=vt,Iq=Aq.RegExp,hF=$q(function(){var e=Iq(".","s");return!(e.dotAll&&e.test(`
`)&&e.flags==="s")}),Mq=Fe,xq=vt,Dq=xq.RegExp,dF=Mq(function(){var e=Dq("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),Bl=Gt,op=Ve,Nq=Wt,Hq=cF,Lq=_0,jq=vf,Fq=Za,Bq=Fo.get,Vq=hF,Wq=dF,Uq=jq("native-string-replace",String.prototype.replace),$g=RegExp.prototype.exec,c_=$g,zq=op("".charAt),Yq=op("".indexOf),Gq=op("".replace),Yw=op("".slice),h_=function(){var e=/a/,t=/b*/g;return Bl($g,e,"a"),Bl($g,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),vF=Lq.BROKEN_CARET,d_=/()??/.exec("")[1]!==void 0,Kq=h_||d_||vF||Vq||Wq;Kq&&(c_=function(t){var r=this,n=Bq(r),o=Nq(t),i=n.raw,a,l,s,u,f,c,h;if(i)return i.lastIndex=r.lastIndex,a=Bl(c_,i,o),r.lastIndex=i.lastIndex,a;var d=n.groups,v=vF&&r.sticky,g=Bl(Hq,r),p=r.source,w=0,S=o;if(v&&(g=Gq(g,"y",""),Yq(g,"g")===-1&&(g+="g"),S=Yw(o,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&zq(o,r.lastIndex-1)!==`
`)&&(p="(?: "+p+")",S=" "+S,w++),l=new RegExp("^(?:"+p+")",g)),d_&&(l=new RegExp("^"+p+"$(?!\\s)",g)),h_&&(s=r.lastIndex),u=Bl($g,v?l:r,S),v?u?(u.input=Yw(u.input,w),u[0]=Yw(u[0],w),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:h_&&u&&(r.lastIndex=r.global?u.index+u[0].length:s),d_&&u&&u.length>1&&Bl(Uq,u[0],l,function(){for(f=1;f<arguments.length-2;f++)arguments[f]===void 0&&(u[f]=void 0)}),u&&d)for(u.groups=c=Fq(null),f=0;f<d.length;f++)h=d[f],c[h[0]]=u[h[1]];return u});var ip=c_,qq=Me,n$=ip;qq({target:"RegExp",proto:!0,forced:/./.exec!==n$},{exec:n$});var o$=Kd,i$=Xr,Xq=ip,a$=Fe,yF=St,Zq=Ka,Jq=yF("species"),Gw=RegExp.prototype,ap=function(e,t,r,n){var o=yF(e),i=!a$(function(){var u={};return u[o]=function(){return 7},""[e](u)!==7}),a=i&&!a$(function(){var u=!1,f=/a/;return e==="split"&&(f={},f.constructor={},f.constructor[Jq]=function(){return f},f.flags="",f[o]=/./[o]),f.exec=function(){return u=!0,null},f[o](""),!u});if(!i||!a||r){var l=o$(/./[o]),s=t(o,""[e],function(u,f,c,h,d){var v=o$(u),g=f.exec;return g===Xq||g===Gw.exec?i&&!d?{done:!0,value:l(f,c,h)}:{done:!0,value:v(c,f,h)}:{done:!1}});i$(String.prototype,e,s[0]),i$(Gw,o,s[1])}n&&Zq(Gw[o],"sham",!0)},Qq=g0.charAt,O0=function(e,t,r){return t+(r?Qq(e,t).length:1)},R0=Ve,eX=Tr,tX=Math.floor,Kw=R0("".charAt),rX=R0("".replace),qw=R0("".slice),nX=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,oX=/\$([$&'`]|\d{1,2})/g,iX=function(e,t,r,n,o,i){var a=r+e.length,l=n.length,s=oX;return o!==void 0&&(o=eX(o),s=nX),rX(i,s,function(u,f){var c;switch(Kw(f,0)){case"$":return"$";case"&":return e;case"`":return qw(t,0,r);case"'":return qw(t,a);case"<":c=o[qw(f,1,-1)];break;default:var h=+f;if(h===0)return u;if(h>l){var d=tX(h/10);return d===0?u:d<=l?n[d-1]===void 0?Kw(f,1):n[d-1]+Kw(f,1):u}c=n[h-1]}return c===void 0?"":c})},l$=Gt,aX=Ht,lX=Et,sX=Fn,uX=ip,fX=TypeError,lp=function(e,t){var r=e.exec;if(lX(r)){var n=l$(r,e,t);return n!==null&&aX(n),n}if(sX(e)==="RegExp")return l$(uX,e,t);throw new fX("RegExp#exec called on incompatible receiver")},cX=Qa,s$=Gt,sp=Ve,hX=ap,dX=Fe,vX=Ht,yX=Et,gX=vn,mX=Ei,pX=Xa,al=Wt,bX=Er,wX=O0,SX=Ga,CX=iX,_X=lp,OX=St,v_=OX("replace"),RX=Math.max,EX=Math.min,TX=sp([].concat),Xw=sp([].push),u$=sp("".indexOf),f$=sp("".slice),PX=function(e){return e===void 0?e:String(e)},kX=function(){return"a".replace(/./,"$0")==="$0"}(),c$=function(){return/./[v_]?/./[v_]("a","$0")==="":!1}(),$X=!dX(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});hX("replace",function(e,t,r){var n=c$?"$":"$0";return[function(i,a){var l=bX(this),s=gX(i)?void 0:SX(i,v_);return s?s$(s,i,l,a):s$(t,al(l),i,a)},function(o,i){var a=vX(this),l=al(o);if(typeof i=="string"&&u$(i,n)===-1&&u$(i,"$<")===-1){var s=r(t,a,l,i);if(s.done)return s.value}var u=yX(i);u||(i=al(i));var f=a.global,c;f&&(c=a.unicode,a.lastIndex=0);for(var h=[],d;d=_X(a,l),!(d===null||(Xw(h,d),!f));){var v=al(d[0]);v===""&&(a.lastIndex=wX(l,pX(a.lastIndex),c))}for(var g="",p=0,w=0;w<h.length;w++){d=h[w];for(var S=al(d[0]),C=RX(EX(mX(d.index),l.length),0),P=[],R,V=1;V<d.length;V++)Xw(P,PX(d[V]));var U=d.groups;if(u){var X=TX([S],P,C,l);U!==void 0&&Xw(X,U),R=al(cX(i,void 0,X))}else R=CX(S,l,C,P,U,i);C>=p&&(g+=f$(l,p,C)+R,p=C+S.length)}return g+f$(l,p)}]},!$X||!kX||c$);var AX=Ht,IX=jj,MX=function(e,t,r,n){try{return n?t(AX(r)[0],r[1]):t(r)}catch(o){IX(e,"throw",o)}},xX=qd,DX=Gt,NX=Tr,HX=MX,LX=Hj,jX=qm,FX=yn,h$=nv,BX=Lj,VX=f0,d$=Array,WX=function(t){var r=NX(t),n=jX(this),o=arguments.length,i=o>1?arguments[1]:void 0,a=i!==void 0;a&&(i=xX(i,o>2?arguments[2]:void 0));var l=VX(r),s=0,u,f,c,h,d,v;if(l&&!(this===d$&&LX(l)))for(h=BX(r,l),d=h.next,f=n?new this:[];!(c=DX(d,h)).done;s++)v=a?HX(h,i,[c.value,s],!0):c.value,h$(f,s,v);else for(u=FX(r),f=n?new this(u):d$(u);u>s;s++)v=a?i(r[s],s):r[s],h$(f,s,v);return f.length=s,f},UX=Me,zX=WX,YX=Vj,GX=!YX(function(e){Array.from(e)});UX({target:"Array",stat:!0,forced:GX},{from:zX});var KX=Me,qX=Kd,XX=WE.indexOf,ZX=gf,y_=qX([].indexOf),gF=!!y_&&1/y_([1],1,-0)<0,JX=gF||!ZX("indexOf");KX({target:"Array",proto:!0,forced:JX},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return gF?y_(this,t,r)||0:XX(this,t,r)}});var QX=Me,eZ=Ve,tZ=yf,rZ=eZ([].reverse),v$=[1,2];QX({target:"Array",proto:!0,forced:String(v$)===String(v$.reverse())},{reverse:function(){return tZ(this)&&(this.length=this.length),rZ(this)}});var nZ=Ja.forEach,oZ=gf,iZ=oZ("forEach"),aZ=iZ?[].forEach:function(t){return nZ(this,t,arguments.length>1?arguments[1]:void 0)},y$=vt,g$=Kj,lZ=qj,Zw=aZ,sZ=Ka,mF=function(e){if(e&&e.forEach!==Zw)try{sZ(e,"forEach",Zw)}catch{e.forEach=Zw}};for(var Jw in g$)g$[Jw]&&mF(y$[Jw]&&y$[Jw].prototype);mF(lZ);var uZ=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",fZ=TypeError,pF=function(e,t){if(e<t)throw new fZ("Not enough arguments");return e},bF=vt,cZ=Qa,hZ=Et,dZ=uZ,vZ=za,yZ=Ti,gZ=pF,mZ=bF.Function,pZ=/MSIE .\./.test(vZ)||dZ&&function(){var e=bF.Bun.version.split(".");return e.length<3||e[0]==="0"&&(e[1]<3||e[1]==="3"&&e[2]==="0")}(),E0=function(e,t){var r=t?2:1;return pZ?function(n,o){var i=gZ(arguments.length,1)>r,a=hZ(n)?n:mZ(n),l=i?yZ(arguments,r):[],s=i?function(){cZ(a,this,l)}:a;return t?e(s,o):e(s)}:e},bZ=Me,wF=vt,wZ=E0,m$=wZ(wF.setInterval,!0);bZ({global:!0,bind:!0,forced:wF.setInterval!==m$},{setInterval:m$});var SZ=Me,SF=vt,CZ=E0,p$=CZ(SF.setTimeout,!0);SZ({global:!0,bind:!0,forced:SF.setTimeout!==p$},{setTimeout:p$});var _Z=za,OZ=/(?:ipad|iphone|ipod).*applewebkit/i.test(_Z),RZ=vt,EZ=Fn,CF=EZ(RZ.process)==="process",Lr=vt,TZ=Qa,PZ=qd,b$=Et,kZ=At,_F=Fe,w$=YL,$Z=Ti,S$=Um,AZ=pF,IZ=OZ,MZ=CF,g_=Lr.setImmediate,m_=Lr.clearImmediate,xZ=Lr.process,Qw=Lr.Dispatch,DZ=Lr.Function,C$=Lr.MessageChannel,NZ=Lr.String,eS=0,hc={},_$="onreadystatechange",kc,Mi,tS,rS;_F(function(){kc=Lr.location});var T0=function(e){if(kZ(hc,e)){var t=hc[e];delete hc[e],t()}},nS=function(e){return function(){T0(e)}},O$=function(e){T0(e.data)},R$=function(e){Lr.postMessage(NZ(e),kc.protocol+"//"+kc.host)};(!g_||!m_)&&(g_=function(t){AZ(arguments.length,1);var r=b$(t)?t:DZ(t),n=$Z(arguments,1);return hc[++eS]=function(){TZ(r,void 0,n)},Mi(eS),eS},m_=function(t){delete hc[t]},MZ?Mi=function(e){xZ.nextTick(nS(e))}:Qw&&Qw.now?Mi=function(e){Qw.now(nS(e))}:C$&&!IZ?(tS=new C$,rS=tS.port2,tS.port1.onmessage=O$,Mi=PZ(rS.postMessage,rS)):Lr.addEventListener&&b$(Lr.postMessage)&&!Lr.importScripts&&kc&&kc.protocol!=="file:"&&!_F(R$)?(Mi=R$,Lr.addEventListener("message",O$,!1)):_$ in S$("script")?Mi=function(e){w$.appendChild(S$("script"))[_$]=function(){w$.removeChild(this),T0(e)}}:Mi=function(e){setTimeout(nS(e),0)});var OF={set:g_,clear:m_},HZ=Me,LZ=vt,E$=OF.clear;HZ({global:!0,bind:!0,enumerable:!0,forced:LZ.clearImmediate!==E$},{clearImmediate:E$});var jZ=Me,RF=vt,T$=OF.set,FZ=E0,P$=RF.setImmediate?FZ(T$,!1):T$;jZ({global:!0,bind:!0,enumerable:!0,forced:RF.setImmediate!==P$},{setImmediate:P$});var BZ=tp,VZ=zj;BZ("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},VZ);var WZ=Me,UZ=Fe,zZ=Tr,EF=rv,YZ=$j,GZ=UZ(function(){EF(1)});WZ({target:"Object",stat:!0,forced:GZ,sham:!YZ},{getPrototypeOf:function(t){return EF(zZ(t))}});var KZ=Nt,qZ=Fn,XZ=St,ZZ=XZ("match"),P0=function(e){var t;return KZ(e)&&((t=e[ZZ])!==void 0?!!t:qZ(e)==="RegExp")},JZ=P0,QZ=TypeError,k0=function(e){if(JZ(e))throw new QZ("The method doesn't accept regular expressions");return e},eJ=St,tJ=eJ("match"),$0=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[tJ]=!1,"/./"[e](t)}catch{}}return!1},rJ=Me,nJ=Ve,oJ=k0,iJ=Er,k$=Wt,aJ=$0,lJ=nJ("".indexOf);rJ({target:"String",proto:!0,forced:!aJ("includes")},{includes:function(t){return!!~lJ(k$(iJ(this)),k$(oJ(t)),arguments.length>1?arguments[1]:void 0)}});var sJ=Me,uJ=Ja.filter,fJ=ov,cJ=fJ("filter");sJ({target:"Array",proto:!0,forced:!cJ},{filter:function(t){return uJ(this,t,arguments.length>1?arguments[1]:void 0)}});var hJ=Gt,dJ=At,vJ=Ri,yJ=cF,$$=RegExp.prototype,TF=function(e){var t=e.flags;return t===void 0&&!("flags"in $$)&&!dJ(e,"flags")&&vJ($$,e)?hJ(yJ,e):t},gJ=mr.f,mJ=function(e,t,r){r in e||gJ(e,r,{configurable:!0,get:function(){return t[r]},set:function(n){t[r]=n}})},pJ=Vt,A0=vt,iv=Ve,bJ=Gm,wJ=d0,SJ=Ka,CJ=Za,_J=qa.f,A$=Ri,OJ=P0,I$=Wt,RJ=TF,PF=_0,EJ=mJ,TJ=Xr,PJ=Fe,kJ=At,$J=Fo.enforce,AJ=Wj,IJ=St,kF=hF,$F=dF,MJ=IJ("match"),fi=A0.RegExp,Dl=fi.prototype,xJ=A0.SyntaxError,DJ=iv(Dl.exec),Ag=iv("".charAt),M$=iv("".replace),x$=iv("".indexOf),NJ=iv("".slice),HJ=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Ta=/a/g,oS=/a/g,LJ=new fi(Ta)!==Ta,AF=PF.MISSED_STICKY,jJ=PF.UNSUPPORTED_Y,FJ=pJ&&(!LJ||AF||kF||$F||PJ(function(){return oS[MJ]=!1,fi(Ta)!==Ta||fi(oS)===oS||String(fi(Ta,"i"))!=="/a/i"})),BJ=function(e){for(var t=e.length,r=0,n="",o=!1,i;r<=t;r++){if(i=Ag(e,r),i==="\\"){n+=i+Ag(e,++r);continue}!o&&i==="."?n+="[\\s\\S]":(i==="["?o=!0:i==="]"&&(o=!1),n+=i)}return n},VJ=function(e){for(var t=e.length,r=0,n="",o=[],i=CJ(null),a=!1,l=!1,s=0,u="",f;r<=t;r++){if(f=Ag(e,r),f==="\\")f+=Ag(e,++r);else if(f==="]")a=!1;else if(!a)switch(!0){case f==="[":a=!0;break;case f==="(":DJ(HJ,NJ(e,r+1))&&(r+=2,l=!0),n+=f,s++;continue;case(f===">"&&l):if(u===""||kJ(i,u))throw new xJ("Invalid capture group name");i[u]=!0,o[o.length]=[u,s],l=!1,u="";continue}l?u+=f:n+=f}return[n,o]};if(bJ("RegExp",FJ)){for(var xi=function(t,r){var n=A$(Dl,this),o=OJ(t),i=r===void 0,a=[],l=t,s,u,f,c,h,d;if(!n&&o&&i&&t.constructor===xi)return t;if((o||A$(Dl,t))&&(t=t.source,i&&(r=RJ(l))),t=t===void 0?"":I$(t),r=r===void 0?"":I$(r),l=t,kF&&"dotAll"in Ta&&(u=!!r&&x$(r,"s")>-1,u&&(r=M$(r,/s/g,""))),s=r,AF&&"sticky"in Ta&&(f=!!r&&x$(r,"y")>-1,f&&jJ&&(r=M$(r,/y/g,""))),$F&&(c=VJ(t),t=c[0],a=c[1]),h=wJ(fi(t,r),n?this:Dl,xi),(u||f||a.length)&&(d=$J(h),u&&(d.dotAll=!0,d.raw=xi(BJ(t),s)),f&&(d.sticky=!0),a.length&&(d.groups=a)),t!==l)try{SJ(h,"source",l===""?"(?:)":l)}catch{}return h},D$=_J(fi),N$=0;D$.length>N$;)EJ(xi,fi,D$[N$++]);Dl.constructor=xi,xi.prototype=Dl,TJ(A0,"RegExp",xi,{constructor:!0})}AJ("RegExp");var WJ=Bd.PROPER,UJ=Xr,zJ=Ht,H$=Wt,YJ=Fe,GJ=TF,I0="toString",IF=RegExp.prototype,MF=IF[I0],KJ=YJ(function(){return MF.call({source:"a",flags:"b"})!=="/a/b"}),qJ=WJ&&MF.name!==I0;(KJ||qJ)&&UJ(IF,I0,function(){var t=zJ(this),r=H$(t.source),n=H$(GJ(t));return"/"+r+"/"+n},{unsafe:!0});var XJ=Me,ZJ=Ve,JJ=Ld,QJ=Fr,eQ=gf,tQ=ZJ([].join),rQ=JJ!==Object,nQ=rQ||!eQ("join",",");XJ({target:"Array",proto:!0,forced:nQ},{join:function(t){return tQ(QJ(this),t===void 0?",":t)}});var oQ=Bd.PROPER,iQ=Fe,L$=nF,j$="​᠎",aQ=function(e){return iQ(function(){return!!L$[e]()||j$[e]()!==j$||oQ&&L$[e].name!==e})},lQ=Me,sQ=oF.trim,uQ=aQ;lQ({target:"String",proto:!0,forced:uQ("trim")},{trim:function(){return sQ(this)}});function p_(e){"@babel/helpers - typeof";return p_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p_(e)}function M0(e){return window.requestAnimationFrame(e)}function fQ(){return!!document.documentElement.classList}function cQ(){return!!document.createTextNode("test").textContent}function hQ(){return!!window.getComputedStyle}function Ig(e){window.cancelAnimationFrame(e)}function xF(){return"ontouchstart"in window}var b_;function dQ(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),b_=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function DF(){return b_===void 0&&dQ(),b_}var ll;function vQ(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ll||((typeof Intl>"u"?"undefined":p_(Intl))==="object"?ll=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?ll=function(n,o){return"".concat(n).localeCompare(o)}:ll=function(n,o){return n===o?0:n>o?-1:1},ll)}var Af;function yQ(){if(Af!==void 0)return Af;try{var e={get passive(){Af=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{Af=!1}return Af}var gQ=qE,mQ=JL;gQ("toPrimitive");mQ();var pQ=Ht,bQ=$L,wQ=TypeError,SQ=function(e){if(pQ(this),e==="string"||e==="default")e="string";else if(e!=="number")throw new wQ("Incorrect hint");return bQ(this,e)},CQ=At,_Q=Xr,OQ=SQ,RQ=St,F$=RQ("toPrimitive"),B$=Date.prototype;CQ(B$,F$)||_Q(B$,F$,OQ);var EQ=qm,TQ=df,PQ=TypeError,NF=function(e){if(EQ(e))return e;throw new PQ(TQ(e)+" is not a constructor")},V$=Ht,kQ=NF,$Q=vn,AQ=St,IQ=AQ("species"),MQ=function(e,t){var r=V$(e).constructor,n;return r===void 0||$Q(n=V$(r)[IQ])?t:kQ(n)},xQ=Qa,If=Gt,x0=Ve,DQ=ap,NQ=Ht,HQ=vn,LQ=P0,W$=Er,jQ=MQ,FQ=O0,BQ=Xa,iS=Wt,VQ=Ga,U$=Ti,z$=lp,WQ=ip,UQ=_0,zQ=Fe,sl=UQ.UNSUPPORTED_Y,Y$=4294967295,YQ=Math.min,HF=[].push,GQ=x0(/./.exec),ul=x0(HF),Mf=x0("".slice),KQ=!zQ(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});DQ("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]==="c"||"test".split(/(?:)/,-1).length!==4||"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(o,i){var a=iS(W$(this)),l=i===void 0?Y$:i>>>0;if(l===0)return[];if(o===void 0)return[a];if(!LQ(o))return If(t,a,o,l);for(var s=[],u=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(o.sticky?"y":""),f=0,c=new RegExp(o.source,u+"g"),h,d,v;(h=If(WQ,c,a))&&(d=c.lastIndex,!(d>f&&(ul(s,Mf(a,f,h.index)),h.length>1&&h.index<a.length&&xQ(HF,s,U$(h,1)),v=h[0].length,f=d,s.length>=l)));)c.lastIndex===h.index&&c.lastIndex++;return f===a.length?(v||!GQ(c,""))&&ul(s,""):ul(s,Mf(a,f)),s.length>l?U$(s,0,l):s}:"0".split(void 0,0).length?n=function(o,i){return o===void 0&&i===0?[]:If(t,this,o,i)}:n=t,[function(i,a){var l=W$(this),s=HQ(i)?void 0:VQ(i,e);return s?If(s,i,l,a):If(n,iS(l),i,a)},function(o,i){var a=NQ(this),l=iS(o),s=r(n,a,l,i,n!==t);if(s.done)return s.value;var u=jQ(a,RegExp),f=a.unicode,c=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(sl?"g":"y"),h=new u(sl?"^(?:"+a.source+")":a,c),d=i===void 0?Y$:i>>>0;if(d===0)return[];if(l.length===0)return z$(h,l)===null?[l]:[];for(var v=0,g=0,p=[];g<l.length;){h.lastIndex=sl?0:g;var w=z$(h,sl?Mf(l,g):l),S;if(w===null||(S=YQ(BQ(h.lastIndex+(sl?g:0)),l.length))===v)g=FQ(l,g,f);else{if(ul(p,Mf(l,v,g)),p.length===d)return p;for(var C=1;C<=w.length-1;C++)if(ul(p,w[C]),p.length===d)return p;g=v=S}}return ul(p,Mf(l,v)),p}]},!KQ,sl);function qQ(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function G$(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function zy(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,o=0;o<r;o++)for(var i=0;i<n;i++)t[i]||(t[i]=[]),t[i][o]=e[o][i];return t}function ar(e,t,r,n){var o=-1,i=e,a=r;Array.isArray(e)||(i=Array.from(e));var l=i.length;for(n&&l&&(o+=1,a=i[o]),o+=1;o<l;)a=t(a,i[o],o,i),o+=1;return a}function Kr(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];t(l,r,n)&&(a+=1,i[a]=l),r+=1}return i}function ze(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];a+=1,i[a]=t(l,r,n),r+=1}return i}function I(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length;r<o&&t(n[r],r,n)!==!1;)r+=1;return e}function LF(e){var t=[];return I(e,function(r){t.indexOf(r)===-1&&t.push(r)}),t}function K$(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return I(i,function(l){a=a.filter(function(s){return!l.includes(s)})}),a}function q$(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}function X$(e,t,r){return t=XQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XQ(e){var t=ZQ(e,"string");return No(t)==="symbol"?t:String(t)}function ZQ(e,t){if(No(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(No(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function No(e){"@babel/helpers - typeof";return No=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},No(e)}function $c(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},Ge(e,function(r,n){n!=="__children"&&(r&&No(r)==="object"&&!Array.isArray(r)?t[n]=$c(r):Array.isArray(r)?r.length&&No(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[$c(r[0])]:t[n]=[]:t[n]=null)})),t}function Pi(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function Yt(e,t,r){var n=Array.isArray(r);return Ge(t,function(o,i){(n===!1||r.includes(i))&&(e[i]=o)}),e}function up(e,t){Ge(t,function(r,n){t[n]&&No(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),up(e[n],t[n])):e[n]=t[n]})}function yr(e){return No(e)==="object"?JSON.parse(JSON.stringify(e)):e}function Rr(e){var t={};return Ge(e,function(r,n){t[n]=r}),t}function bt(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return I(r,function(o){e.MIXINS.push(o.MIXIN_NAME),Ge(o,function(i,a){if(e.prototype[a]!==void 0)throw new Error("Mixin conflict. Property '".concat(a,"' already exist and cannot be overwritten."));if(typeof i=="function")e.prototype[a]=i;else{var l=function(f,c){var h="_".concat(f),d=function(g){var p=g;return(Array.isArray(p)||Ye(p))&&(p=yr(p)),p};return function(){return this[h]===void 0&&(this[h]=d(c)),this[h]}},s=function(f){var c="_".concat(f);return function(h){this[c]=h}};Object.defineProperty(e.prototype,a,{get:l(a,i),set:s(a),configurable:!0})}})}),e}function D0(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Ye(e){return Object.prototype.toString.call(e)==="[object Object]"}function Bo(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function Ge(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function JQ(e,t){var r=t.split("."),n=e;return Ge(r,function(o){if(n=n[o],n===void 0)return n=void 0,!1}),n}function aS(e,t,r){var n=t.split("."),o=e;n.forEach(function(i,a){a!==n.length-1?(Dt(o,i)||(o[i]={}),o=o[i]):o[i]=r})}function N0(e){if(!Ye(e))return 0;var t=function r(n){var o=0;return Ye(n)?Ge(n,function(i,a){a!=="__children"&&(o+=r(i))}):o+=1,o};return t(e)}function ss(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),o=(t={_touched:!1},X$(t,n,e),X$(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(o,r,{get:function(){return this[n]},set:function(a){this._touched=!0,this[n]=a},enumerable:!0,configurable:!0}),o}function Dt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Cr=function(t){var r={value:!1};return r.test=function(n,o){r.value=t(n,o)},r},Bn={chrome:Cr(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:Cr(function(e){return/CriOS/.test(e)}),edge:Cr(function(e){return/Edge/.test(e)}),edgeWebKit:Cr(function(e){return/EdgiOS/.test(e)}),firefox:Cr(function(e){return/Firefox/.test(e)}),firefoxWebKit:Cr(function(e){return/FxiOS/.test(e)}),ie:Cr(function(e){return/Trident/.test(e)}),ie9:Cr(function(){return!!document.documentMode}),mobile:Cr(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:Cr(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},av={mac:Cr(function(e){return/^Mac/.test(e)}),win:Cr(function(e){return/^Win/.test(e)}),linux:Cr(function(e){return/^Linux/.test(e)}),ios:Cr(function(e){return/iPhone|iPad|iPod/i.test(e)})};function QQ(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,o=n===void 0?navigator.vendor:n;Ge(Bn,function(i){var a=i.test;return void a(r,o)})}function eee(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;Ge(av,function(n){var o=n.test;return void o(r)})}QQ();eee();function jF(){return Bn.chrome.value}function tee(){return Bn.chromeWebKit.value}function lS(){return Bn.firefox.value}function ree(){return Bn.firefoxWebKit.value}function nee(){return Bn.safari.value}function oee(){return Bn.edge.value}function iee(){return Bn.ie.value}function aee(){return Bn.ie9.value}function xn(){return Bn.mobile.value}function FF(){return av.ios.value}function BF(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&av.mac.value}function Z$(){return av.win.value}function J$(){return av.mac.value}/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function ni(e){"@babel/helpers - typeof";return ni=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ni(e)}function w_(e,t){return w_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},w_(e,t)}function lee(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yy(e,t,r){return lee()?Yy=Reflect.construct:Yy=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&w_(u,a.prototype),u},Yy.apply(null,arguments)}function nn(e){return see(e)||uee(e)||fee(e)||cee()}function see(e){if(Array.isArray(e))return S_(e)}function uee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fee(e,t){if(e){if(typeof e=="string")return S_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S_(e,t)}}function S_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var hee=Object.hasOwnProperty,Q$=Object.setPrototypeOf,dee=Object.isFrozen,vee=Object.getPrototypeOf,yee=Object.getOwnPropertyDescriptor,gr=Object.freeze,cn=Object.seal,gee=Object.create,VF=typeof Reflect<"u"&&Reflect,Mg=VF.apply,C_=VF.construct;Mg||(Mg=function(t,r,n){return t.apply(r,n)});gr||(gr=function(t){return t});cn||(cn=function(t){return t});C_||(C_=function(t,r){return Yy(t,nn(r))});var mee=qr(Array.prototype.forEach),e1=qr(Array.prototype.pop),xf=qr(Array.prototype.push),Gy=qr(String.prototype.toLowerCase),sS=qr(String.prototype.toString),pee=qr(String.prototype.match),en=qr(String.prototype.replace),bee=qr(String.prototype.indexOf),wee=qr(String.prototype.trim),ur=qr(RegExp.prototype.test),uS=See(TypeError);function qr(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return Mg(e,t,n)}}function See(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return C_(e,r)}}function qe(e,t,r){var n;r=(n=r)!==null&&n!==void 0?n:Gy,Q$&&Q$(e,null);for(var o=t.length;o--;){var i=t[o];if(typeof i=="string"){var a=r(i);a!==i&&(dee(t)||(t[o]=a),i=a)}e[i]=!0}return e}function Di(e){var t=gee(null),r;for(r in e)Mg(hee,e,[r])===!0&&(t[r]=e[r]);return t}function Vv(e,t){for(;e!==null;){var r=yee(e,t);if(r){if(r.get)return qr(r.get);if(typeof r.value=="function")return qr(r.value)}e=vee(e)}function n(o){return console.warn("fallback value for",o),null}return n}var t1=gr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),fS=gr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),cS=gr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Cee=gr(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),hS=gr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),_ee=gr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),r1=gr(["#text"]),n1=gr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),dS=gr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),o1=gr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Wv=gr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Oee=cn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ree=cn(/<%[\w\W]*|[\w\W]*%>/gm),Eee=cn(/\${[\w\W]*}/gm),Tee=cn(/^data-[\-\w.\u00B7-\uFFFF]/),Pee=cn(/^aria-[\-\w]+$/),kee=cn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),$ee=cn(/^(?:\w+script|data):/i),Aee=cn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Iee=cn(/^html$/i),Mee=function(){return typeof window>"u"?null:window},xee=function(t,r){if(ni(t)!=="object"||typeof t.createPolicy!="function")return null;var n=null,o="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(o)&&(n=r.currentScript.getAttribute(o));var i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML:function(l){return l},createScriptURL:function(l){return l}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function WF(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Mee(),t=function(N){return WF(N)};if(t.version="2.4.7",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,o=e.DocumentFragment,i=e.HTMLTemplateElement,a=e.Node,l=e.Element,s=e.NodeFilter,u=e.NamedNodeMap,f=u===void 0?e.NamedNodeMap||e.MozNamedAttrMap:u,c=e.HTMLFormElement,h=e.DOMParser,d=e.trustedTypes,v=l.prototype,g=Vv(v,"cloneNode"),p=Vv(v,"nextSibling"),w=Vv(v,"childNodes"),S=Vv(v,"parentNode");if(typeof i=="function"){var C=n.createElement("template");C.content&&C.content.ownerDocument&&(n=C.content.ownerDocument)}var P=xee(d,r),R=P?P.createHTML(""):"",V=n,U=V.implementation,X=V.createNodeIterator,Y=V.createDocumentFragment,q=V.getElementsByTagName,Z=r.importNode,ie={};try{ie=Di(n).documentMode?n.documentMode:{}}catch{}var J={};t.isSupported=typeof S=="function"&&U&&U.createHTMLDocument!==void 0&&ie!==9;var le=Oee,Ce=Ree,we=Eee,_e=Tee,k=Pee,y=$ee,m=Aee,b=kee,_=null,T=qe({},[].concat(nn(t1),nn(fS),nn(cS),nn(hS),nn(r1))),A=null,F=qe({},[].concat(nn(n1),nn(dS),nn(o1),nn(Wv))),W=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),G=null,Q=null,ee=!0,se=!0,Te=!1,de=!0,ye=!1,K=!1,xe=!1,Ke=!1,$e=!1,Ie=!1,Ae=!1,O=!0,E=!1,$="user-content-",H=!0,M=!1,j={},x=null,D=qe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),B=null,L=qe({},["audio","video","img","source","image","track"]),z=null,ae=qe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),me="http://www.w3.org/1998/Math/MathML",Ee="http://www.w3.org/2000/svg",Ne="http://www.w3.org/1999/xhtml",Xe=Ne,ht=!1,He=null,Le=qe({},[me,Ee,Ne],sS),rt,it=["application/xhtml+xml","text/html"],et="text/html",Ze,Qe=null,Lt=n.createElement("form"),yt=function(N){return N instanceof RegExp||N instanceof Function},st=function(N){Qe&&Qe===N||((!N||ni(N)!=="object")&&(N={}),N=Di(N),rt=it.indexOf(N.PARSER_MEDIA_TYPE)===-1?rt=et:rt=N.PARSER_MEDIA_TYPE,Ze=rt==="application/xhtml+xml"?sS:Gy,_="ALLOWED_TAGS"in N?qe({},N.ALLOWED_TAGS,Ze):T,A="ALLOWED_ATTR"in N?qe({},N.ALLOWED_ATTR,Ze):F,He="ALLOWED_NAMESPACES"in N?qe({},N.ALLOWED_NAMESPACES,sS):Le,z="ADD_URI_SAFE_ATTR"in N?qe(Di(ae),N.ADD_URI_SAFE_ATTR,Ze):ae,B="ADD_DATA_URI_TAGS"in N?qe(Di(L),N.ADD_DATA_URI_TAGS,Ze):L,x="FORBID_CONTENTS"in N?qe({},N.FORBID_CONTENTS,Ze):D,G="FORBID_TAGS"in N?qe({},N.FORBID_TAGS,Ze):{},Q="FORBID_ATTR"in N?qe({},N.FORBID_ATTR,Ze):{},j="USE_PROFILES"in N?N.USE_PROFILES:!1,ee=N.ALLOW_ARIA_ATTR!==!1,se=N.ALLOW_DATA_ATTR!==!1,Te=N.ALLOW_UNKNOWN_PROTOCOLS||!1,de=N.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ye=N.SAFE_FOR_TEMPLATES||!1,K=N.WHOLE_DOCUMENT||!1,$e=N.RETURN_DOM||!1,Ie=N.RETURN_DOM_FRAGMENT||!1,Ae=N.RETURN_TRUSTED_TYPE||!1,Ke=N.FORCE_BODY||!1,O=N.SANITIZE_DOM!==!1,E=N.SANITIZE_NAMED_PROPS||!1,H=N.KEEP_CONTENT!==!1,M=N.IN_PLACE||!1,b=N.ALLOWED_URI_REGEXP||b,Xe=N.NAMESPACE||Ne,W=N.CUSTOM_ELEMENT_HANDLING||{},N.CUSTOM_ELEMENT_HANDLING&&yt(N.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(W.tagNameCheck=N.CUSTOM_ELEMENT_HANDLING.tagNameCheck),N.CUSTOM_ELEMENT_HANDLING&&yt(N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(W.attributeNameCheck=N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),N.CUSTOM_ELEMENT_HANDLING&&typeof N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(W.allowCustomizedBuiltInElements=N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ye&&(se=!1),Ie&&($e=!0),j&&(_=qe({},nn(r1)),A=[],j.html===!0&&(qe(_,t1),qe(A,n1)),j.svg===!0&&(qe(_,fS),qe(A,dS),qe(A,Wv)),j.svgFilters===!0&&(qe(_,cS),qe(A,dS),qe(A,Wv)),j.mathMl===!0&&(qe(_,hS),qe(A,o1),qe(A,Wv))),N.ADD_TAGS&&(_===T&&(_=Di(_)),qe(_,N.ADD_TAGS,Ze)),N.ADD_ATTR&&(A===F&&(A=Di(A)),qe(A,N.ADD_ATTR,Ze)),N.ADD_URI_SAFE_ATTR&&qe(z,N.ADD_URI_SAFE_ATTR,Ze),N.FORBID_CONTENTS&&(x===D&&(x=Di(x)),qe(x,N.FORBID_CONTENTS,Ze)),H&&(_["#text"]=!0),K&&qe(_,["html","head","body"]),_.table&&(qe(_,["tbody"]),delete G.tbody),gr&&gr(N),Qe=N)},nt=qe({},["mi","mo","mn","ms","mtext"]),Ai=qe({},["foreignobject","desc","title","annotation-xml"]),Uo=qe({},["title","style","font","a","script"]),ol=qe({},fS);qe(ol,cS),qe(ol,Cee);var uw=qe({},hS);qe(uw,_ee);var bz=function(N){var oe=S(N);(!oe||!oe.tagName)&&(oe={namespaceURI:Xe,tagName:"template"});var ve=Gy(N.tagName),ut=Gy(oe.tagName);return He[N.namespaceURI]?N.namespaceURI===Ee?oe.namespaceURI===Ne?ve==="svg":oe.namespaceURI===me?ve==="svg"&&(ut==="annotation-xml"||nt[ut]):!!ol[ve]:N.namespaceURI===me?oe.namespaceURI===Ne?ve==="math":oe.namespaceURI===Ee?ve==="math"&&Ai[ut]:!!uw[ve]:N.namespaceURI===Ne?oe.namespaceURI===Ee&&!Ai[ut]||oe.namespaceURI===me&&!nt[ut]?!1:!uw[ve]&&(Uo[ve]||!ol[ve]):!!(rt==="application/xhtml+xml"&&He[N.namespaceURI]):!1},Un=function(N){xf(t.removed,{element:N});try{N.parentNode.removeChild(N)}catch{try{N.outerHTML=R}catch{N.remove()}}},fw=function(N,oe){try{xf(t.removed,{attribute:oe.getAttributeNode(N),from:oe})}catch{xf(t.removed,{attribute:null,from:oe})}if(oe.removeAttribute(N),N==="is"&&!A[N])if($e||Ie)try{Un(oe)}catch{}else try{oe.setAttribute(N,"")}catch{}},uP=function(N){var oe,ve;if(Ke)N="<remove></remove>"+N;else{var ut=pee(N,/^[\r\n\t ]+/);ve=ut&&ut[0]}rt==="application/xhtml+xml"&&Xe===Ne&&(N='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+N+"</body></html>");var br=P?P.createHTML(N):N;if(Xe===Ne)try{oe=new h().parseFromString(br,rt)}catch{}if(!oe||!oe.documentElement){oe=U.createDocument(Xe,"template",null);try{oe.documentElement.innerHTML=ht?R:br}catch{}}var rr=oe.body||oe.documentElement;return N&&ve&&rr.insertBefore(n.createTextNode(ve),rr.childNodes[0]||null),Xe===Ne?q.call(oe,K?"html":"body")[0]:K?oe.documentElement:rr},fP=function(N){return X.call(N.ownerDocument||N,N,s.SHOW_ELEMENT|s.SHOW_COMMENT|s.SHOW_TEXT,null,!1)},wz=function(N){return N instanceof c&&(typeof N.nodeName!="string"||typeof N.textContent!="string"||typeof N.removeChild!="function"||!(N.attributes instanceof f)||typeof N.removeAttribute!="function"||typeof N.setAttribute!="function"||typeof N.namespaceURI!="string"||typeof N.insertBefore!="function"||typeof N.hasChildNodes!="function")},Rf=function(N){return ni(a)==="object"?N instanceof a:N&&ni(N)==="object"&&typeof N.nodeType=="number"&&typeof N.nodeName=="string"},zn=function(N,oe,ve){J[N]&&mee(J[N],function(ut){ut.call(t,oe,ve,Qe)})},cP=function(N){var oe;if(zn("beforeSanitizeElements",N,null),wz(N)||ur(/[\u0080-\uFFFF]/,N.nodeName))return Un(N),!0;var ve=Ze(N.nodeName);if(zn("uponSanitizeElement",N,{tagName:ve,allowedTags:_}),N.hasChildNodes()&&!Rf(N.firstElementChild)&&(!Rf(N.content)||!Rf(N.content.firstElementChild))&&ur(/<[/\w]/g,N.innerHTML)&&ur(/<[/\w]/g,N.textContent)||ve==="select"&&ur(/<template/i,N.innerHTML))return Un(N),!0;if(!_[ve]||G[ve]){if(!G[ve]&&dP(ve)&&(W.tagNameCheck instanceof RegExp&&ur(W.tagNameCheck,ve)||W.tagNameCheck instanceof Function&&W.tagNameCheck(ve)))return!1;if(H&&!x[ve]){var ut=S(N)||N.parentNode,br=w(N)||N.childNodes;if(br&&ut)for(var rr=br.length,tr=rr-1;tr>=0;--tr)ut.insertBefore(g(br[tr],!0),p(N))}return Un(N),!0}return N instanceof l&&!bz(N)||(ve==="noscript"||ve==="noembed"||ve==="noframes")&&ur(/<\/no(script|embed|frames)/i,N.innerHTML)?(Un(N),!0):(ye&&N.nodeType===3&&(oe=N.textContent,oe=en(oe,le," "),oe=en(oe,Ce," "),oe=en(oe,we," "),N.textContent!==oe&&(xf(t.removed,{element:N.cloneNode()}),N.textContent=oe)),zn("afterSanitizeElements",N,null),!1)},hP=function(N,oe,ve){if(O&&(oe==="id"||oe==="name")&&(ve in n||ve in Lt))return!1;if(!(se&&!Q[oe]&&ur(_e,oe))){if(!(ee&&ur(k,oe))){if(!A[oe]||Q[oe]){if(!(dP(N)&&(W.tagNameCheck instanceof RegExp&&ur(W.tagNameCheck,N)||W.tagNameCheck instanceof Function&&W.tagNameCheck(N))&&(W.attributeNameCheck instanceof RegExp&&ur(W.attributeNameCheck,oe)||W.attributeNameCheck instanceof Function&&W.attributeNameCheck(oe))||oe==="is"&&W.allowCustomizedBuiltInElements&&(W.tagNameCheck instanceof RegExp&&ur(W.tagNameCheck,ve)||W.tagNameCheck instanceof Function&&W.tagNameCheck(ve))))return!1}else if(!z[oe]){if(!ur(b,en(ve,m,""))){if(!((oe==="src"||oe==="xlink:href"||oe==="href")&&N!=="script"&&bee(ve,"data:")===0&&B[N])){if(!(Te&&!ur(y,en(ve,m,"")))){if(ve)return!1}}}}}}return!0},dP=function(N){return N.indexOf("-")>0},vP=function(N){var oe,ve,ut,br;zn("beforeSanitizeAttributes",N,null);var rr=N.attributes;if(rr){var tr={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:A};for(br=rr.length;br--;){oe=rr[br];var kv=oe,Xt=kv.name,cw=kv.namespaceURI;if(ve=Xt==="value"?oe.value:wee(oe.value),ut=Ze(Xt),tr.attrName=ut,tr.attrValue=ve,tr.keepAttr=!0,tr.forceKeepAttr=void 0,zn("uponSanitizeAttribute",N,tr),ve=tr.attrValue,!tr.forceKeepAttr&&(fw(Xt,N),!!tr.keepAttr)){if(!de&&ur(/\/>/i,ve)){fw(Xt,N);continue}ye&&(ve=en(ve,le," "),ve=en(ve,Ce," "),ve=en(ve,we," "));var yP=Ze(N.nodeName);if(hP(yP,ut,ve)){if(E&&(ut==="id"||ut==="name")&&(fw(Xt,N),ve=$+ve),P&&ni(d)==="object"&&typeof d.getAttributeType=="function"&&!cw)switch(d.getAttributeType(yP,ut)){case"TrustedHTML":{ve=P.createHTML(ve);break}case"TrustedScriptURL":{ve=P.createScriptURL(ve);break}}try{cw?N.setAttributeNS(cw,Xt,ve):N.setAttribute(Xt,ve),e1(t.removed)}catch{}}}}zn("afterSanitizeAttributes",N,null)}},Sz=function Pe(N){var oe,ve=fP(N);for(zn("beforeSanitizeShadowDOM",N,null);oe=ve.nextNode();)zn("uponSanitizeShadowNode",oe,null),!cP(oe)&&(oe.content instanceof o&&Pe(oe.content),vP(oe));zn("afterSanitizeShadowDOM",N,null)};return t.sanitize=function(Pe){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},oe,ve,ut,br,rr;if(ht=!Pe,ht&&(Pe="<!-->"),typeof Pe!="string"&&!Rf(Pe))if(typeof Pe.toString=="function"){if(Pe=Pe.toString(),typeof Pe!="string")throw uS("dirty is not a string, aborting")}else throw uS("toString is not a function");if(!t.isSupported){if(ni(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof Pe=="string")return e.toStaticHTML(Pe);if(Rf(Pe))return e.toStaticHTML(Pe.outerHTML)}return Pe}if(xe||st(N),t.removed=[],typeof Pe=="string"&&(M=!1),M){if(Pe.nodeName){var tr=Ze(Pe.nodeName);if(!_[tr]||G[tr])throw uS("root node is forbidden and cannot be sanitized in-place")}}else if(Pe instanceof a)oe=uP("<!---->"),ve=oe.ownerDocument.importNode(Pe,!0),ve.nodeType===1&&ve.nodeName==="BODY"||ve.nodeName==="HTML"?oe=ve:oe.appendChild(ve);else{if(!$e&&!ye&&!K&&Pe.indexOf("<")===-1)return P&&Ae?P.createHTML(Pe):Pe;if(oe=uP(Pe),!oe)return $e?null:Ae?R:""}oe&&Ke&&Un(oe.firstChild);for(var kv=fP(M?Pe:oe);ut=kv.nextNode();)ut.nodeType===3&&ut===br||cP(ut)||(ut.content instanceof o&&Sz(ut.content),vP(ut),br=ut);if(br=null,M)return Pe;if($e){if(Ie)for(rr=Y.call(oe.ownerDocument);oe.firstChild;)rr.appendChild(oe.firstChild);else rr=oe;return(A.shadowroot||A.shadowrootmod)&&(rr=Z.call(r,rr,!0)),rr}var Xt=K?oe.outerHTML:oe.innerHTML;return K&&_["!doctype"]&&oe.ownerDocument&&oe.ownerDocument.doctype&&oe.ownerDocument.doctype.name&&ur(Iee,oe.ownerDocument.doctype.name)&&(Xt="<!DOCTYPE "+oe.ownerDocument.doctype.name+`>
`+Xt),ye&&(Xt=en(Xt,le," "),Xt=en(Xt,Ce," "),Xt=en(Xt,we," ")),P&&Ae?P.createHTML(Xt):Xt},t.setConfig=function(Pe){st(Pe),xe=!0},t.clearConfig=function(){Qe=null,xe=!1},t.isValidAttribute=function(Pe,N,oe){Qe||st({});var ve=Ze(Pe),ut=Ze(N);return hP(ve,ut,oe)},t.addHook=function(Pe,N){typeof N=="function"&&(J[Pe]=J[Pe]||[],xf(J[Pe],N))},t.removeHook=function(Pe){if(J[Pe])return e1(J[Pe])},t.removeHooks=function(Pe){J[Pe]&&(J[Pe]=[])},t.removeAllHooks=function(){J={}},t}var Dee=WF(),Nee=Me,Hee=g0.codeAt;Nee({target:"String",proto:!0},{codePointAt:function(t){return Hee(this,t)}});var Lee=Ei,jee=Wt,Fee=Er,Bee=RangeError,H0=function(t){var r=jee(Fee(this)),n="",o=Lee(t);if(o<0||o===1/0)throw new Bee("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(r+=r))o&1&&(n+=r);return n},UF=Ve,Vee=Xa,i1=Wt,Wee=H0,Uee=Er,zee=UF(Wee),Yee=UF("".slice),Gee=Math.ceil,a1=function(e){return function(t,r,n){var o=i1(Uee(t)),i=Vee(r),a=o.length,l=n===void 0?" ":i1(n),s,u;return i<=a||l===""?o:(s=i-a,u=zee(l,Gee(s/l.length)),u.length>s&&(u=Yee(u,0,s)),e?o+u:u+o)}},Kee={start:a1(!1),end:a1(!0)},qee=za,Xee=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(qee),Zee=Me,Jee=Kee.start,Qee=Xee;Zee({target:"String",proto:!0,forced:Qee},{padStart:function(t){return Jee(this,t,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var zF;function te(){return zF.apply(null,arguments)}function ete(e){zF=e}function hn(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function Pa(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function at(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function L0(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(at(e,t))return!1;return!0}function Sr(e){return e===void 0}function Ho(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function lv(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function YF(e,t){var r=[],n,o=e.length;for(n=0;n<o;++n)r.push(t(e[n],n));return r}function ai(e,t){for(var r in t)at(t,r)&&(e[r]=t[r]);return at(t,"toString")&&(e.toString=t.toString),at(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Vn(e,t,r,n){return gB(e,t,r,n,!0).utc()}function tte(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function We(e){return e._pf==null&&(e._pf=tte()),e._pf}var __;Array.prototype.some?__=Array.prototype.some:__=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function j0(e){if(e._isValid==null){var t=We(e),r=__.call(t.parsedDateParts,function(o){return o!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function fp(e){var t=Vn(NaN);return e!=null?ai(We(t),e):We(t).userInvalidated=!0,t}var l1=te.momentProperties=[],vS=!1;function F0(e,t){var r,n,o,i=l1.length;if(Sr(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),Sr(t._i)||(e._i=t._i),Sr(t._f)||(e._f=t._f),Sr(t._l)||(e._l=t._l),Sr(t._strict)||(e._strict=t._strict),Sr(t._tzm)||(e._tzm=t._tzm),Sr(t._isUTC)||(e._isUTC=t._isUTC),Sr(t._offset)||(e._offset=t._offset),Sr(t._pf)||(e._pf=We(t)),Sr(t._locale)||(e._locale=t._locale),i>0)for(r=0;r<i;r++)n=l1[r],o=t[n],Sr(o)||(e[n]=o);return e}function sv(e){F0(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),vS===!1&&(vS=!0,te.updateOffset(this),vS=!1)}function dn(e){return e instanceof sv||e!=null&&e._isAMomentObject!=null}function GF(e){te.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function Zr(e,t){var r=!0;return ai(function(){if(te.deprecationHandler!=null&&te.deprecationHandler(null,e),r){var n=[],o,i,a,l=arguments.length;for(i=0;i<l;i++){if(o="",typeof arguments[i]=="object"){o+=`
[`+i+"] ";for(a in arguments[0])at(arguments[0],a)&&(o+=a+": "+arguments[0][a]+", ");o=o.slice(0,-2)}else o=arguments[i];n.push(o)}GF(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var s1={};function KF(e,t){te.deprecationHandler!=null&&te.deprecationHandler(e,t),s1[e]||(GF(t),s1[e]=!0)}te.suppressDeprecationWarnings=!1;te.deprecationHandler=null;function Wn(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function rte(e){var t,r;for(r in e)at(e,r)&&(t=e[r],Wn(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function O_(e,t){var r=ai({},e),n;for(n in t)at(t,n)&&(Pa(e[n])&&Pa(t[n])?(r[n]={},ai(r[n],e[n]),ai(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)at(e,n)&&!at(t,n)&&Pa(e[n])&&(r[n]=ai({},r[n]));return r}function B0(e){e!=null&&this.set(e)}var R_;Object.keys?R_=Object.keys:R_=function(e){var t,r=[];for(t in e)at(e,t)&&r.push(t);return r};var nte={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function ote(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return Wn(n)?n.call(t,r):n}function Nn(e,t,r){var n=""+Math.abs(e),o=t-n.length,i=e>=0;return(i?r?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+n}var V0=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Uv=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,yS={},zl={};function ke(e,t,r,n){var o=n;typeof n=="string"&&(o=function(){return this[n]()}),e&&(zl[e]=o),t&&(zl[t[0]]=function(){return Nn(o.apply(this,arguments),t[1],t[2])}),r&&(zl[r]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function ite(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function ate(e){var t=e.match(V0),r,n;for(r=0,n=t.length;r<n;r++)zl[t[r]]?t[r]=zl[t[r]]:t[r]=ite(t[r]);return function(o){var i="",a;for(a=0;a<n;a++)i+=Wn(t[a])?t[a].call(o,e):t[a];return i}}function Ky(e,t){return e.isValid()?(t=qF(t,e.localeData()),yS[t]=yS[t]||ate(t),yS[t](e)):e.localeData().invalidDate()}function qF(e,t){var r=5;function n(o){return t.longDateFormat(o)||o}for(Uv.lastIndex=0;r>=0&&Uv.test(e);)e=e.replace(Uv,n),Uv.lastIndex=0,r-=1;return e}var lte={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function ste(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(V0).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var ute="Invalid date";function fte(){return this._invalidDate}var cte="%d",hte=/\d{1,2}/;function dte(e){return this._ordinal.replace("%d",e)}var vte={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function yte(e,t,r,n){var o=this._relativeTime[r];return Wn(o)?o(e,t,r,n):o.replace(/%d/i,e)}function gte(e,t){var r=this._relativeTime[e>0?"future":"past"];return Wn(r)?r(t):r.replace(/%s/i,t)}var dc={};function lr(e,t){var r=e.toLowerCase();dc[r]=dc[r+"s"]=dc[t]=e}function Jr(e){return typeof e=="string"?dc[e]||dc[e.toLowerCase()]:void 0}function W0(e){var t={},r,n;for(n in e)at(e,n)&&(r=Jr(n),r&&(t[r]=e[n]));return t}var XF={};function sr(e,t){XF[e]=t}function mte(e){var t=[],r;for(r in e)at(e,r)&&t.push({unit:r,priority:XF[r]});return t.sort(function(n,o){return n.priority-o.priority}),t}function cp(e){return e%4===0&&e%100!==0||e%400===0}function Yr(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function Je(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=Yr(t)),r}function mf(e,t){return function(r){return r!=null?(ZF(this,e,r),te.updateOffset(this,t),this):xg(this,e)}}function xg(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function ZF(e,t,r){e.isValid()&&!isNaN(r)&&(t==="FullYear"&&cp(e.year())&&e.month()===1&&e.date()===29?(r=Je(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),mp(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function pte(e){return e=Jr(e),Wn(this[e])?this[e]():this}function bte(e,t){if(typeof e=="object"){e=W0(e);var r=mte(e),n,o=r.length;for(n=0;n<o;n++)this[r[n].unit](e[r[n].unit])}else if(e=Jr(e),Wn(this[e]))return this[e](t);return this}var JF=/\d/,Br=/\d\d/,QF=/\d{3}/,U0=/\d{4}/,hp=/[+-]?\d{6}/,Ot=/\d\d?/,eB=/\d\d\d\d?/,tB=/\d\d\d\d\d\d?/,dp=/\d{1,3}/,z0=/\d{1,4}/,vp=/[+-]?\d{1,6}/,pf=/\d+/,yp=/[+-]?\d+/,wte=/Z|[+-]\d\d:?\d\d/gi,gp=/Z|[+-]\d\d(?::?\d\d)?/gi,Ste=/[+-]?\d+(\.\d{1,3})?/,uv=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Dg;Dg={};function Se(e,t,r){Dg[e]=Wn(t)?t:function(n,o){return n&&r?r:t}}function Cte(e,t){return at(Dg,e)?Dg[e](t._strict,t._locale):new RegExp(_te(e))}function _te(e){return Hr(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,o,i){return r||n||o||i}))}function Hr(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var E_={};function mt(e,t){var r,n=t,o;for(typeof e=="string"&&(e=[e]),Ho(t)&&(n=function(i,a){a[t]=Je(i)}),o=e.length,r=0;r<o;r++)E_[e[r]]=n}function fv(e,t){mt(e,function(r,n,o,i){o._w=o._w||{},t(r,o._w,o,i)})}function Ote(e,t,r){t!=null&&at(E_,e)&&E_[e](t,r._a,r,e)}var ir=0,ao=1,In=2,Kt=3,un=4,lo=5,Ji=6,Rte=7,Ete=8;function Tte(e,t){return(e%t+t)%t}var Ft;Array.prototype.indexOf?Ft=Array.prototype.indexOf:Ft=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function mp(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=Tte(t,12);return e+=(t-r)/12,r===1?cp(e)?29:28:31-r%7%2}ke("M",["MM",2],"Mo",function(){return this.month()+1});ke("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});ke("MMMM",0,0,function(e){return this.localeData().months(this,e)});lr("month","M");sr("month",8);Se("M",Ot);Se("MM",Ot,Br);Se("MMM",function(e,t){return t.monthsShortRegex(e)});Se("MMMM",function(e,t){return t.monthsRegex(e)});mt(["M","MM"],function(e,t){t[ao]=Je(e)-1});mt(["MMM","MMMM"],function(e,t,r,n){var o=r._locale.monthsParse(e,n,r._strict);o!=null?t[ao]=o:We(r).invalidMonth=e});var Pte="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),rB="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),nB=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,kte=uv,$te=uv;function Ate(e,t){return e?hn(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||nB).test(t)?"format":"standalone"][e.month()]:hn(this._months)?this._months:this._months.standalone}function Ite(e,t){return e?hn(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[nB.test(t)?"format":"standalone"][e.month()]:hn(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Mte(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=Vn([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return r?t==="MMM"?(o=Ft.call(this._shortMonthsParse,a),o!==-1?o:null):(o=Ft.call(this._longMonthsParse,a),o!==-1?o:null):t==="MMM"?(o=Ft.call(this._shortMonthsParse,a),o!==-1?o:(o=Ft.call(this._longMonthsParse,a),o!==-1?o:null)):(o=Ft.call(this._longMonthsParse,a),o!==-1?o:(o=Ft.call(this._shortMonthsParse,a),o!==-1?o:null))}function xte(e,t,r){var n,o,i;if(this._monthsParseExact)return Mte.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(o=Vn([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function oB(e,t){var r;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=Je(t);else if(t=e.localeData().monthsParse(t),!Ho(t))return e}return r=Math.min(e.date(),mp(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function iB(e){return e!=null?(oB(this,e),te.updateOffset(this,!0),this):xg(this,"Month")}function Dte(){return mp(this.year(),this.month())}function Nte(e){return this._monthsParseExact?(at(this,"_monthsRegex")||aB.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(at(this,"_monthsShortRegex")||(this._monthsShortRegex=kte),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function Hte(e){return this._monthsParseExact?(at(this,"_monthsRegex")||aB.call(this),e?this._monthsStrictRegex:this._monthsRegex):(at(this,"_monthsRegex")||(this._monthsRegex=$te),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function aB(){function e(a,l){return l.length-a.length}var t=[],r=[],n=[],o,i;for(o=0;o<12;o++)i=Vn([2e3,o]),t.push(this.monthsShort(i,"")),r.push(this.months(i,"")),n.push(this.months(i,"")),n.push(this.monthsShort(i,""));for(t.sort(e),r.sort(e),n.sort(e),o=0;o<12;o++)t[o]=Hr(t[o]),r[o]=Hr(r[o]);for(o=0;o<24;o++)n[o]=Hr(n[o]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}ke("Y",0,0,function(){var e=this.year();return e<=9999?Nn(e,4):"+"+e});ke(0,["YY",2],0,function(){return this.year()%100});ke(0,["YYYY",4],0,"year");ke(0,["YYYYY",5],0,"year");ke(0,["YYYYYY",6,!0],0,"year");lr("year","y");sr("year",1);Se("Y",yp);Se("YY",Ot,Br);Se("YYYY",z0,U0);Se("YYYYY",vp,hp);Se("YYYYYY",vp,hp);mt(["YYYYY","YYYYYY"],ir);mt("YYYY",function(e,t){t[ir]=e.length===2?te.parseTwoDigitYear(e):Je(e)});mt("YY",function(e,t){t[ir]=te.parseTwoDigitYear(e)});mt("Y",function(e,t){t[ir]=parseInt(e,10)});function vc(e){return cp(e)?366:365}te.parseTwoDigitYear=function(e){return Je(e)+(Je(e)>68?1900:2e3)};var lB=mf("FullYear",!0);function Lte(){return cp(this.year())}function jte(e,t,r,n,o,i,a){var l;return e<100&&e>=0?(l=new Date(e+400,t,r,n,o,i,a),isFinite(l.getFullYear())&&l.setFullYear(e)):l=new Date(e,t,r,n,o,i,a),l}function Ac(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function Ng(e,t,r){var n=7+t-r,o=(7+Ac(e,0,n).getUTCDay()-t)%7;return-o+n-1}function sB(e,t,r,n,o){var i=(7+r-n)%7,a=Ng(e,n,o),l=1+7*(t-1)+i+a,s,u;return l<=0?(s=e-1,u=vc(s)+l):l>vc(e)?(s=e+1,u=l-vc(e)):(s=e,u=l),{year:s,dayOfYear:u}}function Ic(e,t,r){var n=Ng(e.year(),t,r),o=Math.floor((e.dayOfYear()-n-1)/7)+1,i,a;return o<1?(a=e.year()-1,i=o+Mo(a,t,r)):o>Mo(e.year(),t,r)?(i=o-Mo(e.year(),t,r),a=e.year()+1):(a=e.year(),i=o),{week:i,year:a}}function Mo(e,t,r){var n=Ng(e,t,r),o=Ng(e+1,t,r);return(vc(e)-n+o)/7}ke("w",["ww",2],"wo","week");ke("W",["WW",2],"Wo","isoWeek");lr("week","w");lr("isoWeek","W");sr("week",5);sr("isoWeek",5);Se("w",Ot);Se("ww",Ot,Br);Se("W",Ot);Se("WW",Ot,Br);fv(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=Je(e)});function Fte(e){return Ic(e,this._week.dow,this._week.doy).week}var Bte={dow:0,doy:6};function Vte(){return this._week.dow}function Wte(){return this._week.doy}function Ute(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function zte(e){var t=Ic(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}ke("d",0,"do","day");ke("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});ke("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});ke("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});ke("e",0,0,"weekday");ke("E",0,0,"isoWeekday");lr("day","d");lr("weekday","e");lr("isoWeekday","E");sr("day",11);sr("weekday",11);sr("isoWeekday",11);Se("d",Ot);Se("e",Ot);Se("E",Ot);Se("dd",function(e,t){return t.weekdaysMinRegex(e)});Se("ddd",function(e,t){return t.weekdaysShortRegex(e)});Se("dddd",function(e,t){return t.weekdaysRegex(e)});fv(["dd","ddd","dddd"],function(e,t,r,n){var o=r._locale.weekdaysParse(e,n,r._strict);o!=null?t.d=o:We(r).invalidWeekday=e});fv(["d","e","E"],function(e,t,r,n){t[n]=Je(e)});function Yte(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function Gte(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function Y0(e,t){return e.slice(t,7).concat(e.slice(0,t))}var Kte="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),uB="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),qte="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Xte=uv,Zte=uv,Jte=uv;function Qte(e,t){var r=hn(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?Y0(r,this._week.dow):e?r[e.day()]:r}function ere(e){return e===!0?Y0(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function tre(e){return e===!0?Y0(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function rre(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=Vn([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return r?t==="dddd"?(o=Ft.call(this._weekdaysParse,a),o!==-1?o:null):t==="ddd"?(o=Ft.call(this._shortWeekdaysParse,a),o!==-1?o:null):(o=Ft.call(this._minWeekdaysParse,a),o!==-1?o:null):t==="dddd"?(o=Ft.call(this._weekdaysParse,a),o!==-1||(o=Ft.call(this._shortWeekdaysParse,a),o!==-1)?o:(o=Ft.call(this._minWeekdaysParse,a),o!==-1?o:null)):t==="ddd"?(o=Ft.call(this._shortWeekdaysParse,a),o!==-1||(o=Ft.call(this._weekdaysParse,a),o!==-1)?o:(o=Ft.call(this._minWeekdaysParse,a),o!==-1?o:null)):(o=Ft.call(this._minWeekdaysParse,a),o!==-1||(o=Ft.call(this._weekdaysParse,a),o!==-1)?o:(o=Ft.call(this._shortWeekdaysParse,a),o!==-1?o:null))}function nre(e,t,r){var n,o,i;if(this._weekdaysParseExact)return rre.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(o=Vn([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function ore(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=Yte(e,this.localeData()),this.add(e-t,"d")):t}function ire(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function are(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=Gte(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function lre(e){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||G0.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(at(this,"_weekdaysRegex")||(this._weekdaysRegex=Xte),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function sre(e){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||G0.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(at(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Zte),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function ure(e){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||G0.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(at(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Jte),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function G0(){function e(f,c){return c.length-f.length}var t=[],r=[],n=[],o=[],i,a,l,s,u;for(i=0;i<7;i++)a=Vn([2e3,1]).day(i),l=Hr(this.weekdaysMin(a,"")),s=Hr(this.weekdaysShort(a,"")),u=Hr(this.weekdays(a,"")),t.push(l),r.push(s),n.push(u),o.push(l),o.push(s),o.push(u);t.sort(e),r.sort(e),n.sort(e),o.sort(e),this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function K0(){return this.hours()%12||12}function fre(){return this.hours()||24}ke("H",["HH",2],0,"hour");ke("h",["hh",2],0,K0);ke("k",["kk",2],0,fre);ke("hmm",0,0,function(){return""+K0.apply(this)+Nn(this.minutes(),2)});ke("hmmss",0,0,function(){return""+K0.apply(this)+Nn(this.minutes(),2)+Nn(this.seconds(),2)});ke("Hmm",0,0,function(){return""+this.hours()+Nn(this.minutes(),2)});ke("Hmmss",0,0,function(){return""+this.hours()+Nn(this.minutes(),2)+Nn(this.seconds(),2)});function fB(e,t){ke(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}fB("a",!0);fB("A",!1);lr("hour","h");sr("hour",13);function cB(e,t){return t._meridiemParse}Se("a",cB);Se("A",cB);Se("H",Ot);Se("h",Ot);Se("k",Ot);Se("HH",Ot,Br);Se("hh",Ot,Br);Se("kk",Ot,Br);Se("hmm",eB);Se("hmmss",tB);Se("Hmm",eB);Se("Hmmss",tB);mt(["H","HH"],Kt);mt(["k","kk"],function(e,t,r){var n=Je(e);t[Kt]=n===24?0:n});mt(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});mt(["h","hh"],function(e,t,r){t[Kt]=Je(e),We(r).bigHour=!0});mt("hmm",function(e,t,r){var n=e.length-2;t[Kt]=Je(e.substr(0,n)),t[un]=Je(e.substr(n)),We(r).bigHour=!0});mt("hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[Kt]=Je(e.substr(0,n)),t[un]=Je(e.substr(n,2)),t[lo]=Je(e.substr(o)),We(r).bigHour=!0});mt("Hmm",function(e,t,r){var n=e.length-2;t[Kt]=Je(e.substr(0,n)),t[un]=Je(e.substr(n))});mt("Hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[Kt]=Je(e.substr(0,n)),t[un]=Je(e.substr(n,2)),t[lo]=Je(e.substr(o))});function cre(e){return(e+"").toLowerCase().charAt(0)==="p"}var hre=/[ap]\.?m?\.?/i,dre=mf("Hours",!0);function vre(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var hB={calendar:nte,longDateFormat:lte,invalidDate:ute,ordinal:cte,dayOfMonthOrdinalParse:hte,relativeTime:vte,months:Pte,monthsShort:rB,week:Bte,weekdays:Kte,weekdaysMin:qte,weekdaysShort:uB,meridiemParse:hre},Rt={},Df={},Mc;function yre(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function u1(e){return e&&e.toLowerCase().replace("_","-")}function gre(e){for(var t=0,r,n,o,i;t<e.length;){for(i=u1(e[t]).split("-"),r=i.length,n=u1(e[t+1]),n=n?n.split("-"):null;r>0;){if(o=pp(i.slice(0,r).join("-")),o)return o;if(n&&n.length>=r&&yre(i,n)>=r-1)break;r--}t++}return Mc}function mre(e){return e.match("^[^/\\\\]*$")!=null}function pp(e){var t=null,r;if(Rt[e]===void 0&&typeof module<"u"&&module&&module.exports&&mre(e))try{t=Mc._abbr,r=require,r("./locale/"+e),ci(t)}catch{Rt[e]=null}return Rt[e]}function ci(e,t){var r;return e&&(Sr(t)?r=Vo(e):r=q0(e,t),r?Mc=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Mc._abbr}function q0(e,t){if(t!==null){var r,n=hB;if(t.abbr=e,Rt[e]!=null)KF("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Rt[e]._config;else if(t.parentLocale!=null)if(Rt[t.parentLocale]!=null)n=Rt[t.parentLocale]._config;else if(r=pp(t.parentLocale),r!=null)n=r._config;else return Df[t.parentLocale]||(Df[t.parentLocale]=[]),Df[t.parentLocale].push({name:e,config:t}),null;return Rt[e]=new B0(O_(n,t)),Df[e]&&Df[e].forEach(function(o){q0(o.name,o.config)}),ci(e),Rt[e]}else return delete Rt[e],null}function pre(e,t){if(t!=null){var r,n,o=hB;Rt[e]!=null&&Rt[e].parentLocale!=null?Rt[e].set(O_(Rt[e]._config,t)):(n=pp(e),n!=null&&(o=n._config),t=O_(o,t),n==null&&(t.abbr=e),r=new B0(t),r.parentLocale=Rt[e],Rt[e]=r),ci(e)}else Rt[e]!=null&&(Rt[e].parentLocale!=null?(Rt[e]=Rt[e].parentLocale,e===ci()&&ci(e)):Rt[e]!=null&&delete Rt[e]);return Rt[e]}function Vo(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Mc;if(!hn(e)){if(t=pp(e),t)return t;e=[e]}return gre(e)}function bre(){return R_(Rt)}function X0(e){var t,r=e._a;return r&&We(e).overflow===-2&&(t=r[ao]<0||r[ao]>11?ao:r[In]<1||r[In]>mp(r[ir],r[ao])?In:r[Kt]<0||r[Kt]>24||r[Kt]===24&&(r[un]!==0||r[lo]!==0||r[Ji]!==0)?Kt:r[un]<0||r[un]>59?un:r[lo]<0||r[lo]>59?lo:r[Ji]<0||r[Ji]>999?Ji:-1,We(e)._overflowDayOfYear&&(t<ir||t>In)&&(t=In),We(e)._overflowWeeks&&t===-1&&(t=Rte),We(e)._overflowWeekday&&t===-1&&(t=Ete),We(e).overflow=t),e}var wre=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Sre=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Cre=/Z|[+-]\d\d(?::?\d\d)?/,zv=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],gS=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],_re=/^\/?Date\((-?\d+)/i,Ore=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Rre={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function dB(e){var t,r,n=e._i,o=wre.exec(n)||Sre.exec(n),i,a,l,s,u=zv.length,f=gS.length;if(o){for(We(e).iso=!0,t=0,r=u;t<r;t++)if(zv[t][1].exec(o[1])){a=zv[t][0],i=zv[t][2]!==!1;break}if(a==null){e._isValid=!1;return}if(o[3]){for(t=0,r=f;t<r;t++)if(gS[t][1].exec(o[3])){l=(o[2]||" ")+gS[t][0];break}if(l==null){e._isValid=!1;return}}if(!i&&l!=null){e._isValid=!1;return}if(o[4])if(Cre.exec(o[4]))s="Z";else{e._isValid=!1;return}e._f=a+(l||"")+(s||""),J0(e)}else e._isValid=!1}function Ere(e,t,r,n,o,i){var a=[Tre(e),rB.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(o,10)];return i&&a.push(parseInt(i,10)),a}function Tre(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function Pre(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function kre(e,t,r){if(e){var n=uB.indexOf(e),o=new Date(t[0],t[1],t[2]).getDay();if(n!==o)return We(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function $re(e,t,r){if(e)return Rre[e];if(t)return 0;var n=parseInt(r,10),o=n%100,i=(n-o)/100;return i*60+o}function vB(e){var t=Ore.exec(Pre(e._i)),r;if(t){if(r=Ere(t[4],t[3],t[2],t[5],t[6],t[7]),!kre(t[1],r,e))return;e._a=r,e._tzm=$re(t[8],t[9],t[10]),e._d=Ac.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),We(e).rfc2822=!0}else e._isValid=!1}function Are(e){var t=_re.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(dB(e),e._isValid===!1)delete e._isValid;else return;if(vB(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:te.createFromInputFallback(e)}te.createFromInputFallback=Zr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function Nl(e,t,r){return e??t??r}function Ire(e){var t=new Date(te.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function Z0(e){var t,r,n=[],o,i,a;if(!e._d){for(o=Ire(e),e._w&&e._a[In]==null&&e._a[ao]==null&&Mre(e),e._dayOfYear!=null&&(a=Nl(e._a[ir],o[ir]),(e._dayOfYear>vc(a)||e._dayOfYear===0)&&(We(e)._overflowDayOfYear=!0),r=Ac(a,0,e._dayOfYear),e._a[ao]=r.getUTCMonth(),e._a[In]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=o[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[Kt]===24&&e._a[un]===0&&e._a[lo]===0&&e._a[Ji]===0&&(e._nextDay=!0,e._a[Kt]=0),e._d=(e._useUTC?Ac:jte).apply(null,n),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Kt]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==i&&(We(e).weekdayMismatch=!0)}}function Mre(e){var t,r,n,o,i,a,l,s,u;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(i=1,a=4,r=Nl(t.GG,e._a[ir],Ic(_t(),1,4).year),n=Nl(t.W,1),o=Nl(t.E,1),(o<1||o>7)&&(s=!0)):(i=e._locale._week.dow,a=e._locale._week.doy,u=Ic(_t(),i,a),r=Nl(t.gg,e._a[ir],u.year),n=Nl(t.w,u.week),t.d!=null?(o=t.d,(o<0||o>6)&&(s=!0)):t.e!=null?(o=t.e+i,(t.e<0||t.e>6)&&(s=!0)):o=i),n<1||n>Mo(r,i,a)?We(e)._overflowWeeks=!0:s!=null?We(e)._overflowWeekday=!0:(l=sB(r,n,o,i,a),e._a[ir]=l.year,e._dayOfYear=l.dayOfYear)}te.ISO_8601=function(){};te.RFC_2822=function(){};function J0(e){if(e._f===te.ISO_8601){dB(e);return}if(e._f===te.RFC_2822){vB(e);return}e._a=[],We(e).empty=!0;var t=""+e._i,r,n,o,i,a,l=t.length,s=0,u,f;for(o=qF(e._f,e._locale).match(V0)||[],f=o.length,r=0;r<f;r++)i=o[r],n=(t.match(Cte(i,e))||[])[0],n&&(a=t.substr(0,t.indexOf(n)),a.length>0&&We(e).unusedInput.push(a),t=t.slice(t.indexOf(n)+n.length),s+=n.length),zl[i]?(n?We(e).empty=!1:We(e).unusedTokens.push(i),Ote(i,n,e)):e._strict&&!n&&We(e).unusedTokens.push(i);We(e).charsLeftOver=l-s,t.length>0&&We(e).unusedInput.push(t),e._a[Kt]<=12&&We(e).bigHour===!0&&e._a[Kt]>0&&(We(e).bigHour=void 0),We(e).parsedDateParts=e._a.slice(0),We(e).meridiem=e._meridiem,e._a[Kt]=xre(e._locale,e._a[Kt],e._meridiem),u=We(e).era,u!==null&&(e._a[ir]=e._locale.erasConvertYear(u,e._a[ir])),Z0(e),X0(e)}function xre(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function Dre(e){var t,r,n,o,i,a,l=!1,s=e._f.length;if(s===0){We(e).invalidFormat=!0,e._d=new Date(NaN);return}for(o=0;o<s;o++)i=0,a=!1,t=F0({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[o],J0(t),j0(t)&&(a=!0),i+=We(t).charsLeftOver,i+=We(t).unusedTokens.length*10,We(t).score=i,l?i<n&&(n=i,r=t):(n==null||i<n||a)&&(n=i,r=t,a&&(l=!0));ai(e,r||t)}function Nre(e){if(!e._d){var t=W0(e._i),r=t.day===void 0?t.date:t.day;e._a=YF([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),Z0(e)}}function Hre(e){var t=new sv(X0(yB(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function yB(e){var t=e._i,r=e._f;return e._locale=e._locale||Vo(e._l),t===null||r===void 0&&t===""?fp({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),dn(t)?new sv(X0(t)):(lv(t)?e._d=t:hn(r)?Dre(e):r?J0(e):Lre(e),j0(e)||(e._d=null),e))}function Lre(e){var t=e._i;Sr(t)?e._d=new Date(te.now()):lv(t)?e._d=new Date(t.valueOf()):typeof t=="string"?Are(e):hn(t)?(e._a=YF(t.slice(0),function(r){return parseInt(r,10)}),Z0(e)):Pa(t)?Nre(e):Ho(t)?e._d=new Date(t):te.createFromInputFallback(e)}function gB(e,t,r,n,o){var i={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Pa(e)&&L0(e)||hn(e)&&e.length===0)&&(e=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=o,i._l=r,i._i=e,i._f=t,i._strict=n,Hre(i)}function _t(e,t,r,n){return gB(e,t,r,n,!1)}var jre=Zr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=_t.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:fp()}),Fre=Zr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=_t.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:fp()});function mB(e,t){var r,n;if(t.length===1&&hn(t[0])&&(t=t[0]),!t.length)return _t();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function Bre(){var e=[].slice.call(arguments,0);return mB("isBefore",e)}function Vre(){var e=[].slice.call(arguments,0);return mB("isAfter",e)}var Wre=function(){return Date.now?Date.now():+new Date},Nf=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Ure(e){var t,r=!1,n,o=Nf.length;for(t in e)if(at(e,t)&&!(Ft.call(Nf,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<o;++n)if(e[Nf[n]]){if(r)return!1;parseFloat(e[Nf[n]])!==Je(e[Nf[n]])&&(r=!0)}return!0}function zre(){return this._isValid}function Yre(){return gn(NaN)}function bp(e){var t=W0(e),r=t.year||0,n=t.quarter||0,o=t.month||0,i=t.week||t.isoWeek||0,a=t.day||0,l=t.hour||0,s=t.minute||0,u=t.second||0,f=t.millisecond||0;this._isValid=Ure(t),this._milliseconds=+f+u*1e3+s*6e4+l*1e3*60*60,this._days=+a+i*7,this._months=+o+n*3+r*12,this._data={},this._locale=Vo(),this._bubble()}function qy(e){return e instanceof bp}function T_(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function Gre(e,t,r){var n=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),i=0,a;for(a=0;a<n;a++)(r&&e[a]!==t[a]||!r&&Je(e[a])!==Je(t[a]))&&i++;return i+o}function pB(e,t){ke(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Nn(~~(r/60),2)+t+Nn(~~r%60,2)})}pB("Z",":");pB("ZZ","");Se("Z",gp);Se("ZZ",gp);mt(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=Q0(gp,e)});var Kre=/([\+\-]|\d\d)/gi;function Q0(e,t){var r=(t||"").match(e),n,o,i;return r===null?null:(n=r[r.length-1]||[],o=(n+"").match(Kre)||["-",0,0],i=+(o[1]*60)+Je(o[2]),i===0?0:o[0]==="+"?i:-i)}function eT(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(dn(e)||lv(e)?e.valueOf():_t(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),te.updateOffset(r,!1),r):_t(e).local()}function P_(e){return-Math.round(e._d.getTimezoneOffset())}te.updateOffset=function(){};function qre(e,t,r){var n=this._offset||0,o;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=Q0(gp,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(o=P_(this)),this._offset=e,this._isUTC=!0,o!=null&&this.add(o,"m"),n!==e&&(!t||this._changeInProgress?SB(this,gn(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,te.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:P_(this)}function Xre(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Zre(e){return this.utcOffset(0,e)}function Jre(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(P_(this),"m")),this}function Qre(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=Q0(wte,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function ene(e){return this.isValid()?(e=e?_t(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function tne(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function rne(){if(!Sr(this._isDSTShifted))return this._isDSTShifted;var e={},t;return F0(e,this),e=yB(e),e._a?(t=e._isUTC?Vn(e._a):_t(e._a),this._isDSTShifted=this.isValid()&&Gre(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function nne(){return this.isValid()?!this._isUTC:!1}function one(){return this.isValid()?this._isUTC:!1}function bB(){return this.isValid()?this._isUTC&&this._offset===0:!1}var ine=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,ane=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function gn(e,t){var r=e,n=null,o,i,a;return qy(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:Ho(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=ine.exec(e))?(o=n[1]==="-"?-1:1,r={y:0,d:Je(n[In])*o,h:Je(n[Kt])*o,m:Je(n[un])*o,s:Je(n[lo])*o,ms:Je(T_(n[Ji]*1e3))*o}):(n=ane.exec(e))?(o=n[1]==="-"?-1:1,r={y:Ni(n[2],o),M:Ni(n[3],o),w:Ni(n[4],o),d:Ni(n[5],o),h:Ni(n[6],o),m:Ni(n[7],o),s:Ni(n[8],o)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(a=lne(_t(r.from),_t(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),i=new bp(r),qy(e)&&at(e,"_locale")&&(i._locale=e._locale),qy(e)&&at(e,"_isValid")&&(i._isValid=e._isValid),i}gn.fn=bp.prototype;gn.invalid=Yre;function Ni(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function f1(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function lne(e,t){var r;return e.isValid()&&t.isValid()?(t=eT(t,e),e.isBefore(t)?r=f1(e,t):(r=f1(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function wB(e,t){return function(r,n){var o,i;return n!==null&&!isNaN(+n)&&(KF(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=r,r=n,n=i),o=gn(r,n),SB(this,o,e),this}}function SB(e,t,r,n){var o=t._milliseconds,i=T_(t._days),a=T_(t._months);e.isValid()&&(n=n??!0,a&&oB(e,xg(e,"Month")+a*r),i&&ZF(e,"Date",xg(e,"Date")+i*r),o&&e._d.setTime(e._d.valueOf()+o*r),n&&te.updateOffset(e,i||a))}var sne=wB(1,"add"),une=wB(-1,"subtract");function CB(e){return typeof e=="string"||e instanceof String}function fne(e){return dn(e)||lv(e)||CB(e)||Ho(e)||hne(e)||cne(e)||e===null||e===void 0}function cne(e){var t=Pa(e)&&!L0(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],o,i,a=n.length;for(o=0;o<a;o+=1)i=n[o],r=r||at(e,i);return t&&r}function hne(e){var t=hn(e),r=!1;return t&&(r=e.filter(function(n){return!Ho(n)&&CB(e)}).length===0),t&&r}function dne(e){var t=Pa(e)&&!L0(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],o,i;for(o=0;o<n.length;o+=1)i=n[o],r=r||at(e,i);return t&&r}function vne(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function yne(e,t){arguments.length===1&&(arguments[0]?fne(arguments[0])?(e=arguments[0],t=void 0):dne(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||_t(),n=eT(r,this).startOf("day"),o=te.calendarFormat(this,n)||"sameElse",i=t&&(Wn(t[o])?t[o].call(this,r):t[o]);return this.format(i||this.localeData().calendar(o,this,_t(r)))}function gne(){return new sv(this)}function mne(e,t){var r=dn(e)?e:_t(e);return this.isValid()&&r.isValid()?(t=Jr(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function pne(e,t){var r=dn(e)?e:_t(e);return this.isValid()&&r.isValid()?(t=Jr(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function bne(e,t,r,n){var o=dn(e)?e:_t(e),i=dn(t)?t:_t(t);return this.isValid()&&o.isValid()&&i.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(o,r):!this.isBefore(o,r))&&(n[1]===")"?this.isBefore(i,r):!this.isAfter(i,r))):!1}function wne(e,t){var r=dn(e)?e:_t(e),n;return this.isValid()&&r.isValid()?(t=Jr(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function Sne(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function Cne(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function _ne(e,t,r){var n,o,i;if(!this.isValid())return NaN;if(n=eT(e,this),!n.isValid())return NaN;switch(o=(n.utcOffset()-this.utcOffset())*6e4,t=Jr(t),t){case"year":i=Xy(this,n)/12;break;case"month":i=Xy(this,n);break;case"quarter":i=Xy(this,n)/3;break;case"second":i=(this-n)/1e3;break;case"minute":i=(this-n)/6e4;break;case"hour":i=(this-n)/36e5;break;case"day":i=(this-n-o)/864e5;break;case"week":i=(this-n-o)/6048e5;break;default:i=this-n}return r?i:Yr(i)}function Xy(e,t){if(e.date()<t.date())return-Xy(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),o,i;return t-n<0?(o=e.clone().add(r-1,"months"),i=(t-n)/(n-o)):(o=e.clone().add(r+1,"months"),i=(t-n)/(o-n)),-(r+i)||0}te.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";te.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function One(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Rne(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?Ky(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Wn(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Ky(r,"Z")):Ky(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Ene(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,o,i;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",i=t+'[")]',this.format(r+n+o+i)}function Tne(e){e||(e=this.isUtc()?te.defaultFormatUtc:te.defaultFormat);var t=Ky(this,e);return this.localeData().postformat(t)}function Pne(e,t){return this.isValid()&&(dn(e)&&e.isValid()||_t(e).isValid())?gn({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function kne(e){return this.from(_t(),e)}function $ne(e,t){return this.isValid()&&(dn(e)&&e.isValid()||_t(e).isValid())?gn({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Ane(e){return this.to(_t(),e)}function _B(e){var t;return e===void 0?this._locale._abbr:(t=Vo(e),t!=null&&(this._locale=t),this)}var OB=Zr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function RB(){return this._locale}var Hg=1e3,Yl=60*Hg,Lg=60*Yl,EB=(365*400+97)*24*Lg;function Gl(e,t){return(e%t+t)%t}function TB(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-EB:new Date(e,t,r).valueOf()}function PB(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-EB:Date.UTC(e,t,r)}function Ine(e){var t,r;if(e=Jr(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?PB:TB,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=Gl(t+(this._isUTC?0:this.utcOffset()*Yl),Lg);break;case"minute":t=this._d.valueOf(),t-=Gl(t,Yl);break;case"second":t=this._d.valueOf(),t-=Gl(t,Hg);break}return this._d.setTime(t),te.updateOffset(this,!0),this}function Mne(e){var t,r;if(e=Jr(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?PB:TB,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=Lg-Gl(t+(this._isUTC?0:this.utcOffset()*Yl),Lg)-1;break;case"minute":t=this._d.valueOf(),t+=Yl-Gl(t,Yl)-1;break;case"second":t=this._d.valueOf(),t+=Hg-Gl(t,Hg)-1;break}return this._d.setTime(t),te.updateOffset(this,!0),this}function xne(){return this._d.valueOf()-(this._offset||0)*6e4}function Dne(){return Math.floor(this.valueOf()/1e3)}function Nne(){return new Date(this.valueOf())}function Hne(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Lne(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function jne(){return this.isValid()?this.toISOString():null}function Fne(){return j0(this)}function Bne(){return ai({},We(this))}function Vne(){return We(this).overflow}function Wne(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}ke("N",0,0,"eraAbbr");ke("NN",0,0,"eraAbbr");ke("NNN",0,0,"eraAbbr");ke("NNNN",0,0,"eraName");ke("NNNNN",0,0,"eraNarrow");ke("y",["y",1],"yo","eraYear");ke("y",["yy",2],0,"eraYear");ke("y",["yyy",3],0,"eraYear");ke("y",["yyyy",4],0,"eraYear");Se("N",tT);Se("NN",tT);Se("NNN",tT);Se("NNNN",eoe);Se("NNNNN",toe);mt(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var o=r._locale.erasParse(e,n,r._strict);o?We(r).era=o:We(r).invalidEra=e});Se("y",pf);Se("yy",pf);Se("yyy",pf);Se("yyyy",pf);Se("yo",roe);mt(["y","yy","yyy","yyyy"],ir);mt(["yo"],function(e,t,r,n){var o;r._locale._eraYearOrdinalRegex&&(o=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[ir]=r._locale.eraYearOrdinalParse(e,o):t[ir]=parseInt(e,10)});function Une(e,t){var r,n,o,i=this._eras||Vo("en")._eras;for(r=0,n=i.length;r<n;++r){switch(typeof i[r].since){case"string":o=te(i[r].since).startOf("day"),i[r].since=o.valueOf();break}switch(typeof i[r].until){case"undefined":i[r].until=1/0;break;case"string":o=te(i[r].until).startOf("day").valueOf(),i[r].until=o.valueOf();break}}return i}function zne(e,t,r){var n,o,i=this.eras(),a,l,s;for(e=e.toUpperCase(),n=0,o=i.length;n<o;++n)if(a=i[n].name.toUpperCase(),l=i[n].abbr.toUpperCase(),s=i[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(l===e)return i[n];break;case"NNNN":if(a===e)return i[n];break;case"NNNNN":if(s===e)return i[n];break}else if([a,l,s].indexOf(e)>=0)return i[n]}function Yne(e,t){var r=e.since<=e.until?1:-1;return t===void 0?te(e.since).year():te(e.since).year()+(t-e.offset)*r}function Gne(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function Kne(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function qne(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function Xne(){var e,t,r,n,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e)if(r=o[e].since<=o[e].until?1:-1,n=this.clone().startOf("day").valueOf(),o[e].since<=n&&n<=o[e].until||o[e].until<=n&&n<=o[e].since)return(this.year()-te(o[e].since).year())*r+o[e].offset;return this.year()}function Zne(e){return at(this,"_erasNameRegex")||rT.call(this),e?this._erasNameRegex:this._erasRegex}function Jne(e){return at(this,"_erasAbbrRegex")||rT.call(this),e?this._erasAbbrRegex:this._erasRegex}function Qne(e){return at(this,"_erasNarrowRegex")||rT.call(this),e?this._erasNarrowRegex:this._erasRegex}function tT(e,t){return t.erasAbbrRegex(e)}function eoe(e,t){return t.erasNameRegex(e)}function toe(e,t){return t.erasNarrowRegex(e)}function roe(e,t){return t._eraYearOrdinalRegex||pf}function rT(){var e=[],t=[],r=[],n=[],o,i,a=this.eras();for(o=0,i=a.length;o<i;++o)t.push(Hr(a[o].name)),e.push(Hr(a[o].abbr)),r.push(Hr(a[o].narrow)),n.push(Hr(a[o].name)),n.push(Hr(a[o].abbr)),n.push(Hr(a[o].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}ke(0,["gg",2],0,function(){return this.weekYear()%100});ke(0,["GG",2],0,function(){return this.isoWeekYear()%100});function wp(e,t){ke(0,[e,e.length],0,t)}wp("gggg","weekYear");wp("ggggg","weekYear");wp("GGGG","isoWeekYear");wp("GGGGG","isoWeekYear");lr("weekYear","gg");lr("isoWeekYear","GG");sr("weekYear",1);sr("isoWeekYear",1);Se("G",yp);Se("g",yp);Se("GG",Ot,Br);Se("gg",Ot,Br);Se("GGGG",z0,U0);Se("gggg",z0,U0);Se("GGGGG",vp,hp);Se("ggggg",vp,hp);fv(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=Je(e)});fv(["gg","GG"],function(e,t,r,n){t[n]=te.parseTwoDigitYear(e)});function noe(e){return kB.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function ooe(e){return kB.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function ioe(){return Mo(this.year(),1,4)}function aoe(){return Mo(this.isoWeekYear(),1,4)}function loe(){var e=this.localeData()._week;return Mo(this.year(),e.dow,e.doy)}function soe(){var e=this.localeData()._week;return Mo(this.weekYear(),e.dow,e.doy)}function kB(e,t,r,n,o){var i;return e==null?Ic(this,n,o).year:(i=Mo(e,n,o),t>i&&(t=i),uoe.call(this,e,t,r,n,o))}function uoe(e,t,r,n,o){var i=sB(e,t,r,n,o),a=Ac(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}ke("Q",0,"Qo","quarter");lr("quarter","Q");sr("quarter",7);Se("Q",JF);mt("Q",function(e,t){t[ao]=(Je(e)-1)*3});function foe(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}ke("D",["DD",2],"Do","date");lr("date","D");sr("date",9);Se("D",Ot);Se("DD",Ot,Br);Se("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});mt(["D","DD"],In);mt("Do",function(e,t){t[In]=Je(e.match(Ot)[0])});var $B=mf("Date",!0);ke("DDD",["DDDD",3],"DDDo","dayOfYear");lr("dayOfYear","DDD");sr("dayOfYear",4);Se("DDD",dp);Se("DDDD",QF);mt(["DDD","DDDD"],function(e,t,r){r._dayOfYear=Je(e)});function coe(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}ke("m",["mm",2],0,"minute");lr("minute","m");sr("minute",14);Se("m",Ot);Se("mm",Ot,Br);mt(["m","mm"],un);var hoe=mf("Minutes",!1);ke("s",["ss",2],0,"second");lr("second","s");sr("second",15);Se("s",Ot);Se("ss",Ot,Br);mt(["s","ss"],lo);var doe=mf("Seconds",!1);ke("S",0,0,function(){return~~(this.millisecond()/100)});ke(0,["SS",2],0,function(){return~~(this.millisecond()/10)});ke(0,["SSS",3],0,"millisecond");ke(0,["SSSS",4],0,function(){return this.millisecond()*10});ke(0,["SSSSS",5],0,function(){return this.millisecond()*100});ke(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});ke(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});ke(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});ke(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});lr("millisecond","ms");sr("millisecond",16);Se("S",dp,JF);Se("SS",dp,Br);Se("SSS",dp,QF);var li,AB;for(li="SSSS";li.length<=9;li+="S")Se(li,pf);function voe(e,t){t[Ji]=Je(("0."+e)*1e3)}for(li="S";li.length<=9;li+="S")mt(li,voe);AB=mf("Milliseconds",!1);ke("z",0,0,"zoneAbbr");ke("zz",0,0,"zoneName");function yoe(){return this._isUTC?"UTC":""}function goe(){return this._isUTC?"Coordinated Universal Time":""}var ne=sv.prototype;ne.add=sne;ne.calendar=yne;ne.clone=gne;ne.diff=_ne;ne.endOf=Mne;ne.format=Tne;ne.from=Pne;ne.fromNow=kne;ne.to=$ne;ne.toNow=Ane;ne.get=pte;ne.invalidAt=Vne;ne.isAfter=mne;ne.isBefore=pne;ne.isBetween=bne;ne.isSame=wne;ne.isSameOrAfter=Sne;ne.isSameOrBefore=Cne;ne.isValid=Fne;ne.lang=OB;ne.locale=_B;ne.localeData=RB;ne.max=Fre;ne.min=jre;ne.parsingFlags=Bne;ne.set=bte;ne.startOf=Ine;ne.subtract=une;ne.toArray=Hne;ne.toObject=Lne;ne.toDate=Nne;ne.toISOString=Rne;ne.inspect=Ene;typeof Symbol<"u"&&Symbol.for!=null&&(ne[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ne.toJSON=jne;ne.toString=One;ne.unix=Dne;ne.valueOf=xne;ne.creationData=Wne;ne.eraName=Gne;ne.eraNarrow=Kne;ne.eraAbbr=qne;ne.eraYear=Xne;ne.year=lB;ne.isLeapYear=Lte;ne.weekYear=noe;ne.isoWeekYear=ooe;ne.quarter=ne.quarters=foe;ne.month=iB;ne.daysInMonth=Dte;ne.week=ne.weeks=Ute;ne.isoWeek=ne.isoWeeks=zte;ne.weeksInYear=loe;ne.weeksInWeekYear=soe;ne.isoWeeksInYear=ioe;ne.isoWeeksInISOWeekYear=aoe;ne.date=$B;ne.day=ne.days=ore;ne.weekday=ire;ne.isoWeekday=are;ne.dayOfYear=coe;ne.hour=ne.hours=dre;ne.minute=ne.minutes=hoe;ne.second=ne.seconds=doe;ne.millisecond=ne.milliseconds=AB;ne.utcOffset=qre;ne.utc=Zre;ne.local=Jre;ne.parseZone=Qre;ne.hasAlignedHourOffset=ene;ne.isDST=tne;ne.isLocal=nne;ne.isUtcOffset=one;ne.isUtc=bB;ne.isUTC=bB;ne.zoneAbbr=yoe;ne.zoneName=goe;ne.dates=Zr("dates accessor is deprecated. Use date instead.",$B);ne.months=Zr("months accessor is deprecated. Use month instead",iB);ne.years=Zr("years accessor is deprecated. Use year instead",lB);ne.zone=Zr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Xre);ne.isDSTShifted=Zr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",rne);function moe(e){return _t(e*1e3)}function poe(){return _t.apply(null,arguments).parseZone()}function IB(e){return e}var lt=B0.prototype;lt.calendar=ote;lt.longDateFormat=ste;lt.invalidDate=fte;lt.ordinal=dte;lt.preparse=IB;lt.postformat=IB;lt.relativeTime=yte;lt.pastFuture=gte;lt.set=rte;lt.eras=Une;lt.erasParse=zne;lt.erasConvertYear=Yne;lt.erasAbbrRegex=Jne;lt.erasNameRegex=Zne;lt.erasNarrowRegex=Qne;lt.months=Ate;lt.monthsShort=Ite;lt.monthsParse=xte;lt.monthsRegex=Hte;lt.monthsShortRegex=Nte;lt.week=Fte;lt.firstDayOfYear=Wte;lt.firstDayOfWeek=Vte;lt.weekdays=Qte;lt.weekdaysMin=tre;lt.weekdaysShort=ere;lt.weekdaysParse=nre;lt.weekdaysRegex=lre;lt.weekdaysShortRegex=sre;lt.weekdaysMinRegex=ure;lt.isPM=cre;lt.meridiem=vre;function jg(e,t,r,n){var o=Vo(),i=Vn().set(n,t);return o[r](i,e)}function MB(e,t,r){if(Ho(e)&&(t=e,e=void 0),e=e||"",t!=null)return jg(e,t,r,"month");var n,o=[];for(n=0;n<12;n++)o[n]=jg(e,n,r,"month");return o}function nT(e,t,r,n){typeof e=="boolean"?(Ho(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,Ho(t)&&(r=t,t=void 0),t=t||"");var o=Vo(),i=e?o._week.dow:0,a,l=[];if(r!=null)return jg(t,(r+i)%7,n,"day");for(a=0;a<7;a++)l[a]=jg(t,(a+i)%7,n,"day");return l}function boe(e,t){return MB(e,t,"months")}function woe(e,t){return MB(e,t,"monthsShort")}function Soe(e,t,r){return nT(e,t,r,"weekdays")}function Coe(e,t,r){return nT(e,t,r,"weekdaysShort")}function _oe(e,t,r){return nT(e,t,r,"weekdaysMin")}ci("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=Je(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});te.lang=Zr("moment.lang is deprecated. Use moment.locale instead.",ci);te.langData=Zr("moment.langData is deprecated. Use moment.localeData instead.",Vo);var Yn=Math.abs;function Ooe(){var e=this._data;return this._milliseconds=Yn(this._milliseconds),this._days=Yn(this._days),this._months=Yn(this._months),e.milliseconds=Yn(e.milliseconds),e.seconds=Yn(e.seconds),e.minutes=Yn(e.minutes),e.hours=Yn(e.hours),e.months=Yn(e.months),e.years=Yn(e.years),this}function xB(e,t,r,n){var o=gn(t,r);return e._milliseconds+=n*o._milliseconds,e._days+=n*o._days,e._months+=n*o._months,e._bubble()}function Roe(e,t){return xB(this,e,t,1)}function Eoe(e,t){return xB(this,e,t,-1)}function c1(e){return e<0?Math.floor(e):Math.ceil(e)}function Toe(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,o,i,a,l,s;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=c1(k_(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,o=Yr(e/1e3),n.seconds=o%60,i=Yr(o/60),n.minutes=i%60,a=Yr(i/60),n.hours=a%24,t+=Yr(a/24),s=Yr(DB(t)),r+=s,t-=c1(k_(s)),l=Yr(r/12),r%=12,n.days=t,n.months=r,n.years=l,this}function DB(e){return e*4800/146097}function k_(e){return e*146097/4800}function Poe(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=Jr(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+DB(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(k_(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function koe(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Je(this._months/12)*31536e6:NaN}function Wo(e){return function(){return this.as(e)}}var $oe=Wo("ms"),Aoe=Wo("s"),Ioe=Wo("m"),Moe=Wo("h"),xoe=Wo("d"),Doe=Wo("w"),Noe=Wo("M"),Hoe=Wo("Q"),Loe=Wo("y");function joe(){return gn(this)}function Foe(e){return e=Jr(e),this.isValid()?this[e+"s"]():NaN}function el(e){return function(){return this.isValid()?this._data[e]:NaN}}var Boe=el("milliseconds"),Voe=el("seconds"),Woe=el("minutes"),Uoe=el("hours"),zoe=el("days"),Yoe=el("months"),Goe=el("years");function Koe(){return Yr(this.days()/7)}var ro=Math.round,Vl={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function qoe(e,t,r,n,o){return o.relativeTime(t||1,!!r,e,n)}function Xoe(e,t,r,n){var o=gn(e).abs(),i=ro(o.as("s")),a=ro(o.as("m")),l=ro(o.as("h")),s=ro(o.as("d")),u=ro(o.as("M")),f=ro(o.as("w")),c=ro(o.as("y")),h=i<=r.ss&&["s",i]||i<r.s&&["ss",i]||a<=1&&["m"]||a<r.m&&["mm",a]||l<=1&&["h"]||l<r.h&&["hh",l]||s<=1&&["d"]||s<r.d&&["dd",s];return r.w!=null&&(h=h||f<=1&&["w"]||f<r.w&&["ww",f]),h=h||u<=1&&["M"]||u<r.M&&["MM",u]||c<=1&&["y"]||["yy",c],h[2]=t,h[3]=+e>0,h[4]=n,qoe.apply(null,h)}function Zoe(e){return e===void 0?ro:typeof e=="function"?(ro=e,!0):!1}function Joe(e,t){return Vl[e]===void 0?!1:t===void 0?Vl[e]:(Vl[e]=t,e==="s"&&(Vl.ss=t-1),!0)}function Qoe(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Vl,o,i;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},Vl,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),o=this.localeData(),i=Xoe(this,!r,n,o),r&&(i=o.pastFuture(+this,i)),o.postformat(i)}var mS=Math.abs;function fl(e){return(e>0)-(e<0)||+e}function Sp(){if(!this.isValid())return this.localeData().invalidDate();var e=mS(this._milliseconds)/1e3,t=mS(this._days),r=mS(this._months),n,o,i,a,l=this.asSeconds(),s,u,f,c;return l?(n=Yr(e/60),o=Yr(n/60),e%=60,n%=60,i=Yr(r/12),r%=12,a=e?e.toFixed(3).replace(/\.?0+$/,""):"",s=l<0?"-":"",u=fl(this._months)!==fl(l)?"-":"",f=fl(this._days)!==fl(l)?"-":"",c=fl(this._milliseconds)!==fl(l)?"-":"",s+"P"+(i?u+i+"Y":"")+(r?u+r+"M":"")+(t?f+t+"D":"")+(o||n||e?"T":"")+(o?c+o+"H":"")+(n?c+n+"M":"")+(e?c+a+"S":"")):"P0D"}var tt=bp.prototype;tt.isValid=zre;tt.abs=Ooe;tt.add=Roe;tt.subtract=Eoe;tt.as=Poe;tt.asMilliseconds=$oe;tt.asSeconds=Aoe;tt.asMinutes=Ioe;tt.asHours=Moe;tt.asDays=xoe;tt.asWeeks=Doe;tt.asMonths=Noe;tt.asQuarters=Hoe;tt.asYears=Loe;tt.valueOf=koe;tt._bubble=Toe;tt.clone=joe;tt.get=Foe;tt.milliseconds=Boe;tt.seconds=Voe;tt.minutes=Woe;tt.hours=Uoe;tt.days=zoe;tt.weeks=Koe;tt.months=Yoe;tt.years=Goe;tt.humanize=Qoe;tt.toISOString=Sp;tt.toString=Sp;tt.toJSON=Sp;tt.locale=_B;tt.localeData=RB;tt.toIsoString=Zr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Sp);tt.lang=OB;ke("X",0,0,"unix");ke("x",0,0,"valueOf");Se("x",yp);Se("X",Ste);mt("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});mt("x",function(e,t,r){r._d=new Date(Je(e))});//! moment.js
te.version="2.29.4";ete(_t);te.fn=ne;te.min=Bre;te.max=Vre;te.now=Wre;te.utc=Vn;te.unix=moe;te.months=boe;te.isDate=lv;te.locale=ci;te.invalid=fp;te.duration=gn;te.isMoment=dn;te.weekdays=Soe;te.parseZone=poe;te.localeData=Vo;te.isDuration=qy;te.monthsShort=woe;te.weekdaysMin=_oe;te.defineLocale=q0;te.updateLocale=pre;te.locales=bre;te.weekdaysShort=Coe;te.normalizeUnits=Jr;te.relativeTimeRounding=Zoe;te.relativeTimeThreshold=Joe;te.calendarFormat=vne;te.prototype=ne;te.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const eie=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"}));function ft(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=ar(e,function(i,a,l){var s=a.replace(/\r?\n\s*/g,""),u=r[l]?r[l]:"";return i+s+u},"");return o.trim()}var h1,d1,v1,y1,g1,m1;function Kl(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function $_(e){"@babel/helpers - typeof";return $_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$_(e)}function Bt(e){var t;switch($_(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function pe(e){return typeof e<"u"}function pt(e){return typeof e>"u"}function qt(e){return e===null||e===""||pt(e)}function tie(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var lc="length",yc=function(t){return parseInt(t,16)},p1=function(t){return parseInt(t,10)},Fg=function(t,r,n){return t.substr(r,n)},gc=function(t){return t.codePointAt(0)-65},A_=function(t){return"".concat(t).replace(/\-/g,"")},rie=function(t){return yc(Fg(A_(t),yc("12"),gc("F")))/(yc(Fg(A_(t),gc("B"),~~![][lc]))||9)},nie=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},b1=!1,w1={invalid:function(){return ft(h1||(h1=Kl([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return ft(d1||(d1=Kl([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return ft(v1||(v1=Kl([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},S1={invalid:function(){return ft(y1||(y1=Kl([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return ft(g1||(g1=Kl([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return ft(m1||(m1=Kl([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function oie(e,t){var r=!qt(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",o="12.4.0",i,a="invalid",l="invalid";e=A_(e||"");var s=iie(e);if(r||n||s)if(s){var u=te("23/05/2023","DD/MM/YYYY"),f=Math.floor(u.toDate().getTime()/864e5),c=rie(e);i=te((c+1)*864e5,"x").format("MMMM DD, YYYY"),f>c?(a="expired",l="expired"):(a="valid",l="valid")}else n?(a="non_commercial",l="valid"):(a="invalid",l="invalid");else a="missing",l="missing";if(nie()&&(a="valid",l="valid"),!b1&&a!=="valid"){var h=w1[a]({keyValidityDate:i,hotVersion:o});h&&console[a==="non_commercial"?"info":"warn"](w1[a]({keyValidityDate:i,hotVersion:o})),b1=!0}if(l!=="valid"&&t.parentNode){var d=S1[l]({keyValidityDate:i,hotVersion:o});if(d){var v=document.createElement("div");v.className="hot-display-license-info",v.innerHTML=S1[l]({keyValidityDate:i,hotVersion:o}),t.parentNode.insertBefore(v,t.nextSibling)}}}function iie(e){var t=[][lc],r=t;if(e[lc]!==gc("Z"))return!1;for(var n="",o="B<H4P+".split(""),i=gc(o.shift());i;i=gc(o.shift()||"A"))--i<""[lc]?r=r|(p1("".concat(p1(yc(n)+(yc(Fg(e,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:n=Fg(e,i,i?o[lc]===1?9:8:6);return r===t}function fn(e){return e[0].toUpperCase()+e.substr(1)}function NB(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function HB(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function LB(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function C1(e){return oT("".concat(e),{ALLOWED_TAGS:[]})}function oT(e,t){return Dee.sanitize(e,t)}function _1(e){return uie(e)||sie(e)||lie(e)||aie()}function aie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lie(e,t){if(e){if(typeof e=="string")return I_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return I_(e,t)}}function sie(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uie(e){if(Array.isArray(e))return I_(e)}function I_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fie(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,o=e;o!==null;){if(r===t){n=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(r+=1,o=o.parentNode)}return n}function cie(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function Bg(e){return cie(e)&&e.parent}function ka(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,o=n.ELEMENT_NODE,i=n.DOCUMENT_FRAGMENT_NODE,a=e;a!=null&&a!==r;){var l=a,s=l.nodeType,u=l.nodeName;if(s===o&&(t.includes(u)||t.includes(a)))return a;var f=a,c=f.host;c&&s===i?a=c:a=a.parentNode}return null}function Yv(e,t,r){for(var n=[],o=e;o&&(o=ka(o,t,r),!(!o||r&&!r.contains(o)));)n.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;var i=n.length;return i?n[i-1]:null}function $a(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function hie(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function Hi(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var M_,x_,D_;function Gv(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if(fQ()){var O1=function(t){var r=t.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};M_=function(t,r){return t.classList===void 0||typeof r!="string"||r===""?!1:t.classList.contains(r)},x_=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=Gv(o),o.length>0)if(O1(n)){var i;(i=t.classList).add.apply(i,_1(o))}else for(var a=0;o[a];)t.classList.add(o[a]),a+=1},D_=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=Gv(o),o.length>0)if(O1(n)){var i;(i=t.classList).remove.apply(i,_1(o))}else for(var a=0;o[a];)t.classList.remove(o[a]),a+=1}}else{var pS=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};M_=function(t,r){return t.className!==void 0&&pS(r).test(t.className)},x_=function(t,r){var n=t.className,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=Gv(o),n==="")n=o.join(" ");else for(var i=0;i<o.length;i++)o[i]&&!pS(o[i]).test(n)&&(n+=" ".concat(o[i]));t.className=n},D_=function(t,r){var n=0,o=t.className,i=r;for(typeof i=="string"&&(i=i.split(" ")),i=Gv(i);i[n];)o=o.replace(pS(i[n])," ").trim(),n+=1;t.className!==o&&(t.className=o)}}function De(e,t){return M_(e,t)}function re(e,t){x_(e,t)}function je(e,t){D_(e,t)}function jB(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)jB(t[r])}function Hn(e){for(var t;t=e.lastChild;)e.removeChild(t)}var die=/(<(.*)>|&(.*);)/;function bf(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;die.test(t)?e.innerHTML=r?oT(t):t:Ia(e,t)}function Ia(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?cQ?r.textContent=t:r.data=t:(Hn(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function xc(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return xc(r.host.impl);if(r.host)return xc(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function zt(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,o=e,i,a,l,s;if(DF()&&o.firstChild&&o.firstChild.nodeName==="CAPTION")return s=o.getBoundingClientRect(),{top:s.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:s.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(i=o.offsetLeft,a=o.offsetTop,l=o;(o=o.offsetParent)&&o!==t.body;)i+=o.offsetLeft,a+=o.offsetTop,l=o;return l&&l.style.position==="fixed"&&(i+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:i,top:a}}function Dc(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function us(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function Vg(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?Dc(t):e.scrollTop}function N_(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?us(t):e.scrollLeft}function Wg(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],o=hQ(),i=e.parentNode;i&&i.style&&t.body!==i;){var a=i.style,l=a.overflow,s=a.overflowX,u=a.overflowY;if([l,s,u].includes("scroll"))return i;if(o){var f=r.getComputedStyle(i);if(l=f.overflow,s=f.overflowX,u=f.overflowY,n.includes(l)||n.includes(s)||n.includes(u))return i}if(i.clientHeight<=i.scrollHeight+1&&(n.includes(u)||n.includes(l))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(l)))return i;i=i.parentNode}return r}function fs(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var o=Ma(n,r),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),s=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(l)||i.includes(s))return n;n=n.parentNode}return r}function Nc(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var o=Ma(e,r);if(o[t]!==""&&o[t]!==void 0)return o[t]}function Ma(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function gt(e){return e.offsetWidth}function $t(e){return DF()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function si(e){return e.clientHeight||e.innerHeight}function Zy(e){return e.clientWidth||e.innerWidth}function FB(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),o=n.duplicate();return n.moveToBookmark(r.getBookmark()),o.setEndPoint("EndToStart",n),o.text.length}return 0}function vie(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function yie(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function R1(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function Cp(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,o=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=o}}}var bS;function gie(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var o=t.offsetWidth;return n===o&&(o=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-o}function er(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return bS===void 0&&(bS=gie(e)),bS}function mie(e){return e.offsetWidth!==e.clientWidth}function pie(e){return e.offsetHeight!==e.clientHeight}function iT(e,t,r){aee()?(e.style.top=r,e.style.left=t):nee()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function _p(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function Ug(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function aT(e){return Ug(e)&&e.hasAttribute("data-hot-input")===!1}function bie(e){var t=e.ownerDocument.activeElement;aT(t)||e.select()}function BB(e){return!e.parentNode}function wie(e,t){var r=new IntersectionObserver(function(n,o){n.forEach(function(i){i.isIntersecting&&e.offsetParent!==null&&(t(),o.unobserve(e))})},{root:e.ownerDocument.body});r.observe(e)}function wt(e){return typeof e=="function"}function VB(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function o(){for(var i=this,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return r&&clearTimeout(r),r=setTimeout(function(){n=e.apply(i,l)},t),n}return o}function WB(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return e.apply(this,r.concat(a))}}function Sie(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var s=n.concat(a),u;return s.length>=t?u=e.apply(this,s):u=r(s),u}}return r([])}function H_(e,t,r,n,o,i,a,l){return pe(l)?e.call(t,r,n,o,i,a,l):pe(a)?e.call(t,r,n,o,i,a):pe(i)?e.call(t,r,n,o,i):pe(o)?e.call(t,r,n,o):pe(n)?e.call(t,r,n):pe(r)?e.call(t,r):e.call(t)}function dt(){if(pe(console)){var e;(e=console).warn.apply(e,arguments)}}function lT(){if(pe(console)){var e;(e=console).error.apply(e,arguments)}}var Cie=Ve,E1=v0,Kv=Qd.getWeakData,_ie=h0,Oie=Ht,Rie=vn,wS=Nt,Eie=c0,UB=Ja,T1=At,zB=Fo,Tie=zB.set,Pie=zB.getterFor,kie=UB.find,$ie=UB.findIndex,Aie=Cie([].splice),Iie=0,qv=function(e){return e.frozen||(e.frozen=new YB)},YB=function(){this.entries=[]},SS=function(e,t){return kie(e.entries,function(r){return r[0]===t})};YB.prototype={get:function(e){var t=SS(this,e);if(t)return t[1]},has:function(e){return!!SS(this,e)},set:function(e,t){var r=SS(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=$ie(this.entries,function(r){return r[0]===e});return~t&&Aie(this.entries,t,1),!!~t}};var GB={getConstructor:function(e,t,r,n){var o=e(function(s,u){_ie(s,i),Tie(s,{type:t,id:Iie++,frozen:void 0}),Rie(u)||Eie(u,s[n],{that:s,AS_ENTRIES:r})}),i=o.prototype,a=Pie(t),l=function(s,u,f){var c=a(s),h=Kv(Oie(u),!0);return h===!0?qv(c).set(u,f):h[c.id]=f,s};return E1(i,{delete:function(s){var u=a(this);if(!wS(s))return!1;var f=Kv(s);return f===!0?qv(u).delete(s):f&&T1(f,u.id)&&delete f[u.id]},has:function(u){var f=a(this);if(!wS(u))return!1;var c=Kv(u);return c===!0?qv(f).has(u):c&&T1(c,f.id)}}),E1(i,r?{get:function(u){var f=a(this);if(wS(u)){var c=Kv(u);return c===!0?qv(f).get(u):c?c[f.id]:void 0}},set:function(u,f){return l(this,u,f)}}:{add:function(u){return l(this,u,!0)}}),o}},Mie=r0,P1=vt,Jy=Ve,k1=v0,xie=Qd,Die=tp,KB=GB,Xv=Nt,Zv=Fo.enforce,Nie=Fe,Hie=LL,cv=Object,Lie=Array.isArray,Jv=cv.isExtensible,qB=cv.isFrozen,jie=cv.isSealed,XB=cv.freeze,Fie=cv.seal,Bie=!P1.ActiveXObject&&"ActiveXObject"in P1,Hf,ZB=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},JB=Die("WeakMap",ZB,KB),Hl=JB.prototype,Qy=Jy(Hl.set),Vie=function(){return Mie&&Nie(function(){var e=XB([]);return Qy(new JB,e,1),!qB(e)})};if(Hie)if(Bie){Hf=KB.getConstructor(ZB,"WeakMap",!0),xie.enable();var $1=Jy(Hl.delete),Qv=Jy(Hl.has),A1=Jy(Hl.get);k1(Hl,{delete:function(e){if(Xv(e)&&!Jv(e)){var t=Zv(this);return t.frozen||(t.frozen=new Hf),$1(this,e)||t.frozen.delete(e)}return $1(this,e)},has:function(t){if(Xv(t)&&!Jv(t)){var r=Zv(this);return r.frozen||(r.frozen=new Hf),Qv(this,t)||r.frozen.has(t)}return Qv(this,t)},get:function(t){if(Xv(t)&&!Jv(t)){var r=Zv(this);return r.frozen||(r.frozen=new Hf),Qv(this,t)?A1(this,t):r.frozen.get(t)}return A1(this,t)},set:function(t,r){if(Xv(t)&&!Jv(t)){var n=Zv(this);n.frozen||(n.frozen=new Hf),Qv(this,t)?Qy(this,t,r):n.frozen.set(t,r)}else Qy(this,t,r);return this}})}else Vie()&&k1(Hl,{set:function(t,r){var n;return Lie(t)&&(qB(t)?n=XB:jie(t)&&(n=Fie)),Qy(this,t,r),n&&n(t),this}});var Oe={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:lS()?182:174,AUDIO_MUTE:lS()?181:173,AUDIO_UP:lS()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Wie=[Oe.ALT,Oe.ARROW_DOWN,Oe.ARROW_LEFT,Oe.ARROW_RIGHT,Oe.ARROW_UP,Oe.AUDIO_DOWN,Oe.AUDIO_MUTE,Oe.AUDIO_UP,Oe.BACKSPACE,Oe.CAPS_LOCK,Oe.DELETE,Oe.END,Oe.ENTER,Oe.ESCAPE,Oe.F1,Oe.F2,Oe.F3,Oe.F4,Oe.F5,Oe.F6,Oe.F7,Oe.F8,Oe.F9,Oe.F10,Oe.F11,Oe.F12,Oe.F13,Oe.F14,Oe.F15,Oe.F16,Oe.F17,Oe.F18,Oe.F19,Oe.HOME,Oe.INSERT,Oe.MEDIA_NEXT,Oe.MEDIA_PLAY_PAUSE,Oe.MEDIA_PREV,Oe.MEDIA_STOP,Oe.NULL,Oe.NUM_LOCK,Oe.PAGE_DOWN,Oe.PAGE_UP,Oe.PAUSE,Oe.SCROLL_LOCK,Oe.SHIFT,Oe.TAB];function Uie(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function QB(e){return Wie.includes(e)}function zie(e){return[Oe.CONTROL,Oe.COMMAND_LEFT,Oe.COMMAND_RIGHT,Oe.COMMAND_FIREFOX].includes(e)}function Hc(e,t){var r=t.split("|"),n=!1;return I(r,function(o){if(e===Oe[o])return n=!0,!1}),n}function Ln(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function Ll(e){return e.isImmediatePropagationEnabled===!1}function xa(e){return e.button===2}function sT(e){return e.button===0}function Lc(e){"@babel/helpers - typeof";return Lc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lc(e)}var I1;function Yie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kie(n.key),n)}}function Gie(e,t,r){return t&&M1(e.prototype,t),r&&M1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kie(e){var t=qie(e,"string");return Lc(t)==="symbol"?t:String(t)}function qie(e,t){if(Lc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xie(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var cl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Zie=ft(I1||(I1=Xie([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),CS=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),_S=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),eV=function(){function e(){Yie(this,e),this.globalBucket=this.createEmptyBucket()}return Gie(e,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return I(cl,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))I(n,function(s){return o.add(r,s,i)});else{CS.has(r)&&dt(LB(Zie,{hookName:r,removedInVersion:CS.get(r)})),_S.has(r)&&dt(_S.get(r));var a=this.getBucket(i);if(typeof a[r]>"u"&&(this.register(r),a[r]=[]),n.skip=!1,a[r].indexOf(n)===-1){var l=!1;n.initialHook&&I(a[r],function(s,u){if(s.initialHook)return a[r][u]=n,l=!0,!1}),l||a[r].push(n)}}return this}},{key:"once",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?I(n,function(a){return o.once(r,a,i)}):(n.runOnce=!0,this.add(r,n,i))}},{key:"remove",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=this.getBucket(o);return typeof i[r]<"u"&&i[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=this.getBucket(n);return!!(o[r]!==void 0&&o[r].length)}},{key:"run",value:function(r,n,o,i,a,l,s,u){{var f=this.globalBucket[n],c=f?f.length:0,h=0;if(c)for(;h<c;){if(!f[h]||f[h].skip){h+=1;continue}var d=H_(f[h],r,o,i,a,l,s,u);d!==void 0&&(o=d),f[h]&&f[h].runOnce&&this.remove(n,f[h]),h+=1}}{var v=this.getBucket(r)[n],g=v?v.length:0,p=0;if(g)for(;p<g;){if(!v[p]||v[p].skip){p+=1;continue}var w=H_(v[p],r,o,i,a,l,s,u);w!==void 0&&(o=w),v[p]&&v[p].runOnce&&this.remove(n,v[p],r),p+=1}}return o}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ge(this.getBucket(r),function(n,o,i){return i[o].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||cl.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&cl.splice(cl.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return _S.has(r)||CS.has(r)}},{key:"isRegistered",value:function(r){return cl.indexOf(r)>=0}},{key:"getRegistered",value:function(){return cl}}],[{key:"getSingleton",value:function(){return Qie()}}]),e}(),Jie=new eV;function Qie(){return Jie}const be=eV;function x1(e){return nae(e)||rae(e)||tae(e)||eae()}function eae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tae(e,t){if(e){if(typeof e=="string")return L_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return L_(e,t)}}function rae(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function nae(e){if(Array.isArray(e))return L_(e)}function L_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var OS=new Map;function Qr(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";OS.has(e)||OS.set(e,new Map);var t=OS.get(e);function r(l,s){t.set(l,s)}function n(l){return t.get(l)}function o(l){return t.has(l)}function i(){return x1(t.keys())}function a(){return x1(t.values())}return{register:r,getItem:n,hasItem:o,getNames:i,getValues:a}}var j_=new WeakMap,hv=Qr("editors"),oae=hv.register,tV=hv.getItem,rV=hv.hasItem;hv.getNames;hv.getValues;function iae(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},be.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function nV(e,t){var r;if(typeof e=="function")j_.get(e)||xr(null,e),r=j_.get(e);else if(typeof e=="string")r=tV(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function D1(e){if(typeof e=="function")return e;if(!rV(e))throw Error('No registered editor found under "'.concat(e,'" name'));return tV(e).getConstructor()}function xr(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new iae(t);typeof e=="string"&&oae(e,r),j_.set(t,r)}function jc(e){"@babel/helpers - typeof";return jc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jc(e)}function aae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sae(n.key),n)}}function lae(e,t,r){return t&&N1(e.prototype,t),r&&N1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sae(e){var t=uae(e,"string");return jc(t)==="symbol"?t:String(t)}function uae(e,t){if(jc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fae=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;aae(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return lae(e,[{key:"addEventListener",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function l(s){o.call(this,cae(s))}return typeof a!="boolean"&&!yQ()&&(a=!1),this.context.eventListeners.push({element:r,event:n,callback:o,callbackProxy:l,options:a,eventManager:this}),r.addEventListener(n,l,a),function(){i.removeEventListener(r,n,o)}}},{key:"removeEventListener",value:function(r,n,o){for(var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=this.context.eventListeners.length,l;a;)if(a-=1,l=this.context.eventListeners[a],l.event===n&&l.element===r){if(o&&o!==l.callback||i&&l.eventManager!==this)continue;this.context.eventListeners.splice(a,1),l.element.removeEventListener(l.event,l.callbackProxy,l.options)}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var o=this.context.eventListeners[n];r&&o.eventManager!==this||(this.context.eventListeners.splice(n,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options))}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var o=r.document,i=r;o||(o=r.ownerDocument?r.ownerDocument:r,i=o.defaultView);var a={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},l;o.createEvent?(l=o.createEvent("MouseEvents"),l.initMouseEvent(n,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,o.body.parentNode)):l=o.createEventObject(),r.dispatchEvent?r.dispatchEvent(l):r.fireEvent("on".concat(n),l)}}]),e}();function cae(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),Ln(this)},e}const It=fae;function Fc(e){"@babel/helpers - typeof";return Fc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fc(e)}function hae(e,t){return gae(e)||yae(e,t)||vae(e,t)||dae()}function dae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vae(e,t){if(e){if(typeof e=="string")return H1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H1(e,t)}}function H1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yae(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function gae(e){if(Array.isArray(e))return e}function mae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bae(n.key),n)}}function pae(e,t,r){return t&&L1(e.prototype,t),r&&L1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bae(e){var t=wae(e,"string");return Fc(t)==="symbol"?t:String(t)}function wae(e,t){if(Fc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Op="editorManager.navigation",mc="editorManager.handlingEditor",F_=function(){function e(t,r,n){var o=this;mae(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new It(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var i=this.instance.getShortcutManager();i.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(a){!o.destroyed&&o.instance.isListening()&&o.openEditor("",a)}),this.instance.view._wt.update("onCellDblClick",function(a,l,s){return o.onCellDblClick(a,l,s)})}return pae(e,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),o=n.getContext("grid"),i=n.getContext("editor"),a={group:mc};i.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(s,u){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(u.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],a),o.addShortcuts([{keys:[["F2"]],callback:function(s){r.openEditor(null,s,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(s,u){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,s,!0):r.moveSelectionAfterEnter(u.includes("shift")),Ln(s)}}],a)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(g){g&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance.runHooks("modifyGetCellCoords",o,i),l=o,s=i;if(Array.isArray(a)){var u=hae(a,2);l=u[0],s=u[1]}this.cellProperties=this.instance.getCellMeta(l,s);var f=this.instance.rootDocument.activeElement;if(f&&aT(f)&&f.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var c=this.instance.getCell(o,i,!0);if(c){var h=this.instance.getCellEditor(this.cellProperties),d=this.instance.colToProp(s),v=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(l),s);this.activeEditor=nV(h,this.instance),this.activeEditor.prepare(o,i,d,c,v,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var i=this.instance.getSelectedRangeLast().highlight,a=i.row,l=i.col,s=this.instance.rowIndexMapper.getRenderableFromVisualIndex(a),u=this.instance.columnIndexMapper.getRenderableFromVisualIndex(l);this.instance.view.scrollViewport(this.instance._createCellCoords(s,u)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(o&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,o){this.activeEditor?this.activeEditor.finishEditing(r,n,o):o&&o(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance,l=a.rowIndexMapper,s=a.columnIndexMapper,u=l.isHidden(this.instance.toPhysicalRow(o))||s.isHidden(this.instance.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||u)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(this.instance.isListening()){var o=r.keyCode;if(this.selection.isSelected()){var i=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!QB(o)&&!zie(o)&&!i&&!this.isEditorOpened()){var a=this.instance.getShortcutManager(),l=a.getContext("editor"),s={runOnlyIf:function(){return pe(n.instance.getSelected())},group:Op};l.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],s),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,o){o.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),j1=new WeakMap;F_.getInstance=function(e,t,r){var n=j1.get(e);return n||(n=new F_(e,t,r),j1.set(e,n)),n};const Sae=F_;var Cae=Me,_ae=Tr,oV=zd,Oae=Fe,Rae=Oae(function(){oV(1)});Cae({target:"Object",stat:!0,forced:Rae},{keys:function(t){return oV(_ae(t))}});var Eae=Me,Tae=H0;Eae({target:"String",proto:!0},{repeat:Tae});var Pae=Gt,kae=ap,$ae=Ht,Aae=vn,Iae=Xa,RS=Wt,Mae=Er,xae=Ga,Dae=O0,F1=lp;kae("match",function(e,t,r){return[function(o){var i=Mae(this),a=Aae(o)?void 0:xae(o,e);return a?Pae(a,o,i):new RegExp(o)[e](RS(i))},function(n){var o=$ae(this),i=RS(n),a=r(t,o,i);if(a.done)return a.value;if(!o.global)return F1(o,i);var l=o.unicode;o.lastIndex=0;for(var s=[],u=0,f;(f=F1(o,i))!==null;){var c=RS(f[0]);s[u]=c,c===""&&(o.lastIndex=Dae(i,Iae(o.lastIndex),l)),u++}return u===0?null:s}]});var Nae=Qa,Hae=Fr,Lae=Ei,jae=yn,Fae=gf,Bae=Math.min,B_=[].lastIndexOf,iV=!!B_&&1/[1].lastIndexOf(1,-0)<0,Vae=Fae("lastIndexOf"),Wae=iV||!Vae,Uae=Wae?function(t){if(iV)return Nae(B_,this,arguments)||0;var r=Hae(this),n=jae(r),o=n-1;for(arguments.length>1&&(o=Bae(o,Lae(arguments[1]))),o<0&&(o=n+o);o>=0;o--)if(o in r&&r[o]===t)return o||0;return-1}:B_,zae=Me,B1=Uae;zae({target:"Array",proto:!0,forced:B1!==[].lastIndexOf},{lastIndexOf:B1});var Yae=Ya,Gae=Tr,Kae=Ld,qae=yn,Xae=TypeError,V1=function(e){return function(t,r,n,o){var i=Gae(t),a=Kae(i),l=qae(i);Yae(r);var s=e?l-1:0,u=e?-1:1;if(n<2)for(;;){if(s in a){o=a[s],s+=u;break}if(s+=u,e?s<0:l<=s)throw new Xae("Reduce of empty array with no initial value")}for(;e?s>=0:l>s;s+=u)s in a&&(o=r(o,a[s],s,i));return o}},Zae={left:V1(!1),right:V1(!0)},Jae=Me,Qae=Zae.left,ele=gf,W1=jd,tle=CF,rle=!tle&&W1>79&&W1<83,nle=rle||!ele("reduce");Jae({target:"Array",proto:!0,forced:nle},{reduce:function(t){var r=arguments.length;return Qae(this,t,r,r>1?arguments[1]:void 0)}});var ole=Me,ile=Ja.findIndex,ale=ev,V_="findIndex",aV=!0;V_ in[]&&Array(1)[V_](function(){aV=!1});ole({target:"Array",proto:!0,forced:aV},{findIndex:function(t){return ile(this,t,arguments.length>1?arguments[1]:void 0)}});ale(V_);function ES(e){return fle(e)||ule(e)||sle(e)||lle()}function lle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sle(e,t){if(e){if(typeof e=="string")return W_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W_(e,t)}}function ule(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fle(e){if(Array.isArray(e))return W_(e)}function W_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var lV={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},cle=new RegExp(Object.keys(lV).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function hle(e){return(e&&e.nodeName||"")==="TABLE"}function U1(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData.apply(e,n),i=o.length,a=i>0?o[0].length:0,l=["<table>","</table>"],s=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],f=r?1:0,c=t?1:0,h=0;h<i;h+=1){for(var d=t&&h===0,v=[],g=0;g<a;g+=1){var p=!d&&r&&g===0,w="";if(d)w="<th>".concat(e.getColHeader(g-f),"</th>");else if(p)w="<th>".concat(e.getRowHeader(h-c),"</th>");else{var S=o[h][g],C=e.getCellMeta(h-c,g-f),P=C.hidden,R=C.rowspan,V=C.colspan;if(!P){var U=[];if(R&&U.push('rowspan="'.concat(R,'"')),V&&U.push('colspan="'.concat(V,'"')),qt(S))w="<td ".concat(U.join(" "),"></td>");else{var X=S.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");w="<td ".concat(U.join(" "),">").concat(X,"</td>")}}}v.push(w)}var Y=["<tr>"].concat(v,["</tr>"]).join("");d?s.splice(1,0,Y):u.splice(-1,0,Y)}return l.splice(1,0,s.join(""),u.join("")),l.join("")}function z1(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var o=e[n],i=o.length,a=[];n===0&&r.push("<tbody>");for(var l=0;l<i;l+=1){var s=o[l],u=qt(s)?"":s.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,function(f){return'<span style="mso-spacerun: yes">'.concat("&nbsp;".repeat(f.length-1)," </span>")}).replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(a,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function dle(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=t.createDocumentFragment(),o=t.createElement("div");n.appendChild(o);var i=e;if(typeof i=="string"){var a=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(_){var T=_.match(/<td\b[^>]*?>/g)[0],A=_.substring(T.length,_.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),F="</td>";return"".concat(T).concat(A).concat(F)});o.insertAdjacentHTML("afterbegin","".concat(a)),i=o.querySelector("table")}if(!(!i||!hle(i))){var l=o.querySelector('meta[name$="enerator"]'),s=i.querySelector("tbody th")!==null,u=i.querySelector("tr"),f=u?Array.from(u.cells).reduce(function(_,T){return _+T.colSpan},0)-(s?1:0):0,c=i.tFoot&&Array.from(i.tFoot.rows)||[],h=[],d=!1,v=0,g=0;if(i.tHead){var p=Array.from(i.tHead.rows).filter(function(_){var T=_.querySelector("td")!==null;return T&&h.push(_),!T});v=p.length,d=v>0,v>1?r.nestedHeaders=Array.from(p).reduce(function(_,T){var A=Array.from(T.cells).reduce(function(F,W,G){if(s&&G===0)return F;var Q=W.colSpan,ee=W.innerHTML,se=Q>1?{label:ee,colspan:Q}:ee;return F.push(se),F},[]);return _.push(A),_},[]):d&&(r.colHeaders=Array.from(p[0].children).reduce(function(_,T,A){return s&&A===0||_.push(T.innerHTML),_},[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);var w=[].concat(h,ES(Array.from(i.tBodies).reduce(function(_,T){return _.push.apply(_,ES(Array.from(T.rows))),_},[])),ES(c));g=w.length;for(var S=new Array(g),C=0;C<g;C++)S[C]=new Array(f);for(var P=[],R=[],V=0;V<g;V++)for(var U=w[V],X=Array.from(U.cells),Y=X.length,q=0;q<Y;q++){var Z=X[q],ie=Z.nodeName,J=Z.innerHTML,le=Z.rowSpan,Ce=Z.colSpan,we=S[V].findIndex(function(_){return _===void 0});if(ie==="TD"){if(le>1||Ce>1){for(var _e=V;_e<V+le;_e++)if(_e<g)for(var k=we;k<we+Ce;k++)S[_e][k]=null;var y=Z.getAttribute("style"),m=y&&y.includes("mso-ignore:colspan");m||P.push({col:we,row:V,rowspan:le,colspan:Ce})}var b="";l&&/excel/gi.test(l.content)?b=J.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):b=J.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[V][we]=b.replace(cle,function(_){return lV[_]})}else R.push(J)}return P.length&&(r.mergeCells=P),R.length&&(r.rowHeaders=R),S.length&&(r.data=S),r}}function vle(e){return ple(e)||mle(e)||gle(e)||yle()}function yle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gle(e,t){if(e){if(typeof e=="string")return U_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U_(e,t)}}function mle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ple(e){if(Array.isArray(e))return U_(e)}function U_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function z_(e){"@babel/helpers - typeof";return z_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z_(e)}function Or(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=z_(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(vle(t)))).map(function(o){return"\\".concat(o)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function ble(e){return Or(e,[","])}function Re(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function Y_(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function sV(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}function wle(e){return _le(e)||Cle(e)||uV(e)||Sle()}function Sle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _le(e){if(Array.isArray(e))return G_(e)}function Ole(e,t){return Tle(e)||Ele(e,t)||uV(e,t)||Rle()}function Rle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uV(e,t){if(e){if(typeof e=="string")return G_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return G_(e,t)}}function G_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ele(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Tle(e){if(Array.isArray(e))return e}var K_="asc",Ple="desc",Y1=new Map([[K_,[-1,1]],[Ple,[1,-1]]]),kle=function(t){return"The priority '".concat(t,"' is already declared in a map.")},$le=function(t){return"The priority '".concat(t,"' is not a number.")};function Ale(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=wt(t)?t:kle,r=wt(r)?r:$le;function o(a,l){if(!Or(a))throw new Error(r(a));if(n.has(a))throw new Error(t(a));n.set(a,l)}function i(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:K_,l=Y1.get(a)||Y1.get(K_),s=Ole(l,2),u=s[0],f=s[1];return wle(n).sort(function(c,h){return c[0]<h[0]?u:f}).map(function(c){return c[1]})}return{addItem:o,getItems:i}}var Ile=Me,Mle=Ja.find,xle=ev,q_="find",fV=!0;q_ in[]&&Array(1)[q_](function(){fV=!1});Ile({target:"Array",proto:!0,forced:fV},{find:function(t){return Mle(this,t,arguments.length>1?arguments[1]:void 0)}});xle(q_);function Dle(e){return Lle(e)||Hle(e)||cV(e)||Nle()}function Nle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Lle(e){if(Array.isArray(e))return X_(e)}function G1(e,t){return Ble(e)||Fle(e,t)||cV(e,t)||jle()}function jle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cV(e,t){if(e){if(typeof e=="string")return X_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return X_(e,t)}}function X_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Fle(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Ble(e){if(Array.isArray(e))return e}var Vle=function(t){return"The id '".concat(t,"' is already declared in a map.")};function Rp(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=wt(t)?t:Vle;function n(f,c){if(u(f))throw new Error(t(f));r.set(f,c)}function o(f){return r.delete(f)}function i(){r.clear()}function a(f){var c=s().find(function(v){var g=G1(v,2),p=g[0],w=g[1];return f===w?p:!1})||[null],h=G1(c,1),d=h[0];return d}function l(f){return r.get(f)}function s(){return Dle(r)}function u(f){return r.has(f)}return{addItem:n,clear:i,getId:a,getItem:l,getItems:s,hasItem:u,removeItem:o}}function Wle(e){return Gle(e)||Yle(e)||zle(e)||Ule()}function Ule(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zle(e,t){if(e){if(typeof e=="string")return Z_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Z_(e,t)}}function Yle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Gle(e){if(Array.isArray(e))return Z_(e)}function Z_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Kle=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function qle(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=wt(t)?t:Kle;function n(a){if(r.has(a))throw new Error(t(a));r.add(a)}function o(){return Wle(r)}function i(){r.clear()}return{addItem:n,clear:i,getItems:o}}function Xle(e,t){return Qle(e)||Jle(e,t)||hV(e,t)||Zle()}function Zle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jle(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Qle(e){if(Array.isArray(e))return e}function K1(e){return rse(e)||tse(e)||hV(e)||ese()}function ese(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hV(e,t){if(e){if(typeof e=="string")return J_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return J_(e,t)}}function tse(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rse(e){if(Array.isArray(e))return J_(e)}function J_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var uT=function(t){return'There is already registered "'.concat(t,'" plugin.')},nse=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},ose=function(t){return'The priority "'.concat(t,'" is not a number.')},dV=Ale({errorPriorityExists:nse,errorPriorityNaN:ose}),vV=qle({errorItemExists:uT}),Q_=Rp({errorIdExists:uT});function yV(){return[].concat(K1(dV.getItems()),K1(vV.getItems()))}function fT(e){var t=fn(e);return Q_.getItem(t)}function ise(e){return!!fT(e)}function ot(e,t,r){var n=lse(e,t,r),o=Xle(n,3);e=o[0],t=o[1],r=o[2],fT(e)===void 0&&ase(e,t,r)}function ase(e,t,r){var n=fn(e);if(Q_.hasItem(n))throw new Error(uT(n));r===void 0?vV.addItem(n):dV.addItem(r,n),Q_.addItem(n,t)}function lse(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}var dv=Qr("renderers"),sse=dv.register,use=dv.getItem,gV=dv.hasItem;dv.getNames;dv.getValues;function q1(e){if(typeof e=="function")return e;if(!gV(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return use(e)}function eo(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),sse(e,t)}var vv=Qr("validators"),fse=vv.register,cse=vv.getItem,mV=vv.hasItem;vv.getNames;vv.getValues;function hse(e){if(typeof e=="function")return e;if(!mV(e))throw Error('No registered validator found under "'.concat(e,'" name'));return cse(e)}function sc(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),fse(e,t)}var Zi=1,or=2;function Bc(e){"@babel/helpers - typeof";return Bc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bc(e)}function dse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function X1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yse(n.key),n)}}function vse(e,t,r){return t&&X1(e.prototype,t),r&&X1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yse(e){var t=gse(e,"string");return Bc(t)==="symbol"?t:String(t)}function gse(e,t){if(Bc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hl=new WeakMap,mse=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.stretchMode,u=t.stretchingItemWidthFn,f=u===void 0?function(h){return h}:u,c=t.inlineStartOffset;dse(this,e),hl.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:o,columnWidthFn:i,overrideFn:a,calculationType:l,stretchingColumnWidthFn:f,inlineStartOffset:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=s,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return vse(e,[{key:"calculate",value:function(){for(var r=0,n=!0,o=[],i,a=0,l=0,s=hl.get(this),u=s.calculationType,f=s.overrideFn,c=s.scrollOffset,h=Math.max(s.scrollOffset,0),d=s.totalColumns,v=s.viewportWidth,g=h>0?v+1:v,p=0;p<d;p++)if(i=this._getColumnWidth(p),r<=h&&u!==or&&(this.startColumn=p,a=i),r>=h&&r+(u===or?i:0)<=h+g&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=p,a=i),this.endColumn=p),o.push(r),r+=i,l=i,u!==or&&(this.endColumn=p),r>=h+v){n=!1;break}var w=c+v-g,S=u===or?0:l,C=u===or?a:0;if(w<-1*s.inlineStartOffset||c>o.at(-1)+S||-1*s.scrollOffset-s.viewportWidth>-1*C?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===d-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var P=o[this.endColumn]+i-o[this.startColumn-1];if((P<=v||u!==or)&&(this.startColumn-=1),P>v)break}u===Zi&&this.startColumn!==null&&f&&f(this),this.startPosition=o[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var o=hl.get(this),i=o.totalColumns,a=0,l=0;l<i;l++){var s=this._getColumnWidth(l),u=o.stretchingColumnWidthFn(void 0,l);typeof u=="number"?n-=u:a+=s}var f=n-a;if(this.stretch==="all"&&f>0)this.stretchAllRatio=n/a,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var c=this._getColumnWidth(i-1),h=f+c;this.stretchLastWidth=h>=0?h:c}}}},{key:"getStretchedColumnWidth",value:function(r,n){var o=null;return this.stretch==="all"&&this.stretchAllRatio!==0?o=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(o=this._getStretchedLastColumnWidth(r)),o}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var o=0,i=hl.get(this),a=i.totalColumns;if(!this.stretchAllColumnsWidth[r]){var l=Math.round(n*this.stretchAllRatio),s=i.stretchingColumnWidthFn(l,r);s===void 0?this.stretchAllColumnsWidth[r]=l:this.stretchAllColumnsWidth[r]=isNaN(s)?this._getColumnWidth(r):s}if(this.stretchAllColumnsWidth.length===a&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)o+=this.stretchAllColumnsWidth[u];o!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-o)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=hl.get(this),o=n.totalColumns;return r===o-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=hl.get(this).columnWidthFn(r);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();const cT=mse;function Vc(e){"@babel/helpers - typeof";return Vc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vc(e)}function pse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wse(n.key),n)}}function bse(e,t,r){return t&&Z1(e.prototype,t),r&&Z1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wse(e){var t=Sse(e,"string");return Vc(t)==="symbol"?t:String(t)}function Sse(e,t){if(Vc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var J1=new WeakMap,Cse=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.scrollbarHeight;pse(this,e),J1.set(this,{viewportHeight:r,scrollOffset:n,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:l,horizontalScrollbarHeight:s}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return bse(e,[{key:"calculate",value:function(){for(var r=J1.get(this),n=r.calculationType,o=r.overrideFn,i=r.rowHeightFn,a=r.scrollOffset,l=Math.max(r.scrollOffset,0),s=r.totalRows,u=r.viewportHeight,f=r.horizontalScrollbarHeight||0,c=0,h=!0,d=[],v,g=0,p=0,w=0;w<s;w++)if(v=i(w),isNaN(v)&&(v=e.DEFAULT_HEIGHT),c<=l&&n!==or&&(this.startRow=w,g=v),c>=l&&c+(n===or?v:0)<=l+u-f&&(this.startRow===null&&(this.startRow=w,g=v),this.endRow=w),d.push(c),c+=v,p=v,n!==or&&(this.endRow=w),c>=l+u-f){h=!1;break}var S=a+u-f,C=n===or?g:0,P=n===or?0:p;if(S<C||a>d.at(-1)+P?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===s-1&&h)for(this.startRow=this.endRow;this.startRow>0;){var R=d[this.endRow]+v-d[this.startRow-1];if((R<=u-f||n!==or)&&(this.startRow-=1),R>=u-f)break}n===Zi&&this.startRow!==null&&o&&o(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();const pV=Cse;function Wc(e){"@babel/helpers - typeof";return Wc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wc(e)}function _se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bV(n.key),n)}}function Ose(e,t,r){return t&&Q1(e.prototype,t),r&&Q1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rse(e,t,r){Ese(e,t),t.set(e,r)}function Ese(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eA(e,t,r){return t=bV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bV(e){var t=Tse(e,"string");return Wc(t)==="symbol"?t:String(t)}function Tse(e,t){if(Wc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lf(e,t){var r=wV(e,t,"get");return Pse(e,r)}function Pse(e,t){return t.get?t.get.call(e):t.value}function kse(e,t,r){var n=wV(e,t,"set");return $se(e,n,r),r}function wV(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function $se(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Li=new WeakMap,Ase=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;_se(this,e),eA(this,"row",null),eA(this,"col",null),Rse(this,Li,{writable:!0,value:!1}),kse(this,Li,n),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}return Ose(e,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&(Lf(this,Li)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&(Lf(this,Li)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&(Lf(this,Li)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&(Lf(this,Li)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,Lf(this,Li))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();const zg=Ase;function Uc(e){"@babel/helpers - typeof";return Uc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uc(e)}function Ise(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SV(n.key),n)}}function Mse(e,t,r){return t&&tA(e.prototype,t),r&&tA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xse(e,t,r){Dse(e,t),t.set(e,r)}function Dse(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TS(e,t,r){return t=SV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SV(e){var t=Nse(e,"string");return Uc(t)==="symbol"?t:String(t)}function Nse(e,t){if(Uc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pn(e,t){var r=CV(e,t,"get");return Hse(e,r)}function Hse(e,t){return t.get?t.get.call(e):t.value}function Lse(e,t,r){var n=CV(e,t,"set");return jse(e,n,r),r}function CV(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function jse(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Vr=new WeakMap,Fse=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Ise(this,e),TS(this,"highlight",null),TS(this,"from",null),TS(this,"to",null),xse(this,Vr,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone(),Lse(this,Vr,o)}return Mse(e,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,o=r.col,i=this.getOuterTopStartCorner(),a=this.getOuterBottomEndCorner();return i.row<=n&&a.row>=n&&i.col<=o&&a.col>=o}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>o.row||r.col>o.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(o.row,r.row),Math.max(o.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=this.getDirection(),a=r.getOuterTopStartCorner(),l=r.getOuterBottomEndCorner(),s=Math.min(n.row,a.row),u=Math.min(n.col,a.col),f=Math.max(o.row,l.row),c=Math.max(o.col,l.col),h=this._createCellCoords(s,u),d=this._createCellCoords(f,c);return this.from=h,this.to=d,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var o=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=o[0],this.to=o[1];break;case"SE-NW":var i=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=i[0],this.to=i[1];break;case"SW-NE":var a=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=a[0],this.to=a[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return pn(this,Vr)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return pn(this,Vr)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return pn(this,Vr)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return pn(this,Vr)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return pn(this,Vr)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return pn(this,Vr)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return pn(this,Vr)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return pn(this,Vr)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof zg))return!1;if(n){var o=n.from,i=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(o.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,o.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},i=[];return n.top===o.top&&i.push("top"),n.right===o.right&&i.push("right"),n.bottom===o.bottom&&i.push("bottom"),n.left===o.left&&i.push("left"),i}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)!(this.from.row===i&&this.from.col===a)&&!(this.to.row===i&&this.to.col===a)&&o.push(this._createCellCoords(i,a));return o}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)r.row===i&&r.col===a?o.push(r):n.row===i&&n.col===a?o.push(n):o.push(this._createCellCoords(i,a));return o}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=n.row;i<=o.row;i++)for(var a=n.col;a<=o.col;a++){var l=r(i,a);if(l===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,pn(this,Vr))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new zg(r,n,pn(this,Vr))}}]),e}();const hT=Fse;var Bse=Me,Vse=a0;Bse({target:"Object",stat:!0},{setPrototypeOf:Vse});var _V=Ve,Wse=Ya,Use=Nt,zse=At,rA=Ti,Yse=Dd,OV=Function,Gse=_V([].concat),Kse=_V([].join),PS={},qse=function(e,t,r){if(!zse(PS,t)){for(var n=[],o=0;o<t;o++)n[o]="a["+o+"]";PS[t]=OV("C,a","return new C("+Kse(n,",")+")")}return PS[t](e,r)},Xse=Yse?OV.bind:function(t){var r=Wse(this),n=r.prototype,o=rA(arguments,1),i=function(){var l=Gse(o,rA(arguments));return this instanceof i?qse(r,l.length,l):r.apply(t,l)};return Use(n)&&(i.prototype=n),i},Zse=Me,Jse=jo,kS=Qa,Qse=Xse,nA=NF,eue=Ht,oA=Nt,tue=Za,RV=Fe,dT=Jse("Reflect","construct"),rue=Object.prototype,nue=[].push,EV=RV(function(){function e(){}return!(dT(function(){},[],e)instanceof e)}),TV=!RV(function(){dT(function(){})}),iA=EV||TV;Zse({target:"Reflect",stat:!0,forced:iA,sham:iA},{construct:function(t,r){nA(t),eue(r);var n=arguments.length<3?t:nA(arguments[2]);if(TV&&!EV)return dT(t,r,n);if(t===n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var o=[null];return kS(nue,o,r),new(kS(Qse,t,o))}var i=n.prototype,a=tue(oA(i)?i:rue),l=kS(t,a,r);return oA(l)?l:a}});function zc(e){"@babel/helpers - typeof";return zc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zc(e)}function oue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aue(n.key),n)}}function iue(e,t,r){return t&&aA(e.prototype,t),r&&aA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aue(e){var t=lue(e,"string");return zc(t)==="symbol"?t:String(t)}function lue(e,t){if(zc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dl=new WeakMap,sue=function(){function e(t,r,n,o,i,a){var l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;oue(this,e),this.wtSettings=n,this.domBindings=r,this.wtTable=i,this.selections=a,this.parent=l,this.eventManager=o,this.facadeGetter=t,dl.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return iue(e,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(i){return r.onContextMenu(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(i){return r.onMouseOver(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(i){return r.onMouseOut(i)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(a){return r.onTouchStart(a)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(a){return r.onTouchEnd(a)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},o=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(a){return r.onMouseUp(a)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(a){return r.onMouseDown(a)})};xn()?n():(xF()&&n(),o())}},{key:"selectedCellWasTouched",value:function(r){var n=dl.get(this),o=this.parentCell(r),i=o.coords;if(n.selectedCellBeforeTouchEnd&&i){var a=[i.row,n.selectedCellBeforeTouchEnd.from.row],l=a[0],s=a[1],u=[i.col,n.selectedCellBeforeTouchEnd.from.col],f=u[0],c=u[1];return l===s&&f===c}return!1}},{key:"parentCell",value:function(r){var n={},o=this.wtTable.TABLE,i=Yv(r,["TD","TH"],o);return i?(n.coords=this.wtTable.getCoords(i),n.TD=i):De(r,"wtBorder")&&De(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):De(r,"wtBorder")&&De(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=dl.get(this),o=this.domBindings.rootDocument.activeElement,i=WB(fie,r.target),a=r.target;if(!(a===o||i(0)===o||i(1)===o)){var l=this.parentCell(a);De(a,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,a):l.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,l.coords,l.TD),(r.button===0||this.touchApplied)&&l.TD&&(n.dblClickOrigin[0]=l.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,o=Yv(r.target,["TD","TH"],n),i=this.parent||this;o&&o!==i.lastMouseOver&&$a(o,n)&&(i.lastMouseOver=o,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(o),o))}}},{key:"onMouseOut",value:function(r){if(this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,o=Yv(r.target,["TD","TH"],n),i=Yv(r.relatedTarget,["TD","TH"],n),a=this.parent||this;o&&o!==i&&$a(o,n)&&(this.callListener("onCellMouseOut",r,this.wtTable.getCoords(o),o),i===null&&(a.lastMouseOver=null))}}},{key:"onMouseUp",value:function(r){var n=dl.get(this),o=this.parentCell(r.target);o.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,o.coords,o.TD),!(r.button!==0&&!this.touchApplied)&&(o.TD===n.dblClickOrigin[0]&&o.TD===n.dblClickOrigin[1]?(De(r.target,"corner")?this.callListener("onCellCornerDblClick",r,o.coords,o.TD):this.callListener("onCellDblClick",r,o.coords,o.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):o.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=o.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=dl.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,o=r.target,i=(n=this.parentCell(o))===null||n===void 0?void 0:n.coords,a=pe(i)&&i.row>=0&&i.col>=0,l=r.cancelable&&a&&this.wtSettings.getSetting("isDataViewInstance");if(l){var s=["A","BUTTON","INPUT"];FF()&&(tee()||ree())&&this.selectedCellWasTouched(o)&&!s.includes(o.tagName)?r.preventDefault():this.selectedCellWasTouched(o)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,o,i){var a=this.wtSettings.getSettingPure(r);a&&a(n,o,i,this.facadeGetter())}},{key:"destroy",value:function(){var r=dl.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}();const PV=sue;function Yc(e){"@babel/helpers - typeof";return Yc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yc(e)}function uue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cue(n.key),n)}}function fue(e,t,r){return t&&lA(e.prototype,t),r&&lA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cue(e){var t=hue(e,"string");return Yc(t)==="symbol"?t:String(t)}function hue(e,t){if(Yc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var due=function(){function e(t,r,n){uue(this,e),this.offset=t,this.total=r,this.countTH=n}return fue(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const vue=due;function Gc(e){"@babel/helpers - typeof";return Gc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gc(e)}function yue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mue(n.key),n)}}function gue(e,t,r){return t&&sA(e.prototype,t),r&&sA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mue(e){var t=pue(e,"string");return Gc(t)==="symbol"?t:String(t)}function pue(e,t){if(Gc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bue=function(){function e(t,r,n){yue(this,e),this.offset=t,this.total=r,this.countTH=n}return gue(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const wue=bue;var Sue=0,Yg=1,Gg=2;function Kc(e){"@babel/helpers - typeof";return Kc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kc(e)}function Cue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Oue(n.key),n)}}function _ue(e,t,r){return t&&uA(e.prototype,t),r&&uA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oue(e){var t=Rue(e,"string");return Kc(t)==="symbol"?t:String(t)}function Rue(e,t){if(Kc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fA=function(){function e(){Cue(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return _ue(e,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),e}();function qc(e){"@babel/helpers - typeof";return qc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qc(e)}function Eue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pue(n.key),n)}}function Tue(e,t,r){return t&&cA(e.prototype,t),r&&cA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pue(e){var t=kue(e,"string");return qc(t)==="symbol"?t:String(t)}function kue(e,t){if(qc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $ue=function(){function e(){Eue(this,e),this.size=new fA,this.workingSpace=Sue,this.sharedSize=null}return Tue(e,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof fA}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=Yg,r.workingSpace=Gg,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=Gg,r.workingSpace=Yg,this.sharedSize=r.getViewSize()}}]),e}();function Xc(e){"@babel/helpers - typeof";return Xc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xc(e)}function Aue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mue(n.key),n)}}function Iue(e,t,r){return t&&hA(e.prototype,t),r&&hA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mue(e){var t=xue(e,"string");return Xc(t)==="symbol"?t:String(t)}function xue(e,t){if(Xc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kV=function(){function e(t,r,n){Aue(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new $ue,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return Iue(e,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,o=0;if(this.isSharedViewSet())for(var i=r.firstElementChild;i;){if(i.tagName===this.childNodeType)o+=1;else if(n.isPlaceOn(Yg))break;i=i.nextElementSibling}else o=r.childElementCount;return o}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,o=this.isSharedViewSet(),i=n.getViewSize(),a=i.nextSize,l=this.getRenderedChildCount();l<a;){var s=this.nodesPool();!o||o&&n.isPlaceOn(Gg)?r.appendChild(s):r.insertBefore(s,r.firstChild),l+=1}for(var u=o&&n.isPlaceOn(Yg);l>a;)r.removeChild(u?r.firstChild:r.lastChild),l-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,o=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(Gg)&&(o+=n.sharedSize.nextSize);var i=r.childNodes[o];if(i.tagName!==this.childNodeType){var a=this.nodesPool();r.replaceChild(a,i),i=a}this.collectedNodes.push(i),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function cs(e){"@babel/helpers - typeof";return cs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cs(e)}function Due(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hue(n.key),n)}}function Nue(e,t,r){return t&&dA(e.prototype,t),r&&dA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hue(e){var t=Lue(e,"string");return cs(t)==="symbol"?t:String(t)}function Lue(e,t){if(cs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eO(e,t)}function eO(e,t){return eO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},eO(e,t)}function Fue(e){var t=Wue();return function(){var n=Kg(e),o;if(t){var i=Kg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Bue(this,o)}}function Bue(e,t){if(t&&(cs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vue(e)}function Vue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kg(e){return Kg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Kg(e)}var $V=function(e){jue(r,e);var t=Fue(r);function r(){return Due(this,r),t.apply(this,arguments)}return Nue(r,[{key:"prependView",value:function(o){return this.sizeSet.prepend(o.sizeSet),o.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(o){return this.sizeSet.append(o.sizeSet),o.sizeSet.prepend(this.sizeSet),this}}]),r}(kV);function Zc(e){"@babel/helpers - typeof";return Zc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zc(e)}function Uue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yue(n.key),n)}}function zue(e,t,r){return t&&vA(e.prototype,t),r&&vA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yue(e){var t=Gue(e,"string");return Zc(t)==="symbol"?t:String(t)}function Gue(e,t){if(Zc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kue=function(){function e(t){Uue(this,e),this.nodeType=t.toUpperCase()}return zue(e,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function Jc(e){"@babel/helpers - typeof";return Jc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jc(e)}function que(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zue(n.key),n)}}function Xue(e,t,r){return t&&yA(e.prototype,t),r&&yA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zue(e){var t=Jue(e,"string");return Jc(t)==="symbol"?t:String(t)}function Jue(e,t){if(Jc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yv=function(){function e(t,r){que(this,e),this.nodesPool=typeof t=="string"?new Kue(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return Xue(e,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function hs(e){"@babel/helpers - typeof";return hs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hs(e)}function Que(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tfe(n.key),n)}}function efe(e,t,r){return t&&gA(e.prototype,t),r&&gA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tfe(e){var t=rfe(e,"string");return hs(t)==="symbol"?t:String(t)}function rfe(e,t){if(hs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tO(e,t)}function tO(e,t){return tO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},tO(e,t)}function ofe(e){var t=lfe();return function(){var n=qg(e),o;if(t){var i=qg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ife(this,o)}}function ife(e,t){if(t&&(hs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return afe(e)}function afe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qg(e){return qg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qg(e)}var sfe=function(e){nfe(r,e);var t=ofe(r);function r(){var n;return Que(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return efe(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new $V(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.rowHeaderFunctions,l=o.rowHeadersCount,s=o.rows,u=o.cells,f=0;f<i;f++){var c=this.table.renderedRowToSource(f),h=s.getRenderedNode(f);this.sourceRowIndex=c;var d=this.obtainOrderView(h),v=u.obtainOrderView(h);d.appendView(v).setSize(l).setOffset(this.table.renderedColumnToSource(0)).start();for(var g=0;g<l;g++){d.render();var p=d.getCurrentNode();p.className="",p.removeAttribute("style"),a[g](c,p,g)}d.end()}}}]),r}(yv);function ds(e){"@babel/helpers - typeof";return ds=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ds(e)}function ufe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cfe(n.key),n)}}function ffe(e,t,r){return t&&mA(e.prototype,t),r&&mA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cfe(e){var t=hfe(e,"string");return ds(t)==="symbol"?t:String(t)}function hfe(e,t){if(ds(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ds(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rO(e,t)}function rO(e,t){return rO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},rO(e,t)}function vfe(e){var t=mfe();return function(){var n=Xg(e),o;if(t){var i=Xg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yfe(this,o)}}function yfe(e,t){if(t&&(ds(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gfe(e)}function gfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xg(e){return Xg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xg(e)}var pfe=function(e){dfe(r,e);var t=vfe(r);function r(n){return ufe(this,r),t.call(this,null,n)}return ffe(r,[{key:"adjust",value:function(){var o=this.table,i=o.columnHeadersCount,a=o.rowHeadersCount,l=this.rootNode.firstChild;if(i){for(var s=this.table.columnsToRender,u=s+a,f=0,c=i;f<c;f++){for(l=this.rootNode.childNodes[f],l||(l=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(l)),this.renderedNodes=l.childNodes.length;this.renderedNodes<u;)l.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)l.removeChild(l.lastChild),this.renderedNodes-=1}var h=this.rootNode.childNodes.length;if(h>i)for(var d=i;d<h;d++)this.rootNode.removeChild(this.rootNode.lastChild)}else l&&Hn(l)}},{key:"render",value:function(){for(var o=this.table.columnHeadersCount,i=0;i<o;i+=1)for(var a=this.table,l=a.columnHeaderFunctions,s=a.columnsToRender,u=a.rowHeadersCount,f=this.rootNode.childNodes[i],c=-1*u;c<s;c+=1){var h=this.table.renderedColumnToSource(c),d=f.childNodes[c+u];d.className="",d.removeAttribute("style"),l[i](h,d,i)}}}]),r}(yv);function vs(e){"@babel/helpers - typeof";return vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vs(e)}function bfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sfe(n.key),n)}}function wfe(e,t,r){return t&&pA(e.prototype,t),r&&pA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sfe(e){var t=Cfe(e,"string");return vs(t)==="symbol"?t:String(t)}function Cfe(e,t){if(vs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _fe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nO(e,t)}function nO(e,t){return nO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},nO(e,t)}function Ofe(e){var t=Tfe();return function(){var n=Zg(e),o;if(t){var i=Zg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Rfe(this,o)}}function Rfe(e,t){if(t&&(vs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Efe(e)}function Efe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zg(e){return Zg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zg(e)}var Pfe=function(e){_fe(r,e);var t=Ofe(r);function r(n){return bfe(this,r),t.call(this,null,n)}return wfe(r,[{key:"adjust",value:function(){for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=i+a;this.renderedNodes<l;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>l;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=0;l<a;l++){var s=this.table.renderedColumnToSource(l),u=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[l].style.width="".concat(u,"px")}for(var f=0;f<i;f++){var c=this.table.renderedColumnToSource(f),h=this.table.columnUtils.getStretchedColumnWidth(c);this.rootNode.childNodes[f+a].style.width="".concat(h,"px")}var d=this.rootNode.firstChild;d&&re(d,"rowHeader")}}]),r}(yv);function ys(e){"@babel/helpers - typeof";return ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ys(e)}var bA;function kfe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function $fe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ife(n.key),n)}}function Afe(e,t,r){return t&&wA(e.prototype,t),r&&wA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ife(e){var t=Mfe(e,"string");return ys(t)==="symbol"?t:String(t)}function Mfe(e,t){if(ys(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ys(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oO(e,t)}function oO(e,t){return oO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},oO(e,t)}function Dfe(e){var t=Lfe();return function(){var n=Jg(e),o;if(t){var i=Jg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Nfe(this,o)}}function Nfe(e,t){if(t&&(ys(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hfe(e)}function Hfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jg(e){return Jg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jg(e)}var SA=!1,jfe=function(e){xfe(r,e);var t=Dfe(r);function r(n){var o;return $fe(this,r),o=t.call(this,"TR",n),o.orderView=new kV(n,function(i){return o.nodesPool.obtain(i)},o.nodeType),o}return Afe(r,[{key:"getRenderedNode",value:function(o){return this.orderView.getNode(o)}},{key:"render",value:function(){var o=this.table.rowsToRender;!SA&&o>1e3&&(SA=!0,dt(ft(bA||(bA=kfe([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(o).setOffset(this.table.renderedRowToSource(0)).start();for(var i=0;i<o;i++)this.orderView.render();this.orderView.end()}}]),r}(yv);function gs(e){"@babel/helpers - typeof";return gs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gs(e)}function Ffe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vfe(n.key),n)}}function Bfe(e,t,r){return t&&CA(e.prototype,t),r&&CA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vfe(e){var t=Wfe(e,"string");return gs(t)==="symbol"?t:String(t)}function Wfe(e,t){if(gs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ufe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iO(e,t)}function iO(e,t){return iO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},iO(e,t)}function zfe(e){var t=Kfe();return function(){var n=Qg(e),o;if(t){var i=Qg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Yfe(this,o)}}function Yfe(e,t){if(t&&(gs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gfe(e)}function Gfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qg(e){return Qg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qg(e)}var qfe=function(e){Ufe(r,e);var t=zfe(r);function r(){var n;return Ffe(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return Bfe(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new $V(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.columnsToRender,l=o.rows,s=o.rowHeaders,u=0;u<i;u++){var f=this.table.renderedRowToSource(u),c=l.getRenderedNode(u);this.sourceRowIndex=f;var h=this.obtainOrderView(c),d=s.obtainOrderView(c);h.prependView(d).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<a;v++){h.render();var g=h.getCurrentNode(),p=this.table.renderedColumnToSource(v);De(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),this.table.cellRenderer(f,p,g)}h.end()}}}]),r}(yv);function Qc(e){"@babel/helpers - typeof";return Qc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qc(e)}function Xfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jfe(n.key),n)}}function Zfe(e,t,r){return t&&_A(e.prototype,t),r&&_A(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jfe(e){var t=Qfe(e,"string");return Qc(t)==="symbol"?t:String(t)}function Qfe(e,t){if(Qc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ece=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;Xfe(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return Zfe(e,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,o=r.columnHeaders,i=r.colGroup,a=r.rows,l=r.cells;n.setTable(this),o.setTable(this),i.setTable(this),a.setTable(this),l.setTable(this),this.rowHeaders=n,this.columnHeaders=o,this.colGroup=i,this.rows=a,this.cells=l}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,o=0;o<r;o++){var i=n.getRenderedNode(o);if(i.firstChild){var a=this.renderedRowToSource(o),l=this.rowUtils.getHeight(a);l?i.firstChild.style.height="".concat(l-1,"px"):i.firstChild.style.height=""}}}}]),e}();function eh(e){"@babel/helpers - typeof";return eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eh(e)}function tce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nce(n.key),n)}}function rce(e,t,r){return t&&OA(e.prototype,t),r&&OA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nce(e){var t=oce(e,"string");return eh(t)==="symbol"?t:String(t)}function oce(e,t){if(eh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ice=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,o=t.COLGROUP,i=t.TBODY,a=t.rowUtils,l=t.columnUtils,s=t.cellRenderer;tce(this,e),this.renderer=new ece(r,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new sfe,columnHeaders:new pfe(n),colGroup:new Pfe(o),rows:new jfe(i),cells:new qfe}),this.renderer.setAxisUtils(a,l)}return rce(e,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function th(e){"@babel/helpers - typeof";return th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},th(e)}function ace(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sce(n.key),n)}}function lce(e,t,r){return t&&RA(e.prototype,t),r&&RA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sce(e){var t=uce(e,"string");return th(t)==="symbol"?t:String(t)}function uce(e,t){if(th(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fce=function(){function e(t,r){ace(this,e),this.dataAccessObject=t,this.wtSettings=r,this.headerWidths=new Map}return lce(e,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,o=this.getWidth(r);if(n){var i=n.getStretchedColumnWidth(r,o);i&&(o=i)}return o}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),o=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return o!==void 0&&(n=n?Math.max(n,o):o),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,o=n.wtTable,i=n.wtViewport,a=n.cloneSource,l=a?a.wtTable.holder:o.holder,s=l.offsetHeight<l.scrollHeight?er():0,u=r.getSetting("rowHeaderWidth");if(i.columnsRenderCalculator.refreshStretching(i.getViewportWidth()-s),u=r.getSetting("onModifyRowHeaderWidth",u),u!=null)for(var f=r.getSetting("rowHeaders").length,c=r.getSetting("defaultColumnWidth"),h=0;h<f;h++){var d=Array.isArray(u)?u[h]:u;d=d??c,this.headerWidths.set(h,d)}}}]),e}();function rh(e){"@babel/helpers - typeof";return rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rh(e)}function cce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dce(n.key),n)}}function hce(e,t,r){return t&&EA(e.prototype,t),r&&EA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dce(e){var t=vce(e,"string");return rh(t)==="symbol"?t:String(t)}function vce(e,t){if(rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yce=function(){function e(t,r){cce(this,e),this.dataAccessObject=t,this.wtSettings=r}return hce(e,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),o=this.dataAccessObject.wtViewport.oversizedRows[r];return o!==void 0&&(n=n===void 0?o:Math.max(n,o)),n}}]),e}();function nh(e){"@babel/helpers - typeof";return nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nh(e)}function gce(e){return bce(e)||pce(e)||AV(e)||mce()}function mce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pce(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bce(e){if(Array.isArray(e))return aO(e)}function wce(e,t){return _ce(e)||Cce(e,t)||AV(e,t)||Sce()}function Sce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AV(e,t){if(e){if(typeof e=="string")return aO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aO(e,t)}}function aO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Cce(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function _ce(e){if(Array.isArray(e))return e}function Oce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IV(n.key),n)}}function Rce(e,t,r){return t&&TA(e.prototype,t),r&&TA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bn(e,t,r){return t=IV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IV(e){var t=Ece(e,"string");return nh(t)==="symbol"?t:String(t)}function Ece(e,t){if(nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tce=function(){function e(t,r,n,o,i){var a=this;Oce(this,e),bn(this,"wtSettings",null),bn(this,"domBindings",void 0),bn(this,"TBODY",null),bn(this,"THEAD",null),bn(this,"COLGROUP",null),bn(this,"hasTableHeight",!0),bn(this,"hasTableWidth",!0),bn(this,"isTableVisible",!1),bn(this,"tableOffset",0),bn(this,"holderOffset",0),this.domBindings=n,this.isMaster=i==="master",this.name=i,this.dataAccessObject=t,this.facadeGetter=r,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,jB(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var l=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return a._modifyRowHeaderWidth(l)}),this.rowUtils=new yce(this.dataAccessObject,this.wtSettings),this.columnUtils=new fce(this.dataAccessObject,this.wtSettings),this.tableRenderer=new ice({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return Rce(e,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!De(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtSpreader",n&&n.insertBefore(o,r),o.appendChild(r)),o.style.position="relative",o}},{key:"createHider",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!De(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtHider",n&&n.insertBefore(o,r),o.appendChild(r)),o}},{key:"createHolder",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!De(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.style.position="relative",o.className="wtHolder",n&&n.insertBefore(o,r),this.isMaster&&(o.parentNode.className+="ht_master handsontable",o.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),o.appendChild(r)),o}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,o=this.dataAccessObject,i=o.wtOverlays,a=o.wtViewport,l=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),f=u.length,c=n.getSetting("columnHeaders"),h=c.length,d=!1,v=r;if(this.isMaster&&(this.holderOffset=zt(this.holder),v=a.createRenderCalculators(v),f&&!n.getSetting("fixedColumnsStart"))){var g=i.inlineStartOverlay.getScrollPosition(),p=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,p!==this.correctHeaderWidth&&(v=!1)}if(this.isMaster&&(d=i.updateStateOfRendering()),v)this.isMaster&&a.createVisibleCalculators(),i&&i.refresh(!0);else{this.isMaster?this.tableOffset=zt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var w=l>0?this.getFirstRenderedRow():0,S=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new wue(w,l,h),this.columnFilter=new vue(S,s,f);var C=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var P={};this.wtSettings.getSetting("beforeDraw",!0,P),C=P.skipRender!==!0}if(C){this.tableRenderer.setHeaderContentRenderers(u,c),(this.is(Mn)||this.is(hi))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var R;if(this.isMaster&&(R=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Mn))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var V=gt(this.hider),U=gt(this.TABLE);V!==0&&U!==V&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),R!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Mn)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var X=!1;return this.isMaster&&(X=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(X=i.bottomOverlay.resetFixedPosition()||X),X=i.inlineStartOverlay.resetFixedPosition()||X,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),X?(i.refreshAll(),i.adjustElementsSize()):this.refreshSelections(v),d&&i.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),o=this.wtSettings.getSetting("columnHeaders").length,i=this.wtSettings.getSetting("defaultRowHeight"),a,l,s,u=this.wtSettings.getSetting("columnHeaderHeight")||[];o;)o-=1,a=this.getColumnHeaderHeight(o),l=this.getColumnHeader(n,o),l&&(s=si(l),(!a&&i<s||a<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=s),Array.isArray(u)?u[o]!==null&&u[o]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]<(u[o]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,o=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=r.getSetting("columnHeaders"),a=0,l=i.length;a<l;a++)if(o[a]){if(!n[a]||n[a].childNodes.length===0)return;n[a].childNodes[0].style.height="".concat(o[a],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(Mn))&&!r.getSetting("externalRowCalculator"))for(var o=this.getRenderedRowsCount(),i=0;i<o;i++){var a=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[a]&&(n.oversizedRows[a]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),o=0,i=n.length;o<i;o++)je(n[o],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,o=this.dataAccessObject.selections;if(o){var i=Array.from(o),a=i.length;if(r){for(var l=[],s=0;s<a;s++){for(var u=i[s].settings,f=u.highlightHeaderClassName,c=u.highlightRowClassName,h=u.highlightColumnClassName,d=i[s].classNames,v=d.length,g=0;g<v;g++)l.includes(d[g])||l.push(d[g]);f&&!l.includes(f)&&l.push(f),c&&!l.includes(c)&&l.push(c),h&&!l.includes(h)&&l.push(h)}var p=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(p))for(var w=0;w<p.length;w++)l.push(p[w]);for(var S=l.length,C=0;C<S;C++)this.removeClassFromCells(l[C])}for(var P=0;P<a;P++)i[P].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,o=r.col,i=this.wtSettings.getSetting("onModifyGetCellCoords",n,o);if(i&&Array.isArray(i)){var a=wce(i,2);n=a[0],o=a[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(o))return-3;if(this.isColumnAfterRenderedColumns(o))return-4;var l=this.getRow(n);if(!l&&n>=0)throw new Error("TR was expected to be rendered but is not");var s=l.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!s&&o>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}},{key:"getRow",value:function(r){var n=null,o=null;if(r<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(r),o=this.THEAD}else{var a;n=(a=this.rowFilter)===null||a===void 0?void 0:a.sourceToRendered(r),o=this.TBODY}return n!==void 0&&o!==void 0?o.childNodes.length<n+1?!1:o.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=this.THEAD.childNodes[n];return o==null?void 0:o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],o=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(i){var a=i.childNodes[o];a&&n.push(a)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var o=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=o)){var i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return i==null?void 0:i.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],o=this.wtSettings.getSetting("rowHeaders").length,i=0;i<o;i++){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],l=a==null?void 0:a.childNodes[i];l&&n.push(l)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=ka(n,["TD","TH"])),n===null)return null;var o=n.parentNode,i=o.parentNode,a=hie(o),l=n.cellIndex;if(Hi(Ha,n,this.wtRootElement)||Hi(Da,n,this.wtRootElement))i.nodeName==="THEAD"&&(a-=i.childNodes.length);else if(Hi(hi,n,this.wtRootElement)||Hi(Mn,n,this.wtRootElement)){var s=this.wtSettings.getSetting("totalRows");a=s-i.childNodes.length+a}else i===this.THEAD?a=this.rowFilter.visibleColHeadedRowToSourceRow(a):a=this.rowFilter.renderedToSource(a);return Hi(Ha,n,this.wtRootElement)||Hi(Na,n,this.wtRootElement)||Hi(hi,n,this.wtRootElement)?l=this.columnFilter.offsettedTH(l):l=this.columnFilter.visibleRowHeadedColumnToSourceColumn(l),this.wot.createCellCoords(a,l)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),o=si(this.TBODY)-1,i,a,l,s,u;if(!(n===o&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,l=this.rowFilter.renderedToSource(r),i=this.getRowHeight(l),s=this.getTrForRow(l),u=s.querySelector("th"),u?a=si(u):a=si(s)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<a||i<a)&&(a+=1,this.dataAccessObject.wtViewport.oversizedRows[l]=a)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return gt(this.TABLE)}},{key:"getHeight",value:function(){return $t(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=gt(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=$t(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return xc(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=wt(r)?r():null;return Array.isArray(n)?(n=gce(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}();const wf=Tce;var Pce="stickyRowsBottom",MV={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=t-r;return t===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Bo(MV,"MIXIN_NAME",Pce,{writable:!1,enumerable:!1});const xV=MV;var kce="stickyColumnsStart",DV={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Bo(DV,"MIXIN_NAME",kce,{writable:!1,enumerable:!1});const vT=DV;function ms(e){"@babel/helpers - typeof";return ms=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ms(e)}function PA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ace(n.key),n)}}function $ce(e,t,r){return t&&PA(e.prototype,t),r&&PA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ace(e){var t=Ice(e,"string");return ms(t)==="symbol"?t:String(t)}function Ice(e,t){if(ms(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ms(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lO(e,t)}function lO(e,t){return lO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},lO(e,t)}function Dce(e){var t=Lce();return function(){var n=em(e),o;if(t){var i=em(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Nce(this,o)}}function Nce(e,t){if(t&&(ms(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hce(e)}function Hce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function em(e){return em=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},em(e)}var yT=function(e){xce(r,e);var t=Dce(r);function r(n,o,i,a){return Mce(this,r),t.call(this,n,o,i,a,hi)}return $ce(r)}(wf);bt(yT,xV);bt(yT,vT);const jce=yT;var Da="top",Mn="bottom",Na="inline_start",Ha="top_inline_start_corner",hi="bottom_inline_start_corner",Fce=[Da,Mn,Na,Ha,hi],Bce=new Map([[Da,"ht_clone_".concat(Da)],[Mn,"ht_clone_".concat(Mn)],[Na,"ht_clone_".concat(Na," ht_clone_left")],[Ha,"ht_clone_".concat(Ha," ht_clone_top_left_corner")],[hi,"ht_clone_".concat(hi," ht_clone_bottom_left_corner")]]);function oh(e){"@babel/helpers - typeof";return oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oh(e)}function Vce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NV(n.key),n)}}function Wce(e,t,r){return t&&kA(e.prototype,t),r&&kA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $S(e,t,r){return t=NV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NV(e){var t=Uce(e,"string");return oh(t)==="symbol"?t:String(t)}function Uce(e,t){if(oh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zce=function(){function e(t){Vce(this,e),$S(this,"dataAccessObject",void 0),$S(this,"lastScrolledColumnPos",-1),$S(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return Wce(e,[{key:"scrollViewport",value:function(r,n,o,i,a){var l=this.scrollViewportHorizontally(r.col,o,a),s=this.scrollViewportVertically(r.row,n,i);return l||s}},{key:"scrollViewportHorizontally",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalColumns;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),f=n===void 0&&o===void 0,c=this.dataAccessObject,h=c.fixedColumnsStart,d=c.inlineStartOverlay;if(f&&r<h)return!1;var v=!1;return s===-1?v=d.scrollTo(r,f?r>this.lastScrolledColumnPos:n):(f&&(r<s||r>u)||!f)&&(v=d.scrollTo(r,f?r>u:n)),v&&(this.lastScrolledColumnPos=r),v}},{key:"scrollViewportVertically",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalRows;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),f=n===void 0&&o===void 0,c=this.dataAccessObject,h=c.fixedRowsBottom,d=c.fixedRowsTop,v=c.topOverlay;if(f&&(r<d||r>l-h-1))return!1;var g=!1;return s===-1?g=v.scrollTo(r,f?r>this.lastScrolledRowPos:o):(f&&(r<s||r>u)||!f)&&(g=v.scrollTo(r,f?r>u:o)),g&&(this.lastScrolledRowPos=r),g}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.fixedRowsTop,s=r.rootWindow,u=o.getFirstVisibleRow();if(n.mainTableScrollableElement===s){var f=zt(o.wtRootElement),c=si(o.hider),h=si(s),d=Vg(s,s);if(f.top+c-h<=d){var v=i.getColumnHeaderHeight();v+=n.sumCellSizes(0,l);for(var g=a;g>0;g--)if(v+=n.sumCellSizes(g-1,g),f.top+c-v<=d){u=g;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.rootWindow,s=o.getLastVisibleRow();if(n.mainTableScrollableElement===l){var u=zt(o.wtRootElement),f=Vg(l,l);if(u.top>f){for(var c=si(l),h=i.getColumnHeaderHeight(),d=1;d<=a;d++)if(h+=n.sumCellSizes(d-1,d),u.top+h-f>=c){s=d-2;break}}}return s}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalColumns,l=r.rootWindow,s=o.getFirstVisibleColumn();if(n.mainTableScrollableElement===l){var u=zt(o.wtRootElement),f=Zy(o.hider),c=Zy(l),h=Math.abs(N_(l,l));if(u.left+f-c<=h){for(var d=i.getRowHeaderWidth(),v=a;v>0;v--)if(d+=n.sumCellSizes(v-1,v),u.left+f-d<=h){s=v;break}}}return s}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.wtSettings,o=r.inlineStartOverlay,i=r.wtTable,a=r.wtViewport,l=r.totalColumns,s=r.rootWindow,u=i.getLastVisibleColumn();if(o.mainTableScrollableElement===s){var f=n.getSetting("rtlMode"),c=null;if(f){var h=i.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document,v=d.documentElement.offsetWidth;c=Math.abs(h.right-v)}else{var g=zt(i.wtRootElement);c=g.left}var p=Math.abs(N_(s,s));if(c>p){for(var w=Zy(s),S=a.getRowHeaderWidth(),C=1;C<=l;C++)if(S+=o.sumCellSizes(C-1,C),c+S-p>=w){u=C-2;break}}}return u}}]),e}();const Yce=zce;function ih(e){"@babel/helpers - typeof";return ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ih(e)}function Gce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HV(n.key),n)}}function Kce(e,t,r){return t&&$A(e.prototype,t),r&&$A(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tn(e,t,r){return t=HV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HV(e){var t=qce(e,"string");return ih(t)==="symbol"?t:String(t)}function qce(e,t){if(ih(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gT=function(){function e(t,r){Gce(this,e),tn(this,"wtTable",void 0),tn(this,"wtScroll",void 0),tn(this,"wtViewport",void 0),tn(this,"wtOverlays",void 0),tn(this,"selections",void 0),tn(this,"wtEvent",void 0),tn(this,"guid","wt_".concat(NB())),tn(this,"drawInterrupted",!1),tn(this,"drawn",!1),tn(this,"domBindings",void 0),tn(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new Yce(this.createScrollDao())}return Kce(e,[{key:"eventManager",get:function(){return new It(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;n<o;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(i,a){Ia(a,r[i])}])}}},{key:"createCellCoords",value:function(r,n){return new zg(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,o){return new hT(r,n,o,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var o=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),a=this.wtSettings.getSetting("fixedRowsBottom"),l=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<i&&r.col<l)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<l&&r.row>=o-a){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<l)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<o&&r.row>=o-a&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,o,i,a){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get wtSettings(){return r.wtSettings},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function ps(e){"@babel/helpers - typeof";return ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ps(e)}function AA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LV(n.key),n)}}function Xce(e,t,r){return t&&AA(e.prototype,t),r&&AA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sO(e,t)}function sO(e,t){return sO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},sO(e,t)}function Qce(e){var t=the();return function(){var n=tm(e),o;if(t){var i=tm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ehe(this,o)}}function ehe(e,t){if(t&&(ps(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eg(e)}function eg(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function the(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tm(e){return tm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tm(e)}function IA(e,t,r){return t=LV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LV(e){var t=rhe(e,"string");return ps(t)==="symbol"?t:String(t)}function rhe(e,t){if(ps(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ps(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nhe=function(e){Jce(r,e);var t=Qce(r);function r(n,o,i){var a;Zce(this,r),a=t.call(this,n,o),IA(eg(a),"cloneSource",void 0),IA(eg(a),"cloneOverlay",void 0);var l=a.wtSettings.getSetting("facade",eg(a));return a.cloneSource=i.source,a.cloneOverlay=i.overlay,a.wtTable=a.cloneOverlay.createTable(a.getTableDao(),l,a.domBindings,a.wtSettings),a.wtViewport=i.viewport,a.selections=i.selections,a.wtEvent=new PV(l,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections,i.event),a.findOriginalHeaders(),a}return Xce(r)}(gT);function ah(e){"@babel/helpers - typeof";return ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ah(e)}function ohe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jV(n.key),n)}}function ihe(e,t,r){return t&&MA(e.prototype,t),r&&MA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ahe(e,t,r){return t=jV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jV(e){var t=lhe(e,"string");return ah(t)==="symbol"?t:String(t)}function lhe(e,t){if(ah(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gv=function(){function e(t,r,n,o,i){ohe(this,e),ahe(this,"wtSettings",null),Bo(this,"wot",t,{writable:!1}),this.domBindings=i,this.facadeGetter=r,this.wtSettings=o;var a=this.wot.wtTable,l=a.TABLE,s=a.hider,u=a.spreader,f=a.holder,c=a.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=l,this.hider=s,this.spreader=u,this.holder=f,this.wtRootElement=c,this.trimmingContainer=fs(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return ihe(e,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=fs(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Wg(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,o){if(this.clone.wtTable.holder.contains(r)===!1){dt("The provided element is not a child of the ".concat(this.type," overlay"));return}var i=this.mainTableScrollableElement===this.domBindings.rootWindow,a=o<this.wtSettings.getSetting("fixedColumnsStart"),l=n<this.wtSettings.getSetting("fixedRowsTop"),s=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,f={start:this.getRelativeStartPosition(u),top:u.offsetTop},c={start:this.getRelativeStartPosition(r),top:r.offsetTop},h=null;return i?h=this.getRelativeCellPositionWithinWindow(l,a,c,f):h=this.getRelativeCellPositionWithinHolder(l,s,a,c,f),h}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,o,i){var a=this.wot.wtTable.wtRootElement.getBoundingClientRect(),l=0,s=0;if(!n)l=i.start;else{var u=a.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(a.left+a.width+er())),l=u<=0?-1*u:0}if(r){var f=this.clone.wtTable.TABLE.getBoundingClientRect();s=f.top-a.top}else s=i.top;return{start:o.start+l,top:o.top+s}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,o,i,a){var l={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},s=0,u=0;if(o||(s=l.horizontal-a.start),n){var f=this.wot.wtTable.wtRootElement.getBoundingClientRect(),c=this.clone.wtTable.TABLE.getBoundingClientRect();u=c.top*-1+f.top}else r||(u=l.vertical-a.top);return{start:i.start-s,top:i.top-u}}},{key:"makeClone",value:function(){if(Fce.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=o.createElement("DIV"),l=o.createElement("TABLE"),s=r.wtRootElement.parentNode;a.className="".concat(Bce.get(this.type)," handsontable"),a.setAttribute("dir",this.isRtl()?"rtl":"ltr"),a.style.position="absolute",a.style.top=0,a.style.overflow="visible",this.isRtl()?a.style.right=0:a.style.left=0,l.className=r.TABLE.className,a.appendChild(l),s.appendChild(a);var u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Da||u==="vertical"&&this.type===Na?this.mainTableScrollableElement=i:i.getComputedStyle(s).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=Wg(r.TABLE),new nhe(l,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,o=r.style,i=n.style,a=r.parentNode.style;I([o,i,a],function(l){l.width="",l.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function bs(e){"@babel/helpers - typeof";return bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bs(e)}function tg(e,t,r){return FV()?tg=Reflect.construct.bind():tg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&rm(u,a.prototype),u},tg.apply(null,arguments)}function she(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fhe(n.key),n)}}function uhe(e,t,r){return t&&xA(e.prototype,t),r&&xA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fhe(e){var t=che(e,"string");return bs(t)==="symbol"?t:String(t)}function che(e,t){if(bs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hhe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rm(e,t)}function rm(e,t){return rm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},rm(e,t)}function dhe(e){var t=FV();return function(){var n=nm(e),o;if(t){var i=nm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return vhe(this,o)}}function vhe(e,t){if(t&&(bs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yhe(e)}function yhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nm(e){return nm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nm(e)}var ghe=function(e){hhe(r,e);var t=dhe(r);function r(n,o,i,a,l,s){var u;return she(this,r),u=t.call(this,n,o,hi,i,a),u.bottomOverlay=l,u.inlineStartOverlay=s,u}return uhe(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return tg(jce,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot;if(this.updateTrimmingContainer(),!o.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(i.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var a=this.inlineStartOverlay.getOverlayOffset(),l=this.bottomOverlay.getOverlayOffset();i.style[this.isRtl()?"right":"left"]="".concat(a,"px"),i.style.bottom="".concat(l,"px")}else _p(i),this.repositionOverlay();var s=$t(this.clone.wtTable.TABLE),u=gt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),i.style.height="".concat(s,"px"),i.style.width="".concat(u,"px"),!1}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=er(l)),s.style.bottom="".concat(u,"px")}}]),r}(gv),mhe="calculatedColumns",BV={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};Bo(BV,"MIXIN_NAME",mhe,{writable:!1,enumerable:!1});const mT=BV;function ws(e){"@babel/helpers - typeof";return ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ws(e)}function DA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bhe(n.key),n)}}function phe(e,t,r){return t&&DA(e.prototype,t),r&&DA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bhe(e){var t=whe(e,"string");return ws(t)==="symbol"?t:String(t)}function whe(e,t){if(ws(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ws(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function She(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Che(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uO(e,t)}function uO(e,t){return uO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},uO(e,t)}function _he(e){var t=Ehe();return function(){var n=om(e),o;if(t){var i=om(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ohe(this,o)}}function Ohe(e,t){if(t&&(ws(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rhe(e)}function Rhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ehe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function om(e){return om=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},om(e)}var pT=function(e){Che(r,e);var t=_he(r);function r(n,o,i,a){return She(this,r),t.call(this,n,o,i,a,Mn)}return phe(r)}(wf);bt(pT,xV);bt(pT,mT);const The=pT;function Ss(e){"@babel/helpers - typeof";return Ss=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ss(e)}function rg(e,t,r){return WV()?rg=Reflect.construct.bind():rg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&im(u,a.prototype),u},rg.apply(null,arguments)}function Phe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UV(n.key),n)}}function khe(e,t,r){return t&&NA(e.prototype,t),r&&NA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $he(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&im(e,t)}function im(e,t){return im=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},im(e,t)}function Ahe(e){var t=WV();return function(){var n=am(e),o;if(t){var i=am(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ihe(this,o)}}function Ihe(e,t){if(t&&(Ss(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VV(e)}function VV(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function am(e){return am=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},am(e)}function Mhe(e,t,r){return t=UV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UV(e){var t=xhe(e,"string");return Ss(t)==="symbol"?t:String(t)}function xhe(e,t){if(Ss(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ss(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dhe=function(e){$he(r,e);var t=Ahe(r);function r(n,o,i,a){var l;return Phe(this,r),l=t.call(this,n,o,Mn,i,a),Mhe(VV(l),"cachedFixedRowsBottom",-1),l.cachedFixedRowsBottom=l.wtSettings.getSetting("fixedRowsBottom"),l}return khe(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return rg(The,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.domBindings.rootWindow,i=this.clone.wtTable.holder.parentNode;i.style.top="";var a=0,l=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===o&&(!l||l!=="vertical")?(a=this.getOverlayOffset(),i.style.bottom="".concat(a,"px")):(a=this.getScrollPosition(),this.repositionOverlay());var s=this.adjustHeaderBordersPosition(a);return this.adjustElementsSize(),s}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=er(l)),s.style.bottom="".concat(u,"px")}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i?(i.scrollTo(us(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wot,l=a.wtTable,s=a.wtSettings,u=s.getSetting("defaultRowHeight"),f=o,c=0;f<i;){var h=l.getRowHeight(f);c+=h===void 0?u:h,f+=1}return c}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings,s=l.rootDocument,u=l.rootWindow,f=er(s),c=this.clone.wtTable.holder.parentNode,h=c.style,d=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==u||d==="horizontal"){var v=a.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(v-=f),v=Math.min(v,i.wtRootElement.scrollWidth),h.width="".concat(v,"px")}else h.width="";this.clone.wtTable.holder.style.width=h.width;var g=$t(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(g=0),h.height="".concat(g,"px")}},{key:"adjustRootChildrenSize",value:function(){var o=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height=o.parentNode.style.height}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;i&&s.offsetHeight!==s.clientHeight&&(u=er(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportHeight(),a+=1):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Vg(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s,f=this.domBindings.rootDocument.documentElement.clientHeight;a=Math.max(this.getTableParentOffset()-this.getScrollPosition()-f+l,0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wtSettings.getSetting("fixedRowsBottom"),a=this.cachedFixedRowsBottom!==i,l=this.wtSettings.getSetting("columnHeaders"),s=!1;if((a||i===0)&&l.length>0){var u=this.wot.wtTable.holder.parentNode,f=De(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),o||this.wtSettings.getSetting("totalRows")===0?(re(u,"innerBorderBottom"),s=!f):(je(u,"innerBorderBottom"),s=f)}return s}}]),r}(gv),Nhe="calculatedRows",zV={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};Bo(zV,"MIXIN_NAME",Nhe,{writable:!1,enumerable:!1});const YV=zV;function Cs(e){"@babel/helpers - typeof";return Cs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cs(e)}function HA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lhe(n.key),n)}}function Hhe(e,t,r){return t&&HA(e.prototype,t),r&&HA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lhe(e){var t=jhe(e,"string");return Cs(t)==="symbol"?t:String(t)}function jhe(e,t){if(Cs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bhe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fO(e,t)}function fO(e,t){return fO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},fO(e,t)}function Vhe(e){var t=zhe();return function(){var n=lm(e),o;if(t){var i=lm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Whe(this,o)}}function Whe(e,t){if(t&&(Cs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Uhe(e)}function Uhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zhe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lm(e){return lm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lm(e)}var bT=function(e){Bhe(r,e);var t=Vhe(r);function r(n,o,i,a){return Fhe(this,r),t.call(this,n,o,i,a,Na)}return Hhe(r)}(wf);bt(bT,YV);bt(bT,vT);const Yhe=bT;function _s(e){"@babel/helpers - typeof";return _s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_s(e)}function ng(e,t,r){return GV()?ng=Reflect.construct.bind():ng=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&sm(u,a.prototype),u},ng.apply(null,arguments)}function Ghe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qhe(n.key),n)}}function Khe(e,t,r){return t&&LA(e.prototype,t),r&&LA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qhe(e){var t=Xhe(e,"string");return _s(t)==="symbol"?t:String(t)}function Xhe(e,t){if(_s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zhe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sm(e,t)}function sm(e,t){return sm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},sm(e,t)}function Jhe(e){var t=GV();return function(){var n=um(e),o;if(t){var i=um(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Qhe(this,o)}}function Qhe(e,t){if(t&&(_s(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ede(e)}function ede(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function um(e){return um=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},um(e)}var tde=function(e){Zhe(r,e);var t=Jhe(r);function r(n,o,i,a){return Ghe(this,r),t.call(this,n,o,Na,i,a)}return Khe(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return ng(Yhe,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot.wtTable;if(!this.needFullRender||!o.holder.parentNode)return!1;var i=this.domBindings.rootWindow,a=this.clone.wtTable.holder.parentNode,l=this.wtSettings.getSetting("preventOverflow"),s=0;this.trimmingContainer===i&&(!l||l!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),iT(a,"".concat(s,"px"),"0px")):(s=this.getScrollPosition(),_p(a));var u=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.isRtl()&&(o=-o),this.mainTableScrollableElement===i&&i.scrollX!==o?(i.scrollTo(o,Dc(i)),a=!0):this.mainTableScrollableElement.scrollLeft!==o&&(this.mainTableScrollableElement.scrollLeft=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultColumnWidth"),l=o,s=0;l<i;)s+=this.wot.wtTable.getStretchedColumnWidth(l)||a,l+=1;return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=er(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||c==="vertical"){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=s),h=Math.min(h,o.wtRootElement.scrollHeight),f.height="".concat(h,"px")}else f.height="";this.clone.wtTable.holder.style.height=f.height;var d=gt(this.clone.wtTable.TABLE);f.width="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.height=this.hider.style.height,i.style.height=i.parentNode.style.height,i.style.width="".concat(parseInt(i.parentNode.style.width,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalColumns"),i=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style[i]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;if(i){var f=this.wot.wtTable.getColumnWidth(o),c=this.wot.wtViewport.getViewportWidth();f>c&&(i=!1)}return i&&s.offsetWidth!==s.clientWidth&&(u=er(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportWidth()):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){var o=this.wtSettings.getSetting("preventOverflow"),i=0;return!o&&this.trimmingContainer===this.domBindings.rootWindow&&(i=this.wot.wtTable.holderOffset.left),i}},{key:"getScrollPosition",value:function(){return Math.abs(N_(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="horizontal")){this.isRtl()?a=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var l=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),u=l-s;a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wot.wtTable.holder.parentNode,a=this.wtSettings.getSetting("rowHeaders"),l=this.wtSettings.getSetting("fixedColumnsStart"),s=this.wtSettings.getSetting("totalRows");s?je(i,"emptyRows"):re(i,"emptyRows");var u=!1;if(l&&!a.length)re(i,"innerBorderLeft innerBorderInlineStart");else if(!l&&a.length){var f=De(i,"innerBorderInlineStart");o?(re(i,"innerBorderLeft innerBorderInlineStart"),u=!f):(je(i,"innerBorderLeft innerBorderInlineStart"),u=f)}return u}}]),r}(gv),rde="stickyRowsTop",KV={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Bo(KV,"MIXIN_NAME",rde,{writable:!1,enumerable:!1});const qV=KV;function Os(e){"@babel/helpers - typeof";return Os=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Os(e)}function jA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ode(n.key),n)}}function nde(e,t,r){return t&&jA(e.prototype,t),r&&jA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ode(e){var t=ide(e,"string");return Os(t)==="symbol"?t:String(t)}function ide(e,t){if(Os(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Os(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ade(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cO(e,t)}function cO(e,t){return cO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},cO(e,t)}function sde(e){var t=cde();return function(){var n=fm(e),o;if(t){var i=fm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ude(this,o)}}function ude(e,t){if(t&&(Os(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fde(e)}function fde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fm(e){return fm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fm(e)}var wT=function(e){lde(r,e);var t=sde(r);function r(n,o,i,a){return ade(this,r),t.call(this,n,o,i,a,Ha)}return nde(r)}(wf);bt(wT,qV);bt(wT,vT);const hde=wT;function Rs(e){"@babel/helpers - typeof";return Rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rs(e)}function og(e,t,r){return XV()?og=Reflect.construct.bind():og=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&cm(u,a.prototype),u},og.apply(null,arguments)}function dde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZV(n.key),n)}}function vde(e,t,r){return t&&FA(e.prototype,t),r&&FA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cm(e,t)}function cm(e,t){return cm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},cm(e,t)}function gde(e){var t=XV();return function(){var n=hm(e),o;if(t){var i=hm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return mde(this,o)}}function mde(e,t){if(t&&(Rs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hO(e)}function hO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hm(e){return hm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hm(e)}function BA(e,t,r){return t=ZV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZV(e){var t=pde(e,"string");return Rs(t)==="symbol"?t:String(t)}function pde(e,t){if(Rs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bde=function(e){yde(r,e);var t=gde(r);function r(n,o,i,a,l,s){var u;return dde(this,r),u=t.call(this,n,o,Ha,i,a),BA(hO(u),"topOverlay",void 0),BA(hO(u),"inlineStartOverlay",void 0),u.topOverlay=l,u.inlineStartOverlay=s,u}return vde(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return og(hde,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),a=this.topOverlay.getOverlayOffset();iT(o,"".concat(i,"px"),"".concat(a,"px"))}else _p(o);var l=$t(this.clone.wtTable.TABLE),s=gt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),o.style.height="".concat(l,"px"),o.style.width="".concat(s,"px"),!1}}]),r}(gv);function Es(e){"@babel/helpers - typeof";return Es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Es(e)}function VA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sde(n.key),n)}}function wde(e,t,r){return t&&VA(e.prototype,t),r&&VA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sde(e){var t=Cde(e,"string");return Es(t)==="symbol"?t:String(t)}function Cde(e,t){if(Es(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Es(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _de(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ode(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dO(e,t)}function dO(e,t){return dO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},dO(e,t)}function Rde(e){var t=Pde();return function(){var n=dm(e),o;if(t){var i=dm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ede(this,o)}}function Ede(e,t){if(t&&(Es(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tde(e)}function Tde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dm(e){return dm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dm(e)}var ST=function(e){Ode(r,e);var t=Rde(r);function r(n,o,i,a){return _de(this,r),t.call(this,n,o,i,a,Da)}return wde(r)}(wf);bt(ST,qV);bt(ST,mT);const kde=ST;function Ts(e){"@babel/helpers - typeof";return Ts=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ts(e)}function ig(e,t,r){return QV()?ig=Reflect.construct.bind():ig=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&vm(u,a.prototype),u},ig.apply(null,arguments)}function $de(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eW(n.key),n)}}function Ade(e,t,r){return t&&WA(e.prototype,t),r&&WA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ide(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vm(e,t)}function vm(e,t){return vm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},vm(e,t)}function Mde(e){var t=QV();return function(){var n=ym(e),o;if(t){var i=ym(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xde(this,o)}}function xde(e,t){if(t&&(Ts(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JV(e)}function JV(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ym(e){return ym=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ym(e)}function Dde(e,t,r){return t=eW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eW(e){var t=Nde(e,"string");return Ts(t)==="symbol"?t:String(t)}function Nde(e,t){if(Ts(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ts(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hde=function(e){Ide(r,e);var t=Mde(r);function r(n,o,i,a){var l;return $de(this,r),l=t.call(this,n,o,Da,i,a),Dde(JV(l),"cachedFixedRowsTop",-1),l.cachedFixedRowsTop=l.wtSettings.getSetting("fixedRowsTop"),l}return Ade(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return ig(kde,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode,i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),l=0,s=!1;if(this.trimmingContainer===i&&(!a||a!=="vertical")){var u=this.wot.wtTable,f=u.hider.getBoundingClientRect(),c=Math.ceil(f.bottom),h=o.offsetHeight;s=c===h,l=this.getOverlayOffset(),iT(o,"0px","".concat(l,"px"))}else l=this.getScrollPosition(),_p(o);var d=this.adjustHeaderBordersPosition(l,s);return this.adjustElementsSize(),d}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i&&i.scrollY!==o?(i.scrollTo(us(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultRowHeight"),l=o,s=0;l<i;){var u=this.wot.wtTable.getRowHeight(l);s+=u===void 0?a:u,l+=1}return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=er(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||c==="horizontal"){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=s),h=Math.min(h,o.wtRootElement.scrollWidth),f.width="".concat(h,"px")}else f.width="";this.clone.wtTable.holder.style.width=f.width;var d=$t(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),f.height="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height="".concat(parseInt(i.parentNode.style.height,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.wot,l=this.wtSettings,s=a.cloneSource?a.cloneSource:a,u=s.wtTable.holder,f=this.getTableParentOffset(),c=0;if(i){var h=this.wot.wtTable.getRowHeight(o),d=this.wot.wtViewport.getViewportHeight();h>d&&(i=!1)}if(i&&u.offsetHeight!==u.clientHeight&&(c=er(this.domBindings.rootDocument)),i){var v=l.getSetting("fixedRowsBottom"),g=l.getSetting("totalRows");f+=this.sumCellSizes(0,o+1),f-=a.wtViewport.getViewportHeight()-this.sumCellSizes(g-v,g),f+=1}else f+=this.sumCellSizes(l.getSetting("fixedRowsTop"),o);return f+=c,this.setScrollPosition(f)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Vg(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s;a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.wot.wtTable.holder.parentNode,l=this.wtSettings.getSetting("totalColumns");l?je(a,"emptyColumns"):re(a,"emptyColumns");var s=!1;if(!i){var u=this.wtSettings.getSetting("fixedRowsTop"),f=this.cachedFixedRowsTop!==u,c=this.wtSettings.getSetting("columnHeaders");if((f||u===0)&&c.length>0){var h=De(a,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),o||this.wtSettings.getSetting("totalRows")===0?(re(a,"innerBorderTop"),s=!h):(je(a,"innerBorderTop"),s=h)}}return s}}]),r}(gv);function lh(e){"@babel/helpers - typeof";return lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lh(e)}function oi(e,t,r){return Lde()?oi=Reflect.construct.bind():oi=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&vO(u,a.prototype),u},oi.apply(null,arguments)}function Lde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vO(e,t){return vO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},vO(e,t)}function jde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tW(n.key),n)}}function Fde(e,t,r){return t&&UA(e.prototype,t),r&&UA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gn(e,t,r){return t=tW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tW(e){var t=Bde(e,"string");return lh(t)==="symbol"?t:String(t)}function Bde(e,t){if(lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vde=function(){function e(t,r,n,o,i,a){var l=this;jde(this,e),Gn(this,"wot",null),Gn(this,"topOverlay",null),Gn(this,"bottomOverlay",null),Gn(this,"inlineStartOverlay",null),Gn(this,"topInlineStartCornerOverlay",null),Gn(this,"bottomInlineStartCornerOverlay",null),Gn(this,"browserLineHeight",void 0),Gn(this,"wtSettings",null),Gn(this,"resizeObserver",new ResizeObserver(function(h){M0(function(){!Array.isArray(h)||!h.length||l.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=o,this.domBindings=n,this.facadeGetter=r,this.wtTable=a;var s=this.domBindings,u=s.rootDocument,f=s.rootWindow;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=er(u);var c=f.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?a.holder:Wg(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=f.scrollX,this.lastScrollY=f.scrollY}return Fde(e,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,o=r.rootDocument,i=n.getComputedStyle(o.body),a=parseInt(i.lineHeight,10),l=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=a||l}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=oi(Hde,r),this.bottomOverlay=oi(Dhe,r),this.inlineStartOverlay=oi(tde,r),this.topInlineStartCornerOverlay=oi(bde,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=oi(ghe,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.topOverlay.mainTableScrollableElement,l=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(o.documentElement,"keydown",function(v){return r.onKeyDown(v)}),this.eventManager.addEventListener(o.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(o,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(a,"scroll",function(v){return r.onTableScroll(v)},{passive:!0}),a!==l&&this.eventManager.addEventListener(l,"scroll",function(v){return r.onTableScroll(v)},{passive:!0});var s=i.devicePixelRatio&&i.devicePixelRatio>1,u=this.scrollableElement===i,f=this.wtSettings.getSetting("preventWheel"),c={passive:u};(f||s||!jF())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(v){return r.onCloneWheel(v,f)},c);var h=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];h.forEach(function(v){if(v&&v.needFullRender){var g=v.clone.wtTable.holder;r.eventManager.addEventListener(g,"wheel",function(p){return r.onCloneWheel(p,f)},c)}});var d;this.eventManager.addEventListener(i,"resize",function(){clearTimeout(d),d=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),u||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,a=r.target;this.keyPressed&&(i!==n&&a!==n&&!r.target.contains(i)||o!==n&&a!==n&&!r.target.contains(o))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var o=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,l=r.target,s=a!==o&&l!==o&&!l.contains(a),u=i!==o&&l!==o&&!l.contains(i);if(!(this.keyPressed&&(s||u))){var f=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==o&&f)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=Hc(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,o=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(o+=o*this.browserLineHeight,n+=n*this.browserLineHeight);var i=this.scrollVertically(n),a=this.scrollHorizontally(o);return i||a}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,o=this.inlineStartOverlay.clone.wtTable.holder,i=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],a=i[0],l=i[1];if(this.horizontalScrolling=n.scrollLeft!==a||this.lastScrollX!==r.scrollX,this.verticalScrolling=o.scrollTop!==l||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=a;var s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=a)}this.verticalScrolling&&(o.scrollTop=l),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,o=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=o)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=Wg(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,o=r.clientHeight,i=n!==this.spreaderLastSize.width||o!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=o),i}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,o=this.wtTable,i=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),l=n.getRowHeaderWidth(),s=n.getColumnHeaderHeight(),u=o.hider.style;if(u.width="".concat(l+this.inlineStartOverlay.sumCellSizes(0,i),"px"),u.height="".concat(s+this.topOverlay.sumCellSizes(0,a)+1,"px"),this.scrollbarSize>0){var f=o.wtRootElement,c=f.scrollHeight,h=f.scrollWidth,d=o.holder,v=d.scrollHeight,g=d.scrollWidth;this.hasScrollbarRight=c<v,this.hasScrollbarBottom=h<g,this.hasScrollbarRight&&o.hider.scrollWidth+this.scrollbarSize>h?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&o.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],o=null;return I(n,function(i){i&&i.clone&&i.clone.wtTable.TABLE.contains(r)&&(o=i.clone)}),o}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];I(n,function(o){o&&(o.clone.wtTable.TABLE.className=r.className)})}}]),e}();const Wde=Vde;function sh(e){"@babel/helpers - typeof";return sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sh(e)}function Ude(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rW(n.key),n)}}function zde(e,t,r){return t&&zA(e.prototype,t),r&&zA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YA(e,t,r){return t=rW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rW(e){var t=Yde(e,"string");return sh(t)==="symbol"?t:String(t)}function Yde(e,t){if(sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gde=function(){function e(t){var r=this;Ude(this,e),YA(this,"settings",{}),YA(this,"defaults",Object.freeze(this.getDefaults())),Ge(this.defaults,function(n,o){if(t[o]!==void 0)r.settings[o]=t[o];else{if(n===void 0)throw new Error('A required setting "'.concat(o,'" was not provided'));r.settings[o]=n}})}return zde(e,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(o,i,a){var l=r.getSetting("data",o,i);Ia(a,l??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(o){return o},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(o){return o},onBeforeHighlightingColumnHeader:function(o){return o},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var o=this;return n===void 0?Ge(r,function(i,a){o.settings[a]=i}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,o,i,a){return typeof this.settings[r]=="function"?this.settings[r](n,o,i,a):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),e}();function Ps(e){"@babel/helpers - typeof";return Ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ps(e)}function Kde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xde(n.key),n)}}function qde(e,t,r){return t&&GA(e.prototype,t),r&&GA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xde(e){var t=Zde(e,"string");return Ps(t)==="symbol"?t:String(t)}function Zde(e,t){if(Ps(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ps(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yO(e,t)}function yO(e,t){return yO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},yO(e,t)}function Qde(e){var t=rve();return function(){var n=gm(e),o;if(t){var i=gm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return eve(this,o)}}function eve(e,t){if(t&&(Ps(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tve(e)}function tve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gm(e){return gm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gm(e)}var CT=function(e){Jde(r,e);var t=Qde(r);function r(n,o,i,a){return Kde(this,r),t.call(this,n,o,i,a,"master")}return qde(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var o=fs(this.wtRootElement),i=this.domBindings.rootWindow;if(o===i){var a=this.wtSettings.getSetting("preventOverflow");a||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var l=o.parentElement,s=Nc(o,"height",i),u=Nc(o,"overflow",i),f=this.holder.style,c=o.scrollWidth,h=o.scrollHeight,d=o.getBoundingClientRect(),v=d.width,g=d.height,p=["auto","hidden","scroll"];if(l&&p.includes(u)){var w=o.cloneNode(!1);w.style.overflow="auto",w.style.position="absolute",o.nextElementSibling?l.insertBefore(w,o.nextElementSibling):l.appendChild(w);var S=parseInt(Ma(w,i).height,10);l.removeChild(w),S===0&&(g=0)}g=Math.min(g,h),f.height=s==="auto"?"auto":"".concat(g,"px"),v=Math.min(v,c),f.width="".concat(v,"px"),f.overflow="",this.hasTableHeight=f.height==="auto"?!0:g>0,this.hasTableWidth=v>0}this.isTableVisible=xc(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var o=this.wtSettings,i=this.dataAccessObject.wtViewport,a="master",l=o.getSetting("columnHeaders"),s=l.length;if(s&&!i.hasOversizedColumnHeadersMarked[a]){for(var u=o.getSetting("rowHeaders"),f=u.length,c=this.getRenderedColumnsCount(),h=0;h<s;h++)for(var d=-1*f;d<c;d++)this.markIfOversizedColumnHeader(d);i.hasOversizedColumnHeadersMarked[a]=!0}}}]),r}(wf);bt(CT,YV);bt(CT,mT);const nve=CT;function uh(e){"@babel/helpers - typeof";return uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uh(e)}function ove(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ave(n.key),n)}}function ive(e,t,r){return t&&KA(e.prototype,t),r&&KA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ave(e){var t=lve(e,"string");return uh(t)==="symbol"?t:String(t)}function lve(e,t){if(uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sve=function(){function e(t,r,n,o,i){var a=this;ove(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){a.clientHeight=a.getWorkspaceHeight()})}return ive(e,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,o=0;if(n===this.domBindings.rootWindow)o=r.documentElement.clientHeight;else{var i=$t(n);o=i>0&&n.clientHeight>0?n.clientHeight:1/0}return o}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.dataAccessObject.inlineStartOverlayTrimmingContainer,l=o.documentElement.offsetWidth,s=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),f=r.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),h=f?c.right-l:c.left,d=l-h,v,g;if(u)return gt(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?v=Math.min(d,l):v=Math.min(this.getContainerFillWidth(),d,l),a===i&&s>0&&this.sumColumnWidths(0,s-1)>v)return o.documentElement.clientWidth;if(a!==i&&(g=Nc(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",i),g==="scroll"||g==="hidden"||g==="auto"))return Math.max(v,a.clientWidth);var p=r.getSetting("stretchH");return p==="none"||!p?Math.max(v,gt(this.wtTable.TABLE)):v}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var o=0,i=r;i<n;)o+=this.wtTable.getColumnWidth(i),i+=1;return o}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var o=n.offsetWidth;return this.containerWidth=o,r.removeChild(n),o}},{key:"getWorkspaceOffset",value:function(){return zt(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=$t(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var o=0,i=n.length;o<i;o++)this.rowHeaderWidth+=r[o]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var a=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var l=0,s=n.length;l<s;l++)a?(this.rowHeaderWidth+=gt(a),a=a.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Zi,n=this.wtSettings,o=this.wtTable,i,a,l;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===Zi?i=1/0:i=this.getViewportHeight();var s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,u=n.getSetting("fixedRowsTop"),f=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return u&&s>=0&&(l=this.dataAccessObject.topOverlay.sumCellSizes(0,u),s+=l,i-=l),f&&this.dataAccessObject.bottomOverlay.clone&&(l=this.dataAccessObject.bottomOverlay.sumCellSizes(c-f,c),i-=l),o.holder.clientHeight===o.holder.offsetHeight?a=0:a=er(this.domBindings.rootDocument),new pV({viewportSize:i,scrollOffset:s,totalItems:n.getSetting("totalRows"),itemSizeFn:function(d){return o.getRowHeight(d)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:a})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Zi,n=this.wtSettings,o=this.wtTable,i=this.getViewportWidth(),a=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var l=n.getSetting("fixedColumnsStart");if(l&&a>=0){var s=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,l);a+=s,i-=s}return o.holder.clientWidth!==o.holder.offsetWidth&&(i-=er(this.domBindings.rootDocument)),new cT({viewportSize:i,scrollOffset:a,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(f){return o.getColumnWidth(f)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(f,c){return n.getSetting("onBeforeStretchingColumnWidth",f,c)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var o=this.createRowsCalculator(or),i=this.createColumnsCalculator(or);this.areAllProposedVisibleRowsAlreadyRendered(o)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(Zi),this.columnsRenderCalculator=this.createColumnsCalculator(Zi)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(or),this.columnsVisibleCalculator=this.createColumnsCalculator(or)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,o=r.endRow,i=r.isVisibleInTrimmingContainer;if(n===null&&o===null)return!i;var a=this.rowsRenderCalculator,l=a.startRow,s=a.endRow;return n<l||n===l&&n>0?!1:!(o>s||o===s&&o<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,o=r.endColumn,i=r.isVisibleInTrimmingContainer;if(n===null&&o===null)return!i;var a=this.columnsRenderCalculator,l=a.startColumn,s=a.endColumn;return n<l||n===l&&n>0?!1:!(o>s||o===s&&o<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){Ge(this.hasOversizedColumnHeadersMarked,function(r,n,o){o[n]=void 0})}}]),e}();const uve=sve;function ks(e){"@babel/helpers - typeof";return ks=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ks(e)}function fve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hve(n.key),n)}}function cve(e,t,r){return t&&qA(e.prototype,t),r&&qA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hve(e){var t=dve(e,"string");return ks(t)==="symbol"?t:String(t)}function dve(e,t){if(ks(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ks(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gO(e,t)}function gO(e,t){return gO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},gO(e,t)}function yve(e){var t=mve();return function(){var n=mm(e),o;if(t){var i=mm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gve(this,o)}}function gve(e,t){if(t&&(ks(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mO(e)}function mO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mm(e){return mm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mm(e)}var pve=function(e){vve(r,e);var t=yve(r);function r(n,o){var i;fve(this,r),i=t.call(this,n,new Gde(o));var a=i.wtSettings.getSetting("facade",mO(i));return i.wtTable=new nve(i.getTableDao(),a,i.domBindings,i.wtSettings),i.wtViewport=new uve(i.getViewportDao(),i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.selections=i.wtSettings.getSetting("selections"),i.wtEvent=new PV(a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable,i.selections),i.wtOverlays=new Wde(mO(i),a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.exportSettingsAsClassNames(),i.findOriginalHeaders(),i}return cve(r,[{key:"exportSettingsAsClassNames",value:function(){var o=this,i={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},a=[],l=[];Ge(i,function(s,u){o.wtSettings.getSetting(u).length&&l.push(s),a.push(s)}),je(this.wtTable.wtRootElement.parentNode,a),re(this.wtTable.wtRootElement.parentNode,l)}},{key:"getViewportDao",value:function(){var o=this;return{get wot(){return o},get topOverlayTrimmingContainer(){return o.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return o.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return o.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return o.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return o.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return o.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return o.wtOverlays.topOverlay},get inlineStartOverlay(){return o.wtOverlays.inlineStartOverlay},get bottomOverlay(){return o.wtOverlays.bottomOverlay}}}}]),r}(gT);function fh(e){"@babel/helpers - typeof";return fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fh(e)}function bve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sve(n.key),n)}}function wve(e,t,r){return t&&XA(e.prototype,t),r&&XA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sve(e){var t=Cve(e,"string");return fh(t)==="symbol"?t:String(t)}function Cve(e,t){if(fh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _ve=function(){function e(t){bve(this,e),t instanceof gT?this._wot=t:this._initFromSettings(t)}return wve(e,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var o=new e(n);return function(){return o}},this._wot=new pve(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,o){return this._wot.createCellRange(r,n,o)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wot.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wot.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wot.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,o,i,a){return this._wot.wtSettings.getSetting(r,n,o,i,a)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}(),nW=Vt,Ove=Fe,oW=Ve,Rve=rv,Eve=zd,Tve=Fr,Pve=Nd.f,iW=oW(Pve),kve=oW([].push),$ve=nW&&Ove(function(){var e=Object.create(null);return e[2]=2,!iW(e,2)}),ZA=function(e){return function(t){for(var r=Tve(t),n=Eve(r),o=$ve&&Rve(r)===null,i=n.length,a=0,l=[],s;i>a;)s=n[a++],(!nW||(o?s in r:iW(r,s)))&&kve(l,e?[s,r[s]]:r[s]);return l}},Ave={entries:ZA(!0),values:ZA(!1)},Ive=Me,Mve=Ave.values;Ive({target:"Object",stat:!0},{values:function(t){return Mve(t)}});function ch(e){"@babel/helpers - typeof";return ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ch(e)}function AS(e,t){return Hve(e)||Nve(e,t)||Dve(e,t)||xve()}function xve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dve(e,t){if(e){if(typeof e=="string")return JA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JA(e,t)}}function JA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Nve(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Hve(e){if(Array.isArray(e))return e}function Lve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fve(n.key),n)}}function jve(e,t,r){return t&&QA(e.prototype,t),r&&QA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fve(e){var t=Bve(e,"string");return ch(t)==="symbol"?t:String(t)}function Bve(e,t){if(ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vve=function(){function e(t,r){Lve(this,e),r&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return jve(e,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var o=function(s){var u=r.main.childNodes[s];r.eventManager.addEventListener(u,"mouseenter",function(f){return r.onMouseEnter(f,r.main.childNodes[s])})},i=0,a=this.main.childNodes.length;i<a;i++)o(i)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),Ln(r);var o=this,i=this.wot.rootDocument.body,a=n.getBoundingClientRect();n.style.display="none";function l(u){if(u.clientY<Math.floor(a.top)||u.clientY>Math.ceil(a.top+a.height)||u.clientX<Math.floor(a.left)||u.clientX>Math.ceil(a.left+a.width))return!0}function s(u){l(u)&&(o.eventManager.removeEventListener(i,"mousemove",s),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",s)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var o=["top","start","bottom","end","corner"],i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(var a=0;a<5;a++){var l=o[a],s=n.createElement("div");s.className="wtBorder ".concat(this.settings.className||""),this.settings[l]&&this.settings[l].hide&&(s.className+=" hidden"),i=s.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:r.border.color,i.height=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),i.width=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),xn()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,f=u.bordersHolder;f||(f=n.createElement("div"),f.className="htBorders",u.bordersHolder=f,u.spreader.appendChild(f)),f.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var o=10,i=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var a={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px")};Ge(a,function(s,u){r.selectionHandles.styles.bottomHitArea[u]=s,r.selectionHandles.styles.topHitArea[u]=s});var l={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};Ge(l,function(s,u){r.selectionHandles.styles.bottom[u]=s,r.selectionHandles.styles.top[u]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var o=this.wot.selections.createOrGetArea();return!!(o.cellRange&&(r!==o.cellRange.to.row||n!==o.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,o,i,a,l){var s=this.wot.wtSettings.getSetting("rtlMode"),u=s?"right":"left",f=this.selectionHandles.styles,c=f.top,h=f.topHitArea,d=f.bottom,v=f.bottomHitArea,g=parseInt(c.borderWidth,10),p=parseInt(c.width,10),w=parseInt(h.width,10),S=this.wot.wtTable.getWidth(),C=this.wot.wtTable.getHeight();c.top="".concat(parseInt(o-p-1,10),"px"),c[u]="".concat(parseInt(i-p-1,10),"px"),h.top="".concat(parseInt(o-w/4*3,10),"px"),h[u]="".concat(parseInt(i-w/4*3,10),"px");var P=Math.min(parseInt(i+a,10),S-p-g*2),R=Math.min(parseInt(i+a-w/4,10),S-w-g*2);d[u]="".concat(P,"px"),v[u]="".concat(R,"px");var V=Math.min(parseInt(o+l,10),C-p-g*2),U=Math.min(parseInt(o+l-w/4,10),C-w-g*2);d.top="".concat(V,"px"),v.top="".concat(U,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",h.display="block",this.isPartRange(r,n)?(d.display="none",v.display="none"):(d.display="block",v.display="block")):(c.display="none",d.display="none",h.display="none",v.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",h.zIndex="9999"):(c.zIndex="",h.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,o=n.wtTable,i=n.rootDocument,a=n.rootWindow,l,s,u,f,c,h,d=o.getRenderedRowsCount(),v=0;v<d;v+=1){var g=o.rowFilter.renderedToSource(v);if(g>=r[0]&&g<=r[2]){l=g,c=r[0];break}}for(var p=d-1;p>=0;p-=1){var w=o.rowFilter.renderedToSource(p);if(w>=r[0]&&w<=r[2]){s=w;break}}for(var S=o.getRenderedColumnsCount(),C=0;C<S;C+=1){var P=o.columnFilter.renderedToSource(C);if(P>=r[1]&&P<=r[3]){u=P,h=r[1];break}}for(var R=S-1;R>=0;R-=1){var V=o.columnFilter.renderedToSource(R);if(V>=r[1]&&V<=r[3]){f=V;break}}if(l===void 0||u===void 0){this.disappear();return}var U=o.getCell(this.wot.createCellCoords(l,u)),X=l!==s||u!==f,Y=X?o.getCell(this.wot.createCellCoords(s,f)):U,q=zt(U),Z=X?zt(Y):q,ie=zt(o.TABLE),J=gt(o.TABLE),le=q.top,Ce=q.left,we=this.wot.wtSettings.getSetting("rtlMode"),_e=0,k=0;if(we){var y=gt(U),m=a.innerWidth-ie.left-J;k=Ce+y-Z.left,_e=a.innerWidth-Ce-y-m-1}else k=Z.left+gt(Y)-Ce,_e=Ce-ie.left-1;if(this.isEntireColumnSelected(l,s)){var b=this.getDimensionsFromHeader("columns",u,f,c,ie),_=null;if(b){var T=AS(b,3);_=T[0],_e=T[1],k=T[2]}_&&(U=_)}var A=le-ie.top-1,F=Z.top+$t(Y)-le;if(this.isEntireRowSelected(u,f)){var W=this.getDimensionsFromHeader("rows",l,s,h,ie),G=null;if(W){var Q=AS(W,3);G=Q[0],A=Q[1],F=Q[2]}G&&(U=G)}var ee=Ma(U,a);parseInt(ee.borderTopWidth,10)>0&&(A+=1,F=F>0?F-1:0),parseInt(ee[we?"borderRightWidth":"borderLeftWidth"],10)>0&&(_e+=1,k=k>0?k-1:0);var se=we?"right":"left";this.topStyle.top="".concat(A,"px"),this.topStyle[se]="".concat(_e,"px"),this.topStyle.width="".concat(k,"px"),this.topStyle.display="block",this.startStyle.top="".concat(A,"px"),this.startStyle[se]="".concat(_e,"px"),this.startStyle.height="".concat(F,"px"),this.startStyle.display="block";var Te=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(A+F-Te,"px"),this.bottomStyle[se]="".concat(_e,"px"),this.bottomStyle.width="".concat(k,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(A,"px"),this.endStyle[se]="".concat(_e+k-Te,"px"),this.endStyle.height="".concat(F+1,"px"),this.endStyle.display="block";var de=this.settings.border.cornerVisible;de=typeof de=="function"?de(this.settings.layerLevel):de;var ye=this.wot.getSetting("onModifyGetCellCoords",s,f),K=s,xe=f;if(ye&&Array.isArray(ye)){var Ke=AS(ye,4);K=Ke[2],xe=Ke[3]}if(xn()||!de||this.isPartRange(K,xe))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(A+F+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[se]="".concat(_e+k+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var $e=fs(o.TABLE),Ie=$e===a;Ie&&($e=i.documentElement);var Ae=parseInt(this.cornerDefaultStyle.width,10)/2,O=parseInt(this.cornerDefaultStyle.height,10)/2;if(f===this.wot.getSetting("totalColumns")-1){var E=Ie?Y.getBoundingClientRect().left:Y.offsetLeft,$=!1,H=0;we?(H=E-parseInt(this.cornerDefaultStyle.width,10)/2,$=H<0):(H=E+gt(Y)+parseInt(this.cornerDefaultStyle.width,10)/2,$=H>=Zy($e)),$&&(this.cornerStyle[se]="".concat(Math.floor(_e+k+this.cornerCenterPointOffset-Ae),"px"),this.cornerStyle[we?"borderLeftWidth":"borderRightWidth"]=0)}if(s===this.wot.getSetting("totalRows")-1){var M=Ie?Y.getBoundingClientRect().top:Y.offsetTop,j=M+$t(Y)+parseInt(this.cornerDefaultStyle.height,10)/2,x=j>=si($e);x&&(this.cornerStyle.top="".concat(Math.floor(A+F+this.cornerCenterPointOffset-O),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}xn()&&this.updateMultipleSelectionHandlesPosition(s,f,A,_e,k,F)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,o,i,a){var l=this.wot.wtTable,s=l.wtRootElement.parentNode,u=null,f=null,c=null,h=null,d=null,v=null,g=null,p=null;switch(r){case"rows":u=function(){return l.getRowHeader.apply(l,arguments)},f=function(){return $t.apply(void 0,arguments)},c="ht__selection--rows",v="top";break;case"columns":u=function(){return l.getColumnHeader.apply(l,arguments)},f=function(){return gt.apply(void 0,arguments)},c="ht__selection--columns",v="left";break}if(s.classList.contains(c)){var w=this.wot.getSetting("columnHeaders").length;if(g=u(n,w-i),p=u(o,w-i),!g||!p)return!1;var S=zt(g),C=zt(p);return g&&p&&(h=S[v]-a[v]-1,d=C[v]+f(p)-S[v]),[g,h,d]}return!1}},{key:"changeBorderStyle",value:function(r,n){var o=this[r].style,i=n[r];!i||i.hide?re(this[r],"hidden"):(De(this[r],"hidden")&&je(this[r],"hidden"),o.backgroundColor=i.color,(r==="top"||r==="bottom")&&(o.height="".concat(i.width,"px")),(r==="start"||r==="end")&&(o.width="".concat(i.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},o=this[r].style;o.backgroundColor=n.color,o.width="".concat(n.width,"px"),o.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?re(this[r],"hidden"):je(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",xn()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}();const Wve=Vve;function Uve(e,t){return Kve(e)||Gve(e,t)||Yve(e,t)||zve()}function zve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yve(e,t){if(e){if(typeof e=="string")return eI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eI(e,t)}}function eI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gve(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Kve(e){if(Array.isArray(e))return e}function $s(e){"@babel/helpers - typeof";return $s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$s(e)}function qve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zve(n.key),n)}}function Xve(e,t,r){return t&&tI(e.prototype,t),r&&tI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zve(e){var t=Jve(e,"string");return $s(t)==="symbol"?t:String(t)}function Jve(e,t){if($s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qve=function(){function e(t,r){qve(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return Xve(e,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new Wve(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,o,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,l=r.wtTable.getCell(this.settings.createCellCoords(n,o));if($s(l)==="object"){var s=i;a&&(s=this.classNameGenerator(l),this.classNames.includes(s)||this.classNames.push(s)),re(l,s)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function o(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||a===0)return r;var l=a>=0?a:n,s=r;l-=1;var u=l===0?r:"".concat(r,"-").concat(l);if(De(i,u)){var f=l+1;s="".concat(r,"-").concat(f)}else s=o(i,l);return s}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),o=r.wtTable.getRenderedColumnsCount(),i=this.getCorners(),a=Uve(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.settings,h=c.highlightHeaderClassName,d=c.highlightColumnClassName,v=c.highlightRowClassName,g=c.highlightOnlyClosestHeader,p=c.selectionType,w=p===void 0||["active-header","header"].includes(p);if(w&&s!==null&&f!==null)for(var S=0,C=0;C<o;C+=1){var P=r.wtTable.columnFilter.renderedToSource(C);if(P>=s&&P<=f){var R=r.wtTable.getColumnHeaders(P),V=R.length-1;g&&R.length>1&&(R=[R[V]]);for(var U=0;U<R.length;U+=1){var X=[],Y=R[U];h&&X.push(h),d&&X.push(d),U=g?V:U;var q=r.getSetting("onBeforeHighlightingColumnHeader",P,U,{selectionType:p,columnCursor:S,selectionWidth:f-s+1,classNames:X});q!==P&&(Y=r.wtTable.getColumnHeader(q,U)),re(Y,X)}S+=1}}if(l!==null&&u!==null)for(var Z=0,ie=0;ie<n;ie+=1){var J=r.wtTable.rowFilter.renderedToSource(ie);if(w&&J>=l&&J<=u){var le=r.wtTable.getRowHeaders(J),Ce=le.length-1;g&&le.length>1&&(le=[le[Ce]]);for(var we=0;we<le.length;we+=1){var _e=[],k=le[we];h&&_e.push(h),v&&_e.push(v),we=g?Ce:we;var y=r.getSetting("onBeforeHighlightingRowHeader",J,we,{selectionType:p,rowCursor:Z,selectionHeight:u-l+1,classNames:_e});y!==J&&(k=r.wtTable.getRowHeader(y,we)),re(k,_e)}Z+=1}if(s!==null&&f!==null)for(var m=0;m<o;m+=1){var b=r.wtTable.columnFilter.renderedToSource(m);J>=l&&J<=u&&b>=s&&b<=f?this.settings.className&&this.addClassAtCoords(r,J,b,this.settings.className,this.settings.markIntersections):J>=l&&J<=u?v&&this.addClassAtCoords(r,J,b,v):b>=s&&b<=f&&d&&this.addClassAtCoords(r,J,b,d);var _=r.getSetting("onAfterDrawSelection",J,b,this.settings.layerLevel);typeof _=="string"&&this.addClassAtCoords(r,J,b,_)}}r.getSetting("onBeforeDrawBorders",i,this.settings.className),this.settings.border&&this.getBorder(r).appear(i)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),e}();const eye=Qve;function rI(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,o=e.coords,i=e.selection,a=e.controller,l=e.cellCoordsFactory,s=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),f=i.isSelectedByRowHeader();if(t&&s)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(u||f)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(l(o.row,o.col)):u&&o.row<0&&!a.column?i.setRangeEnd(l(s.to.row,o.col)):f&&o.col<0&&!a.row?i.setRangeEnd(l(o.row,s.to.col)):(!u&&!f&&o.col<0||u&&o.col<0)&&!a.row?i.selectRows(Math.max(s.from.row,0),o.row,o.col):(!u&&!f&&o.row<0||f&&o.row<0)&&!a.column&&i.selectColumns(Math.max(s.from.col,0),o.col,o.row);else{var c=!i.inInSelection(o),h=r||n&&c;o.row<0&&o.col>=0&&!a.column?h&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?h&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?h&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}function tye(e){var t=e.isLeftClick,r=e.coords,n=e.selection,o=e.controller,i=e.cellCoordsFactory;if(t){var a=n.isSelectedByRowHeader(),l=n.isSelectedByColumnHeader(),s=n.tableProps.countCols(),u=n.tableProps.countRows();l&&!o.column?n.setRangeEnd(i(u-1,r.col)):a&&!o.row?n.setRangeEnd(i(r.row,s-1)):o.cell||n.setRangeEnd(r)}}var rye=new Map([["mousedown",rI],["mouseover",tye],["touchstart",rI]]);function nI(e,t){var r=t.coords,n=t.selection,o=t.controller,i=t.cellCoordsFactory;rye.get(e.type)({coords:r,selection:n,controller:o,cellCoordsFactory:i,isShiftKey:e.shiftKey,isLeftClick:sT(e)||e.type==="touchstart",isRightClick:xa(e)})}var aW=new WeakMap,_T=Symbol("rootInstance");function nye(e){aW.set(e,!0)}function oye(e){return e===_T}function pO(e){return aW.has(e)}function hh(e){"@babel/helpers - typeof";return hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hh(e)}function jf(e,t){return lye(e)||aye(e,t)||lW(e,t)||iye()}function iye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aye(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function lye(e){if(Array.isArray(e))return e}function oI(e){return fye(e)||uye(e)||lW(e)||sye()}function sye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lW(e,t){if(e){if(typeof e=="string")return bO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bO(e,t)}}function uye(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fye(e){if(Array.isArray(e))return bO(e)}function bO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sW(n.key),n)}}function hye(e,t,r){return t&&iI(e.prototype,t),r&&iI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aI(e,t,r){dye(e,t),t.set(e,r)}function dye(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yo(e,t,r){return t=sW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sW(e){var t=vye(e,"string");return hh(t)==="symbol"?t:String(t)}function vye(e,t){if(hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lI(e,t){var r=uW(e,t,"get");return yye(e,r)}function yye(e,t){return t.get?t.get.call(e):t.value}function sI(e,t,r){var n=uW(e,t,"set");return gye(e,n,r),r}function uW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function gye(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var ji=new WeakMap,IS=new WeakMap,MS=new WeakMap,mye=function(){function e(t){cye(this,e),Yo(this,"instance",void 0),Yo(this,"eventManager",void 0),Yo(this,"settings",void 0),Yo(this,"THEAD",void 0),Yo(this,"TBODY",void 0),Yo(this,"_wt",void 0),Yo(this,"activeWt",void 0),aI(this,IS,{writable:!0,value:0}),aI(this,MS,{writable:!0,value:0}),Yo(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new It(this.instance),this.settings=this.instance.getSettings(),ji.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return hye(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var o=this._wt.getCell(r,n);return o<0?null:o}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wt.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wt.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wt.scrollViewportVertically(r,n,o)}},{key:"createElements",value:function(){var r=ji.get(this),n=this.instance,o=n.rootElement,i=n.rootDocument,a=o.getAttribute("style");a&&o.setAttribute("data-originalstyle",a),re(o,"handsontable"),r.table=i.createElement("TABLE"),re(r.table,"htCore"),this.instance.getSettings().tableClassName&&re(r.table,this.instance.getSettings().tableClassName),this.THEAD=i.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=i.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=ji.get(this),o=this.instance,i=o.rootElement,a=o.rootDocument,l=o.selection,s=a.documentElement;this.eventManager.addEventListener(i,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var f=r.instance.rootWindow;R1(f),u.preventDefault(),f.focus()}}),this.eventManager.addEventListener(i,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(i,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&R1(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(s,"keyup",function(u){l.isInProgress()&&!u.shiftKey&&l.finish()}),this.eventManager.addEventListener(s,"mouseup",function(u){l.isInProgress()&&sT(u)&&l.finish(),n.mouseDown=!1,(aT(a.activeElement)||!l.isSelected()&&!l.isSelectedByAnyHeader()&&!i.contains(u.target)&&!xa(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",function(u){l.isInProgress()&&xa(u)&&(l.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(s,"touchend",function(){l.isInProgress()&&l.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(s,"mousedown",function(u){var f=u.target,c=u.x||u.clientX,h=u.y||u.clientY,d=u.target;if(!(n.mouseDown||!i||!r.instance.view)){var v=r.instance.view._wt.wtTable.holder;if(d===v){var g=er(a);if(a.elementFromPoint(c+g,h)!==v||a.elementFromPoint(c,h+g)!==v)return}else for(;d!==s;){if(d===null){if(u.isTargetWebComponent)break;return}if(d===i)return;d=d.parentNode}var p=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(f):r.settings.outsideClickDeselects;p?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||Ug(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,o=r.row,i=r.col;return(n=this.instance)._createCellCoords.apply(n,oI(this.translateFromRenderableToVisualIndex(o,i)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var o=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,i=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return o===null&&(o=r),i===null&&(i=n),[o,i]}},{key:"countRenderableIndexes",value:function(r,n){var o=Math.min(r.getNotTrimmedIndexesLength(),n),i=r.getNearestNotHiddenIndex(o-1,-1);return i===null?0:r.getRenderableFromVisualIndex(i)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,o,i){if(isNaN(r)||r<0)return 0;var a=o.getNearestNotHiddenIndex(r,n),l=o.getRenderableFromVisualIndex(a);if(!Number.isInteger(l))return 0;var s=0;return n<0?s=l+1:n>0&&(s=i-l),s}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=ji.get(this),o={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return pO(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(f,c){var h;return(h=r.instance).getDataAtCell.apply(h,oI(r.translateFromRenderableToVisualIndex(f,c)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||o.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||o.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var f=[];return r.instance.hasRowHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(c):c;r.appendRowHeader(d,h)}),r.instance.runHooks("afterGetRowHeaderRenderers",f),sI(r,MS,f.length),f},columnHeaders:function(){var f=[];return r.instance.hasColHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(c):c;r.appendColHeader(d,h)}),r.instance.runHooks("afterGetColumnHeaderRenderers",f),sI(r,IS,f.length),f},columnWidth:function(f){var c=r.instance.columnIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getColWidth(c===null?f:c)},rowHeight:function(f){var c=r.instance.rowIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getRowHeight(c===null?f:c)},cellRenderer:function(f,c,h){var d=r.translateFromRenderableToVisualIndex(f,c),v=jf(d,2),g=v[0],p=v[1],w=r.instance.runHooks("modifyGetCellCoords",g,p),S=g,C=p;if(Array.isArray(w)){var P=jf(w,2);S=P[0],C=P[1]}var R=r.instance.getCellMeta(S,C),V=r.instance.colToProp(C),U=r.instance.getDataAtRowProp(S,V);r.instance.hasHook("beforeValueRender")&&(U=r.instance.runHooks("beforeValueRender",U,R)),r.instance.runHooks("beforeRenderer",h,g,p,V,U,R),r.instance.getCellRenderer(R)(r.instance,h,g,p,V,U,R),r.instance.runHooks("afterRenderer",h,g,p,V,U,R)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),g={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=d,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",f,v,h,g),!Ll(f)&&(nI(f,{coords:v,selection:r.instance.selection,controller:g,cellCoordsFactory:function(w,S){return r.instance._createCellCoords(w,S)}}),r.instance.runHooks("afterOnCellMouseDown",f,v,h),r.activeWt=r._wt)},onCellContextMenu:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",f,v,h),!Ll(f)&&(r.instance.runHooks("afterOnCellContextMenu",f,v,h),r.activeWt=r._wt)},onCellMouseOut:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOut",f,v,h),!Ll(f)&&(r.instance.runHooks("afterOnCellMouseOut",f,v,h),r.activeWt=r._wt)},onCellMouseOver:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),g={row:!1,column:!1,cell:!1};r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOver",f,v,h,g),!Ll(f)&&(n.mouseDown&&nI(f,{coords:v,selection:r.instance.selection,controller:g,cellCoordsFactory:function(w,S){return r.instance._createCellCoords(w,S)}}),r.instance.runHooks("afterOnCellMouseOver",f,v,h),r.activeWt=r._wt)},onCellMouseUp:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseUp",f,v,h),!(Ll(f)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",f,v,h),r.activeWt=r._wt)},onCellCornerMouseDown:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",f)},onCellCornerDblClick:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",f)},beforeDraw:function(f,c){return r.beforeRender(f,c)},onDraw:function(f){return r.afterRender(f)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(f,c,h){var d=r.instance.rowIndexMapper,v=d.getVisualFromRenderableIndex(f),g=r.instance.runHooks("beforeHighlightingRowHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(g,1))},onBeforeHighlightingColumnHeader:function(f,c,h){var d=r.instance.columnIndexMapper,v=d.getVisualFromRenderableIndex(f),g=r.instance.runHooks("beforeHighlightingColumnHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(g,1))},onAfterDrawSelection:function(f,c,h){var d,v=r.translateFromRenderableToVisualIndex(f,c),g=jf(v,2),p=g[0],w=g[1],S=r.instance.selection.getSelectedRange(),C=S.size();if(C>0){var P=(h??0)+1-C,R=S.peekByIndex(P);d=[R.from.row,R.from.col,R.to.row,R.to.col]}return r.instance.runHooks("afterDrawSelection",p,w,d,h)},onBeforeDrawBorders:function(f,c){var h=jf(f,4),d=h[0],v=h[1],g=h[2],p=h[3],w=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(d),r.instance.columnIndexMapper.getVisualFromRenderableIndex(v),r.instance.rowIndexMapper.getVisualFromRenderableIndex(g),r.instance.columnIndexMapper.getVisualFromRenderableIndex(p)];return r.instance.runHooks("beforeDrawBorders",w,c)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(f,c){var h=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.runHooks("beforeStretchingColumnWidth",f,h)},onModifyRowHeaderWidth:function(f){return r.instance.runHooks("modifyRowHeaderWidth",f)},onModifyGetCellCoords:function(f,c,h){var d=r.instance.rowIndexMapper,v=r.instance.columnIndexMapper,g=c>=0?v.getVisualFromRenderableIndex(c):c,p=f>=0?d.getVisualFromRenderableIndex(f):f,w=r.instance.runHooks("modifyGetCellCoords",p,g,h);if(Array.isArray(w)){var S=jf(w,4),C=S[0],P=S[1],R=S[2],V=S[3];return[C>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(C,1)):C,P>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(P,1)):P,R>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(R,-1)):R,V>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(V,-1)):V]}},viewportRowCalculatorOverride:function(f){var c=r.settings.viewportRowRenderingOffset;if(c==="auto"&&r.settings.fixedRowsTop&&(c=10),c>0||c==="auto"){var h=r.countRenderableRows(),d=f.startRow,v=f.endRow;if(typeof c=="number")f.startRow=Math.max(d-c,0),f.endRow=Math.min(v+c,h-1);else if(c==="auto"){var g=Math.ceil(v/h*12);f.startRow=Math.max(d-g,0),f.endRow=Math.min(v+g,h-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",f)},viewportColumnCalculatorOverride:function(f){var c=r.settings.viewportColumnRenderingOffset;if(c==="auto"&&r.settings.fixedColumnsStart&&(c=10),c>0||c==="auto"){var h=r.countRenderableColumns(),d=f.startColumn,v=f.endColumn;if(typeof c=="number"&&(f.startColumn=Math.max(d-c,0),f.endColumn=Math.min(v+c,h-1)),c==="auto"){var g=Math.ceil(v/h*6);f.startColumn=Math.max(d-g,0),f.endColumn=Math.min(v+g,h-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",f)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var f=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||f}};this.instance.runHooks("beforeInitWalkontable",o),this._wt=new _ve(o),this.activeWt=this._wt;var i=this._wt.wtTable.spreader,a=this.instance.rootElement.getBoundingClientRect(),l=a.width,s=a.height;this.setLastSize(l,s),this.eventManager.addEventListener(i,"mousedown",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(i,"contextmenu",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(Ug(r))return!0;var n=$a(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return ji.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var o=n.firstChild;if(!De(o,"relative")){Hn(n),this.appendRowHeader(r,n);return}this.updateCellHeader(o.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var i=this.instance,a=i.rootDocument,l=i.getRowHeader,s=a.createElement("div"),u=a.createElement("span");s.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,l),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var a=n.firstChild;De(a,"relative")?this.updateCellHeader(a.querySelector(".colHeader"),r,o,i):(Hn(n),this.appendColHeader(r,n,o,i))}else{var l=this.instance.rootDocument,s=l.createElement("div"),u=l.createElement("span");s.className="relative",u.className="colHeader",this.updateCellHeader(u,r,o,i),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetColHeader",r,n,i)}},{key:"updateCellHeader",value:function(r,n,o){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=n,l=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(De(r,"colHeader")?a=l.wtTable.columnFilter.sourceToRendered(n):De(r,"rowHeader")&&(a=l.wtTable.rowFilter.sourceToRendered(n))),a>-1?bf(r,o(n,i)):(Ia(r,String.fromCharCode(160)),re(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),o=n-r;return o>0?o:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),o=n-r;return o>0?o:0}},{key:"setLastSize",value:function(r,n){var o=ji.get(this),i=[r,n];o.lastWidth=i[0],o.lastHeight=i[1]}},{key:"getLastSize",value:function(){var r=ji.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return lI(this,IS)}},{key:"getRowHeadersCount",value:function(){return lI(this,MS)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}();const pye=mye;function wO(e){"@babel/helpers - typeof";return wO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wO(e)}var bye="ABCDEFGHIJKLMNOPQRSTUVWXYZ",uI=bye.length;function wye(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%uI,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/uI,10);return r}function fI(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e,n=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(r=[e]),r.forEach(function(o,i){Array.isArray(o)?o.forEach(function(a,l){n.push([i+t,l,a])}):Object.keys(o).forEach(function(a){n.push([i+t,a,o[a]])})}),n}function fW(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&Ye(e[0])&&(t=N0(e[0]))),t}function Sye(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Array.isArray(t)}))}function Cye(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return wO(t)==="object"&&!Array.isArray(t)&&t!==null}))}function dh(e){"@babel/helpers - typeof";return dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dh(e)}function _ye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rye(n.key),n)}}function Oye(e,t,r){return t&&cI(e.prototype,t),r&&cI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rye(e){var t=Eye(e,"string");return dh(t)==="symbol"?t:String(t)}function Eye(e,t){if(dh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tye=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];_ye(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return Oye(e,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,o=[];return I(this.data,function(i,a){var l=n.getAtCell(a,r);o.push(l)}),o}},{key:"getAtRow",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=n===void 0&&o===void 0,s=null,u=null;if(s=this.modifyRowData(r),Array.isArray(s))u=[],l?s.forEach(function(h,d){u[d]=i.getAtPhysicalCell(r,d,s)}):Re(n,o,function(h){u[h-n]=i.getAtPhysicalCell(r,h,s)});else if(Ye(s)||wt(s))if(a?u=[]:u={},!l||a){var f=0,c=this.countFirstRowKeys()-1;Re(f,c,function(h){var d=i.colToProp(h);if(h>=(n||f)&&h<=(o||c)&&!Number.isInteger(d)){var v=i.getAtPhysicalCell(r,d,s);a?u.push(v):aS(u,d,v)}})}else Ge(s,function(h,d){aS(u,d,i.getAtPhysicalCell(r,d,s))});return u}},{key:"setAtCell",value:function(r,n,o){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var i=ss(o);this.hot.runHooks("modifySourceData",r,n,i,"set"),i.isTouched()&&(o=i.value)}Number.isInteger(n)?this.data[r][n]=o:aS(this.data[r],n,o)}}},{key:"getAtPhysicalCell",value:function(r,n,o){var i=null;if(o&&(typeof n=="string"?i=JQ(o,n):typeof n=="function"?i=n(o):i=o[n]),this.hot.hasHook("modifySourceData")){var a=ss(i);this.hot.runHooks("modifySourceData",r,n,a,"get"),a.isTouched()&&(i=a.value)}return i}},{key:"getAtCell",value:function(r,n){var o=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),o)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,l=null,s=null,u=null,f=null;n===null||o===null?(a=!0,l=0,u=this.countRows()-1):(l=Math.min(n.row,o.row),s=Math.min(n.col,o.col),u=Math.max(n.row,o.row),f=Math.max(n.col,o.col));var c=[];return Re(l,u,function(h){c.push(a?r.getAtRow(h,void 0,void 0,i):r.getAtRow(h,s,f,i))}),c}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return fW(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();const Pye=Tye;var hI=At,kye=function(e){return e!==void 0&&(hI(e,"value")||hI(e,"writable"))},$ye=Me,Aye=Gt,Iye=Nt,Mye=Ht,xye=kye,Dye=jn,Nye=rv;function cW(e,t){var r=arguments.length<3?e:arguments[2],n,o;if(Mye(e)===r)return e[t];if(n=Dye.f(e,t),n)return xye(n)?n.value:n.get===void 0?void 0:Aye(n.get,r);if(Iye(o=Nye(e)))return cW(o,t,r)}$ye({target:"Reflect",stat:!0},{get:cW});var Hye=Me,Lye=Fe,jye=Fr,hW=jn.f,dW=Vt,Fye=!dW||Lye(function(){hW(1)});Hye({target:"Object",stat:!0,forced:Fye,sham:!dW},{getOwnPropertyDescriptor:function(t,r){return hW(jye(t),r)}});var Bye="localHooks",vW={_localHooks:Object.create(null),addLocalHook:function(t,r){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(r),this},runLocalHooks:function(t,r,n,o,i,a,l){if(this._localHooks[t])for(var s=this._localHooks[t].length,u=0;u<s;u++)H_(this._localHooks[t][u],this,r,n,o,i,a,l)},clearLocalHooks:function(){return this._localHooks={},this}};Bo(vW,"MIXIN_NAME",Bye,{writable:!1,enumerable:!1});const Pr=vW;function vh(e){"@babel/helpers - typeof";return vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vh(e)}function Vye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uye(n.key),n)}}function Wye(e,t,r){return t&&dI(e.prototype,t),r&&dI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uye(e){var t=zye(e,"string");return vh(t)==="symbol"?t:String(t)}function zye(e,t){if(vh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tl=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Vye(this,e),this.indexedValues=[],this.initValueOrFn=t}return Wye(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,wt(this.initValueOrFn)?Re(n-1,function(o){return r.indexedValues.push(r.initValueOrFn(o))}):Re(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();bt(tl,Pr);function xS(e){return qye(e)||Kye(e)||Gye(e)||Yye()}function Yye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gye(e,t){if(e){if(typeof e=="string")return SO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SO(e,t)}}function Kye(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function qye(e){if(Array.isArray(e))return SO(e)}function SO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function OT(e,t,r,n){var o=r.length?r[0]:void 0;return[].concat(xS(e.slice(0,o)),xS(r.map(function(i,a){return wt(n)?n(i,a):n})),xS(o===void 0?[]:e.slice(o)))}function RT(e,t){return Kr(e,function(r,n){return t.includes(n)===!1})}function As(e){"@babel/helpers - typeof";return As=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},As(e)}function Xye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jye(n.key),n)}}function Zye(e,t,r){return t&&vI(e.prototype,t),r&&vI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jye(e){var t=Qye(e,"string");return As(t)==="symbol"?t:String(t)}function Qye(e,t){if(As(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(As(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pc(){return typeof Reflect<"u"&&Reflect.get?pc=Reflect.get.bind():pc=function(t,r,n){var o=ege(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},pc.apply(this,arguments)}function ege(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=La(e),e!==null););return e}function tge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CO(e,t)}function CO(e,t){return CO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},CO(e,t)}function rge(e){var t=ige();return function(){var n=La(e),o;if(t){var i=La(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return nge(this,o)}}function nge(e,t){if(t&&(As(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oge(e)}function oge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ige(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function La(e){return La=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},La(e)}var ki=function(e){tge(r,e);var t=rge(r);function r(){return Xye(this,r),t.apply(this,arguments)}return Zye(r,[{key:"insert",value:function(o,i){this.indexedValues=OT(this.indexedValues,o,i,this.initValueOrFn),pc(La(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=RT(this.indexedValues,o),pc(La(r.prototype),"remove",this).call(this,o)}}]),r}(tl);function Is(e){"@babel/helpers - typeof";return Is=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Is(e)}function age(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sge(n.key),n)}}function lge(e,t,r){return t&&yI(e.prototype,t),r&&yI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sge(e){var t=uge(e,"string");return Is(t)==="symbol"?t:String(t)}function uge(e,t){if(Is(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Is(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_O(e,t)}function _O(e,t){return _O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_O(e,t)}function cge(e){var t=vge();return function(){var n=pm(e),o;if(t){var i=pm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hge(this,o)}}function hge(e,t){if(t&&(Is(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dge(e)}function dge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pm(e){return pm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pm(e)}var Ep=function(e){fge(r,e);var t=cge(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return age(this,r),t.call(this,n)}return lge(r,[{key:"getHiddenIndexes",value:function(){return ar(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(ki);function DS(e){return pge(e)||mge(e)||gge(e)||yge()}function yge(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gge(e,t){if(e){if(typeof e=="string")return OO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OO(e,t)}}function mge(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pge(e){if(Array.isArray(e))return OO(e)}function OO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ET(e,t,r){return[].concat(DS(e.slice(0,t)),DS(r),DS(e.slice(t)))}function yh(e,t){return Kr(e,function(r){return t.includes(r)===!1})}function TT(e,t){return ze(e,function(r){return r-t.filter(function(n){return n<r}).length})}function PT(e,t){var r=t[0],n=t.length;return ze(e,function(o){return o>=r?o+n:o})}function Ms(e){"@babel/helpers - typeof";return Ms=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ms(e)}function bge(e){return _ge(e)||Cge(e)||Sge(e)||wge()}function wge(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sge(e,t){if(e){if(typeof e=="string")return RO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RO(e,t)}}function Cge(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _ge(e){if(Array.isArray(e))return RO(e)}function RO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Oge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gW(n.key),n)}}function Rge(e,t,r){return t&&gI(e.prototype,t),r&&gI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oo(){return typeof Reflect<"u"&&Reflect.get?oo=Reflect.get.bind():oo=function(t,r,n){var o=Ege(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},oo.apply(this,arguments)}function Ege(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ln(e),e!==null););return e}function Tge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&EO(e,t)}function EO(e,t){return EO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},EO(e,t)}function Pge(e){var t=$ge();return function(){var n=ln(e),o;if(t){var i=ln(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return kge(this,o)}}function kge(e,t){if(t&&(Ms(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yW(e)}function yW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $ge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ln(e){return ln=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ln(e)}function Age(e,t,r){return t=gW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gW(e){var t=Ige(e,"string");return Ms(t)==="symbol"?t:String(t)}function Ige(e,t){if(Ms(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ms(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tp=function(e){Tge(r,e);var t=Pge(r);function r(){var n;Oge(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),Age(yW(n),"orderOfIndexes",[]),n}return Rge(r,[{key:"getValues",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return o.indexedValues[i]})}},{key:"setValues",value:function(o){this.orderOfIndexes=bge(Array(o.length).keys()),oo(ln(r.prototype),"setValues",this).call(this,o)}},{key:"setValueAtIndex",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return o<this.indexedValues.length?(this.indexedValues[o]=i,this.orderOfIndexes.includes(o)===!1&&this.orderOfIndexes.splice(a,0,o),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(o){this.orderOfIndexes=yh(this.orderOfIndexes,[o]),wt(this.initValueOrFn)?oo(ln(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn(o)):oo(ln(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,oo(ln(r.prototype),"setDefaultValues",this).call(this,o)}},{key:"insert",value:function(o,i){this.indexedValues=OT(this.indexedValues,o,i,this.initValueOrFn),this.orderOfIndexes=PT(this.orderOfIndexes,i),oo(ln(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=RT(this.indexedValues,o),this.orderOfIndexes=yh(this.orderOfIndexes,o),this.orderOfIndexes=TT(this.orderOfIndexes,o),oo(ln(r.prototype),"remove",this).call(this,o)}},{key:"getEntries",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return[i,o.getValueAtIndex(i)]})}}]),r}(tl);function xs(e){"@babel/helpers - typeof";return xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xs(e)}function Mge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dge(n.key),n)}}function xge(e,t,r){return t&&mI(e.prototype,t),r&&mI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dge(e){var t=Nge(e,"string");return xs(t)==="symbol"?t:String(t)}function Nge(e,t){if(xs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TO(e,t)}function TO(e,t){return TO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},TO(e,t)}function Lge(e){var t=Bge();return function(){var n=bm(e),o;if(t){var i=bm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return jge(this,o)}}function jge(e,t){if(t&&(xs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fge(e)}function Fge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bm(e){return bm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bm(e)}var mv=function(e){Hge(r,e);var t=Lge(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return Mge(this,r),t.call(this,n)}return xge(r,[{key:"getTrimmedIndexes",value:function(){return ar(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(ki),pI=new Map([["indexesSequence",{getListWithInsertedItems:ET,getListWithRemovedItems:yh}],["physicallyIndexed",{getListWithInsertedItems:OT,getListWithRemovedItems:RT}]]),mW=function(t){if(pI.has(t)===!1)throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return pI.get(t)};function Ds(e){"@babel/helpers - typeof";return Ds=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ds(e)}function Vge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uge(n.key),n)}}function Wge(e,t,r){return t&&bI(e.prototype,t),r&&bI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uge(e){var t=zge(e,"string");return Ds(t)==="symbol"?t:String(t)}function zge(e,t){if(Ds(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ds(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bc(){return typeof Reflect<"u"&&Reflect.get?bc=Reflect.get.bind():bc=function(t,r,n){var o=Yge(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},bc.apply(this,arguments)}function Yge(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ja(e),e!==null););return e}function Gge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PO(e,t)}function PO(e,t){return PO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},PO(e,t)}function Kge(e){var t=Zge();return function(){var n=ja(e),o;if(t){var i=ja(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return qge(this,o)}}function qge(e,t){if(t&&(Ds(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xge(e)}function Xge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ja(e){return ja=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ja(e)}var pW=function(e){Gge(r,e);var t=Kge(r);function r(){return Vge(this,r),t.call(this,function(n){return n})}return Wge(r,[{key:"insert",value:function(o,i){var a=PT(this.indexedValues,i);this.indexedValues=ET(a,o,i),bc(ja(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=yh(this.indexedValues,o);this.indexedValues=TT(i,o),bc(ja(r.prototype),"remove",this).call(this,o)}}]),r}(tl),wI=new Map([["hiding",Ep],["index",tl],["linkedPhysicalIndexToValue",Tp],["physicalIndexToValue",ki],["trimming",mv]]);function Jge(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!wI.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(wI.get(e))(t)}function gh(e){"@babel/helpers - typeof";return gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gh(e)}function Qge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tme(n.key),n)}}function eme(e,t,r){return t&&SI(e.prototype,t),r&&SI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tme(e){var t=rme(e,"string");return gh(t)==="symbol"?t:String(t)}function rme(e,t){if(gh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kT=function(){function e(){Qge(this,e),this.collection=new Map}return eme(e,[{key:"register",value:function(r,n){var o=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return o.runLocalHooks("change",n)}))}},{key:"unregister",value:function(r){var n=this.collection.get(r);pe(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n))}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,o){return r.unregister(o)}),this.collection.clear()}},{key:"get",value:function(r){return pt(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(o){o.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),e}();bt(kT,Pr);function Ns(e){"@babel/helpers - typeof";return Ns=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ns(e)}function nme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ime(n.key),n)}}function ome(e,t,r){return t&&CI(e.prototype,t),r&&CI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ime(e){var t=ame(e,"string");return Ns(t)==="symbol"?t:String(t)}function ame(e,t){if(Ns(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ns(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kO(e,t)}function kO(e,t){return kO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},kO(e,t)}function sme(e){var t=cme();return function(){var n=wm(e),o;if(t){var i=wm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ume(this,o)}}function ume(e,t){if(t&&(Ns(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fme(e)}function fme(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wm(e){return wm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wm(e)}var _I=function(e){lme(r,e);var t=sme(r);function r(n,o){var i;return nme(this,r),i=t.call(this),i.mergedValuesCache=[],i.aggregationFunction=n,i.fallbackValue=o,i}return ome(r,[{key:"getMergedValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(o===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var i=ze(this.get(),function(c){return c.getValues()}),a=[],l=pe(i[0])&&i[0].length||0,s=0;s<l;s+=1){for(var u=[],f=0;f<this.getLength();f+=1)u.push(i[f][s]);a.push(u)}return ze(a,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(o,i){var a=this.getMergedValues(i)[o];return pe(a)?a:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(kT);function mh(e){"@babel/helpers - typeof";return mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mh(e)}function hme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vme(n.key),n)}}function dme(e,t,r){return t&&OI(e.prototype,t),r&&OI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vme(e){var t=yme(e,"string");return mh(t)==="symbol"?t:String(t)}function yme(e,t){if(mh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gme(e,t,r){mme(e,t),t.set(e,r)}function mme(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pme(e,t,r){var n=bW(e,t,"set");return bme(e,n,r),r}function bme(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function wme(e,t){var r=bW(e,t,"get");return Sme(e,r)}function bW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Sme(e,t){return t.get?t.get.call(e):t.value}var NS=new WeakMap,wW=function(){function e(){hme(this,e),gme(this,NS,{writable:!0,value:[]})}return dme(e,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(wme(this,NS)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){pme(this,NS,r)}}]),e}();bt(wW,Pr);function RI(e,t){for(var r=[],n=0,o=0;n<e.length&&o<t.length;n++,o++)e[n]!==t[o]&&r.push({op:"replace",index:o,oldValue:e[n],newValue:t[o]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;o<e.length;o++)r.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return r}function ph(e){"@babel/helpers - typeof";return ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ph(e)}function Cme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ome(n.key),n)}}function _me(e,t,r){return t&&EI(e.prototype,t),r&&EI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ome(e){var t=Rme(e,"string");return ph(t)==="symbol"?t:String(t)}function Rme(e,t){if(ph(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ff(e,t,r){Eme(e,t),t.set(e,r)}function Eme(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wr(e,t){var r=SW(e,t,"get");return Tme(e,r)}function Tme(e,t){return t.get?t.get.call(e):t.value}function ey(e,t,r){var n=SW(e,t,"set");return Pme(e,n,r),r}function SW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Pme(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var ty=new WeakMap,Bf=new WeakMap,ry=new WeakMap,ny=new WeakMap,oy=new WeakMap,kme=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;Cme(this,e),Ff(this,ty,{writable:!0,value:new Set}),Ff(this,Bf,{writable:!0,value:[]}),Ff(this,ry,{writable:!0,value:[]}),Ff(this,ny,{writable:!0,value:!1}),Ff(this,oy,{writable:!0,value:!1}),ey(this,oy,r??!1)}return _me(e,[{key:"createObserver",value:function(){var r=this,n=new wW;return Wr(this,ty).add(n),n.addLocalHook("unsubscribe",function(){Wr(r,ty).delete(n)}),n._writeInitialChanges(RI(Wr(this,Bf),Wr(this,ry))),n}},{key:"emit",value:function(r){var n=Wr(this,ry);(!Wr(this,ny)||Wr(this,Bf).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(Wr(this,oy)):ey(this,Bf,new Array(r.length).fill(Wr(this,oy))),Wr(this,ny)||(ey(this,ny,!0),n=Wr(this,Bf)));var o=RI(n,r);Wr(this,ty).forEach(function(i){return i._write(o)}),ey(this,ry,r)}}]),e}();function bh(e){"@babel/helpers - typeof";return bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bh(e)}var TI;function HS(e){return Mme(e)||Ime(e)||Ame(e)||$me()}function $me(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ame(e,t){if(e){if(typeof e=="string")return $O(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $O(e,t)}}function Ime(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Mme(e){if(Array.isArray(e))return $O(e)}function $O(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xme(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Dme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hme(n.key),n)}}function Nme(e,t,r){return t&&PI(e.prototype,t),r&&PI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hme(e){var t=Lme(e,"string");return bh(t)==="symbol"?t:String(t)}function Lme(e,t){if(bh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kI=new Set(["getFirstNotHiddenIndex"]),AO=function(){function e(){var t=this;Dme(this,e),this.indexesSequence=new pW,this.trimmingMapsCollection=new _I(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new _I(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new kT,this.hidingChangesObservable=new kme({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("indexesSequenceChange",t.indexesChangeSource),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return Nme(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,o){return this.registerMap(r,Jge(n,o))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof mv?this.trimmingMapsCollection.register(r,n):n instanceof Ep?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var o=this.getNumberOfIndexes();return o>0&&n.init(o),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return pe(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return pe(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return pe(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return pe(n)?n:null}},{key:"getFirstNotHiddenIndex",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r-n;kI.has("getFirstNotHiddenIndex")&&(kI.delete("getFirstNotHiddenIndex"),dt(ft(TI||(TI=xme([`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next 
                        major release. Please use "getNearestNotHiddenIndex" instead.`],[`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20
                        major release. Please use "getNearestNotHiddenIndex" instead.`])))));var a=this.getPhysicalFromVisualIndex(r);return a===null?o===!0&&i!==r-n?this.getFirstNotHiddenIndex(i,-n,!1,i):null:this.isHidden(a)===!1?r:this.getFirstNotHiddenIndex(r+n,n,o,i)}},{key:"getNearestNotHiddenIndex",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.getPhysicalFromVisualIndex(r);if(i===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var a=Array.from(this.fromVisualToRenderableIndexesCache.keys()),l=-1;return n>0?l=a.findIndex(function(s){return s>r}):l=a.reverse().findIndex(function(s){return s<r}),l===-1?o?this.getNearestNotHiddenIndex(r,-n,!1):null:a[l]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=HS(new Array(r).keys()),this.notHiddenIndexesCache=HS(new Array(r).keys()),this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var o=HS(Array(this.getNumberOfIndexes()-r).keys()).map(function(i){return i+r});this.removeIndexes(o)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(r),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isTrimmed(i)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var o=this.getNotTrimmedIndexes();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var o=this;typeof r=="number"&&(r=[r]);var i=ze(r,function(c){return o.getPhysicalFromVisualIndex(c)}),a=this.getNotTrimmedIndexesLength(),l=r.length,s=yh(this.getIndexesSequence(),i),u=a-l;if(n+l<a){var f=s.filter(function(c){return o.isTrimmed(c)===!1})[n];u=s.indexOf(f)}this.indexesChangeSource="move",this.setIndexesSequence(ET(s,u,i)),this.indexesChangeSource=void 0}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var o=this.getNotTrimmedIndexes()[r],i=pe(o)?o:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),l=ze(new Array(n).fill(i),function(s,u){return s+u});this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(a,l),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(a,l),this.hidingMapsCollection.insertToEvery(a,l),this.variousMapsCollection.insertToEvery(a,l),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(o,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(o);this.fromVisualToRenderableIndexesCache.set(i,n)}}}]),e}();bt(AO,Pr);var $I;function jme(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Fme(e,t){return Ge(t,function(r,n){pt(e[n])&&(e[n]=r)}),e}function CW(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function _W(e){pe(e)&&lT(ft($I||($I=jme(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function Bme(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var OW=Qr("phraseFormatters"),Vme=OW.register,Wme=OW.getValues;function Ume(e,t){Vme(e,t)}function zme(){return Wme()}Ume("pluralize",Bme);var RW="ContextMenu:items",Be=RW,$T="".concat(Be,".noItems"),Pp="".concat(Be,".insertRowAbove"),kp="".concat(Be,".insertRowBelow"),$p="".concat(Be,".insertColumnOnTheLeft"),Ap="".concat(Be,".insertColumnOnTheRight"),Ip="".concat(Be,".removeRow"),Mp="".concat(Be,".removeColumn"),xp="".concat(Be,".undo"),Dp="".concat(Be,".redo"),Np="".concat(Be,".readOnly"),Hp="".concat(Be,".clearColumn"),Lp="".concat(Be,".copy"),jp="".concat(Be,".copyWithHeaders"),Fp="".concat(Be,".copyWithGroupHeaders"),Bp="".concat(Be,".copyHeadersOnly"),Vp="".concat(Be,".cut"),Wp="".concat(Be,".freezeColumn"),Up="".concat(Be,".unfreezeColumn"),zp="".concat(Be,".mergeCells"),Yp="".concat(Be,".unmergeCells"),Gp="".concat(Be,".addComment"),Kp="".concat(Be,".editComment"),qp="".concat(Be,".removeComment"),Xp="".concat(Be,".readOnlyComment"),Zp="".concat(Be,".align"),Jp="".concat(Be,".align.left"),Qp="".concat(Be,".align.center"),eb="".concat(Be,".align.right"),tb="".concat(Be,".align.justify"),rb="".concat(Be,".align.top"),nb="".concat(Be,".align.middle"),ob="".concat(Be,".align.bottom"),ib="".concat(Be,".borders"),ab="".concat(Be,".borders.top"),lb="".concat(Be,".borders.right"),sb="".concat(Be,".borders.bottom"),ub="".concat(Be,".borders.left"),fb="".concat(Be,".borders.remove"),cb="".concat(Be,".nestedHeaders.insertChildRow"),hb="".concat(Be,".nestedHeaders.detachFromParent"),db="".concat(Be,".hideColumn"),vb="".concat(Be,".showColumn"),yb="".concat(Be,".hideRow"),gb="".concat(Be,".showRow"),pr="Filters:",Mt="".concat(pr,"conditions"),pv="".concat(Mt,".none"),mb="".concat(Mt,".isEmpty"),pb="".concat(Mt,".isNotEmpty"),bb="".concat(Mt,".isEqualTo"),wb="".concat(Mt,".isNotEqualTo"),Sb="".concat(Mt,".beginsWith"),Cb="".concat(Mt,".endsWith"),_b="".concat(Mt,".contains"),Ob="".concat(Mt,".doesNotContain"),Yme="".concat(Mt,".byValue"),Rb="".concat(Mt,".greaterThan"),Eb="".concat(Mt,".greaterThanOrEqualTo"),Tb="".concat(Mt,".lessThan"),Pb="".concat(Mt,".lessThanOrEqualTo"),kb="".concat(Mt,".isBetween"),$b="".concat(Mt,".isNotBetween"),Ab="".concat(Mt,".after"),Ib="".concat(Mt,".before"),Mb="".concat(Mt,".today"),xb="".concat(Mt,".tomorrow"),Db="".concat(Mt,".yesterday"),Nb="".concat(pr,"labels.filterByCondition"),Hb="".concat(pr,"labels.filterByValue"),Lb="".concat(pr,"labels.conjunction"),bv="".concat(pr,"labels.disjunction"),wh="".concat(pr,"values.blankCells"),jb="".concat(pr,"buttons.selectAll"),Fb="".concat(pr,"buttons.clear"),Bb="".concat(pr,"buttons.ok"),Vb="".concat(pr,"buttons.cancel"),Wb="".concat(pr,"buttons.placeholder.search"),Ub="".concat(pr,"buttons.placeholder.value"),zb="".concat(pr,"buttons.placeholder.secondValue");const Gme=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:Gp,CONTEXTMENU_ITEMS_ALIGNMENT:Zp,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:ob,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:Qp,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:tb,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:Jp,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:nb,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:eb,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:rb,CONTEXTMENU_ITEMS_BORDERS:ib,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:sb,CONTEXTMENU_ITEMS_BORDERS_LEFT:ub,CONTEXTMENU_ITEMS_BORDERS_RIGHT:lb,CONTEXTMENU_ITEMS_BORDERS_TOP:ab,CONTEXTMENU_ITEMS_CLEAR_COLUMN:Hp,CONTEXTMENU_ITEMS_COPY:Lp,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:Bp,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:Fp,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:jp,CONTEXTMENU_ITEMS_CUT:Vp,CONTEXTMENU_ITEMS_EDIT_COMMENT:Kp,CONTEXTMENU_ITEMS_FREEZE_COLUMN:Wp,CONTEXTMENU_ITEMS_HIDE_COLUMN:db,CONTEXTMENU_ITEMS_HIDE_ROW:yb,CONTEXTMENU_ITEMS_INSERT_LEFT:$p,CONTEXTMENU_ITEMS_INSERT_RIGHT:Ap,CONTEXTMENU_ITEMS_MERGE_CELLS:zp,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:hb,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:cb,CONTEXTMENU_ITEMS_NO_ITEMS:$T,CONTEXTMENU_ITEMS_READ_ONLY:Np,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:Xp,CONTEXTMENU_ITEMS_REDO:Dp,CONTEXTMENU_ITEMS_REMOVE_BORDERS:fb,CONTEXTMENU_ITEMS_REMOVE_COLUMN:Mp,CONTEXTMENU_ITEMS_REMOVE_COMMENT:qp,CONTEXTMENU_ITEMS_REMOVE_ROW:Ip,CONTEXTMENU_ITEMS_ROW_ABOVE:Pp,CONTEXTMENU_ITEMS_ROW_BELOW:kp,CONTEXTMENU_ITEMS_SHOW_COLUMN:vb,CONTEXTMENU_ITEMS_SHOW_ROW:gb,CONTEXTMENU_ITEMS_UNDO:xp,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:Up,CONTEXTMENU_ITEMS_UNMERGE_CELLS:Yp,CONTEXT_MENU_ITEMS_NAMESPACE:RW,FILTERS_BUTTONS_CANCEL:Vb,FILTERS_BUTTONS_CLEAR:Fb,FILTERS_BUTTONS_OK:Bb,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:Wb,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:zb,FILTERS_BUTTONS_PLACEHOLDER_VALUE:Ub,FILTERS_BUTTONS_SELECT_ALL:jb,FILTERS_CONDITIONS_AFTER:Ab,FILTERS_CONDITIONS_BEFORE:Ib,FILTERS_CONDITIONS_BEGINS_WITH:Sb,FILTERS_CONDITIONS_BETWEEN:kb,FILTERS_CONDITIONS_BY_VALUE:Yme,FILTERS_CONDITIONS_CONTAINS:_b,FILTERS_CONDITIONS_EMPTY:mb,FILTERS_CONDITIONS_ENDS_WITH:Cb,FILTERS_CONDITIONS_EQUAL:bb,FILTERS_CONDITIONS_GREATER_THAN:Rb,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:Eb,FILTERS_CONDITIONS_LESS_THAN:Tb,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:Pb,FILTERS_CONDITIONS_NAMESPACE:Mt,FILTERS_CONDITIONS_NONE:pv,FILTERS_CONDITIONS_NOT_BETWEEN:$b,FILTERS_CONDITIONS_NOT_CONTAIN:Ob,FILTERS_CONDITIONS_NOT_EMPTY:pb,FILTERS_CONDITIONS_NOT_EQUAL:wb,FILTERS_CONDITIONS_TODAY:Mb,FILTERS_CONDITIONS_TOMORROW:xb,FILTERS_CONDITIONS_YESTERDAY:Db,FILTERS_DIVS_FILTER_BY_CONDITION:Nb,FILTERS_DIVS_FILTER_BY_VALUE:Hb,FILTERS_LABELS_CONJUNCTION:Lb,FILTERS_LABELS_DISJUNCTION:bv,FILTERS_NAMESPACE:pr,FILTERS_VALUES_BLANK_CELLS:wh},Symbol.toStringTag,{value:"Module"}));function Sh(e){"@babel/helpers - typeof";return Sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sh(e)}var ue;function ce(e,t,r){return t=Kme(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kme(e){var t=qme(e,"string");return Sh(t)==="symbol"?t:String(t)}function qme(e,t){if(Sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Xme=(ue={languageCode:"en-US"},ce(ue,$T,"No available options"),ce(ue,Pp,"Insert row above"),ce(ue,kp,"Insert row below"),ce(ue,$p,"Insert column left"),ce(ue,Ap,"Insert column right"),ce(ue,Ip,["Remove row","Remove rows"]),ce(ue,Mp,["Remove column","Remove columns"]),ce(ue,xp,"Undo"),ce(ue,Dp,"Redo"),ce(ue,Np,"Read only"),ce(ue,Hp,"Clear column"),ce(ue,Zp,"Alignment"),ce(ue,Jp,"Left"),ce(ue,Qp,"Center"),ce(ue,eb,"Right"),ce(ue,tb,"Justify"),ce(ue,rb,"Top"),ce(ue,nb,"Middle"),ce(ue,ob,"Bottom"),ce(ue,Wp,"Freeze column"),ce(ue,Up,"Unfreeze column"),ce(ue,ib,"Borders"),ce(ue,ab,"Top"),ce(ue,lb,"Right"),ce(ue,sb,"Bottom"),ce(ue,ub,"Left"),ce(ue,fb,"Remove border(s)"),ce(ue,Gp,"Add comment"),ce(ue,Kp,"Edit comment"),ce(ue,qp,"Delete comment"),ce(ue,Xp,"Read-only comment"),ce(ue,zp,"Merge cells"),ce(ue,Yp,"Unmerge cells"),ce(ue,Lp,"Copy"),ce(ue,jp,["Copy with header","Copy with headers"]),ce(ue,Fp,["Copy with group header","Copy with group headers"]),ce(ue,Bp,["Copy header only","Copy headers only"]),ce(ue,Vp,"Cut"),ce(ue,cb,"Insert child row"),ce(ue,hb,"Detach from parent"),ce(ue,db,["Hide column","Hide columns"]),ce(ue,vb,["Show column","Show columns"]),ce(ue,yb,["Hide row","Hide rows"]),ce(ue,gb,["Show row","Show rows"]),ce(ue,pv,"None"),ce(ue,mb,"Is empty"),ce(ue,pb,"Is not empty"),ce(ue,bb,"Is equal to"),ce(ue,wb,"Is not equal to"),ce(ue,Sb,"Begins with"),ce(ue,Cb,"Ends with"),ce(ue,_b,"Contains"),ce(ue,Ob,"Does not contain"),ce(ue,Rb,"Greater than"),ce(ue,Eb,"Greater than or equal to"),ce(ue,Tb,"Less than"),ce(ue,Pb,"Less than or equal to"),ce(ue,kb,"Is between"),ce(ue,$b,"Is not between"),ce(ue,Ab,"After"),ce(ue,Ib,"Before"),ce(ue,Mb,"Today"),ce(ue,xb,"Tomorrow"),ce(ue,Db,"Yesterday"),ce(ue,wh,"Blank cells"),ce(ue,Nb,"Filter by condition"),ce(ue,Hb,"Filter by value"),ce(ue,Lb,"And"),ce(ue,bv,"Or"),ce(ue,jb,"Select all"),ce(ue,Fb,"Clear"),ce(ue,Bb,"OK"),ce(ue,Vb,"Cancel"),ce(ue,Wb,"Search"),ce(ue,Ub,"Value"),ce(ue,zb,"Second value"),ue);const EW=Xme;var IO=EW.languageCode,Yb=Qr("languagesDictionaries"),Zme=Yb.register,TW=Yb.getItem,Jme=Yb.hasItem,Qme=Yb.getValues;AT(EW);function AT(e,t){var r=e,n=t;return Ye(e)&&(n=e,r=n.languageCode),epe(r,n),Zme(r,yr(n)),yr(n)}function epe(e,t){e!==IO&&Fme(t,TW(IO))}function PW(e){return IT(e)?yr(TW(e)):null}function IT(e){return Jme(e)}function tpe(){return Qme()}function kW(e,t,r){var n=PW(e);if(n===null)return null;var o=n[t];if(pt(o))return null;var i=rpe(o,r);return Array.isArray(i)?i[0]:i}function rpe(e,t){var r=e;return I(zme(),function(n){r=n(e,t)}),r}function npe(e){var t=CW(e);return IT(t)||(t=IO,_W(e)),t}var ope=Me,ipe=Vt,ape=WL,lpe=Fr,spe=jn,upe=nv;ope({target:"Object",stat:!0,sham:!ipe},{getOwnPropertyDescriptors:function(t){for(var r=lpe(t),n=spe.f,o=ape(r),i={},a=0,l,s;o.length>a;)s=n(r,l=o[a++]),s!==void 0&&upe(i,l,s);return i}});var Gb="active-header",Kb="area",Ch="cell",MT="fill",wv="header",xT="custom-selection";function Hs(e){"@babel/helpers - typeof";return Hs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hs(e)}function fpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AW(n.key),n)}}function cpe(e,t,r){return t&&AI(e.prototype,t),r&&AI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ag(){return typeof Reflect<"u"&&Reflect.get?ag=Reflect.get.bind():ag=function(t,r,n){var o=hpe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ag.apply(this,arguments)}function hpe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ls(e),e!==null););return e}function dpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MO(e,t)}function MO(e,t){return MO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},MO(e,t)}function vpe(e){var t=gpe();return function(){var n=Ls(e),o;if(t){var i=Ls(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ype(this,o)}}function ype(e,t){if(t&&(Hs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $W(e)}function $W(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ls(e){return Ls=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ls(e)}function mpe(e,t,r){return t=AW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AW(e){var t=ppe(e,"string");return Hs(t)==="symbol"?t:String(t)}function ppe(e,t){if(Hs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bpe=function(e){dpe(r,e);var t=vpe(r);function r(n,o){var i;return fpe(this,r),i=t.call(this,n,null),mpe($W(i),"visualCellRange",null),i.visualCellRange=o||null,i.commit(),i}return cpe(r,[{key:"add",value:function(o){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(o):this.visualCellRange.expand(o),this}},{key:"clear",value:function(){return this.visualCellRange=null,ag(Ls(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(o){var i=o.from,a=o.to,l=this.getNearestNotHiddenCoords(i,1),s=this.getNearestNotHiddenCoords(a,-1);if(l===null||s===null)return null;if(l.row>s.row||l.col>s.col){var u=this.settings.type==="header"||this.settings.type==="active-header";if(!u)return null;l=i,s=a}return this.settings.createCellRange(l,l,s)}},{key:"getNearestNotHiddenCoords",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i,l=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),o.row,i);if(l===null)return null;var s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),o.col,a);return s===null?null:this.settings.createCellCoords(l,s)}},{key:"getNearestNotHiddenIndex",value:function(o,i,a){if(i<0)return i;var l=o.getNearestNotHiddenIndex(i,a),s=this.settings.type==="header"||this.settings.type==="active-header";return s&&l===null?-1:l}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var o=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return o===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(o.from,o.to),this}},{key:"syncWith",value:function(o){var i=o.getVerticalDirection()==="N-S"?1:-1,a=o.getHorizontalDirection()==="W-E"?1:-1,l=this.getNearestNotHiddenCoords(o.from.clone().normalize(),i,a);if(l!==null&&o.overlaps(l)){if(this.cellRange===null){var s=this.settings.visualToRenderableCoords(l);this.cellRange=this.settings.createCellRange(s)}return o.setHighlight(l),this}return o.setHighlight(o.from),this}},{key:"getCorners",value:function(){var o=this.cellRange,i=o.from,a=o.to,l=i.row===null||a.row===null,s=i.col===null||a.col===null,u=this.settings.createCellCoords(l?null:Math.min(i.row,a.row),s?null:Math.min(i.col,a.col)),f=this.settings.createCellCoords(l?null:Math.max(i.row,a.row),s?null:Math.max(i.col,a.col));return[u.row,u.col,f.row,f.col]}},{key:"getVisualCorners",value:function(){var o=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),i=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[o.row,o.col,i.row,i.col]}},{key:"createRenderableCellRange",value:function(o,i){var a=this.settings.visualToRenderableCoords(o),l=this.settings.visualToRenderableCoords(i);return this.settings.createCellRange(a,a,l)}}]),r}(eye);const Sf=bpe;function _h(e){"@babel/helpers - typeof";return _h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_h(e)}var wpe=["activeHeaderClassName"];function II(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function MI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?II(Object(r),!0).forEach(function(n){Spe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):II(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Spe(e,t,r){return t=Cpe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cpe(e){var t=_pe(e,"string");return _h(t)==="symbol"?t:String(t)}function _pe(e,t){if(_h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ope(e,t){if(e==null)return{};var r=Rpe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Rpe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Epe(e){var t=e.activeHeaderClassName,r=Ope(e,wpe),n=new Sf(MI(MI({highlightHeaderClassName:t},r),{},{selectionType:Gb}));return n}function Oh(e){"@babel/helpers - typeof";return Oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oh(e)}var Tpe=["layerLevel","areaCornerVisible"];function xI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function DI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xI(Object(r),!0).forEach(function(n){Ppe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ppe(e,t,r){return t=kpe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kpe(e){var t=$pe(e,"string");return Oh(t)==="symbol"?t:String(t)}function $pe(e,t){if(Oh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ape(e,t){if(e==null)return{};var r=Ipe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Ipe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Mpe(e){var t=e.layerLevel,r=e.areaCornerVisible,n=Ape(e,Tpe),o=new Sf(DI(DI({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:Kb}));return o}function Rh(e){"@babel/helpers - typeof";return Rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rh(e)}var xpe=["cellCornerVisible"];function NI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function HI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NI(Object(r),!0).forEach(function(n){Dpe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Dpe(e,t,r){return t=Npe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Npe(e){var t=Hpe(e,"string");return Rh(t)==="symbol"?t:String(t)}function Hpe(e,t){if(Rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lpe(e,t){if(e==null)return{};var r=jpe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function jpe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Fpe(e){var t=e.cellCornerVisible,r=Lpe(e,xpe),n=new Sf(HI(HI({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:Ch}));return n}function Eh(e){"@babel/helpers - typeof";return Eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eh(e)}var Bpe=["border","visualCellRange"];function LI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function LS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LI(Object(r),!0).forEach(function(n){Vpe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Vpe(e,t,r){return t=Wpe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wpe(e){var t=Upe(e,"string");return Eh(t)==="symbol"?t:String(t)}function Upe(e,t){if(Eh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zpe(e,t){if(e==null)return{};var r=Ype(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Ype(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Gpe(e){var t=e.border,r=e.visualCellRange,n=zpe(e,Bpe),o=new Sf(LS(LS(LS({},t),n),{},{selectionType:xT}),r);return o}var jI=Vt,Kpe=Ve,qpe=Gt,Xpe=Fe,jS=zd,Zpe=Wd,Jpe=Nd,Qpe=Tr,ebe=Ld,vl=Object.assign,FI=Object.defineProperty,tbe=Kpe([].concat),rbe=!vl||Xpe(function(){if(jI&&vl({b:1},vl(FI({},"a",{enumerable:!0,get:function(){FI(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol("assign detection"),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(o){t[o]=o}),vl({},e)[r]!==7||jS(vl({},t)).join("")!==n})?function(t,r){for(var n=Qpe(t),o=arguments.length,i=1,a=Zpe.f,l=Jpe.f;o>i;)for(var s=ebe(arguments[i++]),u=a?tbe(jS(s),a(s)):jS(s),f=u.length,c=0,h;f>c;)h=u[c++],(!jI||qpe(l,s,h))&&(n[h]=s[h]);return n}:vl,nbe=Me,BI=rbe;nbe({target:"Object",stat:!0,arity:2,forced:Object.assign!==BI},{assign:BI});function Th(e){"@babel/helpers - typeof";return Th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Th(e)}function VI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function WI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VI(Object(r),!0).forEach(function(n){obe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function obe(e,t,r){return t=ibe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ibe(e){var t=abe(e,"string");return Th(t)==="symbol"?t:String(t)}function abe(e,t){if(Th(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lbe(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function sbe(e){var t=Object.assign({},(lbe(e),e)),r=new Sf(WI(WI({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:MT}));return r}function Ph(e){"@babel/helpers - typeof";return Ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ph(e)}var ube=["headerClassName","rowClassName","columnClassName"];function UI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function zI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UI(Object(r),!0).forEach(function(n){fbe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):UI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fbe(e,t,r){return t=cbe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cbe(e){var t=hbe(e,"string");return Ph(t)==="symbol"?t:String(t)}function hbe(e,t){if(Ph(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dbe(e,t){if(e==null)return{};var r=vbe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function vbe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function ybe(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,o=dbe(e,ube),i=new Sf(zI(zI({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},o),{},{highlightOnlyClosestHeader:!0,selectionType:wv}));return i}function kh(e){"@babel/helpers - typeof";return kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kh(e)}function YI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function gbe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YI(Object(r),!0).forEach(function(n){mbe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mbe(e,t,r){return t=pbe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pbe(e){var t=bbe(e,"string");return kh(t)==="symbol"?t:String(t)}function bbe(e,t){if(kh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IW=Qr("highlight/types"),Cf=IW.register,wbe=IW.getItem;Cf(Gb,Epe);Cf(Kb,Mpe);Cf(Ch,Fpe);Cf(xT,Gpe);Cf(MT,sbe);Cf(wv,ybe);function yl(e,t){return wbe(e)(gbe({type:e},t))}function $h(e){"@babel/helpers - typeof";return $h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$h(e)}function Go(e){return Obe(e)||_be(e)||Cbe(e)||Sbe()}function Sbe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cbe(e,t){if(e){if(typeof e=="string")return xO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xO(e,t)}}function _be(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Obe(e){if(Array.isArray(e))return xO(e)}function xO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function GI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Vf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GI(Object(r),!0).forEach(function(n){Rbe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Rbe(e,t,r){return t=MW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ebe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MW(n.key),n)}}function Tbe(e,t,r){return t&&KI(e.prototype,t),r&&KI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MW(e){var t=Pbe(e,"string");return $h(t)==="symbol"?t:String(t)}function Pbe(e,t){if($h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kbe=function(e){function t(r){Ebe(this,t),this.options=r,this.layerLevel=0,this.cell=yl(Ch,r),this.fill=yl(MT,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return Tbe(t,[{key:"isEnabledFor",value:function(n,o){var i=n;n===Ch&&(i="current");var a=this.options.disabledCellSelection(o.row,o.col);return typeof a=="string"&&(a=[a]),a===!1||Array.isArray(a)&&!a.includes(i)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,o;return this.areas.has(n)?o=this.areas.get(n):(o=yl(Kb,Vf({layerLevel:n},this.options)),this.areas.set(n,o)),o}},{key:"getAreas",value:function(){return Go(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,o;return this.headers.has(n)?o=this.headers.get(n):(o=yl(wv,Vf({},this.options)),this.headers.set(n,o)),o}},{key:"getHeaders",value:function(){return Go(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,o;return this.activeHeaders.has(n)?o=this.activeHeaders.get(n):(o=yl(Gb,Vf({},this.options)),this.activeHeaders.set(n,o)),o}},{key:"getActiveHeaders",value:function(){return Go(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Go(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(yl(xT,Vf(Vf({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),I(this.areas.values(),function(n){return void n.clear()}),I(this.headers.values(),function(n){return void n.clear()}),I(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(Go(this.areas.values()),Go(this.headers.values()),Go(this.activeHeaders.values()),Go(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator);const $be=kbe;function Ah(e){"@babel/helpers - typeof";return Ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ah(e)}function Abe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mbe(n.key),n)}}function Ibe(e,t,r){return t&&qI(e.prototype,t),r&&qI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mbe(e){var t=xbe(e,"string");return Ah(t)==="symbol"?t:String(t)}function xbe(e,t){if(Ah(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dbe=function(e){function t(r){Abe(this,t),this.ranges=[],this.createCellRange=r}return Ibe(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(o){return o.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,o=this.size()+n-1,i;return o>=0&&(i=this.ranges[o]),i}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator);const Nbe=Dbe;function Ih(e){"@babel/helpers - typeof";return Ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ih(e)}function Hbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jbe(n.key),n)}}function Lbe(e,t,r){return t&&XI(e.prototype,t),r&&XI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jbe(e){var t=Fbe(e,"string");return Ih(t)==="symbol"?t:String(t)}function Fbe(e,t){if(Ih(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xW=function(){function e(t,r){Hbe(this,e),this.range=t,this.options=r}return Lbe(e,[{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.options.createCellCoords(r,n),a=this.range.current().highlight,l=this.options.visualToRenderableCoords(a),s=l.row,u=l.col,f=a,c=0,h=0;if(this.runLocalHooks("beforeTransformStart",i),s!==null&&u!==null){var d=this.options.countRows(),v=this.options.countCols(),g=this.options.fixedRowsBottom(),p=this.options.minSpareRows(),w=this.options.minSpareCols(),S=this.options.autoWrapRow(),C=this.options.autoWrapCol();s+r>d-1?o&&p>0&&!(g&&s>=d-g-1)?(this.runLocalHooks("insertRowRequire",d),d=this.options.countRows()):C&&(i.row=1-d,i.col=u+i.col===v-1?1-v:1):C&&s+i.row<0&&u+i.col>=0&&(i.row=d-1,i.col=u+i.col===0?v-1:-1),u+i.col>v-1?o&&w>0?(this.runLocalHooks("insertColRequire",v),v=this.options.countCols()):S&&(i.row=s+i.row===d-1?1-d:1,i.col=1-v):S&&u+i.col<0&&s+i.row>=0&&(i.row=s+i.row===0?d-1:-1,i.col=v-1);var P=this.options.createCellCoords(s+i.row,u+i.col);c=0,h=0,P.row<0?(c=-1,P.row=0):P.row>0&&P.row>=d&&(c=1,P.row=d-1),P.col<0?(h=-1,P.col=0):P.col>0&&P.col>=v&&(h=1,P.col=v-1),f=this.options.renderableToVisualCoords(P)}return this.runLocalHooks("afterTransformStart",f,c,h),f}},{key:"transformEnd",value:function(r,n){var o=this.options.createCellCoords(r,n),i=this.range.current(),a=i.to,l=0,s=0;this.runLocalHooks("beforeTransformEnd",o);var u=this.options.visualToRenderableCoords(i.highlight),f=u.row,c=u.col;if(f!==null&&c!==null){var h=this.options.countRows(),d=this.options.countCols(),v=this.options.visualToRenderableCoords(i.to),g=v.row,p=v.col,w=this.options.createCellCoords(g+o.row,p+o.col);l=0,s=0,w.row<0?(l=-1,w.row=0):w.row>0&&w.row>=h&&(l=1,w.row=h-1),w.col<0?(s=-1,w.col=0):w.col>0&&w.col>=d&&(s=1,w.col=d-1),a=this.options.renderableToVisualCoords(w)}return this.runLocalHooks("afterTransformEnd",a,l,s),a}}]),e}();bt(xW,Pr);const Bbe=xW;function DW(e,t){return zbe(e)||Ube(e,t)||Wbe(e,t)||Vbe()}function Vbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wbe(e,t){if(e){if(typeof e=="string")return ZI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZI(e,t)}}function ZI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ube(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function zbe(e){if(Array.isArray(e))return e}function DO(e){"@babel/helpers - typeof";return DO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},DO(e)}var qb=0,Xb=1,NW=2,DT=3,Ybe=[DT,NW],Gbe=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],FS=Symbol("root"),JI=Symbol("child");function js(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:FS;if(t!==FS&&t!==JI)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===FS,o=qb;if(r){var i=e[0];if(e.length===0)o=Xb;else if(n&&i instanceof hT)o=DT;else if(n&&Array.isArray(i))o=js(i,JI);else if(e.length>=2&&e.length<=4){var a=!e.some(function(l,s){return!Gbe[s].includes(DO(l))});a&&(o=NW)}}return o}function Mh(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,o=t.propToCol;if(!Ybe.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){var a=e===DT,l=a?i.from.row:i[0],s=a?i.from.col:i[1],u=a?i.to.row:i[2],f=a?i.to.col:i[3];if(typeof o=="function"&&(typeof s=="string"&&(s=o(s)),typeof f=="string"&&(f=o(f))),pt(u)&&(u=l),pt(f)&&(f=s),!n){var c=l,h=s,d=u,v=f;l=Math.min(c,d),s=Math.min(h,v),u=Math.max(c,d),f=Math.max(h,v)}return[l,s,u,f]}}function Kbe(e){var t=js(e);if(t===qb||t===Xb)return[];var r=Mh(t),n=new Set;I(e,function(a){var l=r(a),s=DW(l,4),u=s[1],f=s[3],c=Math.max(u,0),h=f-c+1;I(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=ar(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function qbe(e){var t=js(e);if(t===qb||t===Xb)return[];var r=Mh(t),n=new Set;I(e,function(a){var l=r(a),s=DW(l,3),u=s[0],f=s[2],c=Math.max(u,0),h=f-c+1;I(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=ar(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function Ko(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}function xh(e){"@babel/helpers - typeof";return xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xh(e)}var QI;function eM(e,t){return Qbe(e)||Jbe(e,t)||Zbe(e,t)||Xbe()}function Xbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zbe(e,t){if(e){if(typeof e=="string")return tM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tM(e,t)}}function tM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Jbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Qbe(e){if(Array.isArray(e))return e}function ewe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function twe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nwe(n.key),n)}}function rwe(e,t,r){return t&&rM(e.prototype,t),r&&rM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nwe(e){var t=owe(e,"string");return xh(t)==="symbol"?t:String(t)}function owe(e,t){if(xh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HW=function(){function e(t,r){var n=this;twe(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new Nbe(function(o,i,a){return n.tableProps.createCellRange(o,i,a)}),this.highlight=new $be({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(i,a){return n.tableProps.isDisabledCellSelection(i,a)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},createCellRange:function(i,a,l){return n.tableProps.createCellRange(i,a,l)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new Bbe(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(i))}),this.transformation.addLocalHook("insertColRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertColRequire"].concat(i))})}return rwe(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.settings.selectionMode==="multiple",a=pt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,l=r.row<0,s=r.col<0,u=l&&s,f=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(o?"Only":""),f),(!i||i&&!a&&pt(n))&&this.selectedRange.clear(),this.selectedRange.add(f),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&s&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&l&&this.selectedByColumnHeader.add(this.getLayerLevel()),o||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var o=this.selectedRange.current();this.settings.selectionMode!=="single"&&o.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(Ch,o.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(o);var i=this.getLayerLevel();i<this.highlight.layerLevel&&(I(this.highlight.getAreas(),function(g){return void g.clear()}),I(this.highlight.getHeaders(),function(g){return void g.clear()}),I(this.highlight.getActiveHeaders(),function(g){return void g.clear()})),this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();if(a.clear(),l.clear(),s.clear(),this.highlight.isEnabledFor(Kb,o.highlight)&&(this.isMultiple()||i>=1)&&(a.add(o.from).add(o.to).commit(),i===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(i-1).createOrGetArea().add(u.from).commit().syncWith(u),this.highlight.useLayerLevel(i)}if(this.highlight.isEnabledFor(wv,o.highlight)){var f=this.tableProps.countRowsTranslated()===0,c=this.tableProps.countColsTranslated()===0,h=o;if((f||c)&&(h=o.clone()),f&&(h.from.row=-1),c&&(h.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&h.from.normalize(),l.add(h.from).commit()):l.add(h.from).add(h.to).commit(),this.isEntireRowSelected()){var d=this.tableProps.countCols()===o.getWidth();d&&s.add(this.tableProps.createCellCoords(o.from.row,-1)).add(this.tableProps.createCellCoords(o.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var v=this.tableProps.countRows()===o.getHeight();v&&s.add(this.tableProps.createCellCoords(-1,o.from.col)).add(this.tableProps.createCellCoords(-1,o.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=ss(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,o))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.tableProps.countRows(),i=this.tableProps.countCols();if(!(!r&&!n&&(o===0||i===0))){var a=this.tableProps.createCellCoords(n?-1:0,r?-1:0),l=this.tableProps.createCellCoords(o-1,i-1);this.clear(),this.setRangeStartOnly(a),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(l),this.finish()}}},{key:"selectCells",value:function(r){var n=this,o=js(r);if(o===Xb)return!1;if(o===qb)throw new Error(ft(QI||(QI=ewe([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var i=Mh(o,{propToCol:function(f){return n.tableProps.propToCol(f)},keepDirection:!0}),a=this.tableProps.countRows(),l=this.tableProps.countCols(),s=!r.some(function(u){var f=i(u),c=eM(f,4),h=c[0],d=c[1],v=c[2],g=c[3],p=Ko(h,a)&&Ko(d,l)&&Ko(v,a)&&Ko(g,l);return!p});return s&&(this.clear(),I(r,function(u){var f=i(u),c=eM(f,4),h=c[0],d=c[1],v=c[2],g=c[3];n.setRangeStartOnly(n.tableProps.createCellCoords(h,d),!1),n.setRangeEnd(n.tableProps.createCellCoords(v,g)),n.finish()})),s}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=typeof r=="string"?this.tableProps.propToCol(r):r,a=typeof n=="string"?this.tableProps.propToCol(n):n,l=this.tableProps.countCols(),s=this.tableProps.countRows(),u=Ko(i,l)&&Ko(a,l);return u&&(this.setRangeStartOnly(this.tableProps.createCellCoords(o,i)),this.setRangeEnd(this.tableProps.createCellCoords(s-1,a)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=this.tableProps.countRows(),a=this.tableProps.countCols(),l=Ko(r,i)&&Ko(n,i);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,o)),this.setRangeEnd(this.tableProps.createCellCoords(n,a-1)),this.finish()),l}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),o=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();a.commit(),l.commit(),s.commit()}this.highlight.useLayerLevel(o)}}}]),e}();bt(HW,Pr);const iwe=HW;var awe=Me,lwe=Kd,swe=jn.f,uwe=Xa,nM=Wt,fwe=k0,cwe=Er,hwe=$0,dwe=lwe("".slice),vwe=Math.min,LW=hwe("startsWith"),ywe=!LW&&!!function(){var e=swe(String.prototype,"startsWith");return e&&!e.writable}();awe({target:"String",proto:!0,forced:!ywe&&!LW},{startsWith:function(t){var r=nM(cwe(this));fwe(t);var n=uwe(vwe(arguments.length>1?arguments[1]:void 0,r.length)),o=nM(t);return dwe(r,n,n+o.length)===o}});var oM=/^(\r\n|\n\r|\r|\n)/,gwe=/^[^\t\r\n]+/,iM=/^\t/;function mwe(e){var t=[[""]];if(e.length===0)return t;for(var r=0,n=0,o;e.length>0&&o!==e.length;)if(o=e.length,e.match(iM))e=e.replace(iM,""),r+=1,t[n][r]="";else if(e.match(oM))e=e.replace(oM,""),r=0,n+=1,t[n]=[""];else{var i="";if(e.startsWith('"')){for(var a=0,l=!0;l;){var s=e.slice(0,1);s==='"'&&(a+=1),i+=s,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&a%2===0)&&(l=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(f){return new Array(Math.floor(f.length/2)).fill('"').join("")})}else{var u=e.match(gwe);i=u?u[0]:"",e=e.slice(i.length)}t[n][r]=i}return t}function wc(e){var t,r,n,o,i="",a;for(t=0,r=e.length;t<r;t+=1){for(o=e[t].length,n=0;n<o;n+=1)n>0&&(i+="	"),a=e[t][n],typeof a=="string"?a.indexOf(`
`)>-1?i+='"'.concat(a.replace(/"/g,'""'),'"'):i+=a:a==null?i+="":i+=a;t!==r-1&&(i+=`
`)}return i}function BS(e){return Swe(e)||wwe(e)||bwe(e)||pwe()}function pwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bwe(e,t){if(e){if(typeof e=="string")return NO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NO(e,t)}}function wwe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Swe(e){if(Array.isArray(e))return NO(e)}function NO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Fs(e){"@babel/helpers - typeof";return Fs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fs(e)}function Cwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Owe(n.key),n)}}function _we(e,t,r){return t&&aM(e.prototype,t),r&&aM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Owe(e){var t=Rwe(e,"string");return Fs(t)==="symbol"?t:String(t)}function Rwe(e,t){if(Fs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ewe=function(){function e(t,r,n){Cwe(this,e),this.instance=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return _we(e,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,o;if(this.colToPropCache=[],this.propToColCache=new Map,n){var i=0,a=0,l=!1;if(typeof n=="function"){var s=N0(r);i=s>0?s:this.countFirstRowKeys(),l=!0}else{var u=this.tableMeta.maxCols;i=Math.min(u,n.length)}for(o=0;o<i;o++){var f=l?n(o):n[o];if(Ye(f)){if(typeof f.data<"u"){var c=l?a:o;this.colToPropCache[c]=f.data,this.propToColCache.set(f.data,c)}a+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return fW(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,o){var i=this,a=n,l=o,s;return typeof a>"u"&&(a=0,l=""),Fs(r)==="object"&&!Array.isArray(r)&&Ge(r,function(u,f){u===null?(s=l+f,i.colToPropCache.push(s),i.propToColCache.set(s,a),a+=1):a=i.recursiveDuckColumns(u,a,"".concat(f,"."))}),a}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&pe(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(pe(n))return this.instance.toVisualColumn(n);var o=this.instance.toVisualColumn(r);return o===null?r:o}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?$c(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=i.source,l=i.mode,s=l===void 0?"above":l,u=this.instance.countSourceRows(),f=u,c=0,h=r;(typeof h!="number"||h>=u)&&(h=u),h<this.instance.countRows()&&(f=this.instance.toPhysicalRow(h));var d=this.instance.runHooks("beforeCreateRow",h,o,a);if(d===!1||f===null)return{delta:0};for(var v=this.tableMeta.maxRows,g=this.getSchema().length,p=[],w=function(){var P=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?P=yr(n.getSchema()):(P=[],Re(g-1,function(){return P.push(null)})):n.instance.dataType==="function"?P=n.tableMeta.dataSchema(h+c):(P={},up(P,n.getSchema())),p.push(P),c+=1};c<o&&u+c<v;)w();this.instance.rowIndexMapper.insertIndexes(h,c),s==="below"&&(f=Math.min(f+1,u)),this.spliceData(f,0,p);var S=this.instance.toVisualRow(f);return this.instance.countSourceRows()===p.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),c>0&&(r==null?this.metaManager.createRow(null,c):a!=="auto"&&this.metaManager.createRow(f,o)),this.instance.runHooks("afterCreateRow",S,c,a),this.instance.forceFullRender=!0,{delta:c,startPhysicalIndex:f}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=o.source,a=o.mode,l=a===void 0?"start":a;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var s=this.dataSource,u=this.tableMeta.maxCols,f=this.instance.countSourceCols(),c=r;(typeof c!="number"||c>=f)&&(c=f);var h=this.instance.runHooks("beforeCreateCol",c,n,i);if(h===!1)return{delta:0};var d=f;c<this.instance.countCols()&&(d=this.instance.toPhysicalColumn(c));var v=this.instance.countSourceRows(),g=this.instance.countCols(),p=0,w=d;l==="end"&&(w=Math.min(w+1,f));for(var S=w;p<n&&g<u;){if(typeof c!="number"||c>=g)if(v>0)for(var C=0;C<v;C+=1)typeof s[C]>"u"&&(s[C]=[]),s[C].push(null);else s.push([null]);else for(var P=0;P<v;P++)s[P].splice(w,0,null);p+=1,w+=1,g+=1}this.instance.columnIndexMapper.insertIndexes(c,p),p>0&&(r==null?this.metaManager.createColumn(null,p):i!=="auto"&&this.metaManager.createColumn(S,n));var R=this.instance.toVisualColumn(S);return this.instance.runHooks("afterCreateCol",R,p,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:p,startPhysicalIndex:S}}},{key:"removeRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,a=Number.isInteger(r)?r:-o,l=this.visualRowsToPhysical(a,o),s=this.instance.countSourceRows();a=(s+a)%s;var u=this.instance.runHooks("beforeRemoveRow",a,l.length,l,i);if(u===!1)return!1;var f=l.length;if(this.filterData(a,f,l),a<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(l);var c=pe(this.tableMeta.columns)||pe(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var h=l.slice(0).sort(function(d,v){return v-d});return h.forEach(function(d){n.metaManager.removeRow(d,1)}),this.instance.runHooks("afterRemoveRow",a,f,l,i),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var i=typeof r!="number"?-n:r;i=(this.instance.countCols()+i)%this.instance.countCols();var a=this.visualColumnsToPhysical(i,n),l=a.slice(0).sort(function(S,C){return C-S}),s=this.instance.runHooks("beforeRemoveCol",i,n,a,o);if(s===!1)return!1;for(var u=!0,f=l.length,c=this.dataSource,h=0;h<f;h++)u&&a[0]!==a[h]-h&&(u=!1);if(u)for(var d=0,v=this.instance.countSourceRows();d<v;d++)c[d].splice(a[0],n),d===0&&this.metaManager.removeColumn(a[0],n);else for(var g=0,p=this.instance.countSourceRows();g<p;g++)for(var w=0;w<f;w++)c[g].splice(l[w],1),g===0&&this.metaManager.removeColumn(l[w],1);return i<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(a),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",i,n,a,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,o){for(var i=this.instance.getDataAtCol(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),f=3;f<s;f++)u[f-3]=arguments[f];G$(u,l);for(var c=0;c<o;)u.push(null),c+=1;return qQ(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),a}},{key:"spliceRow",value:function(r,n,o){for(var i=this.instance.getSourceDataAtRow(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),f=3;f<s;f++)u[f-3]=arguments[f];G$(u,l);for(var c=0;c<o;)u.push(null),c+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),a}},{key:"spliceData",value:function(r,n,o){var i=this,a=this.instance.runHooks("beforeDataSplice",r,n,o);if(a!==!1){var l=[].concat(BS(this.dataSource.slice(0,r)),BS(o),BS(this.dataSource.slice(r)));this.dataSource.length=0,l.forEach(function(s){return i.dataSource.push(s)})}}},{key:"filterData",value:function(r,n,o){var i=this.instance.runHooks("filterData",r,n,o);Array.isArray(i)===!1&&(i=this.dataSource.filter(function(a,l){return o.indexOf(l)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}},{key:"get",value:function(r,n){var o=this.instance.toPhysicalRow(r),i=this.dataSource[o],a=this.instance.runHooks("modifyRowData",o);i=isNaN(a)?a:i;var l=null;if(i&&i.hasOwnProperty&&Dt(i,n))l=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var s=n.split("."),u=i;if(!u)return null;for(var f=0,c=s.length;f<c;f++)if(u=u[s[f]],typeof u>"u")return null;l=u}else typeof n=="function"&&(l=n(this.dataSource.slice(o,o+1)[0]));if(this.instance.hasHook("modifyData")){var h=ss(l);this.instance.runHooks("modifyData",o,this.propToCol(n),h,"get"),h.isTouched()&&(l=h.value)}return l}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,o){var i=this.instance.toPhysicalRow(r),a=o,l=this.dataSource[i],s=this.instance.runHooks("modifyRowData",i);if(l=isNaN(s)?s:l,this.instance.hasHook("modifyData")){var u=ss(a);this.instance.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(a=u.value)}if(l&&l.hasOwnProperty&&Dt(l,n))l[n]=a;else if(typeof n=="string"&&n.indexOf(".")>-1){var f=n.split("."),c=l,h=0,d;for(h=0,d=f.length-1;h<d;h++)typeof c[f[h]]>"u"&&(c[f[h]]={}),c=c[f[h]];c[f[h]]=a}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],a):l[n]=a}},{key:"visualRowsToPhysical",value:function(r,n){for(var o=this.instance.countSourceRows(),i=[],a=(o+r)%o,l=n,s;a<o&&l;)s=this.instance.toPhysicalRow(a),i.push(s),l-=1,a+=1;return i}},{key:"visualColumnsToPhysical",value:function(r,n){for(var o=this.instance.countCols(),i=[],a=(o+r)%o,l=n;a<o&&l;){var s=this.instance.toPhysicalColumn(a);i.push(s),l-=1,a+=1}return i}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var o=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(o,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,o){var i=[],a,l,s,u=this.tableMeta.maxRows,f=this.tableMeta.maxCols;if(u===0||f===0)return[];var c=o===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),d=Math.min(Math.max(f-1,0),Math.max(r.col,n.col));for(a=Math.min(r.row,n.row);a<=h;a++){s=[];var v=a>=0?this.instance.toPhysicalRow(a):a;for(l=Math.min(r.col,n.col);l<=d&&v!==null;l++)s.push(c.call(this,a,this.colToProp(l)));v!==null&&i.push(s)}return i}},{key:"getText",value:function(r,n){return wc(this.getRange(r,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return wc(this.getRange(r,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}();const Twe=Ewe;var Sv=Qr("cellTypes"),Pwe=Sv.register,kwe=Sv.getItem,jW=Sv.hasItem;Sv.getNames;Sv.getValues;function $we(e){if(!jW(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return kwe(e)}function Tn(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,o=r.renderer,i=r.validator;n&&xr(e,n),o&&eo(e,o),i&&sc(e,i),Pwe(e,t)}function Awe(e,t){var r;return e==="CELL_TYPE"?!1:((r=t._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(e))||!Dt(t,e)}function Zb(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=typeof t.type=="string"?$we(t.type):t.type;if(e._automaticallyAssignedMetaProps&&Ge(t,function(i,a){return void e._automaticallyAssignedMetaProps.delete(a)}),!!Ye(n)){r===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);var o={};Ge(n,function(i,a){if(Awe(a,r)){var l;o[a]=i,(l=e._automaticallyAssignedMetaProps)===null||l===void 0||l.add(a)}}),Yt(e,o)}}function Iwe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Pi(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function lg(e){return Number.isInteger(e)&&e>=0}function sg(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function iy(e){return e==null}function HO(e){"@babel/helpers - typeof";return HO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},HO(e)}const FW=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var r,n,o;for(r=0,n=this.countRows();r<n;r++)if(o=this.getDataAtCell(r,t),qt(o)===!1)return!1;return!0},isEmptyRow:function(t){var r,n,o,i;for(r=0,n=this.countCols();r<n;r++)if(o=this.getDataAtCell(t,r),qt(o)===!1)return HO(o)==="object"?(i=this.getCellMeta(t,r),D0(this.getSchema()[i.prop],o)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function Dh(e){"@babel/helpers - typeof";return Dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dh(e)}function lM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function sM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lM(Object(r),!0).forEach(function(n){Mwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Mwe(e,t,r){return t=VW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VW(n.key),n)}}function BW(e,t,r){return t&&uM(e.prototype,t),r&&uM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VW(e){var t=xwe(e,"string");return Dh(t)==="symbol"?t:String(t)}function xwe(e,t){if(Dh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WW(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dwe(){return BW(function e(){WW(this,e)})}var Nwe=function(){function e(t){WW(this,e),this.metaCtor=Dwe(),this.meta=this.metaCtor.prototype,Yt(this.meta,FW()),this.meta.instance=t}return BW(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;Yt(this.meta,r),Zb(this.meta,sM(sM({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),e}();function Nh(e){"@babel/helpers - typeof";return Nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nh(e)}function Hwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jwe(n.key),n)}}function Lwe(e,t,r){return t&&fM(e.prototype,t),r&&fM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jwe(e){var t=Fwe(e,"string");return Nh(t)==="symbol"?t:String(t)}function Fwe(e,t){if(Nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bwe=function(){function e(t){Hwe(this,e);var r=t.getMetaConstructor();this.meta=new r}return Lwe(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){Yt(this.meta,r),Zb(this.meta,r,r)}}]),e}();function Hh(e){"@babel/helpers - typeof";return Hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hh(e)}function cM(e){return zwe(e)||Uwe(e)||Wwe(e)||Vwe()}function Vwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wwe(e,t){if(e){if(typeof e=="string")return LO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LO(e,t)}}function Uwe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zwe(e){if(Array.isArray(e))return LO(e)}function LO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ywe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kwe(n.key),n)}}function Gwe(e,t,r){return t&&hM(e.prototype,t),r&&hM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kwe(e){var t=qwe(e,"string");return Hh(t)==="symbol"?t:String(t)}function qwe(e,t){if(Hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jO=function(e){function t(r){Ywe(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return Gwe(t,[{key:"obtain",value:function(n){sg(function(){return lg(n)},"Expecting an unsigned number.");var o=this._getStorageIndexByKey(n),i;if(o>=0)i=this.data[o],i===void 0&&(i=this.valueFactory(n),this.data[o]=i);else if(i=this.valueFactory(n),this.holes.size>0){var a=this.holes.values().next().value;this.holes.delete(a),this.data[a]=i,this.index[n]=a}else this.data.push(i),this.index[n]=this.data.length-1;return i}},{key:"insert",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;sg(function(){return lg(n)||iy(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=[],a=this.data.length,l=0;l<o;l++)i.push(a+l),this.data.push(void 0);var s=iy(n)?this.index.length:n;this.index=[].concat(cM(this.index.slice(0,s)),i,cM(this.index.slice(s)))}},{key:"remove",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;sg(function(){return lg(n)||iy(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=this.index.splice(iy(n)?this.index.length-o:n,o),a=0;a<i.length;a++){var l=i[a];typeof l=="number"&&this.holes.add(l)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return Kr(this.data,function(o,i){return!n.holes.has(i)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],o=0;o<this.data.length;o++){var i=this._getKeyByStorageIndex(o);i!==-1&&n.push([i,this.data[o]])}var a=0;return{next:function(){if(a<n.length){var s=n[a];return a+=1,{value:s,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function Lh(e){"@babel/helpers - typeof";return Lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lh(e)}function Xwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jwe(n.key),n)}}function Zwe(e,t,r){return t&&dM(e.prototype,t),r&&dM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jwe(e){var t=Qwe(e,"string");return Lh(t)==="symbol"?t:String(t)}function Qwe(e,t){if(Lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eSe=["data","width"],tSe=function(){function e(t){var r=this;Xwe(this,e),this.globalMeta=t,this.metas=new jO(function(){return r._createMeta()})}return Zwe(e,[{key:"updateMeta",value:function(r,n){var o=this.getMeta(r);Yt(o,n),Zb(o,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return Iwe(this.globalMeta.getMetaConstructor(),eSe).prototype}}]),e}();function jh(e){"@babel/helpers - typeof";return jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jh(e)}function rSe(e){return aSe(e)||iSe(e)||oSe(e)||nSe()}function nSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oSe(e,t){if(e){if(typeof e=="string")return FO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FO(e,t)}}function iSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aSe(e){if(Array.isArray(e))return FO(e)}function FO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uSe(n.key),n)}}function sSe(e,t,r){return t&&vM(e.prototype,t),r&&vM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uSe(e){var t=fSe(e,"string");return jh(t)==="symbol"?t:String(t)}function fSe(e,t){if(jh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cSe=function(){function e(t){var r=this;lSe(this,e),this.columnMeta=t,this.metas=new jO(function(){return r._createRow()})}return sSe(e,[{key:"updateMeta",value:function(r,n,o){var i=this.getMeta(r,n);Yt(i,o),Zb(i,o)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).remove(r,n)}},{key:"getMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);return o===void 0?i:i[o]}},{key:"setMeta",value:function(r,n,o,i){var a,l=this.metas.obtain(r).obtain(n);(a=l._automaticallyAssignedMetaProps)===null||a===void 0||a.delete(o),l[o]=i}},{key:"removeMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);delete i[o]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),o=0;o<n.length;o++)r.push.apply(r,rSe(n[o].values()));return r}},{key:"getMetasAtRow",value:function(r){sg(function(){return lg(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new jO(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),e}();function Fh(e){"@babel/helpers - typeof";return Fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fh(e)}function hSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vSe(n.key),n)}}function dSe(e,t,r){return t&&yM(e.prototype,t),r&&yM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vSe(e){var t=ySe(e,"string");return Fh(t)==="symbol"?t:String(t)}function ySe(e,t){if(Fh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UW=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];hSe(this,e),this.hot=t,this.globalMeta=new Nwe(t),this.tableMeta=new Bwe(this.globalMeta),this.columnMeta=new tSe(this.globalMeta),this.cellMeta=new cSe(this.columnMeta),o.forEach(function(i){return new i(r)}),this.globalMeta.updateMeta(n)}return dSe(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,o){var i=o.visualRow,a=o.visualColumn,l=this.cellMeta.getMeta(r,n);return l.visualRow=i,l.visualCol=a,l.row=r,l.col=n,this.runLocalHooks("afterGetCellMeta",l),l}},{key:"getCellMetaKeyValue",value:function(r,n,o){if(typeof o!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,o)}},{key:"setCellMeta",value:function(r,n,o,i){this.cellMeta.setMeta(r,n,o,i)}},{key:"updateCellMeta",value:function(r,n,o){this.cellMeta.updateMeta(r,n,o)}},{key:"removeCellMeta",value:function(r,n,o){this.cellMeta.removeMeta(r,n,o)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();bt(UW,Pr);function Sm(e){"@babel/helpers - typeof";return Sm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sm(e)}function gM(e,t,r,n){var o=n.hotInstance,i=n.dataMap,a=n.dataSource,l=n.internalSource,s=n.source,u=n.metaManager,f=n.firstRun,c=fn(l),h=o.getSettings();Array.isArray(h.dataSchema)?o.dataType="array":wt(h.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),e=o.runHooks("before".concat(c),e,f,s);var d=new Twe(o,e,u);if(t(d),Sm(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var v=d.getSchema();e=[];var g,p=0,w=0;for(p=0,w=h.startRows;p<w;p++)if((o.dataType==="object"||o.dataType==="function")&&h.dataSchema)g=yr(v),e.push(g);else if(o.dataType==="array")g=yr(v[0]),e.push(g);else{g=[];for(var S=0,C=h.startCols;S<C;S++)g.push(null);e.push(g)}}else throw new Error("".concat(l," only accepts array of objects or array of arrays (").concat(Sm(e)," given)"));Array.isArray(e[0])&&(o.dataType="array"),h.data=e,d.dataSource=e,a.data=e,a.dataType=o.dataType,a.colToProp=d.colToProp.bind(d),a.propToCol=d.propToCol.bind(d),a.countCachedColumns=d.countCachedColumns.bind(d),r(d),o.runHooks("after".concat(c),e,f,s),f||(o.runHooks("afterChange",null,l),o.render())}function Bh(e){"@babel/helpers - typeof";return Bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bh(e)}function gSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pSe(n.key),n)}}function mSe(e,t,r){return t&&mM(e.prototype,t),r&&mM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pSe(e){var t=bSe(e,"string");return Bh(t)==="symbol"?t:String(t)}function bSe(e,t){if(Bh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wSe=function(){function e(t){var r=this;gSe(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),be.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return mSe(e,[{key:"extendCellMeta",value:function(r){var n,o=r.row,i=r.col;if(!((n=this.metaSyncMemo.get(o))!==null&&n!==void 0&&n.has(i))){var a=r.visualRow,l=r.visualCol,s=this.metaManager.hot,u=s.colToProp(l);r.prop=u,s.runHooks("beforeGetCellMeta",a,l,r);var f=Dt(r,"type")?r.type:null,c=wt(r.cells)?r.cells(o,i,u):null;if(f)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:f}else c={type:f};c&&this.metaManager.updateCellMeta(o,i,c),s.runHooks("afterGetCellMeta",a,l,r),this.metaSyncMemo.has(o)||this.metaSyncMemo.set(o,new Set),this.metaSyncMemo.get(o).add(i)}}}]),e}();function Vh(e){"@babel/helpers - typeof";return Vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vh(e)}function SSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Se(n.key),n)}}function CSe(e,t,r){return t&&pM(e.prototype,t),r&&pM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Se(e){var t=OSe(e,"string");return Vh(t)==="symbol"?t:String(t)}function OSe(e,t){if(Vh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RSe=function(){function e(t){SSe(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var o=this.metaManager.hot.isRtl();if(o&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,o,i){if(!i)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return CSe(e,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,o){var i=n.target,a=n.onChange,l=a===void 0?function(){}:a,s=typeof i=="string",u=s?i:o,f="_".concat(u);r.metaManager.globalMeta.meta[f]=r.metaManager.globalMeta.meta[u],r.installPropWatcher(o,f,l),s&&r.installPropWatcher(i,f,l)})}},{key:"installPropWatcher",value:function(r,n,o){var i=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(l){var s=!i.usageTracker.has(r);i.usageTracker.add(r),o.call(i,r,l,s),this[n]=l},enumerable:!0,configurable:!0})}}]),e}(),bM=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),ay=function(t){return t.map(function(r){var n=r.toLowerCase();return bM.has(n)?bM.get(n):n}).sort().join("+")},ESe=function(t){return t.split("+")},wM=function(t){return t.toLowerCase()},SM;function TSe(e){return $Se(e)||kSe(e)||zW(e)||PSe()}function PSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $Se(e){if(Array.isArray(e))return BO(e)}function ASe(e,t){return xSe(e)||MSe(e,t)||zW(e,t)||ISe()}function ISe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zW(e,t){if(e){if(typeof e=="string")return BO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BO(e,t)}}function BO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function MSe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function xSe(e){if(Array.isArray(e))return e}function DSe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var NSe=function(t){var r=Rp({errorIdExists:function(f){return'The "'.concat(f,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=f.keys,h=f.callback,d=f.group,v=f.runOnlyIf,g=v===void 0?function(){return!0}:v,p=f.captureCtrl,w=p===void 0?!1:p,S=f.preventDefault,C=S===void 0?!0:S,P=f.stopPropagation,R=P===void 0?!1:P,V=f.relativeToGroup,U=f.position;if(pt(d))throw new Error("You need to define the shortcut's group.");if(wt(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(c)===!1)throw new Error(ft(SM||(SM=DSe([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var X={callback:h,group:d,runOnlyIf:g,captureCtrl:w,preventDefault:C,stopPropagation:R};if(pe(V)){var Y=[V,U];X.relativeToGroup=Y[0],X.position=Y[1]}c.forEach(function(q){var Z=ay(q),ie=r.hasItem(Z);if(ie){var J=r.getItem(Z),le=J.findIndex(function(Ce){return Ce.group===V});le!==-1?U==="before"?le-=1:le+=1:le=J.length,J.splice(le,0,X)}else r.addItem(Z,[X])})},o=function(f){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f.forEach(function(h){Ge(c,function(d,v){Object.prototype.hasOwnProperty.call(h,v)===!1&&(h[v]=c[v])}),n(h)})},i=function(f){var c=ay(f);r.removeItem(c)},a=function(f){var c=r.getItems();c.forEach(function(h){var d=ASe(h,2),v=d[0],g=d[1],p=g.filter(function(w){return w.group!==f});p.length===0?i(ESe(v)):(g.length=0,g.push.apply(g,TSe(p)))})},l=function(f){var c=ay(f),h=r.getItem(c);return pe(h)?h.slice():[]},s=function(f){var c=ay(f);return r.hasItem(c)};return{addShortcut:n,addShortcuts:o,getShortcuts:l,hasShortcut:s,removeShortcutsByKeys:i,removeShortcutsByGroup:a}};function HSe(){var e=new Set;return{press:function(r){e.add(r)},release:function(r){e.delete(r)},releaseAll:function(){e.clear()},isPressed:function(r){return e.has(r)}}}var LSe=["meta","alt","shift","control"],Wf=HSe();function jSe(e,t,r,n,o){var i=function(d){return LSe.includes(d)},a=function(d){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,g=[];return d.altKey&&g.push("alt"),v&&(d.ctrlKey||d.metaKey)?g.push("control/meta"):(d.ctrlKey&&g.push("control"),d.metaKey&&g.push("meta")),d.shiftKey&&g.push("shift"),g},l=function(d){if(t(d)!==!1){var v=r(d);if(!(d.keyCode===229||v===!1||Ll(d))){var g=wM(d.key),p=[];i(g)?Wf.press(g):p=a(d);var w=[g].concat(p),S=o(d,w);!S&&(J$()&&p.includes("meta")||!J$()&&p.includes("control"))&&o(d,[g].concat(a(d,!0))),n(d)}}},s=function(d){if(t(d)!==!1){var v=wM(d.key);i(v)!==!1&&Wf.release(v)}},u=function(){Wf.releaseAll()},f=function(){for(var d=e;d;)d.document.documentElement.addEventListener("keydown",l),d.document.documentElement.addEventListener("keyup",s),d.document.documentElement.addEventListener("blur",u),d=Bg(d)},c=function(){for(var d=e;d;)d.document.documentElement.removeEventListener("keydown",l),d.document.documentElement.removeEventListener("keyup",s),d.document.documentElement.removeEventListener("blur",u),d=Bg(d)};return{mount:f,unmount:c,isPressed:function(d){return Wf.isPressed(d)},releasePressedKeys:function(){return Wf.releaseAll()}}}var FSe=function(t){var r=t.ownerWindow,n=t.handleEvent,o=t.beforeKeyDown,i=t.afterKeyDown,a=Rp({errorIdExists:function(g){return'The "'.concat(g,'" context name is already registered.')}}),l="grid",s=function(g){var p=NSe(g);return a.addItem(g,p),p},u=function(){return l},f=function(g){return a.getItem(g)},c=function(g){l=g},h=!1,d=jSe(r,n,o,i,function(v,g){var p=f(u()),w=!1;if(!p.hasShortcut(g))return w;for(var S=p.getShortcuts(g),C=0;C<S.length;C++){var P=S[C],R=P.callback,V=P.runOnlyIf,U=P.preventDefault,X=P.stopPropagation,Y=P.captureCtrl;if(V(v)!==!1&&(h=Y,w=R(v,g)===!1,h=!1,U&&v.preventDefault(),X&&v.stopPropagation(),w))break}return w});return d.mount(),{addContext:s,getActiveContextName:u,getContext:f,setActiveContextName:c,isCtrlPressed:function(){return!h&&(d.isPressed("control")||d.isPressed("meta"))},releasePressedKeys:function(){return d.releasePressedKeys()},destroy:function(){return d.unmount()}}},CM,_M;function wr(e){"@babel/helpers - typeof";return wr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wr(e)}function OM(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function wn(e,t){return WSe(e)||VSe(e,t)||YW(e,t)||BSe()}function BSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VSe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function WSe(e){if(Array.isArray(e))return e}function gl(e){return YSe(e)||zSe(e)||YW(e)||USe()}function USe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YW(e,t){if(e){if(typeof e=="string")return VO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VO(e,t)}}function zSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function YSe(e){if(Array.isArray(e))return VO(e)}function VO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var GSe="gridDefault",VS=null,ly=new Set;function NT(e,t){var r,n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,a=this,l=new It(a),s,u,f,c,h=!0;oye(o)&&nye(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var d=(r=t==null?void 0:t.layoutDirection)!==null&&r!==void 0?r:"inherit",v=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},t.language=npe(t.language);var g=new UW(a,t,[wSe,RSe]),p=g.getTableMeta(),w=g.getGlobalMeta(),S=Rp();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),pO(this)&&oie(t.licenseKey,e),this.guid="ht_".concat(NB()),this.columnIndexMapper=new AO,this.rowIndexMapper=new AO,this.columnIndexMapper.addLocalHook("indexesSequenceChange",function(y){a.runHooks("afterColumnSequenceChange",y)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",function(y){a.runHooks("afterRowSequenceChange",y)}),u=new Pye(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var C=function(m){var b=m.row,_=m.col;return a._createCellCoords(b>=0?a.rowIndexMapper.getRenderableFromVisualIndex(b):b,_>=0?a.columnIndexMapper.getRenderableFromVisualIndex(_):_)},P=function(m){var b=m.row,_=m.col;return a._createCellCoords(b>=0?a.rowIndexMapper.getVisualFromRenderableIndex(b):b,_>=0?a.columnIndexMapper.getVisualFromRenderableIndex(_):_)},R=new iwe(p,{rowIndexMapper:function(){return a.rowIndexMapper},columnIndexMapper:function(){return a.columnIndexMapper},countCols:function(){return a.countCols()},countRows:function(){return a.countRows()},propToCol:function(m){return s.propToCol(m)},isEditorOpened:function(){return a.getActiveEditor()?a.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return a.getShortcutManager()},createCellCoords:function(m,b){return a._createCellCoords(m,b)},createCellRange:function(m,b,_){return a._createCellRange(m,b,_)},visualToRenderableCoords:C,renderableToVisualCoords:P,isDisabledCellSelection:function(m,b){return a.getCellMeta(m,b).disableVisualSelection}});this.selection=R;var V=function(m){var b=m.hiddenIndexesChanged;b&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",V),this.rowIndexMapper.addLocalHook("cacheUpdated",V),this.selection.addLocalHook("beforeSetRangeStart",function(y){n.runHooks("beforeSetRangeStart",y)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(y){n.runHooks("beforeSetRangeStartOnly",y)}),this.selection.addLocalHook("beforeSetRangeEnd",function(y){n.runHooks("beforeSetRangeEnd",y),y.row<0&&(y.row=n.view._wt.wtTable.getFirstVisibleRow()),y.col<0&&(y.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(y){var m=ss(!1),b=n.selection.getSelectedRange(),_=b.current(),T=_.from,A=_.to,F=b.size()-1;n.runHooks("afterSelection",T.row,T.col,A.row,A.col,m,F),n.runHooks("afterSelectionByProp",T.row,a.colToProp(T.col),A.row,a.colToProp(A.col),m,F);var W=n.selection.isSelectedByAnyHeader(),G=n.selection.selectedRange.current(),Q=!0;i&&(Q=!1),m.isTouched()&&(Q=!m.value);var ee=n.selection.isSelectedByRowHeader(),se=n.selection.isSelectedByColumnHeader();Q!==!1&&(W?ee?n.view.scrollViewportVertically(a.rowIndexMapper.getRenderableFromVisualIndex(y.row)):se&&n.view.scrollViewportHorizontally(a.columnIndexMapper.getRenderableFromVisualIndex(y.col)):G&&!n.selection.isMultiple()?n.view.scrollViewport(C(G.from)):n.view.scrollViewport(C(y))),ee&&se?re(n.rootElement,["ht__selection--rows","ht__selection--columns"]):ee?(je(n.rootElement,"ht__selection--columns"),re(n.rootElement,"ht__selection--rows")):se?(je(n.rootElement,"ht__selection--rows"),re(n.rootElement,"ht__selection--columns")):je(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(y){var m=y.length-1,b=y[m],_=b.from,T=b.to;n.runHooks("afterSelectionEnd",_.row,_.col,T.row,T.col,m),n.runHooks("afterSelectionEndByProp",_.row,a.colToProp(_.col),T.row,a.colToProp(T.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",function(y){var m=n.runHooks("afterIsMultipleSelection",y.value);y.value&&(y.value=m)}),this.selection.addLocalHook("beforeModifyTransformStart",function(y){n.runHooks("modifyTransformStart",y)}),this.selection.addLocalHook("afterModifyTransformStart",function(y,m,b){n.runHooks("afterModifyTransformStart",y,m,b)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(y){n.runHooks("modifyTransformEnd",y)}),this.selection.addLocalHook("afterModifyTransformEnd",function(y,m,b){n.runHooks("afterModifyTransformEnd",y,m,b)}),this.selection.addLocalHook("afterDeselect",function(){c.destroyEditor(),n._refreshBorders(),je(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(y){n.alter("insert_row_above",y,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(y){n.alter("insert_col_start",y,1,"auto")}),f={alter:function(m,b){var _,T,A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,F=arguments.length>3?arguments[3]:void 0,W=arguments.length>4?arguments[4]:void 0,G=function(He){if(He.length===0)return[];var Le=gl(He);Le.sort(function(it,et){var Ze=wn(it,1),Qe=Ze[0],Lt=wn(et,1),yt=Lt[0];return Qe===yt?0:Qe>yt?1:-1});var rt=ar(Le,function(it,et){var Ze=wn(et,2),Qe=Ze[0],Lt=Ze[1],yt=it[it.length-1],st=wn(yt,2),nt=st[0],Ai=st[1],Uo=nt+Ai;if(Qe<=Uo){var ol=Math.max(Lt-(Uo-Qe),0);yt[1]+=ol}else it.push([Qe,Lt]);return it},[Le[0]]);return rt};switch(m){case"insert_row":ly.has(m)||(ly.add(m),dt(ft(CM||(CM=OM(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),m)));case"insert_row_below":case"insert_row_above":var Q=a.countSourceRows();if(p.maxRows===Q)return;var ee=m==="insert_row_below"?"below":"above";b=(_=b)!==null&&_!==void 0?_:m==="insert_row"||ee==="below"?Q:0;var se=s.createRow(b,A,{source:F,mode:ee}),Te=se.delta,de=se.startPhysicalIndex;if(Te){var ye=R.selectedRange.current(),K=ye==null?void 0:ye.from,xe=K==null?void 0:K.row,Ke=a.toVisualRow(de);if(R.isSelectedByCorner())a.selectAll();else if(pe(xe)&&xe>=Ke){var $e=ye.to,Ie=$e.row,Ae=$e.col,O=K.col;R.isSelectedByRowHeader()&&(O=-1),R.getSelectedRange().pop(),R.setRangeStartOnly(a._createCellCoords(xe+Te,O),!0),R.setRangeEnd(a._createCellCoords(Ie+Te,Ae))}else a._refreshBorders()}break;case"insert_col":ly.has(m)||(ly.add(m),dt(ft(_M||(_M=OM(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),m)));case"insert_col_start":case"insert_col_end":var E=m==="insert_col_end"?"end":"start";b=(T=b)!==null&&T!==void 0?T:m==="insert_col"||E==="end"?a.countSourceCols():0;var $=s.createCol(b,A,{source:F,mode:E}),H=$.delta,M=$.startPhysicalIndex;if(H){if(Array.isArray(p.colHeaders)){var j=[a.toVisualColumn(M),0];j.length+=H,Array.prototype.splice.apply(p.colHeaders,j)}var x=R.selectedRange.current(),D=x==null?void 0:x.from,B=D==null?void 0:D.col,L=a.toVisualColumn(M);if(R.isSelectedByCorner())a.selectAll();else if(pe(B)&&B>=L){var z=x.to,ae=z.row,me=z.col,Ee=D.row;R.isSelectedByColumnHeader()&&(Ee=-1),R.getSelectedRange().pop(),R.setRangeStartOnly(a._createCellCoords(Ee,B+H),!0),R.setRangeEnd(a._createCellCoords(ae,me+H))}else a._refreshBorders()}break;case"remove_row":var Ne=function(He){var Le=0;I(He,function(rt){var it=wn(rt,2),et=it[0],Ze=it[1],Qe=qt(et)?a.countRows()-1:Math.max(et-Le,0);Number.isInteger(et)&&(et=Math.max(et-Le,0));var Lt=s.removeRow(et,Ze,F);if(Lt){var yt=a.countRows(),st=p.fixedRowsTop;st>=Qe+1&&(p.fixedRowsTop-=Math.min(Ze,st-Qe));var nt=p.fixedRowsBottom;nt&&Qe>=yt-nt&&(p.fixedRowsBottom-=Math.min(Ze,nt)),Le+=Ze}})};Array.isArray(b)?Ne(G(b)):Ne([[b,A]]),f.adjustRowsAndCols(),a._refreshBorders();break;case"remove_col":var Xe=function(He){var Le=0;I(He,function(rt){var it=wn(rt,2),et=it[0],Ze=it[1],Qe=qt(et)?a.countCols()-1:Math.max(et-Le,0),Lt=a.toPhysicalColumn(Qe);Number.isInteger(et)&&(et=Math.max(et-Le,0));var yt=s.removeCol(et,Ze,F);if(yt){var st=p.fixedColumnsStart;st>=Qe+1&&(p.fixedColumnsStart-=Math.min(Ze,st-Qe)),Array.isArray(p.colHeaders)&&(typeof Lt>"u"&&(Lt=-1),p.colHeaders.splice(Lt,Ze)),Le+=Ze}})};Array.isArray(b)?Xe(G(b)):Xe([[b,A]]),f.adjustRowsAndCols(),a._refreshBorders();break;default:throw new Error('There is no such action "'.concat(m,'"'))}W||f.adjustRowsAndCols()},adjustRowsAndCols:function(){var m=p.minRows,b=p.minSpareRows,_=p.minCols,T=p.minSpareCols;if(a.countRows()===0&&a.countCols()===0&&R.deselect(),m){var A=a.countRows();A<m&&s.createRow(A,m-A,{source:"auto"})}if(b){var F=a.countEmptyRows(!0);if(F<b){var W=b-F,G=Math.min(W,p.maxRows-a.countSourceRows());s.createRow(a.countRows(),G,{source:"auto"})}}{var Q;(_||T)&&(Q=a.countEmptyCols(!0));var ee=a.countCols();if(_&&!p.columns&&ee<_){var se=_-ee;Q+=se,s.createCol(ee,se,{source:"auto"})}if(T&&!p.columns&&a.dataType==="array"&&Q<T){ee=a.countCols();var Te=T-Q,de=Math.min(Te,p.maxCols-ee);s.createCol(ee,de,{source:"auto"})}}if(R.isSelected()){var ye=a.countRows(),K=a.countCols();I(R.selectedRange,function(xe){var Ke=!1,$e=xe.from.row,Ie=xe.from.col,Ae=xe.to.row,O=xe.to.col;$e>ye-1?($e=ye-1,Ke=!0,Ae>$e&&(Ae=$e)):Ae>ye-1&&(Ae=ye-1,Ke=!0,$e>Ae&&($e=Ae)),Ie>K-1?(Ie=K-1,Ke=!0,O>Ie&&(O=Ie)):O>K-1&&(O=K-1,Ke=!0,Ie>O&&(Ie=O)),Ke&&a.selectCell($e,Ie,Ae,O)})}a.view&&a.view.adjustElementsSize()},populateFromArray:function(m,b,_,T,A,F,W){var G,Q,ee,se,Te=[],de={},ye=[],K=m.row,xe=m.col;if(Q=b.length,Q===0)return!1;var Ke=0,$e=0;switch(Ye(_)&&(Ke=_.col-xe+1,$e=_.row-K+1),A){case"shift_down":var Ie=zy(b),Ae=Ie.length,O=Math.max(Ae,Ke),E=a.getData().slice(K),$=zy(E).slice(xe,xe+O);for(ee=0;ee<O;ee+=1)if(ee<Ae){for(G=0,Q=Ie[ee].length;G<$e-Q;G+=1)Ie[ee].push(Ie[ee][G%Q]);ee<$.length?ye.push(Ie[ee].concat($[ee])):ye.push(Ie[ee].concat(new Array(E.length).fill(null)))}else ye.push(Ie[ee%Ae].concat($[ee]));a.populateFromArray(K,xe,zy(ye));break;case"shift_right":var H=b.length,M=Math.max(H,$e),j=a.getData().slice(K).map(function(st){return st.slice(xe)});for(G=0;G<M;G+=1)if(G<H){for(ee=0,se=b[G].length;ee<Ke-se;ee+=1)b[G].push(b[G][ee%se]);if(G<j.length)for(var x=0;x<j[G].length;x+=1)b[G].push(j[G][x]);else{var D;(D=b[G]).push.apply(D,gl(new Array(j[0].length).fill(null)))}}else b.push(b[G%Q].slice(0,M).concat(j[G]));a.populateFromArray(K,xe,b);break;case"overwrite":default:de.row=m.row,de.col=m.col;var B={row:_&&m?_.row-m.row+1:1,col:_&&m?_.col-m.col+1:1},L=0,z=0,ae=!0,me,Ee=function(nt){var Ai=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,Uo=b[nt%b.length];return Ai!==null?Uo[Ai%Uo.length]:Uo},Ne=b.length,Xe=_?_.row-m.row+1:0;for(_?Q=Xe:Q=Math.max(Ne,Xe),G=0;G<Q&&!(_&&de.row>_.row&&Xe>Ne||!p.allowInsertRow&&de.row>a.countRows()-1||de.row>=p.maxRows);G++){var ht=G-L,He=Ee(ht).length,Le=_?_.col-m.col+1:0;if(_?se=Le:se=Math.max(He,Le),de.col=m.col,me=a.getCellMeta(de.row,de.col),(T==="CopyPaste.paste"||T==="Autofill.fill")&&me.skipRowOnPaste){L+=1,de.row+=1,Q+=1;continue}for(z=0,ee=0;ee<se&&!(_&&de.col>_.col&&Le>He||!p.allowInsertColumn&&de.col>a.countCols()-1||de.col>=p.maxCols);ee++){if(me=a.getCellMeta(de.row,de.col),(T==="CopyPaste.paste"||T==="Autofill.fill")&&me.skipColumnOnPaste){z+=1,de.col+=1,se+=1;continue}if(me.readOnly&&T!=="UndoRedo.undo"){de.col+=1;continue}var rt=ee-z,it=Ee(ht,rt),et=a.getDataAtCell(de.row,de.col),Ze={row:ht,col:rt};if(T==="Autofill.fill"){var Qe=a.runHooks("beforeAutofillInsidePopulate",Ze,F,b,W,{},B);Qe&&(it=pt(Qe.value)?it:Qe.value)}if(it!==null&&wr(it)==="object")if(Array.isArray(it)&&et===null&&(et=[]),et===null||wr(et)!=="object")ae=!1;else{var Lt=$c(Array.isArray(et)?et:et[0]||et),yt=$c(Array.isArray(it)?it:it[0]||it);D0(Lt,yt)||Array.isArray(Lt)&&Array.isArray(yt)?it=yr(it):ae=!1}else et!==null&&wr(et)==="object"&&(ae=!1);ae&&Te.push([de.row,de.col,it]),ae=!0,de.col+=1}de.row+=1}a.setDataAtCell(Te,null,null,T||"populateFromArray");break}}};function U(y){var m=CW(y);IT(m)?(a.runHooks("beforeLanguageChange",m),w.language=m,a.runHooks("afterLanguageChange",m)):_W(y)}function X(y,m){var b=y==="className"?a.rootElement:a.table;if(h)re(b,m);else{var _=[],T=[];w[y]&&(_=Array.isArray(w[y])?w[y]:q$(w[y])),m&&(T=Array.isArray(m)?m:q$(m));var A=K$(_,T),F=K$(T,_);A.length&&je(b,A),F.length&&re(b,F)}w[y]=m}this.init=function(){u.setData(p.data),a.runHooks("beforeInit"),(xn()||BF())&&re(a.rootElement,"mobile"),this.updateSettings(p,!0),this.view=new pye(this),c=Sae.getInstance(a,p,R),a.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&a.rootElement.offsetParent===null&&wie(a.rootElement,function(){a.view._wt.wtOverlays.updateLastSpreaderSize(),a.render(),a.view.adjustElementsSize()}),wr(h)==="object"&&(a.runHooks("afterChange",h[0],h[1]),h=!1),a.runHooks("afterInit")};function Y(){var y=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,y=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&y===!1&&(y=!0,this.onQueueEmpty(this.valid))}}}function q(y){var m=y.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):y}function Z(y,m,b){if(y.length){var _=a.getActiveEditor(),T=a.runHooks("beforeChange",y,m||"edit"),A=!0;if(T===!1){_&&_.cancelChanges();return}var F=new Y;F.onQueueEmpty=function(ye){_&&A&&_.cancelChanges(),b(ye)};for(var W=y.length-1;W>=0;W--)if(y[W]===null)y.splice(W,1);else{var G=wn(y[W],4),Q=G[0],ee=G[1],se=G[3],Te=s.propToCol(ee),de=a.getCellMeta(Q,Te);de.type==="numeric"&&typeof se=="string"&&ble(se)&&(y[W][3]=q(se)),a.getCellValidator(de)&&(F.addValidatorToQueue(),a.validateCell(y[W][3],de,function(ye,K){return function(xe){if(typeof xe!="boolean")throw new Error("Validation error: result is not boolean");if(xe===!1&&K.allowInvalid===!1){A=!1,y.splice(ye,1),K.valid=!0;var Ke=a.getCell(K.visualRow,K.visualCol);Ke!==null&&je(Ke,p.invalidCellClassName)}F.removeValidatorFormQueue()}}(W,de),m))}F.checkIfQueueIsEmpty()}}function ie(y,m){var b=y.length-1;if(!(b<0)){for(;b>=0;b--){var _=!1;if(y[b]===null){y.splice(b,1);continue}if(!((y[b][2]===null||y[b][2]===void 0)&&(y[b][3]===null||y[b][3]===void 0))){if(p.allowInsertRow)for(;y[b][0]>a.countRows()-1;){var T=s.createRow(void 0,void 0,{source:m}),A=T.delta;if(A===0){_=!0;break}}if(a.dataType==="array"&&(!p.columns||p.columns.length===0)&&p.allowInsertColumn)for(;s.propToCol(y[b][1])>a.countCols()-1;){var F=s.createCol(void 0,void 0,{source:m}),W=F.delta;if(W===0){_=!0;break}}_||s.set(y[b][0],y[b][1],y[b][3])}}a.forceFullRender=!0,f.adjustRowsAndCols(),a.runHooks("beforeChangeRender",y,m),c.lockEditor(),a._refreshBorders(null),c.unlockEditor(),a.view.adjustElementsSize(),a.runHooks("afterChange",y,m||"edit");var G=a.getActiveEditor();G&&pe(G.refreshValue)&&G.refreshValue()}}this._createCellCoords=function(y,m){return a.view._wt.createCellCoords(y,m)},this._createCellRange=function(y,m,b){return a.view._wt.createCellRange(y,m,b)},this.validateCell=function(y,m,b,_){var T=a.getCellValidator(m);function A(F){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!W||m.hidden===!0){b(F);return}var G=m.visualCol,Q=m.visualRow,ee=a.getCell(Q,G,!0);if(ee&&ee.nodeName!=="TH"){var se=a.rowIndexMapper.getRenderableFromVisualIndex(Q),Te=a.columnIndexMapper.getRenderableFromVisualIndex(G);a.view._wt.getSetting("cellRenderer",se,Te,ee)}b(F)}tie(T)&&(T=function(F){return function(W,G){G(F.test(W))}}(T)),wt(T)?(y=a.runHooks("beforeValidate",y,m.visualRow,m.prop,_),a._registerImmediate(function(){T.call(m,y,function(F){a&&(F=a.runHooks("afterValidate",F,y,m.visualRow,m.prop,_),m.valid=F,A(F),a.runHooks("postAfterValidate",F,y,m.visualRow,m.prop,_))})})):a._registerImmediate(function(){m.valid=!0,A(m.valid,!1)})};function J(y,m,b){return Array.isArray(y)?y:[[y,m,b]]}this.setDataAtCell=function(y,m,b,_){var T=J(y,m,b),A=[],F=_,W,G,Q;for(W=0,G=T.length;W<G;W++){if(wr(T[W])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof T[W][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");T[W][1]>=this.countCols()?Q=T[W][1]:Q=s.colToProp(T[W][1]),A.push([T[W][0],Q,u.getAtCell(this.toPhysicalRow(T[W][0]),T[W][1]),T[W][2]])}!F&&wr(y)==="object"&&(F=m),a.runHooks("afterSetDataAtCell",A,F),Z(A,F,function(){ie(A,F)})},this.setDataAtRowProp=function(y,m,b,_){var T=J(y,m,b),A=[],F=_,W,G;for(W=0,G=T.length;W<G;W++)A.push([T[W][0],T[W][1],u.getAtCell(this.toPhysicalRow(T[W][0]),T[W][1]),T[W][2]]);!F&&wr(y)==="object"&&(F=m),a.runHooks("afterSetDataAtRowProp",A,F),Z(A,F,function(){ie(A,F)})},this.listen=function(){a&&!a.isListening()&&(VS=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(VS=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return VS===a.guid},this.destroyEditor=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;a._refreshBorders(y,m)},this.populateFromArray=function(y,m,b,_,T,A,F,W,G){if(!(wr(b)==="object"&&wr(b[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var Q=typeof _=="number"?a._createCellCoords(_,T):null;return f.populateFromArray(a._createCellCoords(y,m),b,Q,A,F,W,G)},this.spliceCol=function(y,m,b){for(var _,T=arguments.length,A=new Array(T>3?T-3:0),F=3;F<T;F++)A[F-3]=arguments[F];return(_=s).spliceCol.apply(_,[y,m,b].concat(A))},this.spliceRow=function(y,m,b){for(var _,T=arguments.length,A=new Array(T>3?T-3:0),F=3;F<T;F++)A[F-3]=arguments[F];return(_=s).spliceRow.apply(_,[y,m,b].concat(A))},this.getSelected=function(){if(R.isSelected())return ze(R.getSelectedRange(),function(y){var m=y.from,b=y.to;return[m.row,m.col,b.row,b.col]})},this.getSelectedLast=function(){var y=this.getSelected(),m;return y&&y.length>0&&(m=y[y.length-1]),m},this.getSelectedRange=function(){if(R.isSelected())return Array.from(R.getSelectedRange())},this.getSelectedRangeLast=function(){var y=this.getSelectedRange(),m;return y&&y.length>0&&(m=y[y.length-1]),m},this.emptySelectedCells=function(y){var m=this;if(!(!R.isSelected()||this.countRows()===0||this.countCols()===0)){var b=[];I(R.getSelectedRange(),function(_){var T=_.getTopStartCorner(),A=_.getBottomEndCorner();Re(T.row,A.row,function(F){Re(T.col,A.col,function(W){m.getCellMeta(F,W).readOnly||b.push([F,W,null])})})}),b.length>0&&this.setDataAtCell(b,y)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var y=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(y,0),!this.isRenderSuspended()&&y===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(c.lockEditor(),this._refreshBorders(null),c.unlockEditor()))},this.batchRender=function(y){this.suspendRender();var m=y();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||y)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(y){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var b=y();return this.resumeExecution(m),b},this.batch=function(y){this.suspendRender(),this.suspendExecution();var m=y();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(a.view){var y=a.view.getLastSize(),m=y.width,b=y.height,_=a.rootElement.getBoundingClientRect(),T=_.width,A=_.height,F=T!==m||A!==b,W=a.runHooks("beforeRefreshDimensions",{width:m,height:b},{width:T,height:A},F)===!1;W||((F||a.view._wt.wtOverlays.scrollableElement===a.rootWindow)&&(a.view.setLastSize(T,A),a.render()),a.runHooks("afterRefreshDimensions",{width:m,height:b},{width:T,height:A},F))}},this.updateData=function(y,m){var b=this;gM(y,function(_){s=_},function(_){s=_,a.columnIndexMapper.fitToLength(b.getInitialColumnCount()),a.rowIndexMapper.fitToLength(b.countSourceRows()),f.adjustRowsAndCols()},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"updateData",source:m,metaManager:g,firstRun:h})},this.loadData=function(y,m){gM(y,function(b){s=b},function(){g.clearCellsCache(),a.initIndexMappers(),f.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"loadData",source:m,metaManager:g,firstRun:h})},this.getInitialColumnCount=function(){var y=p.columns,m=0;if(Array.isArray(y))m=y.length;else if(wt(y))if(a.dataType==="array")for(var b=this.countSourceCols(),_=0;_<b;_+=1)y(_)&&(m+=1);else(a.dataType==="object"||a.dataType==="function")&&(m=s.colToPropCache.length);else if(pe(p.dataSchema)){var T=s.getSchema();m=Array.isArray(T)?T.length:N0(T)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(y,m,b,_){return pt(y)?s.getAll():s.getRange(a._createCellCoords(y,m),a._createCellCoords(b,_),s.DESTINATION_RENDERER)},this.getCopyableText=function(y,m,b,_){return s.getCopyableText(a._createCellCoords(y,m),a._createCellCoords(b,_))},this.getCopyableData=function(y,m){return s.getCopyable(y,s.colToProp(m))},this.getSchema=function(){return s.getSchema()},this.updateSettings=function(y){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,b=(h?a.loadData:a.updateData).bind(this),_=!1,T,A;if(pe(y.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(pe(y.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(pe(y.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(T in y)T==="data"||(T==="language"?U(y.language):T==="className"?X("className",y.className):T==="tableClassName"&&a.table?(X("tableClassName",y.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames()):be.getSingleton().isRegistered(T)||be.getSingleton().isDeprecated(T)?(wt(y[T])||Array.isArray(y[T]))&&(y[T].initialHook=!0,a.addHook(T,y[T])):!m&&Dt(y,T)&&(w[T]=y[T]));y.data===void 0&&p.data===void 0?b(null,"updateSettings"):y.data!==void 0?b(y.data,"updateSettings"):y.columns!==void 0&&(s.createMap(),a.initIndexMappers());var F=a.countCols(),W=p.columns;if(W&&wt(W)&&(_=!0),(y.cell!==void 0||y.cells!==void 0||y.columns!==void 0)&&g.clearCache(),F>0)for(T=0,A=0;T<F;T++){if(W){var G=_?W(T):W[A];G&&g.updateColumnMeta(A,G)}A+=1}pe(y.cell)&&Ge(y.cell,function(ye){a.setCellMetaObject(ye.row,ye.col,ye)}),a.runHooks("afterCellMetaReset");var Q=a.rootElement.style.height;Q!==""&&(Q=parseInt(a.rootElement.style.height,10));var ee=y.height;if(wt(ee)&&(ee=ee()),m){var se=a.rootElement.getAttribute("style");se&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"))}if(ee===null){var Te=a.rootElement.getAttribute("data-initialstyle");Te&&(Te.indexOf("height")>-1||Te.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",Te):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else ee!==void 0&&(a.rootElement.style.height=isNaN(ee)?"".concat(ee):"".concat(ee,"px"),a.rootElement.style.overflow="hidden");if(typeof y.width<"u"){var de=y.width;wt(de)&&(de=de()),a.rootElement.style.width=isNaN(de)?"".concat(de):"".concat(de,"px")}m||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",y)),f.adjustRowsAndCols(),a.view&&!h&&(a.forceFullRender=!0,c.lockEditor(),a._refreshBorders(null),a.view._wt.wtOverlays.adjustElementsSize(),c.unlockEditor()),!m&&a.view&&(Q===""||ee===""||ee===void 0)&&Q!==ee&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var y=a.getSelectedLast();if(p.getValue){if(wt(p.getValue))return p.getValue.call(a);if(y)return a.getData()[y[0][0]][p.getValue]}else if(y)return a.getDataAtCell(y[0],y[1])},this.getSettings=function(){return p},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(y,m,b,_,T){f.alter(y,m,b,_,T)},this.getCell=function(y,m){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,_=m,T=y;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;_=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(y>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(y)))return null;T=this.rowIndexMapper.getRenderableFromVisualIndex(y)}return T===null||_===null?null:a.view.getCellAtCoords(a._createCellCoords(T,_),b)},this.getCoords=function(y){var m=this.view._wt.wtTable.getCoords(y);if(m===null)return null;var b=m.row,_=m.col,T=b,A=_;return b>=0&&(T=this.rowIndexMapper.getVisualFromRenderableIndex(b)),_>=0&&(A=this.columnIndexMapper.getVisualFromRenderableIndex(_)),a._createCellCoords(T,A)},this.colToProp=function(y){return s.colToProp(y)},this.propToCol=function(y){return s.propToCol(y)},this.toVisualRow=function(y){return n.rowIndexMapper.getVisualFromPhysicalIndex(y)},this.toVisualColumn=function(y){return n.columnIndexMapper.getVisualFromPhysicalIndex(y)},this.toPhysicalRow=function(y){return n.rowIndexMapper.getPhysicalFromVisualIndex(y)},this.toPhysicalColumn=function(y){return n.columnIndexMapper.getPhysicalFromVisualIndex(y)},this.getDataAtCell=function(y,m){return s.get(y,s.colToProp(m))},this.getDataAtRowProp=function(y,m){return s.get(y,m)},this.getDataAtCol=function(y){for(var m=[],b=s.getRange(a._createCellCoords(0,y),a._createCellCoords(p.data.length-1,y),s.DESTINATION_RENDERER),_=0;_<b.length;_+=1)for(var T=0;T<b[_].length;T+=1)m.push(b[_][T]);return m},this.getDataAtProp=function(y){for(var m=[],b=s.getRange(a._createCellCoords(0,s.propToCol(y)),a._createCellCoords(p.data.length-1,s.propToCol(y)),s.DESTINATION_RENDERER),_=0;_<b.length;_+=1)for(var T=0;T<b[_].length;T+=1)m.push(b[_][T]);return m},this.getSourceData=function(y,m,b,_){var T;return y===void 0?T=u.getData():T=u.getByRange(a._createCellCoords(y,m),a._createCellCoords(b,_)),T},this.getSourceDataArray=function(y,m,b,_){var T;return y===void 0?T=u.getData(!0):T=u.getByRange(a._createCellCoords(y,m),a._createCellCoords(b,_),!0),T},this.getSourceDataAtCol=function(y){return u.getAtColumn(y)},this.setSourceDataAtCell=function(y,m,b,_){var T=J(y,m,b),A=this.hasHook("afterSetSourceDataAtCell"),F=[];A&&I(T,function(G){var Q=wn(G,3),ee=Q[0],se=Q[1],Te=Q[2];F.push([ee,se,u.getAtCell(ee,se),Te])}),I(T,function(G){var Q=wn(G,3),ee=Q[0],se=Q[1],Te=Q[2];u.setAtCell(ee,se,Te)}),A&&this.runHooks("afterSetSourceDataAtCell",F,_),this.render();var W=a.getActiveEditor();W&&pe(W.refreshValue)&&W.refreshValue()},this.getSourceDataAtRow=function(y){return u.getAtRow(y)},this.getSourceDataAtCell=function(y,m){return u.getAtCell(y,m)},this.getDataAtRow=function(y){var m=s.getRange(a._createCellCoords(y,0),a._createCellCoords(y,this.countCols()-1),s.DESTINATION_RENDERER);return m[0]||[]},this.getDataType=function(y,m,b,_){var T=this,A=y===void 0?[0,0,this.countRows(),this.countCols()]:[y,m,b,_],F=A[0],W=A[1],G=A[2],Q=A[3],ee=null,se=null;G===void 0&&(G=F),Q===void 0&&(Q=W);var Te="mixed";return Re(Math.max(Math.min(F,G),0),Math.max(F,G),function(de){var ye=!0;return Re(Math.max(Math.min(W,Q),0),Math.max(W,Q),function(K){var xe=T.getCellMeta(de,K);return se=xe.type,ee?ye=ee===se:ee=se,ye}),Te=ye?se:"mixed",ye}),Te},this.removeCellMeta=function(y,m,b){var _=[this.toPhysicalRow(y),this.toPhysicalColumn(m)],T=_[0],A=_[1],F=g.getCellMetaKeyValue(T,A,b),W=a.runHooks("beforeRemoveCellMeta",y,m,b,F);W!==!1&&(g.removeCellMeta(T,A,b),a.runHooks("afterRemoveCellMeta",y,m,b,F)),F=null},this.spliceCellsMeta=function(y){for(var m=this,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_=arguments.length,T=new Array(_>2?_-2:0),A=2;A<_;A++)T[A-2]=arguments[A];if(T.length>0&&!Array.isArray(T[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");b>0&&g.removeRow(this.toPhysicalRow(y),b),T.length>0&&I(T.reverse(),function(F){g.createRow(m.toPhysicalRow(y)),I(F,function(W,G){return m.setCellMetaObject(y,G,W)})}),a.render()},this.setCellMetaObject=function(y,m,b){var _=this;wr(b)==="object"&&Ge(b,function(T,A){_.setCellMeta(y,m,A,T)})},this.setCellMeta=function(y,m,b,_){var T=a.runHooks("beforeSetCellMeta",y,m,b,_);if(T!==!1){var A=y,F=m;y<this.countRows()&&(A=this.toPhysicalRow(y)),m<this.countCols()&&(F=this.toPhysicalColumn(m)),g.setCellMeta(A,F,b,_),a.runHooks("afterSetCellMeta",y,m,b,_)}},this.getCellsMeta=function(){return g.getCellsMeta()},this.getCellMeta=function(y,m){var b=this.toPhysicalRow(y),_=this.toPhysicalColumn(m);return b===null&&(b=y),_===null&&(_=m),g.getCellMeta(b,_,{visualRow:y,visualColumn:m})},this.getCellMetaAtRow=function(y){return g.getCellsMetaAtRow(y)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||p.columns)},this.getCellRenderer=function(y,m){var b=typeof y=="number"?a.getCellMeta(y,m).renderer:y.renderer;return typeof b=="string"?q1(b):pt(b)?q1("text"):b},this.getCellEditor=function(y,m){var b=typeof y=="number"?a.getCellMeta(y,m).editor:y.editor;return typeof b=="string"?D1(b):pt(b)?D1("text"):b},this.getCellValidator=function(y,m){var b=typeof y=="number"?a.getCellMeta(y,m).validator:y.validator;return typeof b=="string"?hse(b):b},this.validateCells=function(y){this._validateCells(y)},this.validateRows=function(y,m){if(!Array.isArray(y))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,y)},this.validateColumns=function(y,m){if(!Array.isArray(y))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,y)},this._validateCells=function(y,m,b){var _=new Y;y&&(_.onQueueEmpty=y);for(var T=a.countRows()-1;T>=0;){if(m!==void 0&&m.indexOf(T)===-1){T-=1;continue}for(var A=a.countCols()-1;A>=0;){if(b!==void 0&&b.indexOf(A)===-1){A-=1;continue}_.addValidatorToQueue(),a.validateCell(a.getDataAtCell(T,A),a.getCellMeta(T,A),function(F){if(typeof F!="boolean")throw new Error("Validation error: result is not boolean");F===!1&&(_.valid=!1),_.removeValidatorFormQueue()},"validateCells"),A-=1}T-=1}_.checkIfQueueIsEmpty()},this.getRowHeader=function(y){var m=p.rowHeaders,b=y;return b!==void 0&&(b=a.runHooks("modifyRowHeader",b)),b===void 0?(m=[],Re(a.countRows()-1,function(_){m.push(a.getRowHeader(_))})):Array.isArray(m)&&m[b]!==void 0?m=m[b]:wt(m)?m=m(b):m&&typeof m!="string"&&typeof m!="number"&&(m=b+1),m},this.hasRowHeaders=function(){return!!p.rowHeaders},this.hasColHeaders=function(){if(p.colHeaders!==void 0&&p.colHeaders!==null)return!!p.colHeaders;for(var y=0,m=a.countCols();y<m;y++)if(a.getColHeader(y))return!0;return!1},this.getColHeader=function(y){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,b=a.runHooks("modifyColHeader",y);if(b===void 0){for(var _=[],T=a.countCols(),A=0;A<T;A++)_.push(a.getColHeader(A));return _}var F=p.colHeaders,W=function(se){for(var Te=[],de=a.countCols(),ye=0;ye<de;ye++)wt(p.columns)&&p.columns(ye)&&Te.push(ye);return Te[se]},G=a.toPhysicalColumn(b),Q=W(G);return p.colHeaders===!1?F=null:p.columns&&wt(p.columns)&&p.columns(Q)&&p.columns(Q).title?F=p.columns(Q).title:p.columns&&p.columns[G]&&p.columns[G].title?F=p.columns[G].title:Array.isArray(p.colHeaders)&&p.colHeaders[G]!==void 0?F=p.colHeaders[G]:wt(p.colHeaders)?F=p.colHeaders(G):p.colHeaders&&typeof p.colHeaders!="string"&&typeof p.colHeaders!="number"&&(F=wye(b)),F=a.runHooks("modifyColumnHeaderValue",F,y,m),F},this._getColWidthFromSettings=function(y){var m;if(y>=0){var b=a.getCellMeta(0,y);m=b.width}if((m===void 0||m===p.width)&&(m=p.colWidths),m!=null){switch(wr(m)){case"object":m=m[y];break;case"function":m=m(y);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(y){var m=a._getColWidthFromSettings(y);return m=a.runHooks("modifyColWidth",m,y),m===void 0&&(m=cT.DEFAULT_WIDTH),m},this._getRowHeightFromSettings=function(y){var m=p.rowHeights;if(m!=null){switch(wr(m)){case"object":m=m[y];break;case"function":m=m(y);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getRowHeight=function(y){var m=a._getRowHeightFromSettings(y);return m=a.runHooks("modifyRowHeight",m,y),m},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return s.getLength()},this.countCols=function(){var y=p.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(y,m)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return Y_(a.countRows()-1,function(b){if(a.isEmptyRow(b))m+=1;else if(y===!0)return!1}),m},this.countEmptyCols=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return Y_(a.countCols()-1,function(b){if(a.isEmptyCol(b))m+=1;else if(y===!0)return!1}),m},this.isEmptyRow=function(y){return p.isEmptyRow.call(a,y)},this.isEmptyCol=function(y){return p.isEmptyCol.call(a,y)},this.selectCell=function(y,m,b,_){var T=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,A=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return pt(y)||pt(m)?!1:this.selectCells([[y,m,b,_]],T,A)},this.selectCells=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&(i=!0);var _=R.selectCells(y);return _&&b&&a.listen(),i=!1,_},this.selectColumns=function(y){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y;return R.selectColumns(y,m)},this.selectRows=function(y){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y;return R.selectRows(y,m)},this.deselectCell=function(){R.deselect()},this.selectAll=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=y&&this.hasRowHeaders(),b=y&&this.hasColHeaders();i=!0,R.selectAll(m,b),i=!1};var le=function(m,b){return m.getNearestNotHiddenIndex(b,1,!0)};this.scrollViewportTo=function(y,m){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,_=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,T=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,A=!b,F=!_,W=y,G=m;if(T){var Q=Number.isInteger(y),ee=Number.isInteger(m),se=Q?le(this.rowIndexMapper,y):void 0,Te=ee?le(this.columnIndexMapper,m):void 0;if(se===null||Te===null)return!1;W=Q?a.rowIndexMapper.getRenderableFromVisualIndex(se):void 0,G=ee?a.columnIndexMapper.getRenderableFromVisualIndex(Te):void 0}var de=Number.isInteger(W),ye=Number.isInteger(G);return de&&ye?a.view.scrollViewport(a._createCellCoords(W,G),A,_,b,F):de&&ye===!1?a.view.scrollViewportVertically(W,A,b):ye&&de===!1?a.view.scrollViewportHorizontally(G,_,F):!1},this.destroy=function(){if(a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),g.clearCache(),pO(a)){var y=this.rootDocument.querySelector(".hot-display-license-info");y&&y.parentNode.removeChild(y)}Hn(a.rootElement),l.destroy(),c&&c.destroy(),a.batchExecution(function(){a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),S.getItems().forEach(function(m){var b=wn(m,2),_=b[1];_.destroy()}),S.clear(),a.runHooks("afterDestroy")},!0),be.getSingleton().destroy(a),Ge(a,function(m,b,_){wt(m)?_[b]=Ce(b):b!=="guid"&&(_[b]=null)}),a.isDestroyed=!0,s&&s.destroy(),s=null,f=null,R=null,c=null,a=null};function Ce(y){return function(){throw new Error('The "'.concat(y,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(y){var m=fn(y);return m==="UndoRedo"?this.undoRedo:S.getItem(m)},this.getPluginName=function(y){return y===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:S.getId(y)},this.getInstance=function(){return a},this.addHook=function(y,m){be.getSingleton().add(y,m,a)},this.hasHook=function(y){return be.getSingleton().has(y,a)||be.getSingleton().has(y)},this.addHookOnce=function(y,m){be.getSingleton().once(y,m,a)},this.removeHook=function(y,m){be.getSingleton().remove(y,m,a)},this.runHooks=function(y,m,b,_,T,A,F){return be.getSingleton().run(a,y,m,b,_,T,A,F)},this.getTranslatedPhrase=function(y,m){return kW(p.language,y,m)},this.toHTML=function(){return U1(n)},this.toTableElement=function(){var y=n.rootDocument.createElement("div");return y.insertAdjacentHTML("afterbegin",U1(n)),y.firstElementChild},this.timeouts=[],this._registerTimeout=function(y){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=y;typeof b=="function"&&(b=setTimeout(b,m)),this.timeouts.push(b)},this._clearTimeouts=function(){I(this.timeouts,function(y){clearTimeout(y)})},this.immediates=[],this._registerImmediate=function(y){this.immediates.push(setImmediate(y))},this._clearImmediates=function(){I(this.immediates,function(y){clearImmediate(y)})},this._refreshBorders=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.destroyEditor(y),a.view.render(),m&&R.isSelected()&&c.prepareEditor()},this.isRtl=function(){return a.rootWindow.getComputedStyle(a.rootElement).direction==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1};var we=FSe({handleEvent:function(m){var b=a.isListening(),_=(m==null?void 0:m.key)!==void 0;return b&&_},beforeKeyDown:function(m){return n.runHooks("beforeKeyDown",m)},afterKeyDown:function(m){n.isDestroyed||a.runHooks("afterDocumentKeyDown",m)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(y){y.ctrlKey===!1&&y.metaKey===!1&&we.releasePressedKeys()}),this.getShortcutManager=function(){return we};var _e=we.addContext("grid"),k={runOnlyIf:function(){return pe(a.getSelected())&&a.countRenderedRows()>0&&a.countRenderedCols()>0},group:GSe};we.setActiveContextName("grid"),_e.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){a.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var m=a.getSelectedRange(),b=m[m.length-1].highlight,_=b.row,T=b.col,A=a.getDataAtCell(_,T),F=new Map,W=0;W<m.length;W++)m[W].forAll(function(G,Q){if(G>=0&&Q>=0&&(G!==_||Q!==T)){var ee=a.getCellMeta(G,Q),se=ee.readOnly;se||F.set("".concat(G,"x").concat(Q),[G,Q,A])}});a.setDataAtCell(Array.from(F.values()))},runOnlyIf:function(){return a.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){R.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){R.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(0,1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){R.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m=a.getSelectedRangeLast(),b=m.from,_=m.to,T=a.rowIndexMapper.getNearestNotHiddenIndex(0,1);R.setRangeStart(b.clone()),R.setRangeEnd(a._createCellCoords(T,_.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){R.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){R.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){R.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m=a.getSelectedRangeLast(),b=m.from,_=m.to,T=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1);R.setRangeStart(b.clone()),R.setRangeEnd(a._createCellCoords(T,_.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){R.transformStart(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var m,b=a.getSelectedRangeLast().highlight.row,_=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,gl(a.isRtl()?[a.countCols()-1,-1]:[0,1]));R.setRangeStart(a._createCellCoords(b,_))}},{keys:[["ArrowLeft","Shift"]],callback:function(){R.transformEnd(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m,b=a.getSelectedRangeLast(),_=b.from,T=b.to,A=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,gl(a.isRtl()?[a.countCols()-1,-1]:[0,1]));R.setRangeStart(_.clone()),R.setRangeEnd(a._createCellCoords(T.row,A))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){R.transformStart(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var m,b=a.getSelectedRangeLast().highlight.row,_=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,gl(a.isRtl()?[0,1]:[a.countCols()-1,-1]));R.setRangeStart(a._createCellCoords(b,_))}},{keys:[["ArrowRight","Shift"]],callback:function(){R.transformEnd(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m,b=a.getSelectedRangeLast(),_=b.from,T=b.to,A=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,gl(a.isRtl()?[0,1]:[a.countCols()-1,-1]));R.setRangeStart(_.clone()),R.setRangeEnd(a._createCellCoords(T.row,A))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var m=parseInt(a.getSettings().fixedColumnsStart,10),b=a.getSelectedRangeLast().highlight.row,_=a.columnIndexMapper.getNearestNotHiddenIndex(m,1);R.setRangeStart(a._createCellCoords(b,_))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){R.setRangeEnd(a._createCellCoords(R.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var m=parseInt(a.getSettings().fixedRowsTop,10),b=parseInt(a.getSettings().fixedColumnsStart,10),_=a.rowIndexMapper.getNearestNotHiddenIndex(m,1),T=a.columnIndexMapper.getNearestNotHiddenIndex(b,1);R.setRangeStart(a._createCellCoords(_,T))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){R.setRangeStart(a._createCellCoords(a.getSelectedRangeLast().highlight.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){R.setRangeEnd(a._createCellCoords(R.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var m=parseInt(a.getSettings().fixedRowsBottom,10),b=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-m-1,-1),_=a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1);R.setRangeStart(a._createCellCoords(b,_))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){R.transformStart(-a.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var m=a.getSelectedRangeLast(),b=m.to,_=Math.max(b.row-a.countVisibleRows(),0),T=a.rowIndexMapper.getNearestNotHiddenIndex(_,1);if(T!==null){var A=a._createCellCoords(T,b.col),F=b.row-a.view.getFirstFullyVisibleRow(),W=Math.max(A.row-F,0);R.setRangeEnd(A),a.scrollViewportTo(W)}}},{keys:[["PageDown"]],callback:function(){R.transformStart(a.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var m=a.getSelectedRangeLast(),b=m.to,_=Math.min(b.row+a.countVisibleRows(),a.countRows()-1),T=a.rowIndexMapper.getNearestNotHiddenIndex(_,-1);if(T!==null){var A=a._createCellCoords(T,b.col),F=b.row-a.view.getFirstFullyVisibleRow(),W=Math.min(A.row-F,a.countRows()-1);R.setRangeEnd(A),a.scrollViewportTo(W)}}},{keys:[["Tab"]],callback:function(m){var b=typeof p.tabMoves=="function"?p.tabMoves(m):p.tabMoves;R.transformStart(b.row,b.col,!0)}},{keys:[["Shift","Tab"]],callback:function(m){var b=typeof p.tabMoves=="function"?p.tabMoves(m):p.tabMoves;R.transformStart(-b.row,-b.col)}}],k),yV().forEach(function(y){var m=fT(y);S.addItem(y,new m(n))}),be.getSingleton().run(a,"construct")}var KSe="hooksRefRegisterer",GW={_hooksStorage:Object.create(null),addHook:function(t,r){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,r),this._hooksStorage[t].push(r),this},removeHooksByKey:function(t){var r=this;I(this._hooksStorage[t]||[],function(n){r.hot.removeHook(t,n)})},clearHooks:function(){var t=this;Ge(this._hooksStorage,function(r,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};Bo(GW,"MIXIN_NAME",KSe,{writable:!1,enumerable:!1});const qSe=GW;function Bs(e){"@babel/helpers - typeof";return Bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bs(e)}function XSe(e,t){return eCe(e)||QSe(e,t)||JSe(e,t)||ZSe()}function ZSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JSe(e,t){if(e){if(typeof e=="string")return RM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RM(e,t)}}function RM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function QSe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function eCe(e){if(Array.isArray(e))return e}function tCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WO(e,t)}function WO(e,t){return WO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},WO(e,t)}function rCe(e){var t=iCe();return function(){var n=Cm(e),o;if(t){var i=Cm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return nCe(this,o)}}function nCe(e,t){if(t&&(Bs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oCe(e)}function oCe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cm(e){return Cm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cm(e)}function EM(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aCe(n.key),n)}}function PM(e,t,r){return t&&TM(e.prototype,t),r&&TM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aCe(e){var t=lCe(e,"string");return Bs(t)==="symbol"?t:String(t)}function lCe(e,t){if(Bs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sCe="base",Zt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),UO="baseEditor",_f=function(){function e(t){EM(this,e),this.hot=t,this.instance=t,this.state=Zt.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return PM(e,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,o,i,a,l){this.TD=i,this.row=r,this.col=n,this.prop=o,this.originalValue=a,this.cellProperties=l,this.state=Zt.VIRGIN}},{key:"extend",value:function(){return function(r){tCe(o,r);var n=rCe(o);function o(){return EM(this,o),n.apply(this,arguments)}return PM(o)}(this.constructor)}},{key:"saveValue",value:function(r,n){var o=this,i,a,l,s;if(n){var u=this.hot.getSelectedLast();i=Math.max(Math.min(u[0],u[2]),0),a=Math.max(Math.min(u[1],u[3]),0),l=Math.max(u[0],u[2]),s=Math.max(u[1],u[3])}else{var f=[this.row,this.col,null,null];i=f[0],a=f[1],l=f[2],s=f[3]}var c=this.hot.runHooks("modifyGetCellCoords",i,a);if(Array.isArray(c)){var h=XSe(c,2);i=h[0],a=h[1]}var d=this.hot.getShortcutManager(),v=d.getContext("editor"),g={runOnlyIf:function(){return pe(o.hot.getSelected())},group:UO};this.isInFullEditMode()&&v.addShortcuts([{keys:[["ArrowUp"]],callback:function(){o.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){o.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){o.hot.selection.transformStart(0,-1*o.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){o.hot.selection.transformStart(0,o.hot.getDirectionFactor())}}],g),this.hot.populateFromArray(i,a,r,l,s,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===Zt.VIRGIN){var o=this.hot,i=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),a=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(o._createCellCoords(i,a)),this.state=Zt.EDITING,this.isInFullEditMode()){var l=typeof r=="string"?r:Bt(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,o){var i=this,a;if(o){var l=this._closeCallback;this._closeCallback=function(c){l&&l(c),o(c),i.hot.view.render()}}if(!this.isWaiting()){var s=this.hot.getShortcutManager(),u=s.getContext("editor");if(u.removeShortcutsByGroup(UO),u.removeShortcutsByGroup(Op),this.state===Zt.VIRGIN){this.hot._registerTimeout(function(){i._fireCallbacks(!0)});return}if(this.state===Zt.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var f=this.getValue();this.cellProperties.trimWhitespace?a=[[typeof f=="string"?String.prototype.trim.call(f||""):f]]:a=[[f]],this.state=Zt.WAITING,this.saveValue(a,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(c){i.state=Zt.FINISHED,i.discardEditor(c)}):(this.state=Zt.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=Zt.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===Zt.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=Zt.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Zt.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===Zt.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(n){var o=this.hot.view._wt,i=o.wtOverlays,a=o.wtViewport,l=this.hot.rootWindow,s=zt(n),u=gt(n),f=zt(this.hot.rootElement),c=gt(this.hot.rootElement),h=i.topOverlay.holder,d=i.inlineStartOverlay.holder,v=h!==l?h.scrollTop:0,g=d!==l?d.scrollLeft:0,p=l.innerWidth-f.left-c,w=(r=i.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,S=w.wtTable,C=S.name,P=["master","inline_start"].includes(C)?v:0,R=["master","top","bottom"].includes(C)?g:0,V=s.top===f.top?0:1,U=s.top-f.top-V-P,X=0;this.hot.isRtl()?X=l.innerWidth-s.left-u-p-1+R:X=s.left-f.left-1-R,["top","top_inline_start_corner"].includes(C)&&(U+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(X+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));var Y=this.hot.hasColHeaders(),q=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Z=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),ie=this.hot.rowIndexMapper.getRenderableIndexesLength(),J=ie-this.hot.view._wt.getSetting("fixedRowsBottom");(Y&&q<=0||q===J)&&(U+=1),Z<=0&&(X+=1);var le=a.rowsRenderCalculator.startPosition,Ce=a.columnsRenderCalculator.startPosition,we=Math.abs(i.inlineStartOverlay.getScrollPosition()),_e=i.topOverlay.getScrollPosition(),k=er(this.hot.rootDocument),y=n.offsetTop+le-_e,m=0;if(this.hot.isRtl()){var b=n.offsetLeft;b>=0?m=S.getWidth()-n.offsetLeft:m=Math.abs(b),m+=Ce-we-u}else m=n.offsetLeft+Ce-we;var _=Ma(this.TD,this.hot.rootWindow),T=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",A=parseInt(_[T],10)>0?0:1,F=parseInt(_.borderTopWidth,10)>0?0:1,W=gt(n)+A,G=$t(n)+F,Q=mie(h)?k:0,ee=pie(d)?k:0,se=this.hot.view.maximumVisibleElementWidth(m)-Q+A,Te=Math.max(this.hot.view.maximumVisibleElementHeight(y)-ee+F,23);return{top:U,start:X,height:G,maxHeight:Te,width:W,maxWidth:se}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return sCe}}]),e}();bt(_f,qSe);function uCe(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),o=document.createElement("SPAN"),i=function(d,v,g){d.addEventListener(v,g,!1)},a=function(d,v,g){d.removeEventListener(v,g,!1)},l=function(d){var v,g;d?/^[a-zA-Z \.,\\\/\|0-9]$/.test(d)||(d="."):d="",n.textContent!==void 0?n.textContent=t.value+d:n.data=t.value+d,o.style.position="absolute",o.style.fontSize=c(t).fontSize,o.style.fontFamily=c(t).fontFamily,o.style.whiteSpace="pre",r.appendChild(o),v=o.clientWidth+2,r.removeChild(o),t.style.height=e.minHeight+"px",e.minWidth>v?t.style.width=e.minWidth+"px":v>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=v+"px",g=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>g?t.style.height=e.minHeight+"px":e.maxHeight<g?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=g+"px"},s=function(){window.setTimeout(l,0)},u=function(d){if(d&&d.minHeight)if(d.minHeight=="inherit")e.minHeight=t.clientHeight;else{var v=parseInt(d.minHeight);isNaN(v)||(e.minHeight=v)}if(d&&d.maxHeight)if(d.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var g=parseInt(d.maxHeight);isNaN(g)||(e.maxHeight=g)}if(d&&d.minWidth)if(d.minWidth=="inherit")e.minWidth=t.clientWidth;else{var p=parseInt(d.minWidth);isNaN(p)||(e.minWidth=p)}if(d&&d.maxWidth)if(d.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var w=parseInt(d.maxWidth);isNaN(w)||(e.maxWidth=w)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))},f=function(d,v,g){t=d,u(v),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),g&&(i(t,"change",l),i(t,"cut",s),i(t,"paste",s),i(t,"drop",s),i(t,"keydown",s),i(t,"focus",l),i(t,"compositionstart",s),i(t,"compositionupdate",s),i(t,"compositionend",s)),l()};function c(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(d,v,g){f(d,v,g)},unObserve:function(){a(t,"change",l),a(t,"cut",s),a(t,"paste",s),a(t,"drop",s),a(t,"keydown",s),a(t,"focus",l),a(t,"compositionstart",s),a(t,"compositionupdate",s),a(t,"compositionend",s)},resize:l}}function kM(e,t){for(var r=FB(t),n=t.value.split(`
`),o=r,i=0,a=0;a<n.length;a++){var l=n[a];a!==0&&(i+=n[a-1].length+1);var s=i+l.length;if(e==="home"?o=i:e==="end"&&(o=s),r<=s)break}Cp(t,o)}function Vs(e){"@babel/helpers - typeof";return Vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vs(e)}function $M(e,t){return dCe(e)||hCe(e,t)||cCe(e,t)||fCe()}function fCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cCe(e,t){if(e){if(typeof e=="string")return AM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AM(e,t)}}function AM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function dCe(e){if(Array.isArray(e))return e}function vCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gCe(n.key),n)}}function yCe(e,t,r){return t&&IM(e.prototype,t),r&&IM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gCe(e){var t=mCe(e,"string");return Vs(t)==="symbol"?t:String(t)}function mCe(e,t){if(Vs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sc(){return typeof Reflect<"u"&&Reflect.get?Sc=Reflect.get.bind():Sc=function(t,r,n){var o=pCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Sc.apply(this,arguments)}function pCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Fa(e),e!==null););return e}function bCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zO(e,t)}function zO(e,t){return zO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},zO(e,t)}function wCe(e){var t=CCe();return function(){var n=Fa(e),o;if(t){var i=Fa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return SCe(this,o)}}function SCe(e,t){if(t&&(Vs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KW(e)}function KW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fa(e){return Fa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fa(e)}var _Ce="ht_editor_visible",sy="ht_editor_hidden",MM="textEditor",OCe="text",rl=function(e){bCe(r,e);var t=wCe(r);function r(n){var o;return vCe(this,r),o=t.call(this,n),o.eventManager=new It(KW(o)),o.autoResize=uCe(),o.TEXTAREA=void 0,o.textareaStyle=void 0,o.TEXTAREA_PARENT=void 0,o.textareaParentStyle=void 0,o.layerClass=void 0,o.createElements(),o.bindEvents(),o.hot.addHookOnce("afterDestroy",function(){return o.destroy()}),o}return yCe(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(o){this.TEXTAREA.value=o}},{key:"open",value:function(){var o=this;this.refreshDimensions(),this.showEditableElement();var i=this.hot.getShortcutManager();i.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(o,i,a,l,s,u){var f=this.state;if(Sc(Fa(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),!u.readOnly){this.refreshDimensions(!0);var c=u.allowInvalid,h=u.fragmentSelection;c&&(this.TEXTAREA.value=""),f!==Zt.FINISHED&&this.hideEditableElement();var d=!h;d&&!xn()&&this.focus()}}},{key:"beginEditing",value:function(o,i){this.state===Zt.VIRGIN&&(this.TEXTAREA.value="",Sc(Fa(r.prototype),"beginEditing",this).call(this,o,i))}},{key:"focus",value:function(){this.TEXTAREA.select(),Cp(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var o=this.hot.rootDocument;this.TEXTAREA=o.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,re(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=o.createElement("DIV"),re(this.TEXTAREA_PARENT,"handsontableInputHolder"),De(this.TEXTAREA_PARENT,this.layerClass)&&je(this.TEXTAREA_PARENT,this.layerClass),re(this.TEXTAREA_PARENT,sy),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(iee()||oee())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",je(this.TEXTAREA_PARENT,this.layerClass),re(this.TEXTAREA_PARENT,sy)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var o=this.TEXTAREA_PARENT.childNodes,i=!1;Re(o.length-1,function(a){var l=o[a];if(De(l,"handsontableEditor"))return i=!0,!1}),De(this.TEXTAREA_PARENT,sy)&&je(this.TEXTAREA_PARENT,sy),i?(this.layerClass=_Ce,re(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),re(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var o=this.hot.toPhysicalRow(this.row),i=this.hot.getSourceDataAtCell(o,this.col);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==Zt.EDITING&&!o)){if(this.TD=this.getEditedCell(),!this.TD){o||this.close();return}var i=this.getEditedCellRect(),a=i.top,l=i.start,s=i.width,u=i.maxWidth,f=i.height,c=i.maxHeight;this.textareaParentStyle.top="".concat(a,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(l,"px"),this.showEditableElement();var h=Ma(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var d=Ma(this.TEXTAREA),v=parseInt(d.paddingLeft,10)+parseInt(d.paddingRight,10),g=parseInt(d.paddingTop,10)+parseInt(d.paddingBottom,10),p=s-v,w=f-g,S=u-v,C=c-g;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(p,S),minHeight:Math.min(w,C),maxWidth:S,maxHeight:C},!0)}}},{key:"bindEvents",value:function(){var o=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(i){return i.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(i){return i.stopPropagation()}),FF()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return o.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){o.refreshDimensions(),o.focus()}),this.addHook("afterRowResize",function(){o.refreshDimensions(),o.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),l={runOnlyIf:function(){return pe(o.hot.getSelected())},group:MM},s=function(){o.hot.rootDocument.execCommand("insertText",!1,`
`)};a.addShortcuts([{keys:[["Tab"]],callback:function(f){var c=o.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;o.hot.selection.transformStart(h.row,h.col,!0)}},{keys:[["Shift","Tab"]],callback:function(f){var c=o.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;o.hot.selection.transformStart(-h.row,-h.col)}},{keys:[["Control","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(f){return!o.hot.selection.isMultiple()&&!f.altKey},relativeToGroup:mc,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(){return!o.hot.selection.isMultiple()},relativeToGroup:mc,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return s(),!1},relativeToGroup:mc,position:"before"},{keys:[["PageUp"]],callback:function(){o.hot.selection.transformStart(-o.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){o.hot.selection.transformStart(o.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(f,c){var h=$M(c,1),d=h[0];kM(d,o.TEXTAREA)}},{keys:[["End"]],callback:function(f,c){var h=$M(c,1),d=h[0];kM(d,o.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}}],l)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(Op),i.removeShortcutsByGroup(MM),i.removeShortcutsByGroup(UO)}},{key:"onAfterDocumentKeyDown",value:function(o){var i=[Oe.ARROW_UP,Oe.ARROW_RIGHT,Oe.ARROW_DOWN,Oe.ARROW_LEFT];i.indexOf(o.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(o.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return OCe}}]),r}(_f),RCe="base";function Cv(e,t,r,n,o,i,a){var l=[],s=[];a.className&&re(t,a.className),a.readOnly&&l.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?l.push(a.invalidCellClassName):s.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&l.push(a.noWordWrapClassName),!i&&a.placeholder&&l.push(a.placeholderCellClassName),je(t,s),re(t,l)}Cv.RENDERER_TYPE=RCe;var ECe="text";function $i(e,t,r,n,o,i,a){Cv.apply(this,[e,t,r,n,o,i,a]);var l=i;if(!l&&a.placeholder&&(l=a.placeholder),l=Bt(l),a.trimWhitespace&&(l=l.trim()),a.rendererTemplate){Hn(t);var s=e.rootDocument.createElement("TEMPLATE");s.setAttribute("bind","{{}}"),s.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(s),s.model=e.getSourceDataAtRow(r),t.appendChild(s)}else Ia(t,l)}$i.RENDERER_TYPE=ECe;var TCe="text",qW={CELL_TYPE:TCe,editor:rl,renderer:$i};Tn(qW);jr.editors={BaseEditor:_f};function jr(e,t){var r=new NT(e,t||{},_T);return r.init(),r}jr.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new NT(e,t,_T)};jr.DefaultSettings=FW();jr.hooks=be.getSingleton();jr.CellCoords=zg;jr.CellRange=hT;jr.packageName="handsontable";jr.buildDate="23/05/2023 09:21:52";jr.version="12.4.0";jr.languages={dictionaryKeys:Gme,getLanguageDictionary:PW,getLanguagesDictionaries:tpe,registerLanguageDictionary:AT,getTranslatedPhrase:kW};var ql=Symbol("unassigned"),PCe="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function _m(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function XW(e){var t=jr.hooks.getRegistered(),r={};Object.assign(r,jr.DefaultSettings);for(var n in r)r[n]={default:ql};for(var o=0;o<t.length;o++)r[t[o]]={default:ql};return r.settings={default:ql},e==="HotTable"&&(r.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),r}function ZW(e){var t={},r=e.settings;if(r!==ql)for(var n in r)_m(r,n)&&r[n]!==ql&&(t[n]=r[n]);for(var o in e)_m(e,o)&&o!=="settings"&&e[o]!==ql&&(t[o]=e[o]);return t}function xM(e,t){var r=ZW(e),n=e.settings?e.settings:r,o=e.settings?r:null,i={};for(var a in n)_m(n,a)&&n[a]!==void 0&&(!(t&&a!=="data")||!DM(t[a],n[a]))&&(i[a]=n[a]);for(var l in o)_m(o,l)&&l!=="id"&&l!=="settings"&&o[l]!==void 0&&(!(t&&l!=="data")||!DM(t[l],o[l]))&&(i[l]=o[l]);return i}function DM(e,t){return JSON.stringify(e)===JSON.stringify(t)}var kCe="12.4.0",HT=bL({name:"HotTable",props:XW("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(t){var r=xM(t,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||r===void 0||(r.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete r.data),Object.keys(r).length?this.hotInstance.updateSettings(r):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(PCe),null)},set hotInstance(t){this.__hotInstance=t}}},methods:{hotInit:function(){var t=xM(this.$props);t.columns=this.columnSettings?this.columnSettings:t.columns,this.hotInstance=Cz(new jr.Core(this.$el,t)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var r=this.hotInstance.getSourceData(),n=[],o=[],i=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),a=this.hotInstance.isColumnModificationAllowed(),l=0;if(r&&r.length!==i&&r.length<i)for(var s=r.length;s<i;s++)n.push(s);if(a){var u;if(l=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),r&&r[0]&&((u=r[0])===null||u===void 0?void 0:u.length)!==l&&r[0].length<l)for(var f=r[0].length;f<l;f++)o.push(f)}this.hotInstance.batch(function(){n.length>0?t.hotInstance.rowIndexMapper.removeIndexes(n):t.hotInstance.rowIndexMapper.insertIndexes(i-1,r.length-i),a&&r.length!==0&&(o.length>0?t.hotInstance.columnIndexMapper.removeIndexes(o):t.hotInstance.columnIndexMapper.insertIndexes(l-1,r[0].length-l))})}},getColumnSettings:function(){var t=Array.from(this.columnsCache.values());return t.length?t:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:kCe}),$Ce=["id"];function ACe(e,t,r,n,o,i){return LE(),HE("div",{id:e.id},[_z(e.$slots,"default")],8,$Ce)}HT.render=ACe;HT.__file="src/HotTable.vue";function NM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ICe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NM(Object(r),!0).forEach(function(n){MCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MCe(e,t,r){return t=DCe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xCe(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DCe(e){var t=xCe(e,"string");return typeof t=="symbol"?t:String(t)}var NCe=bL({name:"HotColumn",props:XW("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var t=ZW(this.$props),r=ICe({},t);t.renderer&&(r.renderer=t.renderer),t.editor&&(r.editor=t.editor),this.columnsCache.set(this,r)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});NCe.__file="src/HotColumn.vue";function Ws(e){"@babel/helpers - typeof";return Ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ws(e)}function HCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jCe(n.key),n)}}function LCe(e,t,r){return t&&HM(e.prototype,t),r&&HM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jCe(e){var t=FCe(e,"string");return Ws(t)==="symbol"?t:String(t)}function FCe(e,t){if(Ws(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ws(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function on(){return typeof Reflect<"u"&&Reflect.get?on=Reflect.get.bind():on=function(t,r,n){var o=BCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},on.apply(this,arguments)}function BCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Nr(e),e!==null););return e}function VCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YO(e,t)}function YO(e,t){return YO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},YO(e,t)}function WCe(e){var t=YCe();return function(){var n=Nr(e),o;if(t){var i=Nr(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return UCe(this,o)}}function UCe(e,t){if(t&&(Ws(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zCe(e)}function zCe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nr(e){return Nr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Nr(e)}var LM="handsontableEditor",GCe="handsontable",LT=function(e){VCe(r,e);var t=WCe(r);function r(){return HCe(this,r),t.apply(this,arguments)}return LCe(r,[{key:"open",value:function(){on(Nr(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Cp(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),on(Nr(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(o,i,a,l,s,u){on(Nr(r.prototype),"prepare",this).call(this,o,i,a,l,s,u);var f=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(d,v){var g=this.getSourceData(v.row,v.col);g!==void 0&&f.setValue(g),f.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Yt(c,u.handsontable),this.htOptions=c}},{key:"beginEditing",value:function(o,i){var a=this.hot.getSettings().onBeginEditing;a&&a()===!1||on(Nr(r.prototype),"beginEditing",this).call(this,o,i)}},{key:"createElements",value:function(){on(Nr(r.prototype),"createElements",this).call(this);var o=this.hot.rootDocument.createElement("DIV");o.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(o),this.htContainer=o,this.assignHooks()}},{key:"finishEditing",value:function(o,i,a){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var l=this.htEditor.getInstance().getValue();l!==void 0&&this.setValue(l)}on(Nr(r.prototype),"finishEditing",this).call(this,o,i,a)}},{key:"assignHooks",value:function(){var o=this;this.hot.addHook("afterDestroy",function(){o.htEditor&&o.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor");on(Nr(r.prototype),"registerShortcuts",this).call(this);var l={group:LM,relativeToGroup:Op,position:"before"},s=function(f,c){var h=o.htEditor.getInstance();if(f!==void 0&&(f<0||h.flipped&&f>h.countRows()-1?h.deselectCell():h.selectCell(f,0),h.getData().length))return c.preventDefault(),Ln(c),o.hot.listen(),o.TEXTAREA.focus(),!1};a.addShortcuts([{keys:[["ArrowUp"]],callback:function(f){var c=o.htEditor.getInstance(),h,d;return!c.getSelectedLast()&&c.flipped?h=c.countRows()-1:c.getSelectedLast()&&(c.flipped?(d=c.getSelectedLast()[0],h=Math.max(0,d-1)):(d=c.getSelectedLast()[0],h=d-1)),s(h,f)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(f){var c=o.htEditor.getInstance(),h,d;if(!c.getSelectedLast()&&!c.flipped)h=0;else if(c.getSelectedLast()){if(c.flipped)h=c.getSelectedLast()[0]+1;else if(!c.flipped){var v=c.countRows()-1;d=c.getSelectedLast()[0],h=Math.min(v,d+1)}}return s(h,f)},preventDefault:!1}],l)}},{key:"unregisterShortcuts",value:function(){on(Nr(r.prototype),"unregisterShortcuts",this).call(this);var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(LM)}}],[{key:"EDITOR_TYPE",get:function(){return GCe}}]),r}(rl);function Us(e){"@babel/helpers - typeof";return Us=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Us(e)}function KCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JW(n.key),n)}}function qCe(e,t,r){return t&&jM(e.prototype,t),r&&jM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qi(){return typeof Reflect<"u"&&Reflect.get?Qi=Reflect.get.bind():Qi=function(t,r,n){var o=XCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Qi.apply(this,arguments)}function XCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=so(e),e!==null););return e}function ZCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GO(e,t)}function GO(e,t){return GO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},GO(e,t)}function JCe(e){var t=e_e();return function(){var n=so(e),o;if(t){var i=so(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return QCe(this,o)}}function QCe(e,t){if(t&&(Us(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KO(e)}function KO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function e_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function so(e){return so=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},so(e)}function t_e(e,t,r){return t=JW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JW(e){var t=r_e(e,"string");return Us(t)==="symbol"?t:String(t)}function r_e(e,t){if(Us(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Us(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WS=new WeakMap,n_e="autocomplete",jT=function(e){ZCe(r,e);var t=JCe(r);function r(n){var o;return KCe(this,r),o=t.call(this,n),t_e(KO(o),"sortByRelevance",function(i,a,l){var s=[],u=[],f=i.length,c=a.length,h,d,v,g;if(f===0){for(v=0;v<c;v++)u.push(v);return u}for(v=0;v<c;v++){if(d=C1(Bt(a[v])),l)g=d.indexOf(i);else{var p=this.cellProperties.locale;g=d.toLocaleLowerCase(p).indexOf(i.toLocaleLowerCase(p))}g!==-1&&(h=d.length-g-f,s.push({baseIndex:v,index:g,charsLeft:h,value:d}))}for(s.sort(function(w,S){if(S.index===-1)return-1;if(w.index===-1)return 1;if(w.index<S.index)return-1;if(S.index<w.index)return 1;if(w.index===S.index){if(w.charsLeft<S.charsLeft)return-1;if(w.charsLeft>S.charsLeft)return 1}return 0}),v=0,c=s.length;v<c;v++)u.push(s[v].baseIndex);return u}),o.query=null,o.strippedChoices=[],o.rawChoices=[],WS.set(KO(o),{skipOne:!1,isMacOS:o.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),o}return qCe(r,[{key:"getValue",value:function(){var o=this,i=this.rawChoices.find(function(a){var l=o.stripValueIfNeeded(a);return l===o.TEXTAREA.value});return pe(i)?i:this.TEXTAREA.value}},{key:"createElements",value:function(){Qi(so(r.prototype),"createElements",this).call(this),re(this.htContainer,"autocompleteEditor"),re(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var o=this,i=WS.get(this);Qi(so(r.prototype),"open",this).call(this);var a=this.htEditor.getInstance(),l=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var s=er();s===0&&i.isMacOS&&(s+=15),this.addHook("beforeKeyDown",function(u){return o.onBeforeKeyDown(u)}),a.updateSettings({colWidths:l?[gt(this.TEXTAREA)-2]:void 0,width:l?gt(this.TEXTAREA)+s:void 0,renderer:function(f,c,h,d,v,g,p){$i(f,c,h,d,v,g,p);var w=o.cellProperties,S=w.filteringCaseSensitive,C=w.allowHtml,P=w.locale,R=o.query,V=Bt(g),U,X;V&&!C&&(U=S===!0?V.indexOf(R):V.toLocaleLowerCase(P).indexOf(R.toLocaleLowerCase(P)),U!==-1&&(X=V.substr(U,R.length),V=V.replace(X,"<strong>".concat(X,"</strong>")))),c.innerHTML=V},autoColumnSize:!0}),i.skipOne&&(i.skipOne=!1),this.hot._registerTimeout(function(){o.queryChoices(o.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),Qi(so(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(o){Qi(so(r.prototype),"discardEditor",this).call(this,o),this.hot.view.render()}},{key:"queryChoices",value:function(o){var i=this,a=this.cellProperties.source;this.query=o,typeof a=="function"?a.call(this.cellProperties,o,function(l){i.rawChoices=l,i.updateChoicesList(i.stripValuesIfNeeded(l))}):Array.isArray(a)?(this.rawChoices=a,this.updateChoicesList(this.stripValuesIfNeeded(a))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(o){var i=FB(this.TEXTAREA),a=vie(this.TEXTAREA),l=this.cellProperties.sortByRelevance,s=this.cellProperties.filter,u=null,f=null,c=o;l&&(u=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),c,this.cellProperties.filteringCaseSensitive));var h=Array.isArray(u)?u.length:0;if(s===!1)h&&(f=u[0]);else{for(var d=[],v=0,g=c.length;v<g&&!(l&&h<=v);v++)h?d.push(c[u[v]]):d.push(c[v]);f=0,c=d}this.strippedChoices=c,this.htEditor.loadData(zy([c])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(f),this.hot.listen(),Cp(this.TEXTAREA,i,i===a?void 0:a)}},{key:"flipDropdownIfNeeded",value:function(){var o=fs(this.hot.view._wt.wtTable.TABLE),i=o===this.hot.rootWindow,a=this.cellProperties.preventOverflow;if(i||!i&&(a||a==="horizontal"))return!1;var l=zt(this.TEXTAREA),s=$t(this.TEXTAREA),u=this.getDropdownHeight(),f=o.scrollTop,c=$t(this.hot.view._wt.wtTable.THEAD),h=zt(o),d=l.top-h.top-c+f,v=o.scrollHeight-d-c-s,g=u>v&&d>v;return g?this.flipDropdown(u):this.unflipDropdown(),this.limitDropdownIfNeeded(g?d:v,u),g}},{key:"limitDropdownIfNeeded",value:function(o,i){if(i>o){var a=0,l=0,s=0,u=null;do s=this.htEditor.getRowHeight(l)||this.htEditor.view._wt.getSetting("defaultRowHeight"),a+=s,l+=1;while(a<o);u=a-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+i-u,"px")),this.setDropdownHeight(a-s)}}},{key:"flipDropdown",value:function(o){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="".concat(-o,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var o=this.htEditor.rootElement.style;o.position="absolute",o.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var o=this.htEditor.getColWidth(0)+er(this.hot.rootDocument)+2,i=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:i?void 0:o}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(o){this.htEditor.updateSettings({height:o})}},{key:"highlightBestMatchingChoice",value:function(o){typeof o=="number"?this.htEditor.selectCell(o,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var o=this.htEditor.getInstance().getRowHeight(0)||23,i=this.cellProperties.visibleRows;return this.strippedChoices.length>=i?i*o:this.strippedChoices.length*o+8}},{key:"stripValueIfNeeded",value:function(o){return this.stripValuesIfNeeded([o])[0]}},{key:"stripValuesIfNeeded",value:function(o){var i=this.cellProperties.allowHtml,a=ze(o,function(s){return Bt(s)}),l=ze(a,function(s){return i?s:C1(s)});return l}},{key:"allowKeyEventPropagation",value:function(o){var i=this.htEditor.getSelectedRangeLast(),a={row:i?i.from.row:-1},l=!1;return o===Oe.ARROW_DOWN&&a.row>0&&a.row<this.htEditor.countRows()-1&&(l=!0),o===Oe.ARROW_UP&&a.row>-1&&(l=!0),l}},{key:"onBeforeKeyDown",value:function(o){var i=this,a=WS.get(this);if(a.skipOne=!1,Uie(o.keyCode)||o.keyCode===Oe.BACKSPACE||o.keyCode===Oe.DELETE||o.keyCode===Oe.INSERT){var l=10;if(o.keyCode===Oe.C&&(o.ctrlKey||o.metaKey))return;this.isOpened()||(l+=10),this.htEditor&&this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value),a.skipOne=!0},l)}}}],[{key:"EDITOR_TYPE",get:function(){return n_e}}]),r}(LT);function zs(e){"@babel/helpers - typeof";return zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zs(e)}function o_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a_e(n.key),n)}}function i_e(e,t,r){return t&&FM(e.prototype,t),r&&FM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a_e(e){var t=l_e(e,"string");return zs(t)==="symbol"?t:String(t)}function l_e(e,t){if(zs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function s_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qO(e,t)}function qO(e,t){return qO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},qO(e,t)}function u_e(e){var t=h_e();return function(){var n=Om(e),o;if(t){var i=Om(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return f_e(this,o)}}function f_e(e,t){if(t&&(zs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c_e(e)}function c_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Om(e){return Om=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Om(e)}var d_e="checkbox",QW=function(e){s_e(r,e);var t=u_e(r);function r(){return o_e(this,r),t.apply(this,arguments)}return i_e(r,[{key:"beginEditing",value:function(o,i){if(i&&i.type==="mouseup"){var a=this.TD.querySelector('input[type="checkbox"]');De(a,"htBadValue")||a.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return d_e}}]),r}(_f),e2={exports:{}};const v_e=Tz(eie);/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(e,t){(function(r,n){var o;{try{o=v_e}catch{}e.exports=n(o)}})(oc,function(r){var n=typeof r=="function",o=!!window.addEventListener,i=window.document,a=window.setTimeout,l=function(k,y,m,b){o?k.addEventListener(y,m,!!b):k.attachEvent("on"+y,m)},s=function(k,y,m,b){o?k.removeEventListener(y,m,!!b):k.detachEvent("on"+y,m)},u=function(k){return k.trim?k.trim():k.replace(/^\s+|\s+$/g,"")},f=function(k,y){return(" "+k.className+" ").indexOf(" "+y+" ")!==-1},c=function(k,y){f(k,y)||(k.className=k.className===""?y:k.className+" "+y)},h=function(k,y){k.className=u((" "+k.className+" ").replace(" "+y+" "," "))},d=function(k){return/Array/.test(Object.prototype.toString.call(k))},v=function(k){return/Date/.test(Object.prototype.toString.call(k))&&!isNaN(k.getTime())},g=function(k){var y=k.getDay();return y===0||y===6},p=function(k){return k%4===0&&k%100!==0||k%400===0},w=function(k,y){return[31,p(k)?29:28,31,30,31,30,31,31,30,31,30,31][y]},S=function(k){v(k)&&k.setHours(0,0,0,0)},C=function(k,y){return k.getTime()===y.getTime()},P=function(k,y,m){var b,_;for(b in y)_=k[b]!==void 0,_&&typeof y[b]=="object"&&y[b]!==null&&y[b].nodeName===void 0?v(y[b])?m&&(k[b]=new Date(y[b].getTime())):d(y[b])?m&&(k[b]=y[b].slice(0)):k[b]=P({},y[b],m):(m||!_)&&(k[b]=y[b]);return k},R=function(k,y,m){var b;i.createEvent?(b=i.createEvent("HTMLEvents"),b.initEvent(y,!0,!1),b=P(b,m),k.dispatchEvent(b)):i.createEventObject&&(b=i.createEventObject(),b=P(b,m),k.fireEvent("on"+y,b))},V=function(k){return k.month<0&&(k.year-=Math.ceil(Math.abs(k.month)/12),k.month+=12),k.month>11&&(k.year+=Math.floor(Math.abs(k.month)/12),k.month-=12),k},U={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},X=function(k,y,m){for(y+=k.firstDay;y>=7;)y-=7;return m?k.i18n.weekdaysShort[y]:k.i18n.weekdays[y]},Y=function(k){var y=[],m="false";if(k.isEmpty)if(k.showDaysInNextAndPreviousMonths)y.push("is-outside-current-month"),k.enableSelectionDaysInNextAndPreviousMonths||y.push("is-selection-disabled");else return'<td class="is-empty"></td>';return k.isDisabled&&y.push("is-disabled"),k.isToday&&y.push("is-today"),k.isSelected&&(y.push("is-selected"),m="true"),k.hasEvent&&y.push("has-event"),k.isInRange&&y.push("is-inrange"),k.isStartRange&&y.push("is-startrange"),k.isEndRange&&y.push("is-endrange"),'<td data-day="'+k.day+'" class="'+y.join(" ")+'" aria-selected="'+m+'"><button class="pika-button pika-day" type="button" data-pika-year="'+k.year+'" data-pika-month="'+k.month+'" data-pika-day="'+k.day+'">'+k.day+"</button></td>"},q=function(k,y){k.setHours(0,0,0,0);var m=k.getDate(),b=k.getDay(),_=y,T=_-1,A=7,F=function(se){return(se+A-1)%A};k.setDate(m+T-F(b));var W=new Date(k.getFullYear(),0,_),G=24*60*60*1e3,Q=(k.getTime()-W.getTime())/G,ee=1+Math.round((Q-T+F(W.getDay()))/A);return ee},Z=function(k,y,m,b){var _=new Date(m,y,k),T=n?r(_).isoWeek():q(_,b);return'<td class="pika-week">'+T+"</td>"},ie=function(k,y,m,b){return'<tr class="pika-row'+(m?" pick-whole-week":"")+(b?" is-selected":"")+'">'+(y?k.reverse():k).join("")+"</tr>"},J=function(k){return"<tbody>"+k.join("")+"</tbody>"},le=function(k){var y,m=[];for(k.showWeekNumber&&m.push("<th></th>"),y=0;y<7;y++)m.push('<th scope="col"><abbr title="'+X(k,y)+'">'+X(k,y,!0)+"</abbr></th>");return"<thead><tr>"+(k.isRTL?m.reverse():m).join("")+"</tr></thead>"},Ce=function(k,y,m,b,_,T){var A,F,W,G=k._o,Q=m===G.minYear,ee=m===G.maxYear,se='<div id="'+T+'" class="pika-title" role="heading" aria-live="assertive">',Te,de,ye=!0,K=!0;for(W=[],A=0;A<12;A++)W.push('<option value="'+(m===_?A-y:12+A-y)+'"'+(A===b?' selected="selected"':"")+(Q&&A<G.minMonth||ee&&A>G.maxMonth?' disabled="disabled"':"")+">"+G.i18n.months[A]+"</option>");for(Te='<div class="pika-label">'+G.i18n.months[b]+'<select class="pika-select pika-select-month" tabindex="-1">'+W.join("")+"</select></div>",d(G.yearRange)?(A=G.yearRange[0],F=G.yearRange[1]+1):(A=m-G.yearRange,F=1+m+G.yearRange),W=[];A<F&&A<=G.maxYear;A++)A>=G.minYear&&W.push('<option value="'+A+'"'+(A===m?' selected="selected"':"")+">"+A+"</option>");return de='<div class="pika-label">'+m+G.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+W.join("")+"</select></div>",G.showMonthAfterYear?se+=de+Te:se+=Te+de,Q&&(b===0||G.minMonth>=b)&&(ye=!1),ee&&(b===11||G.maxMonth<=b)&&(K=!1),y===0&&(se+='<button class="pika-prev'+(ye?"":" is-disabled")+'" type="button">'+G.i18n.previousMonth+"</button>"),y===k._o.numberOfMonths-1&&(se+='<button class="pika-next'+(K?"":" is-disabled")+'" type="button">'+G.i18n.nextMonth+"</button>"),se+="</div>"},we=function(k,y,m){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+m+'">'+le(k)+J(y)+"</table>"},_e=function(k){var y=this,m=y.config(k);y._onMouseDown=function(_){if(y._v){_=_||window.event;var T=_.target||_.srcElement;if(T)if(f(T,"is-disabled")||(f(T,"pika-button")&&!f(T,"is-empty")&&!f(T.parentNode,"is-disabled")?(y.setDate(new Date(T.getAttribute("data-pika-year"),T.getAttribute("data-pika-month"),T.getAttribute("data-pika-day"))),m.bound&&a(function(){y.hide(),m.blurFieldOnSelect&&m.field&&m.field.blur()},100)):f(T,"pika-prev")?y.prevMonth():f(T,"pika-next")&&y.nextMonth()),f(T,"pika-select"))y._c=!0;else if(_.preventDefault)_.preventDefault();else return _.returnValue=!1,!1}},y._onChange=function(_){_=_||window.event;var T=_.target||_.srcElement;T&&(f(T,"pika-select-month")?y.gotoMonth(T.value):f(T,"pika-select-year")&&y.gotoYear(T.value))},y._onKeyChange=function(_){if(_=_||window.event,y.isVisible())switch(_.keyCode){case 13:case 27:m.field&&m.field.blur();break;case 37:y.adjustDate("subtract",1);break;case 38:y.adjustDate("subtract",7);break;case 39:y.adjustDate("add",1);break;case 40:y.adjustDate("add",7);break;case 8:case 46:y.setDate(null);break}},y._parseFieldValue=function(){if(m.parse)return m.parse(m.field.value,m.format);if(n){var _=r(m.field.value,m.format,m.formatStrict);return _&&_.isValid()?_.toDate():null}else return new Date(Date.parse(m.field.value))},y._onInputChange=function(_){var T;_.firedBy!==y&&(T=y._parseFieldValue(),v(T)&&y.setDate(T),y._v||y.show())},y._onInputFocus=function(){y.show()},y._onInputClick=function(){y.show()},y._onInputBlur=function(){var _=i.activeElement;do if(f(_,"pika-single"))return;while(_=_.parentNode);y._c||(y._b=a(function(){y.hide()},50)),y._c=!1},y._onClick=function(_){_=_||window.event;var T=_.target||_.srcElement,A=T;if(T){!o&&f(T,"pika-select")&&(T.onchange||(T.setAttribute("onchange","return;"),l(T,"change",y._onChange)));do if(f(A,"pika-single")||A===m.trigger)return;while(A=A.parentNode);y._v&&T!==m.trigger&&A!==m.trigger&&y.hide()}},y.el=i.createElement("div"),y.el.className="pika-single"+(m.isRTL?" is-rtl":"")+(m.theme?" "+m.theme:""),l(y.el,"mousedown",y._onMouseDown,!0),l(y.el,"touchend",y._onMouseDown,!0),l(y.el,"change",y._onChange),m.keyboardInput&&l(i,"keydown",y._onKeyChange),m.field&&(m.container?m.container.appendChild(y.el):m.bound?i.body.appendChild(y.el):m.field.parentNode.insertBefore(y.el,m.field.nextSibling),l(m.field,"change",y._onInputChange),m.defaultDate||(m.defaultDate=y._parseFieldValue(),m.setDefaultDate=!0));var b=m.defaultDate;v(b)?m.setDefaultDate?y.setDate(b,!0):y.gotoDate(b):y.gotoDate(new Date),m.bound?(this.hide(),y.el.className+=" is-bound",l(m.trigger,"click",y._onInputClick),l(m.trigger,"focus",y._onInputFocus),l(m.trigger,"blur",y._onInputBlur)):this.show()};return _e.prototype={config:function(k){this._o||(this._o=P({},U,!0));var y=P(this._o,k,!0);y.isRTL=!!y.isRTL,y.field=y.field&&y.field.nodeName?y.field:null,y.theme=typeof y.theme=="string"&&y.theme?y.theme:null,y.bound=!!(y.bound!==void 0?y.field&&y.bound:y.field),y.trigger=y.trigger&&y.trigger.nodeName?y.trigger:y.field,y.disableWeekends=!!y.disableWeekends,y.disableDayFn=typeof y.disableDayFn=="function"?y.disableDayFn:null;var m=parseInt(y.numberOfMonths,10)||1;if(y.numberOfMonths=m>4?4:m,v(y.minDate)||(y.minDate=!1),v(y.maxDate)||(y.maxDate=!1),y.minDate&&y.maxDate&&y.maxDate<y.minDate&&(y.maxDate=y.minDate=!1),y.minDate&&this.setMinDate(y.minDate),y.maxDate&&this.setMaxDate(y.maxDate),d(y.yearRange)){var b=new Date().getFullYear()-10;y.yearRange[0]=parseInt(y.yearRange[0],10)||b,y.yearRange[1]=parseInt(y.yearRange[1],10)||b}else y.yearRange=Math.abs(parseInt(y.yearRange,10))||U.yearRange,y.yearRange>100&&(y.yearRange=100);return y},toString:function(k){return k=k||this._o.format,v(this._d)?this._o.toString?this._o.toString(this._d,k):n?r(this._d).format(k):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function(k,y){n&&r.isMoment(k)&&this.setDate(k.toDate(),y)},getDate:function(){return v(this._d)?new Date(this._d.getTime()):null},setDate:function(k,y){if(!k)return this._d=null,this._o.field&&(this._o.field.value="",R(this._o.field,"change",{firedBy:this})),this.draw();if(typeof k=="string"&&(k=new Date(Date.parse(k))),!!v(k)){var m=this._o.minDate,b=this._o.maxDate;v(m)&&k<m?k=m:v(b)&&k>b&&(k=b),this._d=new Date(k.getTime()),S(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),R(this._o.field,"change",{firedBy:this})),!y&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(k){var y=!0;if(v(k)){if(this.calendars){var m=new Date(this.calendars[0].year,this.calendars[0].month,1),b=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),_=k.getTime();b.setMonth(b.getMonth()+1),b.setDate(b.getDate()-1),y=_<m.getTime()||b.getTime()<_}y&&(this.calendars=[{month:k.getMonth(),year:k.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(k,y){var m=this.getDate()||new Date,b=parseInt(y)*24*60*60*1e3,_;k==="add"?_=new Date(m.valueOf()+b):k==="subtract"&&(_=new Date(m.valueOf()-b)),this.setDate(_)},adjustCalendars:function(){this.calendars[0]=V(this.calendars[0]);for(var k=1;k<this._o.numberOfMonths;k++)this.calendars[k]=V({month:this.calendars[0].month+k,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(k){isNaN(k)||(this.calendars[0].month=parseInt(k,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(k){isNaN(k)||(this.calendars[0].year=parseInt(k,10),this.adjustCalendars())},setMinDate:function(k){k instanceof Date?(S(k),this._o.minDate=k,this._o.minYear=k.getFullYear(),this._o.minMonth=k.getMonth()):(this._o.minDate=U.minDate,this._o.minYear=U.minYear,this._o.minMonth=U.minMonth,this._o.startRange=U.startRange),this.draw()},setMaxDate:function(k){k instanceof Date?(S(k),this._o.maxDate=k,this._o.maxYear=k.getFullYear(),this._o.maxMonth=k.getMonth()):(this._o.maxDate=U.maxDate,this._o.maxYear=U.maxYear,this._o.maxMonth=U.maxMonth,this._o.endRange=U.endRange),this.draw()},setStartRange:function(k){this._o.startRange=k},setEndRange:function(k){this._o.endRange=k},draw:function(k){if(!(!this._v&&!k)){var y=this._o,m=y.minYear,b=y.maxYear,_=y.minMonth,T=y.maxMonth,A="",F;this._y<=m&&(this._y=m,!isNaN(_)&&this._m<_&&(this._m=_)),this._y>=b&&(this._y=b,!isNaN(T)&&this._m>T&&(this._m=T));for(var W=0;W<y.numberOfMonths;W++)F="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),A+='<div class="pika-lendar">'+Ce(this,W,this.calendars[W].year,this.calendars[W].month,this.calendars[0].year,F)+this.render(this.calendars[W].year,this.calendars[W].month,F)+"</div>";this.el.innerHTML=A,y.bound&&y.field.type!=="hidden"&&a(function(){y.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),y.bound&&y.field.setAttribute("aria-label",y.ariaLabel)}},adjustPosition:function(){var k,y,m,b,_,T,A,F,W,G,Q,ee;if(!this._o.container){if(this.el.style.position="absolute",k=this._o.trigger,y=k,m=this.el.offsetWidth,b=this.el.offsetHeight,_=window.innerWidth||i.documentElement.clientWidth,T=window.innerHeight||i.documentElement.clientHeight,A=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,Q=!0,ee=!0,typeof k.getBoundingClientRect=="function")G=k.getBoundingClientRect(),F=G.left+window.pageXOffset,W=G.bottom+window.pageYOffset;else for(F=y.offsetLeft,W=y.offsetTop+y.offsetHeight;y=y.offsetParent;)F+=y.offsetLeft,W+=y.offsetTop;(this._o.reposition&&F+m>_||this._o.position.indexOf("right")>-1&&F-m+k.offsetWidth>0)&&(F=F-m+k.offsetWidth,Q=!1),(this._o.reposition&&W+b>T+A||this._o.position.indexOf("top")>-1&&W-b-k.offsetHeight>0)&&(W=W-b-k.offsetHeight,ee=!1),this.el.style.left=F+"px",this.el.style.top=W+"px",c(this.el,Q?"left-aligned":"right-aligned"),c(this.el,ee?"bottom-aligned":"top-aligned"),h(this.el,Q?"right-aligned":"left-aligned"),h(this.el,ee?"top-aligned":"bottom-aligned")}},render:function(k,y,m){var b=this._o,_=new Date,T=w(k,y),A=new Date(k,y,1).getDay(),F=[],W=[];S(_),b.firstDay>0&&(A-=b.firstDay,A<0&&(A+=7));for(var G=y===0?11:y-1,Q=y===11?0:y+1,ee=y===0?k-1:k,se=y===11?k+1:k,Te=w(ee,G),de=T+A,ye=de;ye>7;)ye-=7;de+=7-ye;for(var K=!1,xe=0,Ke=0;xe<de;xe++){var $e=new Date(k,y,1+(xe-A)),Ie=v(this._d)?C($e,this._d):!1,Ae=C($e,_),O=b.events.indexOf($e.toDateString())!==-1,E=xe<A||xe>=T+A,$=1+(xe-A),H=y,M=k,j=b.startRange&&C(b.startRange,$e),x=b.endRange&&C(b.endRange,$e),D=b.startRange&&b.endRange&&b.startRange<$e&&$e<b.endRange,B=b.minDate&&$e<b.minDate||b.maxDate&&$e>b.maxDate||b.disableWeekends&&g($e)||b.disableDayFn&&b.disableDayFn($e);E&&(xe<A?($=Te+$,H=G,M=ee):($=$-T,H=Q,M=se));var L={day:$,month:H,year:M,hasEvent:O,isSelected:Ie,isToday:Ae,isDisabled:B,isEmpty:E,isStartRange:j,isEndRange:x,isInRange:D,showDaysInNextAndPreviousMonths:b.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:b.enableSelectionDaysInNextAndPreviousMonths};b.pickWholeWeek&&Ie&&(K=!0),W.push(Y(L)),++Ke===7&&(b.showWeekNumber&&W.unshift(Z(xe-A,y,k,b.firstWeekOfYearMinDays)),F.push(ie(W,b.isRTL,b.pickWholeWeek,K)),W=[],Ke=0,K=!1)}return we(b,F,m)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(l(i,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var k=this._v;k!==!1&&(this._o.bound&&s(i,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),c(this.el,"is-hidden"),this._v=!1,k!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var k=this._o;this.hide(),s(this.el,"mousedown",this._onMouseDown,!0),s(this.el,"touchend",this._onMouseDown,!0),s(this.el,"change",this._onChange),k.keyboardInput&&s(i,"keydown",this._onKeyChange),k.field&&(s(k.field,"change",this._onInputChange),k.bound&&(s(k.trigger,"click",this._onInputClick),s(k.trigger,"focus",this._onInputFocus),s(k.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},_e})})(e2);var y_e=e2.exports;const BM=CL(y_e);function Ys(e){"@babel/helpers - typeof";return Ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ys(e)}function g_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p_e(n.key),n)}}function m_e(e,t,r){return t&&VM(e.prototype,t),r&&VM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function p_e(e){var t=b_e(e,"string");return Ys(t)==="symbol"?t:String(t)}function b_e(e,t){if(Ys(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ys(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function io(){return typeof Reflect<"u"&&Reflect.get?io=Reflect.get.bind():io=function(t,r,n){var o=w_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},io.apply(this,arguments)}function w_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=sn(e),e!==null););return e}function S_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XO(e,t)}function XO(e,t){return XO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},XO(e,t)}function C_e(e){var t=R_e();return function(){var n=sn(e),o;if(t){var i=sn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return __e(this,o)}}function __e(e,t){if(t&&(Ys(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return O_e(e)}function O_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sn(e){return sn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sn(e)}var t2="date",WM="dateEditor",r2=function(e){S_e(r,e);var t=C_e(r);function r(n){var o;return g_e(this,r),o=t.call(this,n),o.defaultDateFormat="DD/MM/YYYY",o.isCellEdited=!1,o.parentDestroyed=!1,o.$datePicker=null,o}return m_e(r,[{key:"init",value:function(){var o=this;if(typeof te!="function")throw new Error("You need to include moment.js to your project.");if(typeof BM!="function")throw new Error("You need to include Pikaday to your project.");io(sn(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){o.parentDestroyed=!0,o.destroyElements()})}},{key:"createElements",value:function(){io(sn(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),re(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var o=new It(this);o.addEventListener(this.datePicker,"mousedown",function(i){return i.stopPropagation()})}},{key:"destroyElements",value:function(){var o=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),o&&o.removeChild(this.datePicker)}},{key:"prepare",value:function(o,i,a,l,s,u){io(sn(r.prototype),"prepare",this).call(this,o,i,a,l,s,u)}},{key:"open",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=this.hot.getShortcutManager(),a=i.getContext("editor");io(sn(r.prototype),"open",this).call(this),this.showDatepicker(o),a.addShortcut({keys:[["Enter"]],callback:function(s){s.stopPropagation()},group:WM})}},{key:"close",value:function(){var o,i=this;this._opened=!1,(o=this.$datePicker)!==null&&o!==void 0&&o.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){i.instance._refreshBorders()});var a=this.hot.getShortcutManager(),l=a.getContext("editor");l.removeShortcutsByGroup(WM),io(sn(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(o){var a=this.originalValue;a!==void 0&&this.setValue(a)}io(sn(r.prototype),"finishEditing",this).call(this,o,i)}},{key:"showDatepicker",value:function(o){var i=this.TD.getBoundingClientRect(),a=this.cellProperties.dateFormat||this.defaultDateFormat,l=this.instance.view.isMouseDown(),s=o?QB(o.keyCode):!1,u;this.datePicker.style.display="block",this.$datePicker=new BM(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+i.top+$t(this.TD),"px");var f=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?f=i.right-gt(this.datePicker):f=i.left,this.datePickerStyle.left="".concat(f,"px"),this.originalValue?(u=this.originalValue,te(u,a,!0).isValid()&&this.$datePicker.setMoment(te(u,a),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!s&&!l&&this.setValue("")):this.cellProperties.defaultDate?(u=this.cellProperties.defaultDate,te(u,a,!0).isValid()&&this.$datePicker.setMoment(te(u,a),!0),!s&&!l&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var o=this,i=this.TEXTAREA,a={};this.cellProperties&&this.cellProperties.datePickerConfig&&up(a,this.cellProperties.datePickerConfig);var l=a.onSelect,s=a.onClose;return a.field=i,a.trigger=i,a.container=this.datePicker,a.bound=!1,a.format=a.format||this.defaultDateFormat,a.reposition=a.reposition||!1,a.isRTL=!1,a.onSelect=function(u){var f=u;isNaN(f.getTime())||(f=te(f).format(o.cellProperties.dateFormat||o.defaultDateFormat)),o.setValue(f),o.hideDatepicker(),l&&l()},a.onClose=function(){o.parentDestroyed||o.finishEditing(!1),s&&s()},a}}],[{key:"EDITOR_TYPE",get:function(){return t2}}]),r}(rl);function Gs(e){"@babel/helpers - typeof";return Gs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gs(e)}function E_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P_e(n.key),n)}}function T_e(e,t,r){return t&&UM(e.prototype,t),r&&UM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function P_e(e){var t=k_e(e,"string");return Gs(t)==="symbol"?t:String(t)}function k_e(e,t){if(Gs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ug(){return typeof Reflect<"u"&&Reflect.get?ug=Reflect.get.bind():ug=function(t,r,n){var o=$_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ug.apply(this,arguments)}function $_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ks(e),e!==null););return e}function A_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZO(e,t)}function ZO(e,t){return ZO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ZO(e,t)}function I_e(e){var t=D_e();return function(){var n=Ks(e),o;if(t){var i=Ks(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return M_e(this,o)}}function M_e(e,t){if(t&&(Gs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return x_e(e)}function x_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ks(e){return Ks=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ks(e)}var N_e="dropdown",FT=function(e){A_e(r,e);var t=I_e(r);function r(){return E_e(this,r),t.apply(this,arguments)}return T_e(r,[{key:"prepare",value:function(o,i,a,l,s,u){ug(Ks(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return N_e}}]),r}(jT);be.getSingleton().add("beforeValidate",function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));n.editor===FT&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function qs(e){"@babel/helpers - typeof";return qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qs(e)}function H_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,j_e(n.key),n)}}function L_e(e,t,r){return t&&zM(e.prototype,t),r&&zM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function j_e(e){var t=F_e(e,"string");return qs(t)==="symbol"?t:String(t)}function F_e(e,t){if(qs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function B_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JO(e,t)}function JO(e,t){return JO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},JO(e,t)}function V_e(e){var t=z_e();return function(){var n=Rm(e),o;if(t){var i=Rm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return W_e(this,o)}}function W_e(e,t){if(t&&(qs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return U_e(e)}function U_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Rm(e){return Rm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Rm(e)}var Y_e="numeric",n2=function(e){B_e(r,e);var t=V_e(r);function r(){return H_e(this,r),t.apply(this,arguments)}return L_e(r,null,[{key:"EDITOR_TYPE",get:function(){return Y_e}}]),r}(rl);function Xs(e){"@babel/helpers - typeof";return Xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xs(e)}function G_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,q_e(n.key),n)}}function K_e(e,t,r){return t&&YM(e.prototype,t),r&&YM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function q_e(e){var t=X_e(e,"string");return Xs(t)==="symbol"?t:String(t)}function X_e(e,t){if(Xs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fg(){return typeof Reflect<"u"&&Reflect.get?fg=Reflect.get.bind():fg=function(t,r,n){var o=Z_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},fg.apply(this,arguments)}function Z_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Zs(e),e!==null););return e}function J_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QO(e,t)}function QO(e,t){return QO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},QO(e,t)}function Q_e(e){var t=rOe();return function(){var n=Zs(e),o;if(t){var i=Zs(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return eOe(this,o)}}function eOe(e,t){if(t&&(Xs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tOe(e)}function tOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zs(e){return Zs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zs(e)}var nOe="password",o2=function(e){J_e(r,e);var t=Q_e(r);function r(){return G_e(this,r),t.apply(this,arguments)}return K_e(r,[{key:"createElements",value:function(){fg(Zs(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Hn(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return nOe}}]),r}(rl);function Ba(e){"@babel/helpers - typeof";return Ba=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ba(e)}function oOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aOe(n.key),n)}}function iOe(e,t,r){return t&&GM(e.prototype,t),r&&GM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aOe(e){var t=lOe(e,"string");return Ba(t)==="symbol"?t:String(t)}function lOe(e,t){if(Ba(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ba(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cg(){return typeof Reflect<"u"&&Reflect.get?cg=Reflect.get.bind():cg=function(t,r,n){var o=sOe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},cg.apply(this,arguments)}function sOe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Js(e),e!==null););return e}function uOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eR(e,t)}function eR(e,t){return eR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},eR(e,t)}function fOe(e){var t=dOe();return function(){var n=Js(e),o;if(t){var i=Js(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return cOe(this,o)}}function cOe(e,t){if(t&&(Ba(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hOe(e)}function hOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Js(e){return Js=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Js(e)}var US="ht_editor_visible",KM="selectEditor",vOe="select",yOe=function(e){uOe(r,e);var t=fOe(r);function r(){return oOe(this,r),t.apply(this,arguments)}return iOe(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),re(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(o){this.select.value=o}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var o=this.hot.getShortcutManager();o.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",De(this.select,US)&&je(this.select,US),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var o=this;this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){return o.refreshDimensions()}),this.addHook("afterRowResize",function(){return o.refreshDimensions()})}},{key:"prepare",value:function(o,i,a,l,s,u){var f=this;cg(Js(r.prototype),"prepare",this).call(this,o,i,a,l,s,u);var c=this.cellProperties.selectOptions,h;typeof c=="function"?h=this.prepareOptions(c(this.row,this.col,this.prop)):h=this.prepareOptions(c),Hn(this.select),Ge(h,function(d,v){var g=f.hot.rootDocument.createElement("OPTION");g.value=v,bf(g,d),f.select.appendChild(g)})}},{key:"prepareOptions",value:function(o){var i={};if(Array.isArray(o))for(var a=0,l=o.length;a<l;a++)i[o[a]]=o[a];else Ba(o)==="object"&&(i=o);return i}},{key:"refreshValue",value:function(){var o=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===Zt.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var o=this.getEditedCellRect(),i=o.top,a=o.start,l=o.width,s=o.height,u=this.select.style;u.height="".concat(s,"px"),u.width="".concat(l,"px"),u.top="".concat(i,"px"),u[this.hot.isRtl()?"right":"left"]="".concat(a,"px"),u.margin="0px",re(this.select,US)}}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),l={group:KM};this.isInFullEditMode()!==!1&&a.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var u=o.select.selectedIndex-1;u>=0&&(o.select[u].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var u=o.select.selectedIndex+1;u<=o.select.length-1&&(o.select[u].selected=!0)}}],l)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(KM)}}],[{key:"EDITOR_TYPE",get:function(){return vOe}}]),r}(_f);function Qs(e){"@babel/helpers - typeof";return Qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qs(e)}function gOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pOe(n.key),n)}}function mOe(e,t,r){return t&&qM(e.prototype,t),r&&qM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pOe(e){var t=bOe(e,"string");return Qs(t)==="symbol"?t:String(t)}function bOe(e,t){if(Qs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hg(){return typeof Reflect<"u"&&Reflect.get?hg=Reflect.get.bind():hg=function(t,r,n){var o=wOe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},hg.apply(this,arguments)}function wOe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=eu(e),e!==null););return e}function SOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tR(e,t)}function tR(e,t){return tR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},tR(e,t)}function COe(e){var t=ROe();return function(){var n=eu(e),o;if(t){var i=eu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _Oe(this,o)}}function _Oe(e,t){if(t&&(Qs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OOe(e)}function OOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ROe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function eu(e){return eu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},eu(e)}var EOe="time",i2=function(e){SOe(r,e);var t=COe(r);function r(){return gOe(this,r),t.apply(this,arguments)}return mOe(r,[{key:"prepare",value:function(o,i,a,l,s,u){hg(eu(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return EOe}}]),r}(rl);function TOe(){xr(_f),xr(jT),xr(QW),xr(r2),xr(FT),xr(LT),xr(n2),xr(o2),xr(yOe),xr(rl),xr(i2)}var POe="html";function BT(e,t,r,n,o,i,a){Cv.apply(this,[e,t,r,n,o,i,a]),bf(t,i??"",!1)}BT.RENDERER_TYPE=POe;var kOe="autocomplete";function Of(e,t,r,n,o,i,a){var l=e.rootDocument,s=a.allowHtml?BT:$i,u=l.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(l.createTextNode(String.fromCharCode(9660))),s.apply(this,[e,t,r,n,o,i,a]),t.firstChild||t.appendChild(l.createTextNode(String.fromCharCode(160))),t.insertBefore(u,t.firstChild),re(t,"htAutocomplete"),!e.acArrowListener){var f=new It(e);e.acArrowListener=function(c){De(c.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(r,n),t)},f.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){f.destroy()})}}Of.RENDERER_TYPE=kOe;var XM=new WeakMap,ZM=new WeakMap,$Oe="htBadValue",tu="data-row",ru="data-col",AOe="checkboxRenderer",a2="checkbox";be.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,r){var n=t.label,o=t.type,i=t.row,a=t.column,l=t.prop;if(o===a2){if(n){var s=n.value,u=n.property,f=r;if(s)f=typeof s=="function"?s(i,a,l,r):s;else if(u){var c=this.getDataAtRowProp(i,u);f=c!==null?c:r}e=f}return e}});function VT(e,t,r,n,o,i,a){var l=e.rootDocument;Cv.apply(this,[e,t,r,n,o,i,a]),IOe(e);var s=MOe(l),u=a.label,f=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),Hn(t),i===a.checkedTemplate||Bt(i).toLocaleLowerCase(a.locale)===Bt(a.checkedTemplate).toLocaleLowerCase(a.locale)?s.checked=!0:i===a.uncheckedTemplate||Bt(i).toLocaleLowerCase(a.locale)===Bt(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?s.checked=!1:qt(i)?re(s,"noValue"):(s.style.display="none",re(s,$Oe),f=!0),s.setAttribute(tu,r),s.setAttribute(ru,n),!f&&u){var c="";if(u.value)c=typeof u.value=="function"?u.value.call(this,r,n,o,i):u.value;else if(u.property){var h=e.getDataAtRowProp(r,u.property);c=h!==null?h:""}var d=xOe(l,c,u.separated!==!0);u.position==="before"?u.separated?(t.appendChild(d),t.appendChild(s)):(d.appendChild(s),s=d):(!u.position||u.position==="after")&&(u.separated?(t.appendChild(s),t.appendChild(d)):(d.insertBefore(s,d.firstChild),s=d))}(!u||u&&!u.separated)&&t.appendChild(s),f&&t.appendChild(l.createTextNode("#bad-value#")),XM.has(e)||(XM.set(e,!0),v());function v(){var w=e.getShortcutManager(),S=w.getContext("grid"),C={group:AOe};S.addShortcuts([{keys:[["space"]],callback:function(){return g(),!p()}},{keys:[["enter"]],callback:function(){return g(),!p()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return g(!0),!p()},relativeToGroup:mc,position:"before"}],C)}function g(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=e.getSelectedRange();if(S)for(var C=0;C<S.length;C++){for(var P=S[C].getTopStartCorner(),R=P.row,V=P.col,U=S[C].getBottomEndCorner(),X=U.row,Y=U.col,q=[],Z=R;Z<=X;Z+=1)for(var ie=V;ie<=Y;ie+=1){var J=e.getCellMeta(Z,ie);if(J.type!=="checkbox")return;if(J.readOnly!==!0){typeof J.checkedTemplate>"u"&&(J.checkedTemplate=!0),typeof J.uncheckedTemplate>"u"&&(J.uncheckedTemplate=!1);var le=e.getDataAtCell(Z,ie);w===!1?[J.checkedTemplate,J.checkedTemplate.toString()].includes(le)?q.push([Z,ie,J.uncheckedTemplate]):[J.uncheckedTemplate,J.uncheckedTemplate.toString(),null,void 0].includes(le)&&q.push([Z,ie,J.checkedTemplate]):q.push([Z,ie,J.uncheckedTemplate])}}q.length>0&&e.setDataAtCell(q)}}function p(){var w=e.getSelectedRange();if(w){for(var S=0;S<w.length;S++)for(var C=w[S].getTopStartCorner(),P=w[S].getBottomEndCorner(),R=C.row;R<=P.row;R++)for(var V=C.col;V<=P.col;V++){var U=e.getCellMeta(R,V);if(U.type!=="checkbox")return!1;var X=e.getCell(R,V);if(X==null)return!0;var Y=X.querySelectorAll("input[type=checkbox]");if(Y.length>0&&!U.readOnly)return!0}return!1}}}VT.RENDERER_TYPE=a2;function IOe(e){var t=ZM.get(e);if(!t){var r=e.rootElement;t=new It(e),t.addEventListener(r,"click",function(n){return NOe(n,e)}),t.addEventListener(r,"mouseup",function(n){return DOe(n,e)}),t.addEventListener(r,"change",function(n){return HOe(n,e)}),ZM.set(e,t)}return t}function MOe(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function xOe(e,t,r){var n=e.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(e.createTextNode(t)),n.cloneNode(!0)}function DOe(e,t){var r=e.target;WT(r)&&(!r.hasAttribute(tu)||!r.hasAttribute(ru)||setTimeout(t.listen,10))}function NOe(e,t){var r=e.target;if(WT(r)&&!(!r.hasAttribute(tu)||!r.hasAttribute(ru))){var n=parseInt(r.getAttribute(tu),10),o=parseInt(r.getAttribute(ru),10),i=t.getCellMeta(n,o);i.readOnly&&e.preventDefault()}}function HOe(e,t){var r=e.target;if(WT(r)&&!(!r.hasAttribute(tu)||!r.hasAttribute(ru))){var n=parseInt(r.getAttribute(tu),10),o=parseInt(r.getAttribute(ru),10),i=t.getCellMeta(n,o);if(!i.readOnly){var a=null;e.target.checked?a=i.uncheckedTemplate===void 0?!0:i.checkedTemplate:a=i.uncheckedTemplate===void 0?!1:i.uncheckedTemplate,t.setDataAtCell(n,o,a)}}}function WT(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}function uy(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var l2={exports:{}};(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,o,i){function a(u,f){if(!o[u]){if(!n[u]){var c=typeof uy=="function"&&uy;if(!f&&c)return c(u,!0);if(l)return l(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=o[u]={exports:{}};n[u][0].call(d.exports,function(v){return a(n[u][1][v]||v)},d,d.exports,r,n,o,i)}return o[u].exports}for(var l=typeof uy=="function"&&uy,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(r,n,o){(function(i){var a,l=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,u=Math.floor,f="[BigNumber Error] ",c=f+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,v=9007199254740991,g=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],p=1e7,w=1e9;function S(Y){var q=0|Y;return 0<Y||Y===q?q:q-1}function C(Y){for(var q,Z,ie=1,J=Y.length,le=Y[0]+"";ie<J;){for(q=Y[ie++]+"",Z=d-q.length;Z--;q="0"+q);le+=q}for(J=le.length;le.charCodeAt(--J)===48;);return le.slice(0,J+1||1)}function P(Y,q){var Z,ie,J=Y.c,le=q.c,Ce=Y.s,we=q.s,_e=Y.e,k=q.e;if(!Ce||!we)return null;if(Z=J&&!J[0],ie=le&&!le[0],Z||ie)return Z?ie?0:-we:Ce;if(Ce!=we)return Ce;if(Z=Ce<0,ie=_e==k,!J||!le)return ie?0:!J^Z?1:-1;if(!ie)return k<_e^Z?1:-1;for(we=(_e=J.length)<(k=le.length)?_e:k,Ce=0;Ce<we;Ce++)if(J[Ce]!=le[Ce])return J[Ce]>le[Ce]^Z?1:-1;return _e==k?0:k<_e^Z?1:-1}function R(Y,q,Z,ie){if(Y<q||Z<Y||Y!==(Y<0?s(Y):u(Y)))throw Error(f+(ie||"Argument")+(typeof Y=="number"?Y<q||Z<Y?" out of range: ":" not an integer: ":" not a primitive number: ")+String(Y))}function V(Y){var q=Y.c.length-1;return S(Y.e/d)==q&&Y.c[q]%2!=0}function U(Y,q){return(1<Y.length?Y.charAt(0)+"."+Y.slice(1):Y)+(q<0?"e":"e+")+q}function X(Y,q,Z){var ie,J;if(q<0){for(J=Z+".";++q;J+=Z);Y=J+Y}else if(++q>(ie=Y.length)){for(J=Z,q-=ie;--q;J+=Z);Y+=J}else q<ie&&(Y=Y.slice(0,q)+"."+Y.slice(q));return Y}(a=function Y(q){var Z,ie,J,le,Ce,we,_e,k,y,m,b=K.prototype={constructor:K,toString:null,valueOf:null},_=new K(1),T=20,A=4,F=-7,W=21,G=-1e7,Q=1e7,ee=!1,se=1,Te=0,de={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},ye="0123456789abcdefghijklmnopqrstuvwxyz";function K(O,E){var $,H,M,j,x,D,B,L,z=this;if(!(z instanceof K))return new K(O,E);if(E==null){if(O instanceof K)return z.s=O.s,z.e=O.e,void(z.c=(O=O.c)?O.slice():O);if((D=typeof O=="number")&&0*O==0){if(z.s=1/O<0?(O=-O,-1):1,O===~~O){for(j=0,x=O;10<=x;x/=10,j++);return z.e=j,void(z.c=[O])}L=String(O)}else{if(L=String(O),!l.test(L))return J(z,L,D);z.s=L.charCodeAt(0)==45?(L=L.slice(1),-1):1}-1<(j=L.indexOf("."))&&(L=L.replace(".","")),0<(x=L.search(/e/i))?(j<0&&(j=x),j+=+L.slice(x+1),L=L.substring(0,x)):j<0&&(j=L.length)}else{if(R(E,2,ye.length,"Base"),L=String(O),E==10)return Ie(z=new K(O instanceof K?O:L),T+z.e+1,A);if(D=typeof O=="number"){if(0*O!=0)return J(z,L,D,E);if(z.s=1/O<0?(L=L.slice(1),-1):1,K.DEBUG&&15<L.replace(/^0\.0*|\./,"").length)throw Error(c+O);D=!1}else z.s=L.charCodeAt(0)===45?(L=L.slice(1),-1):1;for($=ye.slice(0,E),j=x=0,B=L.length;x<B;x++)if($.indexOf(H=L.charAt(x))<0){if(H=="."){if(j<x){j=B;continue}}else if(!M&&(L==L.toUpperCase()&&(L=L.toLowerCase())||L==L.toLowerCase()&&(L=L.toUpperCase()))){M=!0,x=-1,j=0;continue}return J(z,String(O),D,E)}-1<(j=(L=ie(L,E,10,z.s)).indexOf("."))?L=L.replace(".",""):j=L.length}for(x=0;L.charCodeAt(x)===48;x++);for(B=L.length;L.charCodeAt(--B)===48;);if(L=L.slice(x,++B)){if(B-=x,D&&K.DEBUG&&15<B&&(v<O||O!==u(O)))throw Error(c+z.s*O);if(Q<(j=j-x-1))z.c=z.e=null;else if(j<G)z.c=[z.e=0];else{if(z.e=j,z.c=[],x=(j+1)%d,j<0&&(x+=d),x<B){for(x&&z.c.push(+L.slice(0,x)),B-=d;x<B;)z.c.push(+L.slice(x,x+=d));L=L.slice(x),x=d-L.length}else x-=B;for(;x--;L+="0");z.c.push(+L)}}else z.c=[z.e=0]}function xe(O,E,$,H){var M,j,x,D,B;if($==null?$=A:R($,0,8),!O.c)return O.toString();if(M=O.c[0],x=O.e,E==null)B=C(O.c),B=H==1||H==2&&(x<=F||W<=x)?U(B,x):X(B,x,"0");else if(j=(O=Ie(new K(O),E,$)).e,D=(B=C(O.c)).length,H==1||H==2&&(E<=j||j<=F)){for(;D<E;B+="0",D++);B=U(B,j)}else if(E-=x,B=X(B,j,"0"),D<j+1){if(0<--E)for(B+=".";E--;B+="0");}else if(0<(E+=j-D))for(j+1==D&&(B+=".");E--;B+="0");return O.s<0&&M?"-"+B:B}function Ke(O,E){for(var $,H=1,M=new K(O[0]);H<O.length;H++){if(!($=new K(O[H])).s){M=$;break}E.call(M,$)&&(M=$)}return M}function $e(O,E,$){for(var H=1,M=E.length;!E[--M];E.pop());for(M=E[0];10<=M;M/=10,H++);return($=H+$*d-1)>Q?O.c=O.e=null:O.c=$<G?[O.e=0]:(O.e=$,E),O}function Ie(O,E,$,H){var M,j,x,D,B,L,z,ae=O.c,me=g;if(ae){e:{for(M=1,D=ae[0];10<=D;D/=10,M++);if((j=E-M)<0)j+=d,x=E,z=(B=ae[L=0])/me[M-x-1]%10|0;else if((L=s((j+1)/d))>=ae.length){if(!H)break e;for(;ae.length<=L;ae.push(0));B=z=0,x=(j%=d)-d+(M=1)}else{for(B=D=ae[L],M=1;10<=D;D/=10,M++);z=(x=(j%=d)-d+M)<0?0:B/me[M-x-1]%10|0}if(H=H||E<0||ae[L+1]!=null||(x<0?B:B%me[M-x-1]),H=$<4?(z||H)&&($==0||$==(O.s<0?3:2)):5<z||z==5&&($==4||H||$==6&&(0<j?0<x?B/me[M-x]:0:ae[L-1])%10&1||$==(O.s<0?8:7)),E<1||!ae[0])return ae.length=0,H?(E-=O.e+1,ae[0]=me[(d-E%d)%d],O.e=-E||0):ae[0]=O.e=0,O;if(j==0?(ae.length=L,D=1,L--):(ae.length=L+1,D=me[d-j],ae[L]=0<x?u(B/me[M-x]%me[x])*D:0),H)for(;;){if(L==0){for(j=1,x=ae[0];10<=x;x/=10,j++);for(x=ae[0]+=D,D=1;10<=x;x/=10,D++);j!=D&&(O.e++,ae[0]==h&&(ae[0]=1));break}if(ae[L]+=D,ae[L]!=h)break;ae[L--]=0,D=1}for(j=ae.length;ae[--j]===0;ae.pop());}O.e>Q?O.c=O.e=null:O.e<G&&(O.c=[O.e=0])}return O}function Ae(O){var E,$=O.e;return $===null?O.toString():(E=C(O.c),E=$<=F||W<=$?U(E,$):X(E,$,"0"),O.s<0?"-"+E:E)}return K.clone=Y,K.ROUND_UP=0,K.ROUND_DOWN=1,K.ROUND_CEIL=2,K.ROUND_FLOOR=3,K.ROUND_HALF_UP=4,K.ROUND_HALF_DOWN=5,K.ROUND_HALF_EVEN=6,K.ROUND_HALF_CEIL=7,K.ROUND_HALF_FLOOR=8,K.EUCLID=9,K.config=K.set=function(O){var E,$;if(O!=null){if(typeof O!="object")throw Error(f+"Object expected: "+O);if(O.hasOwnProperty(E="DECIMAL_PLACES")&&(R($=O[E],0,w,E),T=$),O.hasOwnProperty(E="ROUNDING_MODE")&&(R($=O[E],0,8,E),A=$),O.hasOwnProperty(E="EXPONENTIAL_AT")&&(($=O[E])&&$.pop?(R($[0],-w,0,E),R($[1],0,w,E),F=$[0],W=$[1]):(R($,-w,w,E),F=-(W=$<0?-$:$))),O.hasOwnProperty(E="RANGE"))if(($=O[E])&&$.pop)R($[0],-w,-1,E),R($[1],1,w,E),G=$[0],Q=$[1];else{if(R($,-w,w,E),!$)throw Error(f+E+" cannot be zero: "+$);G=-(Q=$<0?-$:$)}if(O.hasOwnProperty(E="CRYPTO")){if(($=O[E])!==!!$)throw Error(f+E+" not true or false: "+$);if($){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw ee=!$,Error(f+"crypto unavailable");ee=$}else ee=$}if(O.hasOwnProperty(E="MODULO_MODE")&&(R($=O[E],0,9,E),se=$),O.hasOwnProperty(E="POW_PRECISION")&&(R($=O[E],0,w,E),Te=$),O.hasOwnProperty(E="FORMAT")){if(typeof($=O[E])!="object")throw Error(f+E+" not an object: "+$);de=$}if(O.hasOwnProperty(E="ALPHABET")){if(typeof($=O[E])!="string"||/^.$|[+-.\s]|(.).*\1/.test($))throw Error(f+E+" invalid: "+$);ye=$}}return{DECIMAL_PLACES:T,ROUNDING_MODE:A,EXPONENTIAL_AT:[F,W],RANGE:[G,Q],CRYPTO:ee,MODULO_MODE:se,POW_PRECISION:Te,FORMAT:de,ALPHABET:ye}},K.isBigNumber=function(O){return O instanceof K||O&&O._isBigNumber===!0||!1},K.maximum=K.max=function(){return Ke(arguments,b.lt)},K.minimum=K.min=function(){return Ke(arguments,b.gt)},K.random=(le=9007199254740992,Ce=Math.random()*le&2097151?function(){return u(Math.random()*le)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(O){var E,$,H,M,j,x=0,D=[],B=new K(_);if(O==null?O=T:R(O,0,w),M=s(O/d),ee)if(crypto.getRandomValues){for(E=crypto.getRandomValues(new Uint32Array(M*=2));x<M;)9e15<=(j=131072*E[x]+(E[x+1]>>>11))?($=crypto.getRandomValues(new Uint32Array(2)),E[x]=$[0],E[x+1]=$[1]):(D.push(j%1e14),x+=2);x=M/2}else{if(!crypto.randomBytes)throw ee=!1,Error(f+"crypto unavailable");for(E=crypto.randomBytes(M*=7);x<M;)9e15<=(j=281474976710656*(31&E[x])+1099511627776*E[x+1]+4294967296*E[x+2]+16777216*E[x+3]+(E[x+4]<<16)+(E[x+5]<<8)+E[x+6])?crypto.randomBytes(7).copy(E,x):(D.push(j%1e14),x+=7);x=M/7}if(!ee)for(;x<M;)(j=Ce())<9e15&&(D[x++]=j%1e14);for(M=D[--x],O%=d,M&&O&&(j=g[d-O],D[x]=u(M/j)*j);D[x]===0;D.pop(),x--);if(x<0)D=[H=0];else{for(H=-1;D[0]===0;D.splice(0,1),H-=d);for(x=1,j=D[0];10<=j;j/=10,x++);x<d&&(H-=d-x)}return B.e=H,B.c=D,B}),K.sum=function(){for(var O=1,E=arguments,$=new K(E[0]);O<E.length;)$=$.plus(E[O++]);return $},ie=function(){var O="0123456789";function E($,H,M,j){for(var x,D,B=[0],L=0,z=$.length;L<z;){for(D=B.length;D--;B[D]*=H);for(B[0]+=j.indexOf($.charAt(L++)),x=0;x<B.length;x++)B[x]>M-1&&(B[x+1]==null&&(B[x+1]=0),B[x+1]+=B[x]/M|0,B[x]%=M)}return B.reverse()}return function($,H,M,j,x){var D,B,L,z,ae,me,Ee,Ne,Xe=$.indexOf("."),ht=T,He=A;for(0<=Xe&&(z=Te,Te=0,$=$.replace(".",""),me=(Ne=new K(H)).pow($.length-Xe),Te=z,Ne.c=E(X(C(me.c),me.e,"0"),10,M,O),Ne.e=Ne.c.length),L=z=(Ee=E($,H,M,x?(D=ye,O):(D=O,ye))).length;Ee[--z]==0;Ee.pop());if(!Ee[0])return D.charAt(0);if(Xe<0?--L:(me.c=Ee,me.e=L,me.s=j,Ee=(me=Z(me,Ne,ht,He,M)).c,ae=me.r,L=me.e),Xe=Ee[B=L+ht+1],z=M/2,ae=ae||B<0||Ee[B+1]!=null,ae=He<4?(Xe!=null||ae)&&(He==0||He==(me.s<0?3:2)):z<Xe||Xe==z&&(He==4||ae||He==6&&1&Ee[B-1]||He==(me.s<0?8:7)),B<1||!Ee[0])$=ae?X(D.charAt(1),-ht,D.charAt(0)):D.charAt(0);else{if(Ee.length=B,ae)for(--M;++Ee[--B]>M;)Ee[B]=0,B||(++L,Ee=[1].concat(Ee));for(z=Ee.length;!Ee[--z];);for(Xe=0,$="";Xe<=z;$+=D.charAt(Ee[Xe++]));$=X($,L,D.charAt(0))}return $}}(),Z=function(){function O(H,M,j){var x,D,B,L,z=0,ae=H.length,me=M%p,Ee=M/p|0;for(H=H.slice();ae--;)z=((D=me*(B=H[ae]%p)+(x=Ee*B+(L=H[ae]/p|0)*me)%p*p+z)/j|0)+(x/p|0)+Ee*L,H[ae]=D%j;return z&&(H=[z].concat(H)),H}function E(H,M,j,x){var D,B;if(j!=x)B=x<j?1:-1;else for(D=B=0;D<j;D++)if(H[D]!=M[D]){B=H[D]>M[D]?1:-1;break}return B}function $(H,M,j,x){for(var D=0;j--;)H[j]-=D,D=H[j]<M[j]?1:0,H[j]=D*x+H[j]-M[j];for(;!H[0]&&1<H.length;H.splice(0,1));}return function(H,M,j,x,D){var B,L,z,ae,me,Ee,Ne,Xe,ht,He,Le,rt,it,et,Ze,Qe,Lt,yt=H.s==M.s?1:-1,st=H.c,nt=M.c;if(!(st&&st[0]&&nt&&nt[0]))return new K(H.s&&M.s&&(st?!nt||st[0]!=nt[0]:nt)?st&&st[0]==0||!nt?0*yt:yt/0:NaN);for(ht=(Xe=new K(yt)).c=[],yt=j+(L=H.e-M.e)+1,D||(D=h,L=S(H.e/d)-S(M.e/d),yt=yt/d|0),z=0;nt[z]==(st[z]||0);z++);if(nt[z]>(st[z]||0)&&L--,yt<0)ht.push(1),ae=!0;else{for(et=st.length,Qe=nt.length,yt+=2,1<(me=u(D/(nt[z=0]+1)))&&(nt=O(nt,me,D),st=O(st,me,D),Qe=nt.length,et=st.length),it=Qe,Le=(He=st.slice(0,Qe)).length;Le<Qe;He[Le++]=0);Lt=nt.slice(),Lt=[0].concat(Lt),Ze=nt[0],nt[1]>=D/2&&Ze++;do{if(me=0,(B=E(nt,He,Qe,Le))<0){if(rt=He[0],Qe!=Le&&(rt=rt*D+(He[1]||0)),1<(me=u(rt/Ze)))for(D<=me&&(me=D-1),Ne=(Ee=O(nt,me,D)).length,Le=He.length;E(Ee,He,Ne,Le)==1;)me--,$(Ee,Qe<Ne?Lt:nt,Ne,D),Ne=Ee.length,B=1;else me==0&&(B=me=1),Ne=(Ee=nt.slice()).length;if(Ne<Le&&(Ee=[0].concat(Ee)),$(He,Ee,Le,D),Le=He.length,B==-1)for(;E(nt,He,Qe,Le)<1;)me++,$(He,Qe<Le?Lt:nt,Le,D),Le=He.length}else B===0&&(me++,He=[0]);ht[z++]=me,He[0]?He[Le++]=st[it]||0:(He=[st[it]],Le=1)}while((it++<et||He[0]!=null)&&yt--);ae=He[0]!=null,ht[0]||ht.splice(0,1)}if(D==h){for(z=1,yt=ht[0];10<=yt;yt/=10,z++);Ie(Xe,j+(Xe.e=z+L*d-1)+1,x,ae)}else Xe.e=L,Xe.r=+ae;return Xe}}(),we=/^(-?)0([xbo])(?=\w[\w.]*$)/i,_e=/^([^.]+)\.$/,k=/^\.([^.]+)$/,y=/^-?(Infinity|NaN)$/,m=/^\s*\+(?=[\w.])|^\s+|\s+$/g,J=function(O,E,$,H){var M,j=$?E:E.replace(m,"");if(y.test(j))O.s=isNaN(j)?null:j<0?-1:1,O.c=O.e=null;else{if(!$&&(j=j.replace(we,function(x,D,B){return M=(B=B.toLowerCase())=="x"?16:B=="b"?2:8,H&&H!=M?x:D}),H&&(M=H,j=j.replace(_e,"$1").replace(k,"0.$1")),E!=j))return new K(j,M);if(K.DEBUG)throw Error(f+"Not a"+(H?" base "+H:"")+" number: "+E);O.c=O.e=O.s=null}},b.absoluteValue=b.abs=function(){var O=new K(this);return O.s<0&&(O.s=1),O},b.comparedTo=function(O,E){return P(this,new K(O,E))},b.decimalPlaces=b.dp=function(O,E){var $,H,M;if(O!=null)return R(O,0,w),E==null?E=A:R(E,0,8),Ie(new K(this),O+this.e+1,E);if(!($=this.c))return null;if(H=((M=$.length-1)-S(this.e/d))*d,M=$[M])for(;M%10==0;M/=10,H--);return H<0&&(H=0),H},b.dividedBy=b.div=function(O,E){return Z(this,new K(O,E),T,A)},b.dividedToIntegerBy=b.idiv=function(O,E){return Z(this,new K(O,E),0,1)},b.exponentiatedBy=b.pow=function(O,E){var $,H,M,j,x,D,B,L,z=this;if((O=new K(O)).c&&!O.isInteger())throw Error(f+"Exponent not an integer: "+Ae(O));if(E!=null&&(E=new K(E)),x=14<O.e,!z.c||!z.c[0]||z.c[0]==1&&!z.e&&z.c.length==1||!O.c||!O.c[0])return L=new K(Math.pow(+Ae(z),x?2-V(O):+Ae(O))),E?L.mod(E):L;if(D=O.s<0,E){if(E.c?!E.c[0]:!E.s)return new K(NaN);(H=!D&&z.isInteger()&&E.isInteger())&&(z=z.mod(E))}else{if(9<O.e&&(0<z.e||z.e<-1||(z.e==0?1<z.c[0]||x&&24e7<=z.c[1]:z.c[0]<8e13||x&&z.c[0]<=9999975e7)))return j=z.s<0&&V(O)?-0:0,-1<z.e&&(j=1/j),new K(D?1/j:j);Te&&(j=s(Te/d+2))}for(B=x?($=new K(.5),D&&(O.s=1),V(O)):(M=Math.abs(+Ae(O)))%2,L=new K(_);;){if(B){if(!(L=L.times(z)).c)break;j?L.c.length>j&&(L.c.length=j):H&&(L=L.mod(E))}if(M){if((M=u(M/2))===0)break;B=M%2}else if(Ie(O=O.times($),O.e+1,1),14<O.e)B=V(O);else{if((M=+Ae(O))==0)break;B=M%2}z=z.times(z),j?z.c&&z.c.length>j&&(z.c.length=j):H&&(z=z.mod(E))}return H?L:(D&&(L=_.div(L)),E?L.mod(E):j?Ie(L,Te,A,void 0):L)},b.integerValue=function(O){var E=new K(this);return O==null?O=A:R(O,0,8),Ie(E,E.e+1,O)},b.isEqualTo=b.eq=function(O,E){return P(this,new K(O,E))===0},b.isFinite=function(){return!!this.c},b.isGreaterThan=b.gt=function(O,E){return 0<P(this,new K(O,E))},b.isGreaterThanOrEqualTo=b.gte=function(O,E){return(E=P(this,new K(O,E)))===1||E===0},b.isInteger=function(){return!!this.c&&S(this.e/d)>this.c.length-2},b.isLessThan=b.lt=function(O,E){return P(this,new K(O,E))<0},b.isLessThanOrEqualTo=b.lte=function(O,E){return(E=P(this,new K(O,E)))===-1||E===0},b.isNaN=function(){return!this.s},b.isNegative=function(){return this.s<0},b.isPositive=function(){return 0<this.s},b.isZero=function(){return!!this.c&&this.c[0]==0},b.minus=function(O,E){var $,H,M,j,x=this,D=x.s;if(E=(O=new K(O,E)).s,!D||!E)return new K(NaN);if(D!=E)return O.s=-E,x.plus(O);var B=x.e/d,L=O.e/d,z=x.c,ae=O.c;if(!B||!L){if(!z||!ae)return z?(O.s=-E,O):new K(ae?x:NaN);if(!z[0]||!ae[0])return ae[0]?(O.s=-E,O):new K(z[0]?x:A==3?-0:0)}if(B=S(B),L=S(L),z=z.slice(),D=B-L){for((M=(j=D<0)?(D=-D,z):(L=B,ae)).reverse(),E=D;E--;M.push(0));M.reverse()}else for(H=(j=(D=z.length)<(E=ae.length))?D:E,D=E=0;E<H;E++)if(z[E]!=ae[E]){j=z[E]<ae[E];break}if(j&&(M=z,z=ae,ae=M,O.s=-O.s),0<(E=(H=ae.length)-($=z.length)))for(;E--;z[$++]=0);for(E=h-1;D<H;){if(z[--H]<ae[H]){for($=H;$&&!z[--$];z[$]=E);--z[$],z[H]+=h}z[H]-=ae[H]}for(;z[0]==0;z.splice(0,1),--L);return z[0]?$e(O,z,L):(O.s=A==3?-1:1,O.c=[O.e=0],O)},b.modulo=b.mod=function(O,E){var $,H,M=this;return O=new K(O,E),!M.c||!O.s||O.c&&!O.c[0]?new K(NaN):!O.c||M.c&&!M.c[0]?new K(M):(se==9?(H=O.s,O.s=1,$=Z(M,O,0,3),O.s=H,$.s*=H):$=Z(M,O,0,se),(O=M.minus($.times(O))).c[0]||se!=1||(O.s=M.s),O)},b.multipliedBy=b.times=function(O,E){var $,H,M,j,x,D,B,L,z,ae,me,Ee,Ne,Xe,ht,He=this,Le=He.c,rt=(O=new K(O,E)).c;if(!(Le&&rt&&Le[0]&&rt[0]))return!He.s||!O.s||Le&&!Le[0]&&!rt||rt&&!rt[0]&&!Le?O.c=O.e=O.s=null:(O.s*=He.s,Le&&rt?(O.c=[0],O.e=0):O.c=O.e=null),O;for(H=S(He.e/d)+S(O.e/d),O.s*=He.s,(B=Le.length)<(ae=rt.length)&&(Ne=Le,Le=rt,rt=Ne,M=B,B=ae,ae=M),M=B+ae,Ne=[];M--;Ne.push(0));for(Xe=h,ht=p,M=ae;0<=--M;){for($=0,me=rt[M]%ht,Ee=rt[M]/ht|0,j=M+(x=B);M<j;)$=((L=me*(L=Le[--x]%ht)+(D=Ee*L+(z=Le[x]/ht|0)*me)%ht*ht+Ne[j]+$)/Xe|0)+(D/ht|0)+Ee*z,Ne[j--]=L%Xe;Ne[j]=$}return $?++H:Ne.splice(0,1),$e(O,Ne,H)},b.negated=function(){var O=new K(this);return O.s=-O.s||null,O},b.plus=function(O,E){var $,H=this,M=H.s;if(E=(O=new K(O,E)).s,!M||!E)return new K(NaN);if(M!=E)return O.s=-E,H.minus(O);var j=H.e/d,x=O.e/d,D=H.c,B=O.c;if(!j||!x){if(!D||!B)return new K(M/0);if(!D[0]||!B[0])return B[0]?O:new K(D[0]?H:0*M)}if(j=S(j),x=S(x),D=D.slice(),M=j-x){for(($=0<M?(x=j,B):(M=-M,D)).reverse();M--;$.push(0));$.reverse()}for((M=D.length)-(E=B.length)<0&&($=B,B=D,D=$,E=M),M=0;E;)M=(D[--E]=D[E]+B[E]+M)/h|0,D[E]=h===D[E]?0:D[E]%h;return M&&(D=[M].concat(D),++x),$e(O,D,x)},b.precision=b.sd=function(O,E){var $,H,M;if(O!=null&&O!==!!O)return R(O,1,w),E==null?E=A:R(E,0,8),Ie(new K(this),O,E);if(!($=this.c))return null;if(H=(M=$.length-1)*d+1,M=$[M]){for(;M%10==0;M/=10,H--);for(M=$[0];10<=M;M/=10,H++);}return O&&this.e+1>H&&(H=this.e+1),H},b.shiftedBy=function(O){return R(O,-v,v),this.times("1e"+O)},b.squareRoot=b.sqrt=function(){var O,E,$,H,M,j=this,x=j.c,D=j.s,B=j.e,L=T+4,z=new K("0.5");if(D!==1||!x||!x[0])return new K(!D||D<0&&(!x||x[0])?NaN:x?j:1/0);if(($=(D=Math.sqrt(+Ae(j)))==0||D==1/0?(((E=C(x)).length+B)%2==0&&(E+="0"),D=Math.sqrt(+E),B=S((B+1)/2)-(B<0||B%2),new K(E=D==1/0?"1e"+B:(E=D.toExponential()).slice(0,E.indexOf("e")+1)+B)):new K(D+"")).c[0]){for((D=(B=$.e)+L)<3&&(D=0);;)if(M=$,$=z.times(M.plus(Z(j,M,L,1))),C(M.c).slice(0,D)===(E=C($.c)).slice(0,D)){if($.e<B&&--D,(E=E.slice(D-3,D+1))!="9999"&&(H||E!="4999")){+E&&(+E.slice(1)||E.charAt(0)!="5")||(Ie($,$.e+T+2,1),O=!$.times($).eq(j));break}if(!H&&(Ie(M,M.e+T+2,0),M.times(M).eq(j))){$=M;break}L+=4,D+=4,H=1}}return Ie($,$.e+T+1,A,O)},b.toExponential=function(O,E){return O!=null&&(R(O,0,w),O++),xe(this,O,E,1)},b.toFixed=function(O,E){return O!=null&&(R(O,0,w),O=O+this.e+1),xe(this,O,E)},b.toFormat=function(O,E,$){var H;if($==null)O!=null&&E&&typeof E=="object"?($=E,E=null):O&&typeof O=="object"?($=O,O=E=null):$=de;else if(typeof $!="object")throw Error(f+"Argument not an object: "+$);if(H=this.toFixed(O,E),this.c){var M,j=H.split("."),x=+$.groupSize,D=+$.secondaryGroupSize,B=$.groupSeparator||"",L=j[0],z=j[1],ae=this.s<0,me=ae?L.slice(1):L,Ee=me.length;if(D&&(M=x,x=D,Ee-=D=M),0<x&&0<Ee){for(M=Ee%x||x,L=me.substr(0,M);M<Ee;M+=x)L+=B+me.substr(M,x);0<D&&(L+=B+me.slice(M)),ae&&(L="-"+L)}H=z?L+($.decimalSeparator||"")+((D=+$.fractionGroupSize)?z.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+($.fractionGroupSeparator||"")):z):L}return($.prefix||"")+H+($.suffix||"")},b.toFraction=function(O){var E,$,H,M,j,x,D,B,L,z,ae,me,Ee=this,Ne=Ee.c;if(O!=null&&(!(D=new K(O)).isInteger()&&(D.c||D.s!==1)||D.lt(_)))throw Error(f+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+Ae(D));if(!Ne)return new K(Ee);for(E=new K(_),L=$=new K(_),H=B=new K(_),me=C(Ne),j=E.e=me.length-Ee.e-1,E.c[0]=g[(x=j%d)<0?d+x:x],O=!O||0<D.comparedTo(E)?0<j?E:L:D,x=Q,Q=1/0,D=new K(me),B.c[0]=0;z=Z(D,E,0,1),(M=$.plus(z.times(H))).comparedTo(O)!=1;)$=H,H=M,L=B.plus(z.times(M=L)),B=M,E=D.minus(z.times(M=E)),D=M;return M=Z(O.minus($),H,0,1),B=B.plus(M.times(L)),$=$.plus(M.times(H)),B.s=L.s=Ee.s,ae=Z(L,H,j*=2,A).minus(Ee).abs().comparedTo(Z(B,$,j,A).minus(Ee).abs())<1?[L,H]:[B,$],Q=x,ae},b.toNumber=function(){return+Ae(this)},b.toPrecision=function(O,E){return O!=null&&R(O,1,w),xe(this,O,E,2)},b.toString=function(O){var E,$=this,H=$.s,M=$.e;return M===null?H?(E="Infinity",H<0&&(E="-"+E)):E="NaN":(E=O==null?M<=F||W<=M?U(C($.c),M):X(C($.c),M,"0"):O===10?X(C(($=Ie(new K($),T+M+1,A)).c),$.e,"0"):(R(O,2,ye.length,"Base"),ie(X(C($.c),M,"0"),10,O,H,!0)),H<0&&$.c[0]&&(E="-"+E)),E},b.valueOf=b.toJSON=function(){return Ae(this)},b._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(b[Symbol.toStringTag]="BigNumber",b[Symbol.for("nodejs.util.inspect.custom")]=b.valueOf),q!=null&&K.set(q),K}()).default=a.BigNumber=a,n!==void 0&&n.exports?n.exports=a:(i||(i=typeof self<"u"&&self?self:window),i.BigNumber=a)})(this)},{}],2:[function(r,n,o){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(i){var a=i%10;return~~(i%100/10)==1?"th":a===1?"st":a===2?"nd":a===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,o){function i(S,C){return function(P){if(Array.isArray(P))return P}(S)||function(P,R){var V=[],U=!0,X=!1,Y=void 0;try{for(var q,Z=P[Symbol.iterator]();!(U=(q=Z.next()).done)&&(V.push(q.value),!R||V.length!==R);U=!0);}catch(ie){X=!0,Y=ie}finally{try{U||Z.return==null||Z.return()}finally{if(X)throw Y}}return V}(S,C)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=r("./globalState"),l=r("./validating"),s=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],f={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(S){var C=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},P=2<arguments.length?arguments[2]:void 0;if(typeof C=="string"&&(C=s.parseFormat(C)),!l.validateFormat(C))return"ERROR: invalid format";var R=C.prefix||"",V=C.postfix||"",U=function(X,Y,q){switch(Y.output){case"currency":return Y=w(Y,a.currentCurrencyDefaultFormat()),function(ye,K,xe){var Ke=xe.currentCurrency(),$e=Object.assign({},c,K),Ie=void 0,Ae="",O=!!$e.totalLength||!!$e.forceAverage||$e.average,E=K.currencyPosition||Ke.position,$=K.currencySymbol||Ke.symbol;$e.spaceSeparated&&(Ae=" "),E==="infix"&&(Ie=Ae+$+Ae);var H=p({instance:ye,providedFormat:K,state:xe,decimalSeparator:Ie});return E==="prefix"&&(H=ye._value<0&&$e.negative==="sign"?"-".concat(Ae).concat($).concat(H.slice(1)):$+Ae+H),E&&E!=="postfix"||(H=H+(Ae=O?"":Ae)+$),H}(X,Y,a);case"percent":return Y=w(Y,a.currentPercentageDefaultFormat()),function(ye,K,xe,Ke){var $e=K.prefixSymbol,Ie=p({instance:Ke(100*ye._value),providedFormat:K,state:xe}),Ae=Object.assign({},c,K);return $e?"%".concat(Ae.spaceSeparated?" ":"").concat(Ie):"".concat(Ie).concat(Ae.spaceSeparated?" ":"","%")}(X,Y,a,q);case"byte":return Y=w(Y,a.currentByteDefaultFormat()),_=X,A=a,F=q,W=(T=Y).base||"binary",G=f[W],Q=d(_._value,G.suffixes,G.scale),ee=Q.value,se=Q.suffix,Te=p({instance:F(ee),providedFormat:T,state:A,defaults:A.currentByteDefaultFormat()}),de=A.currentAbbreviations(),"".concat(Te).concat(de.spaced?" ":"").concat(se);case"time":return Y=w(Y,a.currentTimeDefaultFormat()),k=X,y=Math.floor(k._value/60/60),m=Math.floor((k._value-60*y*60)/60),b=Math.round(k._value-60*y*60-60*m),"".concat(y,":").concat(m<10?"0":"").concat(m,":").concat(b<10?"0":"").concat(b);case"ordinal":return Y=w(Y,a.currentOrdinalDefaultFormat()),Z=X,ie=Y,le=(J=a).currentOrdinal(),Ce=Object.assign({},c,ie),we=p({instance:Z,providedFormat:ie,state:J}),_e=le(Z._value),"".concat(we).concat(Ce.spaceSeparated?" ":"").concat(_e);case"number":default:return p({instance:X,providedFormat:Y,numbro:q})}var Z,ie,J,le,Ce,we,_e,k,y,m,b,_,T,A,F,W,G,Q,ee,se,Te,de}(S,C,P);return U=(U=R+U)+V}function d(S,C,P){var R=C[0],V=Math.abs(S);if(P<=V){for(var U=1;U<C.length;++U){var X=Math.pow(P,U),Y=Math.pow(P,U+1);if(X<=V&&V<Y){R=C[U],S/=X;break}}R===C[0]&&(S/=Math.pow(P,C.length-1),R=C[C.length-1])}return{value:S,suffix:R}}function v(S){for(var C="",P=0;P<S;P++)C+="0";return C}function g(S,C){return S.toString().indexOf("e")!==-1?function(P,R){var V=P.toString(),U=i(V.split("e"),2),X=U[0],Y=U[1],q=i(X.split("."),2),Z=q[0],ie=q[1],J=ie===void 0?"":ie;if(0<+Y)V=Z+J+v(Y-J.length);else{var le=".";le=+Z<0?"-0".concat(le):"0".concat(le);var Ce=(v(-Y-1)+Math.abs(Z)+J).substr(0,R);Ce.length<R&&(Ce+=v(R-Ce.length)),V=le+Ce}return 0<+Y&&0<R&&(V+=".".concat(v(R))),V}(S,C):(Math.round(+"".concat(S,"e+").concat(C))/Math.pow(10,C)).toFixed(C)}function p(S){var C=S.instance,P=S.providedFormat,R=S.state,V=R===void 0?a:R,U=S.decimalSeparator,X=S.defaults,Y=X===void 0?V.currentDefaults():X,q=C._value;if(q===0&&V.hasZeroFormat())return V.getZeroFormat();if(!isFinite(q))return q.toString();var Z,ie,J,le,Ce,we,_e,k,y=Object.assign({},c,Y,P),m=y.totalLength,b=m?0:y.characteristic,_=y.optionalCharacteristic,T=y.forceAverage,A=!!m||!!T||y.average,F=m?-1:A&&P.mantissa===void 0?0:y.mantissa,W=!m&&(P.optionalMantissa===void 0?F===-1:y.optionalMantissa),G=y.trimMantissa,Q=y.thousandSeparated,ee=y.spaceSeparated,se=y.negative,Te=y.forceSign,de=y.exponential,ye="";if(A){var K=function(O){var E=O.value,$=O.forceAverage,H=O.abbreviations,M=O.spaceSeparated,j=M!==void 0&&M,x=O.totalLength,D=x===void 0?0:x,B="",L=Math.abs(E),z=-1;if(L>=Math.pow(10,12)&&!$||$==="trillion"?(B=H.trillion,E/=Math.pow(10,12)):L<Math.pow(10,12)&&L>=Math.pow(10,9)&&!$||$==="billion"?(B=H.billion,E/=Math.pow(10,9)):L<Math.pow(10,9)&&L>=Math.pow(10,6)&&!$||$==="million"?(B=H.million,E/=Math.pow(10,6)):(L<Math.pow(10,6)&&L>=Math.pow(10,3)&&!$||$==="thousand")&&(B=H.thousand,E/=Math.pow(10,3)),B&&(B=(j?" ":"")+B),D){var ae=E.toString().split(".")[0];z=Math.max(D-ae.length,0)}return{value:E,abbreviation:B,mantissaPrecision:z}}({value:q,forceAverage:T,abbreviations:V.currentAbbreviations(),spaceSeparated:ee,totalLength:m});q=K.value,ye+=K.abbreviation,m&&(F=K.mantissaPrecision)}if(de){var xe=(ie=(Z={value:q,characteristicPrecision:b}).value,J=Z.characteristicPrecision,le=J===void 0?0:J,Ce=i(ie.toExponential().split("e"),2),we=Ce[0],_e=Ce[1],k=+we,le&&1<le&&(k*=Math.pow(10,le-1),_e=0<=(_e=+_e-(le-1))?"+".concat(_e):_e),{value:k,abbreviation:"e".concat(_e)});q=xe.value,ye=xe.abbreviation+ye}var Ke,$e,Ie,Ae=function(O,E,$,H,M){if(H===-1)return O;var j=g(E,H),x=i(j.toString().split("."),2),D=x[0],B=x[1],L=B===void 0?"":B;if(L.match(/^0+$/)&&($||M))return D;var z=L.match(/0+$/);return M&&z?"".concat(D,".").concat(L.toString().slice(0,z.index)):j.toString()}(q.toString(),q,W,F,G);return Ae=function(O,E,$,H,M){var j=H.currentDelimiters(),x=j.thousands;M=M||j.decimal;var D=j.thousandsSize||3,B=O.toString(),L=B.split(".")[0],z=B.split(".")[1];return $&&(E<0&&(L=L.slice(1)),function(ae,me){for(var Ee=[],Ne=0,Xe=ae;0<Xe;Xe--)Ne===me&&(Ee.unshift(Xe),Ne=0),Ne++;return Ee}(L.length,D).forEach(function(ae,me){L=L.slice(0,ae+me)+x+L.slice(ae+me)}),E<0&&(L="-".concat(L))),B=z?L+M+z:L}(Ae=function(O,E,$,H){var M=O,j=i(M.toString().split("."),2),x=j[0],D=j[1];if(x.match(/^-?0$/)&&$)return D?"".concat(x.replace("0",""),".").concat(D):x.replace("0","");if(x.length<H)for(var B=H-x.length,L=0;L<B;L++)M="0".concat(M);return M.toString()}(Ae,0,_,b),q,Q,V,U),(A||de)&&(Ae=Ae+ye),(Te||q<0)&&(Ke=Ae,Ie=se,Ae=($e=q)===0?Ke:+Ke==0?Ke.replace("-",""):0<$e?"+".concat(Ke):Ie==="sign"?Ke:"(".concat(Ke.replace("-",""),")")),Ae}function w(S,C){if(!S)return C;var P=Object.keys(S);return P.length===1&&P[0]==="output"?C:S}n.exports=function(S){return{format:function(){for(var C=arguments.length,P=new Array(C),R=0;R<C;R++)P[R]=arguments[R];return h.apply(void 0,P.concat([S]))},getByteUnit:function(){for(var C=arguments.length,P=new Array(C),R=0;R<C;R++)P[R]=arguments[R];return(function(V){var U=f.general;return d(V._value,U.suffixes,U.scale).suffix}).apply(void 0,P.concat([S]))},getBinaryByteUnit:function(){for(var C=arguments.length,P=new Array(C),R=0;R<C;R++)P[R]=arguments[R];return(function(V){var U=f.binary;return d(V._value,U.suffixes,U.scale).suffix}).apply(void 0,P.concat([S]))},getDecimalByteUnit:function(){for(var C=arguments.length,P=new Array(C),R=0;R<C;R++)P[R]=arguments[R];return(function(V){var U=f.decimal;return d(V._value,U.suffixes,U.scale).suffix}).apply(void 0,P.concat([S]))},formatOrDefault:w}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,o){var i=r("./en-US"),a=r("./validating"),l=r("./parsing"),s={},u=void 0,f={},c=null,h={};function d(g){u=g}function v(){return f[u]}s.languages=function(){return Object.assign({},f)},s.currentLanguage=function(){return u},s.currentCurrency=function(){return v().currency},s.currentAbbreviations=function(){return v().abbreviations},s.currentDelimiters=function(){return v().delimiters},s.currentOrdinal=function(){return v().ordinal},s.currentDefaults=function(){return Object.assign({},v().defaults,h)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().timeFormat)},s.setDefaults=function(g){g=l.parseFormat(g),a.validateFormat(g)&&(h=g)},s.getZeroFormat=function(){return c},s.setZeroFormat=function(g){return c=typeof g=="string"?g:null},s.hasZeroFormat=function(){return c!==null},s.languageData=function(g){if(g){if(f[g])return f[g];throw new Error('Unknown tag "'.concat(g,'"'))}return v()},s.registerLanguage=function(g){var p=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!a.validateLanguage(g))throw new Error("Invalid language data");f[g.languageTag]=g,p&&d(g.languageTag)},s.setLanguage=function(g){var p=1<arguments.length&&arguments[1]!==void 0?arguments[1]:i.languageTag;if(!f[g]){var w=g.split("-")[0],S=Object.keys(f).find(function(C){return C.split("-")[0]===w});return f[S]?void d(S):void d(p)}d(g)},s.registerLanguage(i),u=i.languageTag,n.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,o){n.exports=function(i){return{loadLanguagesInNode:function(a){return l=i,void a.forEach(function(s){var u=void 0;try{u=r("../languages/".concat(s))}catch{console.error('Unable to load "'.concat(s,'". No matching language file found.'))}u&&l.registerLanguage(u)});var l}}}},{}],6:[function(r,n,o){var i=r("bignumber.js");function a(l,s,u){var f=new i(l._value),c=s;return u.isNumbro(s)&&(c=s._value),c=new i(c),l._value=f.minus(c).toNumber(),l}n.exports=function(l){return{add:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.plus(v).toNumber(),f;var f,c,h,d,v},subtract:function(s,u){return a(s,u,l)},multiply:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.times(v).toNumber(),f;var f,c,h,d,v},divide:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.dividedBy(v).toNumber(),f;var f,c,h,d,v},set:function(s,u){return f=s,h=c=u,l.isNumbro(c)&&(h=c._value),f._value=h,f;var f,c,h},difference:function(s,u){return f=u,a(h=(c=l)(s._value),f,c),Math.abs(h._value);var f,c,h}}}},{"bignumber.js":1}],7:[function(r,n,o){function i(p,w){for(var S=0;S<w.length;S++){var C=w[S];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(p,C.key,C)}}var a=r("./globalState"),l=r("./validating"),s=r("./loading")(g),u=r("./unformatting"),f=r("./formatting")(g),c=r("./manipulating")(g),h=r("./parsing"),d=function(){function p(C){(function(P,R){if(!(P instanceof R))throw new TypeError("Cannot call a class as a function")})(this,p),this._value=C}var w,S;return w=p,(S=[{key:"clone",value:function(){return g(this._value)}},{key:"format",value:function(){var C=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return f.format(this,C)}},{key:"formatCurrency",value:function(C){return typeof C=="string"&&(C=h.parseFormat(C)),(C=f.formatOrDefault(C,a.currentCurrencyDefaultFormat())).output="currency",f.format(this,C)}},{key:"formatTime",value:function(){var C=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return C.output="time",f.format(this,C)}},{key:"binaryByteUnits",value:function(){return f.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return f.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return f.getByteUnit(this)}},{key:"difference",value:function(C){return c.difference(this,C)}},{key:"add",value:function(C){return c.add(this,C)}},{key:"subtract",value:function(C){return c.subtract(this,C)}},{key:"multiply",value:function(C){return c.multiply(this,C)}},{key:"divide",value:function(C){return c.divide(this,C)}},{key:"set",value:function(C){return c.set(this,v(C))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(w.prototype,S),p}();function v(p){var w=p;return g.isNumbro(p)?w=p._value:typeof p=="string"?w=g.unformat(p):isNaN(p)&&(w=NaN),w}function g(p){return new d(v(p))}g.version="2.1.2",g.isNumbro=function(p){return p instanceof d},g.language=a.currentLanguage,g.registerLanguage=a.registerLanguage,g.setLanguage=a.setLanguage,g.languages=a.languages,g.languageData=a.languageData,g.zeroFormat=a.setZeroFormat,g.defaultFormat=a.currentDefaults,g.setDefaults=a.setDefaults,g.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,g.validate=l.validate,g.loadLanguagesInNode=s.loadLanguagesInNode,g.unformat=u.unformat,n.exports=g},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,o){n.exports={parseFormat:function(i){var a,l,s,u,f,c,h,d,v,g,p,w,S,C,P,R,V,U,X,Y,q=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof i!="string"?i:(l=q,i=(s=(a=i).match(/^{([^}]*)}/))?(l.prefix=s[1],a.slice(s[0].length)):a,f=q,function(Z,ie){if(Z.indexOf("$")===-1){if(Z.indexOf("%")===-1)return Z.indexOf("bd")!==-1?(ie.output="byte",ie.base="general"):Z.indexOf("b")!==-1?(ie.output="byte",ie.base="binary"):Z.indexOf("d")!==-1?(ie.output="byte",ie.base="decimal"):Z.indexOf(":")===-1?Z.indexOf("o")!==-1&&(ie.output="ordinal"):ie.output="time";ie.output="percent"}else ie.output="currency"}(i=(c=(u=i).match(/{([^}]*)}$/))?(f.postfix=c[1],u.slice(0,-c[0].length)):u,q),h=q,(d=i.match(/[1-9]+[0-9]*/))&&(h.totalLength=+d[0]),v=q,(g=i.split(".")[0].match(/0+/))&&(v.characteristic=g[0].length),function(Z,ie){if(Z.indexOf(".")!==-1){var J=Z.split(".")[0];ie.optionalCharacteristic=J.indexOf("0")===-1}}(i,q),p=q,i.indexOf("a")!==-1&&(p.average=!0),S=q,(w=i).indexOf("K")!==-1?S.forceAverage="thousand":w.indexOf("M")!==-1?S.forceAverage="million":w.indexOf("B")!==-1?S.forceAverage="billion":w.indexOf("T")!==-1&&(S.forceAverage="trillion"),function(Z,ie){var J=Z.split(".")[1];if(J){var le=J.match(/0+/);le&&(ie.mantissa=le[0].length)}}(i,q),P=q,(C=i).match(/\[\.]/)?P.optionalMantissa=!0:C.match(/\./)&&(P.optionalMantissa=!1),R=q,i.indexOf(",")!==-1&&(R.thousandSeparated=!0),V=q,i.indexOf(" ")!==-1&&(V.spaceSeparated=!0),X=q,(U=i).match(/^\+?\([^)]*\)$/)&&(X.negative="parenthesis"),U.match(/^\+?-/)&&(X.negative="sign"),Y=q,i.match(/^\+/)&&(Y.forceSign=!0),q)}}},{}],9:[function(r,n,o){var i=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function a(s){return s.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function l(s,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",c=3<arguments.length?arguments[3]:void 0,h=4<arguments.length?arguments[4]:void 0,d=5<arguments.length?arguments[5]:void 0,v=6<arguments.length?arguments[6]:void 0;if(s!=="")return s===h?0:function g(p,w){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",C=3<arguments.length?arguments[3]:void 0,P=4<arguments.length?arguments[4]:void 0,R=5<arguments.length?arguments[5]:void 0,V=6<arguments.length?arguments[6]:void 0;if(!isNaN(+p))return+p;var U="",X=p.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(X!==p)return-1*g(X,w,S,C,P,R,V);for(var Y=0;Y<i.length;Y++){var q=i[Y];if((U=p.replace(q.key,""))!==p)return g(U,w,S,C,P,R,V)*q.factor}if((U=p.replace("%",""))!==p)return g(U,w,S,C,P,R,V)/100;var Z=parseFloat(p);if(!isNaN(Z)){var ie=C(Z);if(ie&&ie!=="."&&(U=p.replace(new RegExp("".concat(a(ie),"$")),""))!==p)return g(U,w,S,C,P,R,V);var J={};Object.keys(R).forEach(function(m){J[R[m]]=m});for(var le=Object.keys(J).sort().reverse(),Ce=le.length,we=0;we<Ce;we++){var _e=le[we],k=J[_e];if((U=p.replace(_e,""))!==p){var y=void 0;switch(k){case"thousand":y=Math.pow(10,3);break;case"million":y=Math.pow(10,6);break;case"billion":y=Math.pow(10,9);break;case"trillion":y=Math.pow(10,12)}return g(U,w,S,C,P,R,V)*y}}}}(function(g,p){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",S=g.replace(w,"");return S=(S=S.replace(new RegExp("([0-9])".concat(a(p.thousands),"([0-9])"),"g"),"$1$2")).replace(p.decimal,".")}(s,u,f),u,f,c,h,d,v)}n.exports={unformat:function(s,u){var f,c,h,d=r("./globalState"),v=d.currentDelimiters(),g=d.currentCurrency().symbol,p=d.currentOrdinal(),w=d.getZeroFormat(),S=d.currentAbbreviations(),C=void 0;if(typeof s=="string")C=function(P,R){if(!P.indexOf(":")||R.thousands===":")return!1;var V=P.split(":");if(V.length!==3)return!1;var U=+V[0],X=+V[1],Y=+V[2];return!isNaN(U)&&!isNaN(X)&&!isNaN(Y)}(s,v)?(f=s.split(":"),c=+f[0],h=+f[1],+f[2]+60*h+3600*c):l(s,v,g,p,w,S,u);else{if(typeof s!="number")return;C=s}if(C!==void 0)return C}}},{"./globalState":4}],10:[function(r,n,o){function i(v){return function(g){if(Array.isArray(g)){for(var p=0,w=new Array(g.length);p<g.length;p++)w[p]=g[p];return w}}(v)||function(g){if(Symbol.iterator in Object(g)||Object.prototype.toString.call(g)==="[object Arguments]")return Array.from(g)}(v)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(v){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(v)}var l=r("./unformatting"),s=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(v,g){return g.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(v){return v.output==="byte"}},characteristic:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(v){return 0<=v},message:"value must be positive"},{restriction:function(v,g){return!g.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(v,g){return g.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},f={languageTag:{type:"string",mandatory:!0,restriction:function(v){return v.match(s)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(v){return!!l.unformat(v)}function h(v,g,p){var w=3<arguments.length&&arguments[3]!==void 0&&arguments[3],S=Object.keys(v).map(function(C){if(!g[C])return console.error("".concat(p," Invalid key: ").concat(C)),!1;var P=v[C],R=g[C];if(typeof R=="string"&&(R={type:R}),R.type==="format"){if(!h(P,u,"[Validate ".concat(C,"]"),!0))return!1}else if(a(P)!==R.type)return console.error("".concat(p," ").concat(C,' type mismatched: "').concat(R.type,'" expected, "').concat(a(P),'" provided')),!1;if(R.restrictions&&R.restrictions.length)for(var V=R.restrictions.length,U=0;U<V;U++){var X=R.restrictions[U],Y=X.restriction,q=X.message;if(!Y(P,v))return console.error("".concat(p," ").concat(C," invalid value: ").concat(q)),!1}return R.restriction&&!R.restriction(P,v)?(console.error("".concat(p," ").concat(C," invalid value: ").concat(R.message)),!1):R.validValues&&R.validValues.indexOf(P)===-1?(console.error("".concat(p," ").concat(C," invalid value: must be among ").concat(JSON.stringify(R.validValues),', "').concat(P,'" provided')),!1):!(R.children&&!h(P,R.children,"[Validate ".concat(C,"]")))});return w||S.push.apply(S,i(Object.keys(g).map(function(C){var P=g[C];if(typeof P=="string"&&(P={type:P}),P.mandatory){var R=P.mandatory;if(typeof R=="function"&&(R=R(v)),R&&v[C]===void 0)return console.error("".concat(p,' Missing mandatory key "').concat(C,'"')),!1}return!0}))),S.reduce(function(C,P){return C&&P},!0)}function d(v){return h(v,u,"[Validate format]")}n.exports={validate:function(v,g){var p=c(v),w=d(g);return p&&w},validateFormat:d,validateInput:c,validateLanguage:function(v){return h(v,f,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(l2);var LOe=l2.exports;const Fi=CL(LOe);var jOe="numeric";function UT(e,t,r,n,o,i,a){var l=i;if(Or(l)){var s=a.numericFormat,u=s&&s.culture||"-",f=s&&s.pattern,c=a.className||"",h=c.length?c.split(" "):[];if(typeof u<"u"&&!Fi.languages()[u]){var d=u.replace("-",""),v=Fi.allLanguages?Fi.allLanguages[u]:Fi[d];v&&Fi.registerLanguage(v)}Fi.setLanguage(u),l=Fi(l).format(f||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" "),t.dir="ltr"}$i(e,t,r,n,o,l,a)}UT.RENDERER_TYPE=jOe;var FOe="password";function zT(e,t,r,n,o,i,a){$i.apply(this,[e,t,r,n,o,i,a]);var l=a.hashLength||t.innerHTML.length,s=a.hashSymbol||"*",u="";Re(l-1,function(){u+=s}),bf(t,u)}zT.RENDERER_TYPE=FOe;var BOe="time";function YT(e,t,r,n,o,i,a){$i.apply(this,[e,t,r,n,o,i,a]),t.dir="ltr"}YT.RENDERER_TYPE=BOe;function VOe(){eo(Of),eo(Cv),eo(VT),eo(BT),eo(UT),eo(zT),eo($i),eo(YT)}var WOe="autocomplete";function Jb(e,t){var r=e;if(r==null&&(r=""),this.allowEmpty&&r===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,JM(r,t)):JM(r,t)(this.source):t(!0)}Jb.VALIDATOR_TYPE=WOe;function JM(e,t){var r=e;return function(n){for(var o=!1,i=0,a=n.length;i<a;i++)if(r===n[i]){o=!0;break}t(o)}}var UOe=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!==t&&r!==r},zOe=Gt,YOe=ap,GOe=Ht,KOe=vn,qOe=Er,QM=UOe,ex=Wt,XOe=Ga,ZOe=lp;YOe("search",function(e,t,r){return[function(o){var i=qOe(this),a=KOe(o)?void 0:XOe(o,e);return a?zOe(a,o,i):new RegExp(o)[e](ex(i))},function(n){var o=GOe(this),i=ex(n),a=r(t,o,i);if(a.done)return a.value;var l=o.lastIndex;QM(l,0)||(o.lastIndex=0);var s=ZOe(o,i);return QM(o.lastIndex,l)||(o.lastIndex=l),s===null?-1:s.index}]});function JOe(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}var QOe="date";function GT(e,t){var r=nV(t2,this.instance),n=e,o=!0;n==null&&(n="");var i=te(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=te(new Date(n)).isValid()||i;if(this.allowEmpty&&n===""&&(a=!0,i=!0),a||(o=!1),!a&&i&&(o=!0),a&&!i)if(this.correctFormat===!0){var l=eRe(n,this.dateFormat),s=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(s,u,l,"dateValidator"),o=!0}else o=!1;t(o)}GT.VALIDATOR_TYPE=QOe;function eRe(e,t){var r=te(JOe(e)),n=te(e,t),o=e.search(/[A-z]/g)>-1,i;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||o?i=r:i=n,i.format(t)}var tRe="numeric";function KT(e,t){var r=e;r==null&&(r=""),this.allowEmpty&&r===""?t(!0):t(r===""?!1:Or(e))}KT.VALIDATOR_TYPE=tRe;var rRe=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],nRe="time";function qT(e,t){var r=this.timeFormat||"h:mm:ss a",n=!0,o=e;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var a=te(o,rRe,!0).isValid()?te(o):te(o,r),l=a.isValid(),s=te(o,r,!0).isValid()&&!i;if(this.allowEmpty&&o===""&&(l=!0,s=!0),l||(n=!1),!l&&s&&(n=!0),l&&!s)if(this.correctFormat===!0){var u=a.format(r),f=this.instance.toVisualRow(this.row),c=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(f,c,u,"timeValidator"),n=!0}else n=!1;t(n)}qT.VALIDATOR_TYPE=nRe;function oRe(){sc(Jb),sc(GT),sc(KT),sc(qT)}var iRe="autocomplete",aRe={CELL_TYPE:iRe,editor:jT,renderer:Of,validator:Jb},lRe="checkbox",sRe={CELL_TYPE:lRe,editor:QW,renderer:VT},uRe="date",fRe={CELL_TYPE:uRe,editor:r2,renderer:Of,validator:GT},cRe="dropdown",hRe={CELL_TYPE:cRe,editor:FT,renderer:Of,validator:Jb},dRe="handsontable",vRe={CELL_TYPE:dRe,editor:LT,renderer:Of},yRe="numeric",gRe={CELL_TYPE:yRe,editor:n2,renderer:UT,validator:KT,dataType:"number"},mRe="password",pRe={CELL_TYPE:mRe,editor:o2,renderer:zT,copyable:!1},bRe="time",wRe={CELL_TYPE:bRe,editor:i2,renderer:YT,validator:qT};function SRe(){Tn(aRe),Tn(sRe),Tn(fRe),Tn(hRe),Tn(vRe),Tn(gRe),Tn(pRe),Tn(qW),Tn(wRe)}var CRe=tp,_Re=GB;CRe("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},_Re);function Wh(e){"@babel/helpers - typeof";return Wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wh(e)}function ORe(e,t){return PRe(e)||TRe(e,t)||ERe(e,t)||RRe()}function RRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ERe(e,t){if(e){if(typeof e=="string")return tx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tx(e,t)}}function tx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function TRe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function PRe(e){if(Array.isArray(e))return e}function kRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ARe(n.key),n)}}function $Re(e,t,r){return t&&rx(e.prototype,t),r&&rx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ARe(e){var t=IRe(e,"string");return Wh(t)==="symbol"?t:String(t)}function IRe(e,t){if(Wh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MRe(e,t){xRe(e,t),t.add(e)}function xRe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DRe(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var nx=new Map([["plugin",ise],["cell-type",jW],["editor",rV],["renderer",gV],["validator",mV]]),NRe="base",Bi=new WeakMap,zS=[],Sn=null,ox=new WeakSet,ct=function(){function e(t){var r=this;kRe(this,e),MRe(this,ox),Bo(this,"hot",t,{writable:!1}),Bi.set(this,{hooks:{}}),Sn=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return $Re(e,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,o=Array.isArray(n)?n:[];if(o.length>0){var i=[];if(o.forEach(function(u){var f=u.split(":"),c=ORe(f,2),h=c[0],d=c[1];if(!nx.has(h))throw new Error('Unknown plugin dependency type "'.concat(h,'" was found.'));nx.get(h)(d)||i.push(" - ".concat(d," (").concat(h,")"))}),i.length>0){var a=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(i.join(`
`),`
`)].join("");zS.push(a)}}Sn||(Sn=yV()),Sn.indexOf("UndoRedo")>=0&&Sn.splice(Sn.indexOf("UndoRedo"),1),Sn.indexOf(this.pluginName)>=0&&Sn.splice(Sn.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var l=Sn.length===0;if(l){if(zS.length>0){var s=["".concat(zS.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(s)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){Bi.get(this).hooks[r]=Bi.get(this).hooks[r]||[];var o=Bi.get(this).hooks[r];this.hot.addHook(r,n),o.push(n),Bi.get(this).hooks[r]=o}},{key:"removeHooks",value:function(r){var n=this;I(Bi.get(this).hooks[r]||[],function(o){n.hot.removeHook(r,o)})}},{key:"clearHooks",value:function(){var r=this,n=Bi.get(this).hooks;Ge(n,function(o,i){return r.removeHooks(i)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){I(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=DRe(this,ox,HRe).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Ge(this,function(n,o){o!=="hot"&&(r[o]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return NRe}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function HRe(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(var r=0;r<t.length;r++)if(e[t[r]]!==void 0)return!0;return!1}function Uh(e){"@babel/helpers - typeof";return Uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uh(e)}function LRe(e,t){return VRe(e)||BRe(e,t)||FRe(e,t)||jRe()}function jRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FRe(e,t){if(e){if(typeof e=="string")return ix(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ix(e,t)}}function ix(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BRe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function VRe(e){if(Array.isArray(e))return e}function WRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ax(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zRe(n.key),n)}}function URe(e,t,r){return t&&ax(e.prototype,t),r&&ax(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zRe(e){var t=YRe(e,"string");return Uh(t)==="symbol"?t:String(t)}function YRe(e,t){if(Uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GRe=function(){function e(t){WRe(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return URe(e,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={row:r};this.rows.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var o={row:-1};this.rows.push(o),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={col:r};this.columns.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),I(this.rows,function(n){r(n.row,$t(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),I(this.columns,function(n){var o=n.table.getBoundingClientRect(),i=o.width;r(n.col,Math.ceil(i))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(o){I(o.strings,function(i){n.appendChild(r.createColElement(i.col))})}),n}},{key:"createRow",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment(),a=o.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,a),i.appendChild(a)),this.samples.forEach(function(l){I(l.strings,function(s){var u=s.col,f=n.hot.getCellMeta(r,u);f.col=u,f.row=r;var c=n.hot.getCellRenderer(f),h=o.createElement("td");h.setAttribute("ghost-table",1),c(n.hot,h,r,u,n.hot.colToProp(u),s.value,f),i.appendChild(h)})}),i}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,o=n.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){var a=n.createElement("th");i.push([-1,a]),o.appendChild(a)}this.samples.forEach(function(l){I(l.strings,function(s){var u=s.col,f=n.createElement("th");i.push([u,f]),o.appendChild(f)})}),this.table.tHead.appendChild(o),I(i,function(l){var s=LRe(l,2),u=s[0],f=s[1];r.hot.view.appendColHeader(u,f)})}},{key:"createCol",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment();return this.samples.forEach(function(a){I(a.strings,function(l){var s=l.row,u=n.hot.getCellMeta(s,r);u.col=r,u.row=s;var f=n.hot.getCellRenderer(u),c=o.createElement("td"),h=o.createElement("tr");c.setAttribute("ghost-table",1),f(n.hot,c,s,r,n.hot.colToProp(r),l.value,u),h.appendChild(c),i.appendChild(h)})}),i}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("table"),a=n.createElement("thead"),l=n.createElement("tbody"),s=n.createElement("colgroup"),u=n.createElement("tr"),f=n.createElement("th");return this.isVertical()&&i.appendChild(s),this.isHorizontal()&&(u.appendChild(f),a.appendChild(u),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(a),this.isVertical()&&l.appendChild(u),i.appendChild(l),re(i,r),o.appendChild(i),{fragment:o,table:i,tHead:a,tBody:l,colGroup:s,tr:u,th:f}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("div"),a="htGhostTable htAutoSize ".concat(r.trim());return re(i,a),o.appendChild(i),{fragment:o,container:i}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}();const s2=GRe;function zh(e){"@babel/helpers - typeof";return zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zh(e)}function KRe(e,t,r){return t=u2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u2(n.key),n)}}function XRe(e,t,r){return t&&lx(e.prototype,t),r&&lx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function u2(e){var t=ZRe(e,"string");return zh(t)==="symbol"?t:String(t)}function ZRe(e,t){if(zh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var JRe=function(){function e(t){qRe(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return XRe(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,o){var i=this,a=new Map,l=typeof o=="number"?{from:o,to:o}:o,s=l.from,u=l.to;return Re(s,u,function(f){var c=i.generateSample(r,n,f);a.set(f,c)}),a}},{key:"generateSample",value:function(r,n,o){var i=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var a=new Map,l=r==="row"?"col":"row",s=[];return Re(n.from,n.to,function(u){var f=r==="row"?i.dataFactory(o,u):i.dataFactory(u,o),c=f.value,h=f.bundleSeed,d=typeof h=="string"&&h.length>0,v;d?v=h:Ye(c)?v="".concat(Object.keys(c).length):Array.isArray(c)?v="".concat(c.length):v="".concat(Bt(c).length),a.has(v)||a.set(v,{needed:i.getSampleCount(),strings:[]});var g=a.get(v);if(g.needed){var p=s.indexOf(c)>-1;(!p||i.allowDuplicates||d)&&(g.strings.push(KRe({value:c},l,u)),s.push(c),g.needed-=1)}}),a}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}();const f2=JRe;function nu(e){"@babel/helpers - typeof";return nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nu(e)}function sx(e,t){return rEe(e)||tEe(e,t)||eEe(e,t)||QRe()}function QRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eEe(e,t){if(e){if(typeof e=="string")return ux(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ux(e,t)}}function ux(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tEe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function rEe(e){if(Array.isArray(e))return e}function nEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iEe(n.key),n)}}function oEe(e,t,r){return t&&fx(e.prototype,t),r&&fx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iEe(e){var t=aEe(e,"string");return nu(t)==="symbol"?t:String(t)}function aEe(e,t){if(nu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ea(){return typeof Reflect<"u"&&Reflect.get?ea=Reflect.get.bind():ea=function(t,r,n){var o=lEe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ea.apply(this,arguments)}function lEe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=uo(e),e!==null););return e}function sEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rR(e,t)}function rR(e,t){return rR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},rR(e,t)}function uEe(e){var t=cEe();return function(){var n=uo(e),o;if(t){var i=uo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fEe(this,o)}}function fEe(e,t){if(t&&(nu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c2(e)}function c2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uo(e){return uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},uo(e)}be.getSingleton().register("modifyAutoColumnSizeSeed");var Uf="autoColumnSize",hEe=10,YS=new WeakMap,dEe="autoColumnSize",vEe=function(e){sEe(r,e);var t=uEe(r);function r(n){var o;return nEe(this,r),o=t.call(this,n),YS.set(c2(o),{cachedColumnHeaders:[]}),o.ghostTable=new s2(o.hot),o.samplesGenerator=new f2(function(i,a){var l=o.hot.getCellMeta(i,a),s="";l.spanned||(s=o.hot.getDataAtCell(i,a));var u="";return o.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=o.hot.runHooks("modifyAutoColumnSizeSeed",u,l,s)),{value:s,bundleSeed:u}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredColumns=0,o.columnWidthsMap=new ki,o.hot.columnIndexMapper.registerMap(dEe,o.columnWidthsMap),o.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),o}return oEe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[Uf]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Uf];i&&i.useHeaders!==null&&i.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",i.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(a){return o.onBeforeChange(a)}),this.addHook("afterFormulasValuesUpdate",function(a){return o.onAfterFormulasValuesUpdate(a)}),this.addHook("beforeViewRender",function(a){return o.onBeforeViewRender(a)}),this.addHook("modifyColWidth",function(a,l){return o.getColumnWidth(l,a)}),this.addHook("afterInit",function(){return o.onAfterInit()}),ea(uo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var o=this.findColumnsWhereHeaderWasChanged();o.length&&(this.clearCache(o),this.calculateVisibleColumnsWidth()),ea(uo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=this;ea(uo(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)})}},{key:"calculateVisibleColumnsWidth",value:function(){var o=this.hot.countRows();if(o){var i=this.hot.renderCall,a=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn();a===-1||l===-1||this.calculateColumnsWidth({from:a,to:l},void 0,i)}}},{key:"calculateColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;Re(s.from,s.to,function(f){var c=o.hot.toPhysicalColumn(f);if(c===null&&(c=f),l||o.columnWidthsMap.getValueAtIndex(c)===null&&!o.hot._getColWidthFromSettings(c)){var h=o.samplesGenerator.generateColumnSamples(f,u);I(h,function(d){var v=sx(d,2),g=v[0],p=v[1];return o.ghostTable.addColumn(g,p)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){o.ghostTable.getWidths(function(f,c){var h=o.hot.toPhysicalColumn(f);o.columnWidthsMap.setValueAtIndex(h,c)})},!0),this.measuredColumns=s.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=0,l=this.hot.countCols()-1,s=null;this.inProgress=!0;var u=function c(){if(!o.hot){Ig(s),o.inProgress=!1;return}o.calculateColumnsWidth({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=M0(c):(Ig(s),o.inProgress=!1,o.hot.view.adjustElementsSize())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateColumnsWidth({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<l?u():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[Uf],i=o&&Dt(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&Dt(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[Uf],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countCols()-1;return Ye(o)&&(i=o.syncLimit,HB(i)?i=sV(a,i):i>>=0),Math.min(i,a)}},{key:"getColumnWidth",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=i;return l===void 0&&(l=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(o)),a&&typeof l=="number"&&(l=Math.max(l,cT.DEFAULT_WIDTH))),l}},{key:"getFirstVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getFirstVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getFirstRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"getLastVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getLastVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getLastRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var o=this.hot.getColHeader(),i=YS.get(this),a=i.cachedColumnHeaders,l=ar(o,function(s,u,f){var c=a.length;return(c-1<f||a[f]!==u)&&s.push(f),c-1<f?a.push(u):a[f]=u,s},[]);return l}},{key:"clearCache",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];i.length?this.hot.batchExecution(function(){I(i,function(a){o.columnWidthsMap.setValueAtIndex(a,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!Kr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){o.hot&&o.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(o){var i=this,a=ze(o,function(l){var s=sx(l,2),u=s[1];return i.hot.toPhysicalColumn(i.hot.propToCol(u))});this.clearCache(Array.from(new Set(a)))}},{key:"onBeforeColumnResize",value:function(o,i,a){var l=o;return a&&(this.calculateColumnsWidth(i,void 0,!0),l=this.getColumnWidth(i,void 0,!1)),l}},{key:"onAfterInit",value:function(){YS.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(o){var i=Kr(o,function(l){var s;return pe((s=l.address)===null||s===void 0?void 0:s.col)}),a=ze(i,function(l){return l.address.col});this.clearCache(Array.from(new Set(a)))}},{key:"destroy",value:function(){this.ghostTable.clean(),ea(uo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Uf}},{key:"PLUGIN_PRIORITY",get:function(){return hEe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(ct),ta={horizontal:"horizontal",vertical:"vertical"};function yEe(e,t,r,n){var o=r.length,i=r?r[0].length:0,a=[],l=t.row-e.row,s=t.col-e.col;if(["down","up"].indexOf(n)!==-1){for(var u=[],f=0;f<s;f++){var c=parseInt(r[0][f],10),h=parseInt(r[o-1][f],10),d=(n==="down"?h-c:c-h)/(o-1)||0;u.push(d)}a.push(u)}if(["right","left"].indexOf(n)!==-1)for(var v=0;v<l;v++){var g=parseInt(r[v][0],10),p=parseInt(r[v][i-1],10),w=(n==="right"?p-g:g-p)/(i-1)||0;a.push([w])}return a}function gEe(e,t,r){var n,o,i;return t[0]===e[0]&&t[1]<e[1]?(i="left",n=r(t[0],t[1]),o=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(i="right",n=r(t[0],e[3]+1),o=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(i="up",n=r(t[0],t[1]),o=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(i="down",n=r(e[2]+1,t[1]),o=r(t[2],t[3])),n&&n.normalize(),o&&o.normalize(),{directionOfDrag:i,startOfDragCoords:n,endOfDragCoords:o}}function mEe(e){var t={};return e===!0?(t.directions=Object.keys(ta),t.autoInsertRow=!0):Ye(e)?(pe(e.autoInsertRow)?e.direction===ta.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,pe(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(ta)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function ou(e){"@babel/helpers - typeof";return ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ou(e)}function pEe(e){return SEe(e)||wEe(e)||h2(e)||bEe()}function bEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function SEe(e){if(Array.isArray(e))return nR(e)}function CEe(e,t){return REe(e)||OEe(e,t)||h2(e,t)||_Ee()}function _Ee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h2(e,t){if(e){if(typeof e=="string")return nR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nR(e,t)}}function nR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function OEe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function REe(e){if(Array.isArray(e))return e}function EEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PEe(n.key),n)}}function TEe(e,t,r){return t&&cx(e.prototype,t),r&&cx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PEe(e){var t=kEe(e,"string");return ou(t)==="symbol"?t:String(t)}function kEe(e,t){if(ou(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ra(){return typeof Reflect<"u"&&Reflect.get?ra=Reflect.get.bind():ra=function(t,r,n){var o=$Ee(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ra.apply(this,arguments)}function $Ee(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=fo(e),e!==null););return e}function AEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oR(e,t)}function oR(e,t){return oR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},oR(e,t)}function IEe(e){var t=xEe();return function(){var n=fo(e),o;if(t){var i=fo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return MEe(this,o)}}function MEe(e,t){if(t&&(ou(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return d2(e)}function d2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fo(e){return fo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fo(e)}be.getSingleton().register("modifyAutofillRange");be.getSingleton().register("beforeAutofill");be.getSingleton().register("afterAutofill");var hx="autofill",DEe=20,NEe=["fillHandle"],HEe="insert_row_below",LEe=200,jEe=function(e){AEe(r,e);var t=IEe(r);function r(n){var o;return EEe(this,r),o=t.call(this,n),o.eventManager=new It(d2(o)),o.addingStarted=!1,o.mouseDownOnCellCorner=!1,o.mouseDragOutside=!1,o.handleDraggedCells=0,o.directions=[],o.autoInsertRow=!1,o}return TEe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(i){return o.onAfterCellCornerMouseDown(i)}),this.addHook("afterOnCellCornerDblClick",function(i){return o.onCellCornerDblClick(i)}),this.addHook("beforeOnCellMouseOver",function(i,a){return o.onBeforeCellMouseOver(a)}),ra(fo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ra(fo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),ra(fo(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var o=this,i=this.hot.getSelectedRangeLast(),a=i.getTopStartCorner(),l=a.row,s=a.col,u=i.getBottomEndCorner(),f=u.row,c=u.col,h=this.hot.runHooks("modifyCopyableRange",[{startRow:l,startCol:s,endRow:f,endCol:c}]),d=[],v=[],g=[];return I(h,function(p){for(var w=p.startRow;w<=p.endRow;w+=1)d.indexOf(w)===-1&&d.push(w);for(var S=p.startCol;S<=p.endCol;S+=1)v.indexOf(S)===-1&&v.push(S)}),I(d,function(p){var w=[];I(v,function(S){w.push(o.hot.getCopyableData(p,S))}),g.push(w)}),g}},{key:"fillIn",value:function(){var o=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var i=this.hot.selection.highlight.getFill().getVisualCorners(),a=CEe(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.hot.getSelectedRangeLast(),h=c.getTopStartCorner(),d=c.getBottomEndCorner();this.resetSelectionOfDraggedArea();var v=[h.row,h.col,d.row,d.col],g=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,l),Math.min(h.col,s),Math.max(d.row,u),Math.max(d.col,f)],v),p=gEe(v,g,function(k,y){return o.hot._createCellCoords(k,y)}),w=p.directionOfDrag,S=p.startOfDragCoords,C=p.endOfDragCoords;if(S&&S.row>-1&&S.col>-1){var P=this.getSelectionData(),R=c.clone(),V=this.hot._createCellRange(S,S,C),U=this.hot.runHooks("beforeAutofill",P,R,V,w);if(U===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var X=yEe(S,C,P,w),Y=U,q=U;if(["up","left"].indexOf(w)>-1&&!(q.length===1&&q[0].length===0))if(Y=[],w==="up")for(var Z=C.row-S.row+1,ie=Z%q.length,J=0;J<Z;J++)Y.push(q[(J+(q.length-ie))%q.length]);else for(var le=C.col-S.col+1,Ce=le%q[0].length,we=0;we<q.length;we++){Y.push([]);for(var _e=0;_e<le;_e++)Y[we].push(q[we][(_e+(q[we].length-Ce))%q[we].length])}this.hot.populateFromArray(S.row,S.col,Y,C.row,C.col,"".concat(this.pluginName,".fill"),null,w,X),this.setSelection(g),this.hot.runHooks("afterAutofill",Y,R,V,w),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(o){return o.row<0&&(o.row=0),o.col<0&&(o.col=0),o}},{key:"getCoordsOfDragAndDropBorders",value:function(o){var i=this.hot.getSelectedRangeLast(),a=i.getBottomEndCorner(),l=o;if(this.directions.includes(ta.vertical)&&this.directions.includes(ta.horizontal)){var s=i.getTopStartCorner();(a.col<=o.col||s.col>=o.col)&&(l=this.hot._createCellCoords(a.row,o.col)),(a.row<o.row||s.row>o.row)&&(l=this.hot._createCellCoords(o.row,a.col))}else if(this.directions.includes(ta.vertical))l=this.hot._createCellCoords(o.row,a.col);else if(this.directions.includes(ta.horizontal))l=this.hot._createCellCoords(a.row,o.col);else return;return this.reduceSelectionAreaIfNeeded(l)}},{key:"showBorder",value:function(o){var i=this.getCoordsOfDragAndDropBorders(o);i&&this.redrawBorders(i)}},{key:"addRow",value:function(){var o=this;this.hot._registerTimeout(function(){o.hot.alter(HEe,void 0,1,"".concat(o.pluginName,".fill")),o.addingStarted=!1},LEe)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var o=this.hot.getSelectedLast(),i=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.countRows();o[2]<a-1&&i[2]===a-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(o){for(var i=this.hot.getData(),a=this.hot.countRows(),l,s=o[2]+1;s<a;s++){for(var u=o[1];u<=o[3];u++){var f=i[s][u];if(f)return-1}var c=i[s][o[1]-1],h=i[s][o[3]+1];(c||h)&&(l=s)}return l}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(o,i){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(o[0],o[1])).add(this.hot._createCellCoords(i,o[3])).commit()}},{key:"setSelection",value:function(o){var i;(i=this.hot).selectCell.apply(i,pEe(ze(o,function(a){return Math.max(a,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var o=this.hot.getSelectedLast(),i=this.getIndexOfLastAdjacentFilledInRow(o);return i===-1||i===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(o,i),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(o){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(o).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(o){var i=this.hot.rootDocument.documentElement,a=zt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||i.scrollTop)+$t(this.hot.table),l=zt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||i.scrollLeft)+gt(this.hot.table);return o.clientY>a&&o.clientX<=l}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)})}},{key:"onCellCornerDblClick",value:function(){var o=this.selectAdjacent();o&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(o){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(o),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(o){var i=this.getIfMouseWasDraggedOutside(o);this.addingStarted===!1&&this.handleDraggedCells>0&&i?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var o=mEe(this.hot.getSettings().fillHandle);this.directions=o.directions,this.autoInsertRow=o.autoInsertRow}},{key:"destroy",value:function(){ra(fo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return hx}},{key:"PLUGIN_PRIORITY",get:function(){return DEe}},{key:"SETTING_KEYS",get:function(){return[hx].concat(NEe)}}]),r}(ct);function iu(e){"@babel/helpers - typeof";return iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iu(e)}function FEe(e,t){return UEe(e)||WEe(e,t)||VEe(e,t)||BEe()}function BEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VEe(e,t){if(e){if(typeof e=="string")return dx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dx(e,t)}}function dx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WEe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function UEe(e){if(Array.isArray(e))return e}function zEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GEe(n.key),n)}}function YEe(e,t,r){return t&&vx(e.prototype,t),r&&vx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function GEe(e){var t=KEe(e,"string");return iu(t)==="symbol"?t:String(t)}function KEe(e,t){if(iu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(iu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xl(){return typeof Reflect<"u"&&Reflect.get?Xl=Reflect.get.bind():Xl=function(t,r,n){var o=qEe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Xl.apply(this,arguments)}function qEe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=di(e),e!==null););return e}function XEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iR(e,t)}function iR(e,t){return iR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},iR(e,t)}function ZEe(e){var t=e0e();return function(){var n=di(e),o;if(t){var i=di(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return JEe(this,o)}}function JEe(e,t){if(t&&(iu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QEe(e)}function QEe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function e0e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function di(e){return di=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},di(e)}var fy="autoRowSize",t0e=40,r0e="autoRowSize",n0e=function(e){XEe(r,e);var t=ZEe(r);function r(n){var o;return zEe(this,r),o=t.call(this,n),o.rowHeightsMap=void 0,o.headerHeight=null,o.ghostTable=new s2(o.hot),o.samplesGenerator=new f2(function(i,a){var l;return i>=0?l=o.hot.getDataAtCell(i,a):i===-1&&(l=o.hot.getColHeader(a)),{value:l}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredRows=0,o.rowHeightsMap=new ki,o.hot.rowIndexMapper.registerMap(r0e,o.rowHeightsMap),o.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)}),o}return YEe(r,[{key:"isEnabled",value:function(){var o=this.hot.getSettings()[fy];return o===!0||Ye(o)}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(i){return o.onBeforeChange(i)}),this.addHook("beforeColumnResize",function(){return o.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(i){return o.onBeforeViewRender(i)}),this.addHook("modifyRowHeight",function(i,a){return o.getRowHeight(a,i)}),this.addHook("modifyColumnHeaderHeight",function(){return o.getColumnHeaderHeight()}),Xl(di(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this;this.headerHeight=null,Xl(di(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)})}},{key:"calculateRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;if(this.hot.getColHeader(0)!==null){var f=this.samplesGenerator.generateRowSamples(-1,u);this.ghostTable.addColumnHeadersRow(f.get(-1))}Re(s.from,s.to,function(c){if(l||o.rowHeightsMap.getValueAtIndex(c)===null){var h=o.samplesGenerator.generateRowSamples(c,u);I(h,function(d){var v=FEe(d,2),g=v[0],p=v[1];return o.ghostTable.addRow(g,p)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){o.ghostTable.getHeights(function(c,h){c<0?o.headerHeight=h:o.rowHeightsMap.setValueAtIndex(o.hot.toPhysicalRow(c),h)})},!0),this.measuredRows=s.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=0,l=this.hot.countRows()-1,s=null;this.inProgress=!0;var u=function c(){if(!o.hot){Ig(s),o.inProgress=!1;return}o.calculateRowsHeight({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=M0(c):(Ig(s),o.inProgress=!1,o.hot.view.adjustElementsSize(!0),o.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&o.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateRowsHeight({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<l?u():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[fy],i=o&&Dt(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&Dt(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllRowsHeight",value:function(){xc(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[fy],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countRows()-1;return Ye(o)&&(i=o.syncLimit,HB(i)?i=sV(a,i):i>>=0),Math.min(i,a)}},{key:"getRowHeight",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=o<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(o)),l=i;return a!==null&&a>(i||0)&&(l=a),l}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getFirstVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getLastVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(o){var i=this,a=typeof o=="number"?{from:o,to:o}:o,l=a.from,s=a.to;this.hot.batchExecution(function(){Re(Math.min(l,s),Math.max(l,s),function(u){i.rowHeightsMap.setValueAtIndex(u,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!Kr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){var o=this.hot.renderCall,i=this.hot.getSettings().fixedRowsBottom,a=this.getFirstVisibleRow(),l=this.getLastVisibleRow();if(!(a===-1||l===-1)){if(this.calculateRowsHeight({from:a,to:l},void 0,o),i){var s=this.hot.countRows()-1;this.calculateRowsHeight({from:s-i,to:s})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(o,i){this.clearCacheByRange({from:o,to:i}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(o,i,a){var l=o;return a&&(this.calculateRowsHeight(i,void 0,!0),l=this.getRowHeight(i)),l}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){o.hot&&o.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(o){var i=null;o.length===1?i=o[0][0]:o.length>1&&(i={from:o[0][0],to:o[o.length-1][0]}),i!==null&&this.clearCacheByRange(i)}},{key:"destroy",value:function(){this.ghostTable.clean(),Xl(di(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return fy}},{key:"PLUGIN_PRIORITY",get:function(){return t0e}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(ct);function au(e){"@babel/helpers - typeof";return au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},au(e)}function o0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a0e(n.key),n)}}function i0e(e,t,r){return t&&yx(e.prototype,t),r&&yx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a0e(e){var t=l0e(e,"string");return au(t)==="symbol"?t:String(t)}function l0e(e,t){if(au(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(au(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cc(){return typeof Reflect<"u"&&Reflect.get?Cc=Reflect.get.bind():Cc=function(t,r,n){var o=s0e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Cc.apply(this,arguments)}function s0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Va(e),e!==null););return e}function u0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aR(e,t)}function aR(e,t){return aR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},aR(e,t)}function f0e(e){var t=d0e();return function(){var n=Va(e),o;if(t){var i=Va(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return c0e(this,o)}}function c0e(e,t){if(t&&(au(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return h0e(e)}function h0e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d0e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Va(e){return Va=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Va(e)}var v2=mW("physicallyIndexed"),v0e=v2.getListWithInsertedItems,y0e=v2.getListWithRemovedItems,g0e=function(e){u0e(r,e);var t=f0e(r);function r(){return o0e(this,r),t.call(this,function(n){return n})}return i0e(r,[{key:"insert",value:function(o,i){var a=PT(this.indexedValues,i);this.indexedValues=v0e(a,o,i,this.initValueOrFn),Cc(Va(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=y0e(this.indexedValues,o);this.indexedValues=TT(i,o),Cc(Va(r.prototype),"remove",this).call(this,o)}}]),r}(tl);const m0e=g0e;function lu(e){"@babel/helpers - typeof";return lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lu(e)}function p0e(e){return C0e(e)||S0e(e)||w0e(e)||b0e()}function b0e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w0e(e,t){if(e){if(typeof e=="string")return lR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lR(e,t)}}function S0e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function C0e(e){if(Array.isArray(e))return lR(e)}function lR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,R0e(n.key),n)}}function O0e(e,t,r){return t&&gx(e.prototype,t),r&&gx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function R0e(e){var t=E0e(e,"string");return lu(t)==="symbol"?t:String(t)}function E0e(e,t){if(lu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _c(){return typeof Reflect<"u"&&Reflect.get?_c=Reflect.get.bind():_c=function(t,r,n){var o=T0e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_c.apply(this,arguments)}function T0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Wa(e),e!==null););return e}function P0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sR(e,t)}function sR(e,t){return sR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},sR(e,t)}function k0e(e){var t=I0e();return function(){var n=Wa(e),o;if(t){var i=Wa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $0e(this,o)}}function $0e(e,t){if(t&&(lu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return A0e(e)}function A0e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I0e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wa(e){return Wa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wa(e)}var y2=mW("physicallyIndexed"),M0e=y2.getListWithInsertedItems,x0e=y2.getListWithRemovedItems,D0e=function(e){P0e(r,e);var t=k0e(r);function r(){return _0e(this,r),t.call(this,function(n){return n})}return O0e(r,[{key:"insert",value:function(o,i){var a=this;this.indexedValues=M0e(this.indexedValues,o,i,function(l,s){return a.getNextValue(s)}),_c(Wa(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=x0e(this.indexedValues,o),_c(Wa(r.prototype),"remove",this).call(this,o)}},{key:"getNextValue",value:function(o){return Math.max.apply(Math,p0e(this.getValues()))+1+o}}]),r}(tl);const N0e=D0e;function su(e){"@babel/helpers - typeof";return su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},su(e)}function H0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,j0e(n.key),n)}}function L0e(e,t,r){return t&&mx(e.prototype,t),r&&mx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function j0e(e){var t=F0e(e,"string");return su(t)==="symbol"?t:String(t)}function F0e(e,t){if(su(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(su(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zl(){return typeof Reflect<"u"&&Reflect.get?Zl=Reflect.get.bind():Zl=function(t,r,n){var o=B0e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Zl.apply(this,arguments)}function B0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vi(e),e!==null););return e}function V0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uR(e,t)}function uR(e,t){return uR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},uR(e,t)}function W0e(e){var t=Y0e();return function(){var n=vi(e),o;if(t){var i=vi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return U0e(this,o)}}function U0e(e,t){if(t&&(su(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return z0e(e)}function z0e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Y0e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vi(e){return vi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vi(e)}var GS="bindRowsWithHeaders",G0e=210,K0e="loose",q0e=new Map([["loose",m0e],["strict",N0e]]),X0e=function(e){V0e(r,e);var t=W0e(r);function r(n){var o;return H0e(this,r),o=t.call(this,n),o.headerIndexes=null,o}return L0e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[GS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[GS];typeof i!="string"&&(i=K0e);var a=q0e.get(i);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new a),this.addHook("modifyRowHeader",function(l){return o.onModifyRowHeader(l)}),Zl(vi(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),Zl(vi(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(o){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(o))}},{key:"destroy",value:function(){Zl(vi(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return GS}},{key:"PLUGIN_PRIORITY",get:function(){return G0e}}]),r}(ct);function uu(e){"@babel/helpers - typeof";return uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uu(e)}function px(e){return eTe(e)||Q0e(e)||J0e(e)||Z0e()}function Z0e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function J0e(e,t){if(e){if(typeof e=="string")return fR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fR(e,t)}}function Q0e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function eTe(e){if(Array.isArray(e))return fR(e)}function fR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g2(n.key),n)}}function rTe(e,t,r){return t&&bx(e.prototype,t),r&&bx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function na(){return typeof Reflect<"u"&&Reflect.get?na=Reflect.get.bind():na=function(t,r,n){var o=nTe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},na.apply(this,arguments)}function nTe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=co(e),e!==null););return e}function oTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cR(e,t)}function cR(e,t){return cR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},cR(e,t)}function iTe(e){var t=lTe();return function(){var n=co(e),o;if(t){var i=co(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return aTe(this,o)}}function aTe(e,t){if(t&&(uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jl(e)}function jl(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function co(e){return co=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},co(e)}function sTe(e,t,r){uTe(e,t),t.set(e,r)}function uTe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function KS(e,t,r){return t=g2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g2(e){var t=fTe(e,"string");return uu(t)==="symbol"?t:String(t)}function fTe(e,t){if(uu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wx(e,t){var r=m2(e,t,"get");return cTe(e,r)}function cTe(e,t){return t.get?t.get.call(e):t.value}function qS(e,t,r){var n=m2(e,t,"set");return hTe(e,n,r),r}function m2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function hTe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var XS="collapsibleColumns",dTe=290,vTe=["nestedHeaders"],ml="collapsibleIndicator",Sx=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),pl=new WeakMap,yTe=function(e){oTe(r,e);var t=iTe(r);function r(){var n;tTe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),KS(jl(n),"nestedHeadersPlugin",null),KS(jl(n),"eventManager",new It(jl(n))),KS(jl(n),"headerStateManager",null),sTe(jl(n),pl,{writable:!0,value:null}),n}return rTe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[XS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;a||dt("You need to configure the Nested Headers plugin in order to use collapsible headers."),qS(this,pl,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(l,s,u){return o.onBeforeOnCellMouseDown(l,s,u)}),na(co(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var o=this.hot.getSettings(),i=o.collapsibleColumns;typeof i=="boolean"?this.headerStateManager.mapState(function(a){return{collapsible:a.origColspan>1}}):Array.isArray(i)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(i))}na(co(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),qS(this,pl,null),this.nestedHeadersPlugin=null,this.clearButtons(),na(co(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var o=this.hot.view._wt.getSetting("columnHeaders").length,i=this.hot.view._wt.wtTable.THEAD,a=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,l=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(f){f&&f.parentNode.removeChild(f)};Re(0,o-1,function(u){var f=i.childNodes[u],c=a.childNodes[u],h=l?l.childNodes[u]:null;Re(0,f.childNodes.length-1,function(d){var v=f.childNodes[d].querySelector(".".concat(ml));s(v),c&&c.childNodes[d]&&(v=c.childNodes[d].querySelector(".".concat(ml)),s(v)),l&&h&&h.childNodes[d]&&(v=h.childNodes[d].querySelector(".".concat(ml)),s(v))})})}}},{key:"expandSection",value:function(o){this.toggleCollapsibleSection([o],"expand")}},{key:"collapseSection",value:function(o){this.toggleCollapsibleSection([o],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(o){var i=this,a=this.headerStateManager.mapNodes(function(l){var s=l.collapsible,u=l.origColspan,f=l.headerLevel,c=l.columnIndex,h=l.isCollapsed;if(s===!0&&u>1&&(h&&o==="expand"||!h&&o==="collapse"))return{row:i.headerStateManager.levelToRowCoords(f),col:c}});this.toggleCollapsibleSection(a,o)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(o,i){var a=this;if(!Sx.has(i))throw new Error("Unsupported action is passed (".concat(i,")."));if(Array.isArray(o)){var l=Kr(o,function(p){var w=p.row;return w<0}),s=l.length>0;I(l,function(p){var w,S=p.row,C=p.col,P=(w=a.headerStateManager.getHeaderSettings(S,C))!==null&&w!==void 0?w:{},R=P.collapsible,V=P.isCollapsed;if(!R||V&&i==="collapse"||!V&&i==="expand")return s=!1,!1});var u=[],f=[];s&&I(l,function(p){var w=p.row,S=p.col,C=a.headerStateManager.triggerNodeModification(i,w,S),P=C.colspanCompensation,R=C.affectedColumns,V=C.rollbackModification;P>0&&(f.push.apply(f,px(R)),u.push(V))});var c=this.getCollapsedColumns(),h=[];i==="collapse"?h=LF([].concat(px(c),f)):i==="expand"&&(h=Kr(c,function(p){return!f.includes(p)}));var d=Sx.get(i),v=this.hot.runHooks(d.beforeHook,c,h,s);if(v===!1){I(u,function(p){p()});return}this.hot.batchExecution(function(){I(f,function(p){wx(a,pl).setValueAtIndex(a.hot.toPhysicalColumn(p),d.hideColumn)})},!0);var g=this.getCollapsedColumns().length!==c.length;this.hot.runHooks(d.afterHook,c,h,s,g),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return wx(this,pl).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(o,i,a){var l,s=(l=this.headerStateManager.getHeaderSettings(a,o))!==null&&l!==void 0?l:{},u=s.collapsible,f=s.origColspan,c=s.isCollapsed,h=u&&f>1&&o>=this.hot.getSettings().fixedColumnsStart,d=i.querySelector(".".concat(ml));if(h)d||(d=this.hot.rootDocument.createElement("div"),re(d,ml),i.querySelector("div:first-child").appendChild(d)),je(d,["collapsed","expanded"]),c?(re(d,"collapsed"),Ia(d,"+")):(re(d,"expanded"),Ia(d,"-"));else{var v;(v=d)===null||v===void 0||v.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(o,i){De(o.target,ml)&&(De(o.target,"expanded")?(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"collapse")):De(o.target,"collapsed")&&(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"expand")),Ln(o))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){qS(this,pl,null),na(co(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return XS}},{key:"PLUGIN_PRIORITY",get:function(){return dTe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[XS].concat(vTe)}}]),r}(ct);function Yh(e){"@babel/helpers - typeof";return Yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yh(e)}function Cx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function gTe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Cx(Object(r),!0).forEach(function(n){mTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mTe(e,t,r){return t=p2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _x(e,t){return STe(e)||wTe(e,t)||bTe(e,t)||pTe()}function pTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bTe(e,t){if(e){if(typeof e=="string")return Ox(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ox(e,t)}}function Ox(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wTe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function STe(e){if(Array.isArray(e))return e}function CTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p2(n.key),n)}}function _Te(e,t,r){return t&&Rx(e.prototype,t),r&&Rx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function p2(e){var t=OTe(e,"string");return Yh(t)==="symbol"?t:String(t)}function OTe(e,t){if(Yh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RTe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],ETe=!1,TTe=!0,PTe=!0,kTe=function(){function e(t,r){CTe(this,e),this.hot=t,this.sortingStates=new Tp,this.sortEmptyCells=ETe,this.indicator=TTe,this.headerAction=PTe,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return _Te(e,[{key:"updateAllColumnsProperties",value:function(r){var n=this;Ye(r)&&Ge(r,function(o,i){RTe.includes(i)&&(n[i]=o)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var o=_x(n,1),i=o[0];return i===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return Ye(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(o){var i=_x(o,2),a=i[0],l=i[1];return gTe({column:r.hot.toVisualColumn(a)},l)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(pe(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),Em="asc",Tm="desc",$Te="colHeader";function ATe(e){if(Ye(e)===!1)return!1;var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[Em,Tm].includes(r)}function ITe(e){if(e.some(function(r){return ATe(r)===!1}))return!1;var t=e.map(function(r){var n=r.column;return n});return new Set(t).size===t.length}function Ex(e){if(e!==Tm)return e===Em?Tm:Em}function Tx(e){var t=e.querySelector(".".concat($Te));return t}function Px(e,t){if(e<0||!t.parentNode)return!1;var r=t.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(t.parentNode)-r.length;return n===-1}function hR(e,t,r){return e===-1&&t>=0&&xa(r)===!1}var MTe="ascending",xTe="descending",b2="indicatorDisabled",w2="columnSorting",S2="sortAction",C2=new Map([[Em,MTe],[Tm,xTe]]);function DTe(e,t,r,n){var o=[w2];if(n&&o.push(S2),r===!1)return o.push(b2),o;var i=e.getSortOrderOfColumn(t);return pe(i)&&o.push(C2.get(i)),o}function NTe(){return Array.from(C2.values()).concat(S2,b2,w2)}function _2(e,t,r){var n=t.locale;return function(o,i){var a=r.sortEmptyCells;return typeof o=="string"&&(o=o.toLocaleLowerCase(n)),typeof i=="string"&&(i=i.toLocaleLowerCase(n)),o===i?Dn:qt(o)?qt(i)?Dn:a&&e==="asc"?Pt:kt:qt(i)?a&&e==="asc"?kt:Pt:isNaN(o)&&!isNaN(i)?e==="asc"?kt:Pt:!isNaN(o)&&isNaN(i)||(isNaN(o)||isNaN(i)||(o=parseFloat(o),i=parseFloat(i)),o<i)?e==="asc"?Pt:kt:o>i?e==="asc"?kt:Pt:Dn}}var O2="default";function HTe(e,t,r){return function(n,o){var i=parseFloat(n),a=parseFloat(o),l=r.sortEmptyCells;if(i===a||isNaN(i)&&isNaN(a))return Dn;if(l){if(qt(n))return e==="asc"?Pt:kt;if(qt(o))return e==="asc"?kt:Pt}return isNaN(i)?kt:isNaN(a)?Pt:i<a?e==="asc"?Pt:kt:i>a?e==="asc"?kt:Pt:Dn}}var LTe="numeric";function jTe(e,t,r){var n=t.checkedTemplate,o=t.uncheckedTemplate,i=r.sortEmptyCells;return function(a,l){var s=qt(a),u=qt(l),f=s?o:a,c=u?o:l,h=f===o||f===n,d=c===o||c===n;if(i===!1){if(s&&u===!1)return kt;if(s===!1&&u)return Pt}return h===!1&&d?e==="asc"?Pt:kt:h&&d===!1?e==="asc"?kt:Pt:h===!1&&d===!1?_2(e,t,r)(a,l):f===o&&c===n?e==="asc"?Pt:kt:f===n&&c===o?e==="asc"?kt:Pt:Dn}}var FTe="checkbox";function BTe(e,t,r){return function(n,o){var i=r.sortEmptyCells;if(n===o)return Dn;if(qt(n))return qt(o)?Dn:i&&e==="asc"?Pt:kt;if(qt(o))return i&&e==="asc"?kt:Pt;var a=t.dateFormat,l=te(n,a),s=te(o,a);return l.isValid()?s.isValid()?s.isAfter(l)?e==="asc"?Pt:kt:s.isBefore(l)?e==="asc"?kt:Pt:Dn:Pt:kt}}var VTe="date",XT=Qr("sorting.compareFunctionFactory"),Qb=XT.register,kx=XT.getItem,WTe=XT.hasItem,R2=Qr("sorting.mainSortComparator"),E2=R2.register,UTe=R2.getItem;function T2(e){return WTe(e)?kx(e):kx(O2)}Qb(LTe,HTe);Qb(FTe,jTe);Qb(VTe,BTe);Qb(O2,_2);var Dn=0,Pt=-1,kt=1;function zTe(e,t){for(var r=UTe(t),n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];e.sort(r.apply(void 0,o))}function $x(e){return qTe(e)||KTe(e)||GTe(e)||YTe()}function YTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GTe(e,t){if(e){if(typeof e=="string")return Ax(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ax(e,t)}}function Ax(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function KTe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function qTe(e){if(Array.isArray(e))return e}function XTe(e,t){return function(r,n){var o=$x(r),i=o.slice(1),a=$x(n),l=a.slice(1);return function(u){var f=e[u],c=t[u],h=i[u],d=l[u],v=c.columnSorting,g=v.compareFunctionFactory?v.compareFunctionFactory:T2(c.type),p=g(f,c,v)(h,d);return p}(0)}}function fu(e){"@babel/helpers - typeof";return fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fu(e)}var ZTe=["column"],JTe=["column"];function bl(e){return rPe(e)||tPe(e)||ePe(e)||QTe()}function QTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ePe(e,t){if(e){if(typeof e=="string")return dR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dR(e,t)}}function tPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rPe(e){if(Array.isArray(e))return dR(e)}function dR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ix(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Mx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ix(Object(r),!0).forEach(function(n){nPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ix(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nPe(e,t,r){return t=P2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xx(e,t){if(e==null)return{};var r=oPe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function oPe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function iPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P2(n.key),n)}}function aPe(e,t,r){return t&&Dx(e.prototype,t),r&&Dx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function P2(e){var t=lPe(e,"string");return fu(t)==="symbol"?t:String(t)}function lPe(e,t){if(fu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oa(){return typeof Reflect<"u"&&Reflect.get?oa=Reflect.get.bind():oa=function(t,r,n){var o=sPe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},oa.apply(this,arguments)}function sPe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ho(e),e!==null););return e}function uPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vR(e,t)}function vR(e,t){return vR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},vR(e,t)}function fPe(e){var t=dPe();return function(){var n=ho(e),o;if(t){var i=ho(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return cPe(this,o)}}function cPe(e,t){if(t&&(fu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hPe(e)}function hPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dPe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ho(e){return ho=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ho(e)}var yR="columnSorting",vPe=50,Nx="append",yPe="replace";E2(yR,XTe);be.getSingleton().register("beforeColumnSort");be.getSingleton().register("afterColumnSort");var k2=function(e){uPe(r,e);var t=fPe(r);function r(n){var o;return iPe(this,r),o=t.call(this,n),o.columnStatesManager=null,o.columnMetaCache=null,o.pluginKey=yR,o.indexesSequenceCache=null,o}return aPe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnStatesManager=new kTe(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new ki(function(i){var a=o.hot.toVisualColumn(i);return a===null&&(a=i),o.getMergedPluginSettings(a)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(i,a){return o.onAfterOnCellMouseDown(i,a)}),this.addHook("afterInit",function(){return o.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.hot.view&&this.loadOrSortBySettings(),oa(ho(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this,i=function(l,s){var u=Tx(s);Px(l,s)===!1||u===null||o.updateHeaderClasses(u)};this.hot.addHook("afterGetColHeader",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("afterGetColHeader",i)}),this.hot.batchExecution(function(){o.indexesSequenceCache!==null&&(o.hot.rowIndexMapper.setIndexesSequence(o.indexesSequenceCache.getValues()),o.hot.rowIndexMapper.unregisterMap(o.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,oa(ho(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){var i=this.getSortConfig(),a=this.getNormalizedSortConfigs(o),l=this.areValidSortConfigs(a),s=this.hot.runHooks("beforeColumnSort",i,a,l);s!==!1&&(i.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new pW),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),l&&(this.columnStatesManager.setSortStates(a),this.sortByPresetSortStates(a),this.saveAllSortSettings(a)),this.hot.runHooks("afterColumnSort",i,l?a:i,l),l&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(o){return pe(o)?this.columnStatesManager.getColumnSortState(o):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(o){var i=this.getNormalizedSortConfigs(o);this.areValidSortConfigs(i)&&this.columnStatesManager.setSortStates(i)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o.slice(0,1):[o]}},{key:"areValidSortConfigs",value:function(o){var i=this.hot.countCols();return ITe(o)&&o.every(function(a){var l=a.column;return l<=i&&l>=0})}},{key:"saveAllSortSettings",value:function(o){var i=this,a=this.columnStatesManager.getAllColumnsProperties(),l=function(u){var f=u.column,c=xx(u,ZTe);return Mx({column:i.hot.toPhysicalColumn(f)},c)};a.initialConfig=ze(o,l),this.hot.runHooks("persistentStateSave","columnSorting",a)}},{key:"getAllSavedSortSettings",value:function(){var o=this,i={};this.hot.runHooks("persistentStateLoad","columnSorting",i);var a=i.value,l=function(u){var f=u.column,c=xx(u,JTe);return Mx({column:o.hot.toVisualColumn(f)},c)};return pe(a)&&Array.isArray(a.initialConfig)&&(a.initialConfig=ze(a.initialConfig,l)),a}},{key:"getColumnNextConfig",value:function(o){var i=this.columnStatesManager.getSortOrderOfColumn(o);if(pe(i)){var a=Ex(i);return pe(a)?{column:o,sortOrder:a}:void 0}var l=this.hot.countCols();if(Number.isInteger(o)&&o>=0&&o<l)return{column:o,sortOrder:Ex()}}},{key:"getNextSortConfig",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Nx,a=this.columnStatesManager.getIndexOfColumnInSortQueue(o),l=a!==-1,s=this.getSortConfig(),u=this.getColumnNextConfig(o);if(l){if(pt(u))return[].concat(bl(s.slice(0,a)),bl(s.slice(a+1)));if(i===Nx)return[].concat(bl(s.slice(0,a)),bl(s.slice(a+1)),[u]);if(i===yPe)return[].concat(bl(s.slice(0,a)),[u],bl(s.slice(a+1)))}return pe(u)?s.concat(u):s}},{key:"getPluginColumnConfig",value:function(o){if(Ye(o)){var i=o[this.pluginKey];if(Ye(i))return i}return{}}},{key:"getMergedPluginSettings",value:function(o){var i=this.hot.getSettings()[this.pluginKey],a=this.columnStatesManager.getAllColumnsProperties(),l=this.hot.getCellMeta(0,o),s=Object.getPrototypeOf(l);return Array.isArray(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns[o])):wt(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns(o))):Object.assign(a,i)}},{key:"getFirstCellSettings",value:function(o){var i=this.hot.getCellMeta(0,o),a=Object.create(i);return a[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(o)),a}},{key:"getNumberOfRowsToSort",value:function(o){var i=this.hot.getSettings();return i.maxRows<=o?i.maxRows:o-i.minSpareRows}},{key:"sortByPresetSortStates",value:function(o){var i=this;if(o.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var a=[],l=this.hot.countRows(),s=function(p){return ze(o,function(w){return i.hot.getDataAtCell(p,w.column)})},u=0;u<this.getNumberOfRowsToSort(l);u+=1)a.push([this.hot.toPhysicalRow(u)].concat(s(u)));var f=ze(a,function(g){return g[0]});zTe(a,this.pluginKey,ze(o,function(g){return g.sortOrder}),ze(o,function(g){return i.getFirstCellSettings(g.column)}));for(var c=a.length;c<l;c+=1)a.push([c].concat(s(c)));var h=ze(a,function(g){return g[0]}),d=new Map(ze(f,function(g,p){return[g,h[p]]})),v=ze(this.hot.rowIndexMapper.getIndexesSequence(),function(g){return d.has(g)?d.get(g):g});this.hot.rowIndexMapper.setIndexesSequence(v)}},{key:"loadOrSortBySettings",value:function(){var o=this.getAllSavedSortSettings();if(Ye(o))this.sortBySettings(o);else{var i=this.hot.getSettings()[this.pluginKey];this.sortBySettings(i)}}},{key:"sortBySettings",value:function(o){if(Ye(o)){this.columnStatesManager.updateAllColumnsProperties(o);var i=o.initialConfig;(Array.isArray(i)||Ye(i))&&this.sort(i)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(o,i){var a=Tx(i);if(!(Px(o,i)===!1||a===null)){var l=this.getFirstCellSettings(o)[this.pluginKey],s=l.indicator,u=l.headerAction;this.updateHeaderClasses(a,this.columnStatesManager,o,s,u)}}},{key:"updateHeaderClasses",value:function(o){if(je(o,NTe()),this.enabled!==!1){for(var i=arguments.length,a=new Array(i>1?i-1:0),l=1;l<i;l++)a[l-1]=arguments[l];re(o,DTe.apply(void 0,a))}}},{key:"onUpdateSettings",value:function(o){oa(ho(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),pe(o[this.pluginKey])&&this.sortBySettings(o[this.pluginKey])}},{key:"onAfterLoadData",value:function(o){o===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(o,i){var a=this.getFirstCellSettings(i)[this.pluginKey],l=a.headerAction;return l&&o.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){hR(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){hR(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(i.col)),this.sort(this.getColumnNextConfig(i.col)))}},{key:"destroy",value:function(){var o;(o=this.columnStatesManager)===null||o===void 0||o.destroy(),oa(ho(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return yR}},{key:"PLUGIN_PRIORITY",get:function(){return vPe}}]),r}(ct),gPe=Me,ZT=Ve,mPe=Ei,pPe=rF,bPe=H0,Hx=Fe,wPe=RangeError,$2=String,A2=Math.floor,gR=ZT(bPe),Lx=ZT("".slice),zf=ZT(1 .toFixed),Wl=function(e,t,r){return t===0?r:t%2===1?Wl(e,t-1,r*e):Wl(e*e,t/2,r)},SPe=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},wl=function(e,t,r){for(var n=-1,o=r;++n<6;)o+=t*e[n],e[n]=o%1e7,o=A2(o/1e7)},ZS=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=A2(n/t),n=n%t*1e7},jx=function(e){for(var t=6,r="";--t>=0;)if(r!==""||t===0||e[t]!==0){var n=$2(e[t]);r=r===""?n:r+gR("0",7-n.length)+n}return r},CPe=Hx(function(){return zf(8e-5,3)!=="0.000"||zf(.9,0)!=="1"||zf(1.255,2)!=="1.25"||zf(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!Hx(function(){zf({})});gPe({target:"Number",proto:!0,forced:CPe},{toFixed:function(t){var r=pPe(this),n=mPe(t),o=[0,0,0,0,0,0],i="",a="0",l,s,u,f;if(n<0||n>20)throw new wPe("Incorrect fraction digits");if(r!==r)return"NaN";if(r<=-1e21||r>=1e21)return $2(r);if(r<0&&(i="-",r=-r),r>1e-21)if(l=SPe(r*Wl(2,69,1))-69,s=l<0?r*Wl(2,-l,1):r/Wl(2,l,1),s*=4503599627370496,l=52-l,l>0){for(wl(o,0,s),u=n;u>=7;)wl(o,1e7,0),u-=7;for(wl(o,Wl(10,u,1),0),u=l-1;u>=23;)ZS(o,1<<23),u-=23;ZS(o,1<<u),wl(o,1,1),ZS(o,2),a=jx(o)}else wl(o,0,s),wl(o,1<<-l,0),a=jx(o)+gR("0",n);return n>0?(f=a.length,a=i+(f<=n?"0."+gR("0",n-f)+a:Lx(a,0,f-n)+"."+Lx(a,f-n))):a=i+a,a}});function Gh(e){"@babel/helpers - typeof";return Gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gh(e)}function _Pe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RPe(n.key),n)}}function OPe(e,t,r){return t&&Fx(e.prototype,t),r&&Fx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RPe(e){var t=EPe(e,"string");return Gh(t)==="symbol"?t:String(t)}function EPe(e,t){if(Gh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TPe=function(){function e(t,r){_Pe(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return OPe(e,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,o=[],i=r;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),I(i,function(a){var l={};n.assignSetting(a,l,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(a,l,"reversedRowCoords",!1),n.assignSetting(a,l,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"sourceColumn",a.destinationColumn),n.assignSetting(a,l,"type","sum"),n.assignSetting(a,l,"forceNumeric",!1),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"customFunction",null),n.assignSetting(a,l,"readOnly",!0),n.assignSetting(a,l,"roundFloat",!1),o.push(l)}),o}},{key:"assignSetting",value:function(r,n,o,i){if(o==="ranges"&&r[o]===void 0){n[o]=i;return}else if(o==="ranges"&&r[o].length===0)return;if(r[o]===void 0){if(i instanceof Error)throw i;n[o]=i}else o==="destinationRow"&&n.reversedRowCoords?n[o]=this.hot.countRows()-r[o]-1:n[o]=r[o]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,o){if(this.settingsType==="function"){var i=r.indexOf("row")>-1?"row":"col",a=this.getAllEndpoints();I(a,function(l){i==="row"&&l.destinationRow>=n&&(r==="insert_row"?l.alterRowOffset=o:r==="remove_row"&&(l.alterRowOffset=-1*o)),i==="col"&&l.destinationColumn>=n&&(r==="insert_col"?l.alterColumnOffset=o:r==="remove_col"&&(l.alterColumnOffset=-1*o))}),this.resetAllEndpoints(a,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,o,i,a){var l=this,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var u=function g(){return l.hot.removeHook("beforeViewRender",g),l.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",u);return}var f=r.indexOf("row")>-1?"row":"col",c=r.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=r.indexOf("move_row")===0,v=n;I(h,function(g){f==="row"&&g.destinationRow>=v&&(g.alterRowOffset=c*o),f==="col"&&g.destinationColumn>=v&&(g.alterColumnOffset=c*o)}),this.resetAllEndpoints(h,!d),d?I(h,function(g){l.extendEndpointRanges(g,v,i[0],i.length),l.recreatePhysicalRanges(g),l.clearOffsetInformation(g)}):I(h,function(g){l.shiftEndpointCoordinates(g,v)}),s&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,o,i){I(r.ranges,function(a){a[1]&&(n>=a[0]&&n<=a[1]?o>a[1]?a[1]+=i:o<a[0]&&(a[0]-=i):o>=a[0]&&o<=a[1]&&(a[1]-=i,n<=a[0]&&(a[0]+=1,a[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,o=r.ranges,i=[],a=[];I(o,function(l){var s=[];if(l[1])for(var u=l[0];u<=l[1];u++)s.push(n.hot.toPhysicalRow(u));else s.push(n.hot.toPhysicalRow(l[0]));a.push(s)}),I(a,function(l){var s=[];I(l,function(u,f){f===0?s.push(u):l[f]!==l[f-1]+1&&(s.push(l[f-1]),i.push(s),s=[],s.push(u)),f===l.length-1&&(s.push(u),i.push(s))})}),r.ranges=i}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,I(r.ranges,function(o){I(o,function(i,a){i>=n&&(o[a]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=n.some(function(a){var l=a.alterRowOffset||0,s=a.alterColumnOffset||0;return a.destinationRow+l>=r.hot.countRows()||a.destinationColumn+s>=r.hot.countCols()});i||(this.cellsToSetCache=[],I(n,function(a){r.resetEndpointValue(a,o)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],I(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,o=[];this.cellsToSetCache=[],I(r,function(i,a,l){"".concat(i[2]||"")!=="".concat(i[3])&&I(n.getAllEndpoints(),function(s,u){n.hot.propToCol(l[a][1])===s.sourceColumn&&o.indexOf(u)===-1&&o.push(u)})}),I(o,function(i){n.refreshEndpoint(n.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=r.alterRowOffset||0,i=r.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?o:0)),this.hot.toVisualColumn(r.destinationColumn+(n?i:0)),""])}},{key:"setEndpointValue",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var a=this.hot.toVisualRow(r.destinationRow);if(a!==null){var l=this.hot.getCellMeta(a,r.destinationColumn);(n==="init"||l.readOnly!==r.readOnly)&&(l.readOnly=r.readOnly,l.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),o?this.hot.setDataAtCell(i,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){dt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}();const PPe=TPe;function JS(e){return e==null||isNaN(e)}function cu(e){"@babel/helpers - typeof";return cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cu(e)}var Bx;function kPe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function $Pe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IPe(n.key),n)}}function APe(e,t,r){return t&&Vx(e.prototype,t),r&&Vx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function IPe(e){var t=MPe(e,"string");return cu(t)==="symbol"?t:String(t)}function MPe(e,t){if(cu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dg(){return typeof Reflect<"u"&&Reflect.get?dg=Reflect.get.bind():dg=function(t,r,n){var o=xPe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},dg.apply(this,arguments)}function xPe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=hu(e),e!==null););return e}function DPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mR(e,t)}function mR(e,t){return mR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},mR(e,t)}function NPe(e){var t=jPe();return function(){var n=hu(e),o;if(t){var i=hu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return HPe(this,o)}}function HPe(e,t){if(t&&(cu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LPe(e)}function LPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jPe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hu(e){return hu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hu(e)}var QS="columnSummary",FPe=220,BPe=function(e){DPe(r,e);var t=NPe(r);function r(n){var o;return $Pe(this,r),o=t.call(this,n),o.endpoints=null,o}return APe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[QS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.settings=this.hot.getSettings()[QS],this.endpoints=new PPe(this,this.settings),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeCreateRow",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_row",i,a,null,l)}),this.addHook("beforeCreateCol",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_col",i,a,null,l)}),this.addHook("beforeRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("beforeRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterCreateRow",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_row",i,a,null,l)}),this.addHook("afterCreateCol",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_col",i,a,null,l)}),this.addHook("afterRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("afterRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterRowMove",function(){return o.onAfterRowMove.apply(o,arguments)}),dg(hu(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(o){switch(o.type.toLowerCase()){case"sum":o.result=this.calculateSum(o);break;case"min":o.result=this.calculateMinMax(o,o.type);break;case"max":o.result=this.calculateMinMax(o,o.type);break;case"count":o.result=this.countEntries(o);break;case"average":o.result=this.calculateAverage(o);break;case"custom":o.result=o.customFunction.call(this,o);break}}},{key:"calculateSum",value:function(o){var i=this,a=0;return Ge(o.ranges,function(l){a+=i.getPartialSum(l,o.sourceColumn)}),a}},{key:"getPartialSum",value:function(o,i){var a=0,l=o[1]||o[0],s=null,u=0;do{if(s=this.getCellValue(l,i),s=JS(s)?null:s,s!==null){var f=("".concat(s).split(".")[1]||[]).length||1;f>u&&(u=f)}a+=s||0,l-=1}while(l>=o[0]);return Math.round(a*Math.pow(10,u))/Math.pow(10,u)}},{key:"calculateMinMax",value:function(o,i){var a=this,l=null;return Ge(o.ranges,function(s){var u=a.getPartialMinMax(s,o.sourceColumn,i);if(l===null&&u!==null&&(l=u),u!==null)switch(i){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}}),l===null?"Not enough data":l}},{key:"getPartialMinMax",value:function(o,i,a){var l=null,s=o[1]||o[0],u;do{if(u=this.getCellValue(s,i),u=JS(u)?null:u,l===null)l=u;else if(u!==null)switch(a){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}s-=1}while(s>=o[0]);return l}},{key:"countEmpty",value:function(o,i){var a,l=0,s=o[1]||o[0];do a=this.getCellValue(s,i),a=JS(a)?null:a,a===null&&(l+=1),s-=1;while(s>=o[0]);return l}},{key:"countEntries",value:function(o){var i=this,a=0,l=o.ranges;return Ge(l,function(s){var u=s[1]===void 0?1:s[1]-s[0]+1,f=i.countEmpty(s,o.sourceColumn);a+=u,a-=f}),a}},{key:"calculateAverage",value:function(o){var i=this.calculateSum(o),a=this.countEntries(o);return i/a}},{key:"getCellValue",value:function(o,i){var a=this.hot.toVisualRow(o),l=this.hot.toVisualColumn(i),s=this.hot.getSourceDataAtCell(o,i),u="";if(a!==null&&l!==null&&(u=this.hot.getCellMeta(a,l).className||""),u.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ft(Bx||(Bx=kPe(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),o,i));return s}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(o,i){o&&i!=="ColumnSummary.reset"&&i!=="ColumnSummary.set"&&i!=="loadData"&&this.endpoints.refreshChangedEndpoints(o)}},{key:"onAfterRowMove",value:function(o,i){this.endpoints.resetSetupBeforeStructureAlteration("move_row",o[0],o.length,o,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",i,o.length,o,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return QS}},{key:"PLUGIN_PRIORITY",get:function(){return FPe}}]),r}(ct);function Kh(e){"@babel/helpers - typeof";return Kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kh(e)}function VPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UPe(n.key),n)}}function WPe(e,t,r){return t&&Wx(e.prototype,t),r&&Wx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function UPe(e){var t=zPe(e,"string");return Kh(t)==="symbol"?t:String(t)}function zPe(e,t){if(Kh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var YPe=function(){function e(t,r){VPe(this,e),this.rootDocument=t,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return WPe(e,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var o=this.getInputElement();o.style.width="".concat(r,"px"),o.style.height="".concat(n,"px")}}},{key:"getSize",value:function(){return{width:gt(this.getInputElement()),height:$t(this.getInputElement())}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),re(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),re(r,e.CLASS_EDITOR),re(n,e.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}();const GPe=YPe;var Ue="---------";function KPe(){return{name:Ue}}function qPe(e){return ze(e,function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}})}function cy(e){return De(e,"htSeparator")}function XPe(e){return De(e,"htSubmenu")}function hy(e){return De(e,"htDisabled")}function dy(e){return De(e,"htSelectionDisabled")}function nl(e){var t=e.getSelected();return!t||t[0]<0?null:t}function ZPe(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function JPe(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function Vi(e,t){var r={};return I(e,function(n){n.forAll(function(o,i){o>=0&&i>=0&&(r[o]||(r[o]=[]),r[o][i]=t(o,i))})}),r}function ri(e,t,r,n,o){I(e,function(i){i.forAll(function(a,l){a>=0&&l>=0&&QPe(a,l,t,r,n,o)})})}function QPe(e,t,r,n,o,i){var a=o(e,t),l=n;a.className&&(r==="vertical"?l=ZPe(a.className,n):l=JPe(a.className,n)),i(e,t,"className",l)}function $n(e,t){var r=!1;return Array.isArray(e)&&I(e,function(n){return n.forAll(function(o,i){if(o>=0&&i>=0&&t(o,i))return r=!0,!1}),r}),r}function no(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function eke(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function I2(e,t){for(var r=e.slice(0),n=0;n<r.length&&r[n].name===t;)r.shift();return r}function tke(e,t){var r=e.slice(0);return r.reverse(),r=I2(r,t),r.reverse(),r}function rke(e){var t=[];return I(e,function(r,n){n>0?t[t.length-1].name!==r.name&&t.push(r):t.push(r)}),t}function nke(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ue,r=e.slice(0);return r=I2(r,t),r=tke(r,t),r=rke(r),r}function qh(e){"@babel/helpers - typeof";return qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qh(e)}function oke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ux(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ake(n.key),n)}}function ike(e,t,r){return t&&Ux(e.prototype,t),r&&Ux(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ake(e){var t=lke(e,"string");return qh(t)==="symbol"?t:String(t)}function lke(e,t){if(qh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ske=250,uke=250,M2=function(){function e(t){oke(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return ike(e,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},uke)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ske;this.showDebounced=VB(function(o){r.wasLastActionShow&&r.runLocalHooks("show",o.from.row,o.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();bt(M2,Pr);const fke=M2;function du(e){"@babel/helpers - typeof";return du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},du(e)}function eC(e,t,r){return t=x2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,x2(n.key),n)}}function hke(e,t,r){return t&&zx(e.prototype,t),r&&zx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function x2(e){var t=dke(e,"string");return du(t)==="symbol"?t:String(t)}function dke(e,t){if(du(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(du(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ia(){return typeof Reflect<"u"&&Reflect.get?ia=Reflect.get.bind():ia=function(t,r,n){var o=vke(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ia.apply(this,arguments)}function vke(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vo(e),e!==null););return e}function yke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pR(e,t)}function pR(e,t){return pR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},pR(e,t)}function gke(e){var t=pke();return function(){var n=vo(e),o;if(t){var i=vo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return mke(this,o)}}function mke(e,t){if(t&&(du(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return D2(e)}function D2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pke(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vo(e){return vo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vo(e)}var tC="comments",bke=60,vy=new WeakMap,Cn="comment",Sl="value",Yx="style",yy="readOnly",wke=function(e){yke(r,e);var t=gke(r);function r(n){var o;return cke(this,r),o=t.call(this,n),o.editor=null,o.displaySwitch=null,o.eventManager=null,o.range={},o.preventEditorAutoSwitch=!1,vy.set(D2(o),{tempEditorDimensions:{},cellBelowCursor:null}),o}return hke(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[tC]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.editor||(this.editor=new GPe(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new It(this)),this.displaySwitch||(this.displaySwitch=new fke(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(i){return o.addToContextMenu(i)}),this.addHook("afterRenderer",function(i,a,l,s,u,f){return o.onAfterRenderer(i,f)}),this.addHook("afterScrollHorizontally",function(){return o.hide()}),this.addHook("afterScrollVertically",function(){return o.hide()}),this.addHook("afterBeginEditing",function(){return o.hide()}),this.displaySwitch.addLocalHook("hide",function(){return o.hide()}),this.displaySwitch.addLocalHook("show",function(i,a){return o.showAtCell(i,a)}),this.registerListeners(),ia(vo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ia(vo(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){ia(vo(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var o=this,i=this.hot.rootDocument;this.eventManager.addEventListener(i,"mouseover",function(a){return o.onMouseOver(a)}),this.eventManager.addEventListener(i,"mousedown",function(a){return o.onMouseDown(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return o.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(a){return o.onEditorMouseDown(a)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(a){return o.onEditorMouseUp(a)})}},{key:"setRange",value:function(o){this.range=o}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(o){var i=ka(o.target,"TD","TBODY");return!!(i&&De(i,"htCommentCell")&&ka(i,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(o){return this.editor.getInputElement()===o.target}},{key:"setComment",value:function(o){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.editor.getValue(),a="";o!=null?a=o:i!=null&&(a=i);var l=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(l,s,eC({},Sl,a)),this.hot.render()}},{key:"setCommentAtCell",value:function(o,i,a){this.setRange({from:this.hot._createCellCoords(o,i)}),this.setComment(a)}},{key:"removeComment",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Cn),o&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(o,i)}),this.removeComment(a)}},{key:"getComment",value:function(){var o=this.range.from.row,i=this.range.from.col;return this.getCommentMeta(o,i,Sl)}},{key:"getCommentAtCell",value:function(o,i){return this.getCommentMeta(o,i,Sl)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var o=this.range.from,i=o.row,a=o.col;if(i<0||i>this.hot.countSourceRows()-1||a<0||a>this.hot.countSourceCols()-1)return!1;var l=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(l[Cn]?l[Cn][Sl]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(o,i){return this.setRange({from:this.hot._createCellCoords(o,i)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var o,i,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!a&&(!this.range.from||!this.editor.isVisible()))){var l=this.hot,s=l.rowIndexMapper,u=l.columnIndexMapper,f=this.range.from,c=f.row,h=f.col,d=s.getRenderableFromVisualIndex(c),v=u.getRenderableFromVisualIndex(h),g=d===null;this.editor.setPosition(0,0),d===null&&(d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(c,-1))),v===null&&(v=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(h,-1)));var p=d===null,w=v===null;d=(o=d)!==null&&o!==void 0?o:0,v=(i=v)!==null&&i!==void 0?i:0;var S=this.hot,C=S.rootWindow,P=S.view._wt,R=P.wtTable,V=P.getCell({row:d,col:v},!0),U=this.getCommentMeta(c,h,Yx);U?this.editor.setSize(U.width,U.height):this.editor.resetSize();var X=w?0:R.getStretchedColumnWidth(v),Y=g&&!p?$t(V):0,q=V.getBoundingClientRect(),Z=q.left,ie=q.top,J=q.width,le=q.height,Ce=this.editor.getSize(),we=Ce.width,_e=Ce.height,k=this.hot.rootWindow,y=k.innerWidth,m=k.innerHeight,b=this.hot.rootDocument.documentElement,_=Z+C.scrollX+X,T=ie+C.scrollY+Y;this.hot.isRtl()&&(_-=we+X),this.hot.isLtr()&&Z+J+we>y?_=Z+C.scrollX-we-1:this.hot.isRtl()&&_<-(b.scrollWidth-b.clientWidth)&&(_=Z+C.scrollX+X+1),ie+_e>m&&(T-=_e-le+1),this.editor.setPosition(_,T),this.editor.setReadOnlyState(this.getCommentMeta(c,h,yy))}}},{key:"checkSelectionCommentsConsistency",value:function(){var o=this.hot.getSelectedRangeLast();if(!o)return!1;var i=!1,a=o.getTopStartCorner();return this.getCommentMeta(a.row,a.col,Sl)&&(i=!0),i}},{key:"updateCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i)[Cn],s;l?(s=yr(l),up(s,a)):s=a,this.hot.setCellMeta(o,i,Cn,s)}},{key:"getCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i);if(l[Cn])return l[Cn][a]}},{key:"onMouseDown",value:function(o){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(o)){var i=ka(o.target,"TD","TBODY"),a=null;i&&(a=this.hot.getCoords(i)),(!i||this.range.from&&a&&(this.range.from.row!==a.row||this.range.from.col!==a.col))&&this.hide()}}},{key:"onMouseOver",value:function(o){var i=vy.get(this),a=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||De(o.target,"wtBorder")||i.cellBelowCursor===o.target||!this.editor))if(i.cellBelowCursor=a.elementFromPoint(o.clientX,o.clientY),this.targetIsCellWithComment(o)){var l=this.hot._createCellRange(this.hot.getCoords(o.target));this.displaySwitch.show(l)}else $a(o.target,a)&&!this.targetIsCommentTextArea(o)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(o,i){i[Cn]&&i[Cn][Sl]&&re(o,i.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(o){var i=vy.get(this);i.tempEditorDimensions={width:gt(o.target),height:$t(o.target)}}},{key:"onEditorMouseUp",value:function(o){var i=vy.get(this),a=gt(o.target),l=$t(o.target);(a!==i.tempEditorDimensions.width+1||l!==i.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,eC({},Yx,{width:a,height:l}))}},{key:"onContextMenuAddComment",value:function(){var o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:o.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){a>=0&&l>=0&&o.removeCommentAtCell(a,l,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){if(a>=0&&l>=0){var s=!!o.getCommentMeta(a,l,yy);o.updateCommentMeta(a,l,eC({},yy,!s))}})}},{key:"addToContextMenu",value:function(o){var i=this,a=function(){return i.hot.rowIndexMapper.getRenderableIndexesLength()>0&&i.hot.columnIndexMapper.getRenderableIndexesLength()>0};o.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return i.checkSelectionCommentsConsistency()?i.hot.getTranslatedPhrase(Kp):i.hot.getTranslatedPhrase(Gp)},callback:function(){return i.onContextMenuAddComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(qp)},callback:function(){return i.onContextMenuRemoveComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var s=this,u=this.getTranslatedPhrase(Xp),f=$n(this.getSelectedRangeLast(),function(c,h){var d=s.getCellMeta(c,h)[Cn];if(d&&(d=d[yy]),d)return!0});return f&&(u=no(u)),u},callback:function(){return i.onContextMenuMakeReadOnly()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner())||!i.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var o=this.hot.getSettings()[tC];if(Ye(o))return o.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),ia(vo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return tC}},{key:"PLUGIN_PRIORITY",get:function(){return bke}}]),r}(ct);function Xh(e){"@babel/helpers - typeof";return Xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xh(e)}function Ske(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_ke(n.key),n)}}function Cke(e,t,r){return t&&Gx(e.prototype,t),r&&Gx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _ke(e){var t=Oke(e,"string");return Xh(t)==="symbol"?t:String(t)}function Oke(e,t){if(Xh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rke=function(){function e(t){Ske(this,e),this.hot=t,this.commands={},this.commonCallback=null}return Cke(e,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var l=r.split(":"),s=l[0],u=l.length===2?l[1]:null,f=this.commands[s];if(!f)throw new Error("Menu command '".concat(s,"' not exists."));if(u&&f.submenu&&(f=Eke(u,f.submenu.items)),f.disabled!==!0&&!(typeof f.disabled=="function"&&f.disabled.call(this.hot)===!0)&&!Dt(f,"submenu")){var c=[];typeof f.callback=="function"&&c.push(f.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),i.unshift(l.join(":")),I(c,function(h){return h.apply(n.hot,i)})}}}]),e}();function Eke(e,t){var r;return I(t,function(n){var o=n.key?n.key.split(":"):null;if(Array.isArray(o)&&o[1]===e)return r=n,!1}),r}const N2=Rke;var zr="alignment";function Tke(){return{key:zr,name:function(){return this.getTranslatedPhrase(Zp)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(zr,":left"),name:function(){var t=this,r=this.getTranslatedPhrase(Jp),n=$n(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htLeft")!==-1)return!0});return n&&(r=no(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Vi(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",n,r,o,i),ri(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(zr,":center"),name:function(){var t=this,r=this.getTranslatedPhrase(Qp),n=$n(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htCenter")!==-1)return!0});return n&&(r=no(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Vi(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",n,r,o,i),ri(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(zr,":right"),name:function(){var t=this,r=this.getTranslatedPhrase(eb),n=$n(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htRight")!==-1)return!0});return n&&(r=no(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Vi(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htRight";this.runHooks("beforeCellAlignment",n,r,o,i),ri(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(zr,":justify"),name:function(){var t=this,r=this.getTranslatedPhrase(tb),n=$n(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htJustify")!==-1)return!0});return n&&(r=no(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Vi(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",n,r,o,i),ri(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{name:Ue},{key:"".concat(zr,":top"),name:function(){var t=this,r=this.getTranslatedPhrase(rb),n=$n(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htTop")!==-1)return!0});return n&&(r=no(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Vi(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htTop";this.runHooks("beforeCellAlignment",n,r,o,i),ri(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(zr,":middle"),name:function(){var t=this,r=this.getTranslatedPhrase(nb),n=$n(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htMiddle")!==-1)return!0});return n&&(r=no(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Vi(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",n,r,o,i),ri(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(zr,":bottom"),name:function(){var t=this,r=this.getTranslatedPhrase(ob),n=$n(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htBottom")!==-1)return!0});return n&&(r=no(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Vi(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htBottom";this.runHooks("beforeCellAlignment",n,r,o,i),ri(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1}]}}}var ew="clear_column";function Pke(){return{key:ew,name:function(){return this.getTranslatedPhrase(Hp)},callback:function(t,r){var n=r[0].start.col,o=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),o,"ContextMenu.clearColumn")},disabled:function(){var t=nl(this);return t?!this.selection.isSelectedByColumnHeader():!0}}}var _v="col_left";function kke(){return{key:_v,name:function(){return this.getTranslatedPhrase($p)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner(),r=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(r,t.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=nl(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Ov="col_right";function $ke(){return{key:Ov,name:function(){return this.getTranslatedPhrase(Ap)},callback:function(){var t=this.getSelectedRangeLast().getTopRightCorner(),r=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(r,t.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=nl(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Rv="make_read_only";function Ake(){return{key:Rv,name:function(){var t=this,r=this.getTranslatedPhrase(Np),n=$n(this.getSelectedRange(),function(o,i){return t.getCellMeta(o,i).readOnly});return n&&(r=no(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=$n(r,function(o,i){return t.getCellMeta(o,i).readOnly});I(r,function(o){o.forAll(function(i,a){i>=0&&a>=0&&t.setCellMeta(i,a,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var tw="redo";function Ike(){return{key:tw,name:function(){return this.getTranslatedPhrase(Dp)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function Mke(e,t){return Hke(e)||Nke(e,t)||Dke(e,t)||xke()}function xke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dke(e,t){if(e){if(typeof e=="string")return Kx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Kx(e,t)}}function Kx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Nke(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Hke(e){if(Array.isArray(e))return e}var Ev="remove_col";function Lke(){return{key:Ev,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=Mke(t[0],4),o=n[1],i=n[3];o-i!==0&&(r=1)}return this.getTranslatedPhrase(Mp,r)},callback:function(){this.alter("remove_col",Kbe(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=nl(this);if(!t)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function jke(e,t){return Wke(e)||Vke(e,t)||Bke(e,t)||Fke()}function Fke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bke(e,t){if(e){if(typeof e=="string")return qx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qx(e,t)}}function qx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vke(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Wke(e){if(Array.isArray(e))return e}var rw="remove_row";function Uke(){return{key:rw,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=jke(t[0],3),o=n[0],i=n[2];o-i!==0&&(r=1)}return this.getTranslatedPhrase(Ip,r)},callback:function(){this.alter("remove_row",qbe(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=nl(this);if(!t)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var nw="row_above";function zke(){return{key:nw,name:function(){return this.getTranslatedPhrase(Pp)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled:function(){var t=nl(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var ow="row_below";function Yke(){return{key:ow,name:function(){return this.getTranslatedPhrase(kp)},callback:function(){var t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled:function(){var t=nl(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var Zh="no_items";function Gke(){return{key:Zh,name:function(){return this.getTranslatedPhrase($T)},disabled:!0,isCommand:!1}}var iw="undo";function Kke(){return{key:iw,name:function(){return this.getTranslatedPhrase(xp)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function Jh(e){"@babel/helpers - typeof";return Jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jh(e)}var fr;function kr(e,t,r){return t=qke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qke(e){var t=Xke(e,"string");return Jh(t)==="symbol"?t:String(t)}function Xke(e,t){if(Jh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zke=[nw,ow,_v,Ov,ew,rw,Ev,iw,tw,Rv,zr,Ue,Zh],Jke=(fr={},kr(fr,Ue,KPe),kr(fr,Zh,Gke),kr(fr,nw,zke),kr(fr,ow,Yke),kr(fr,_v,kke),kr(fr,Ov,$ke),kr(fr,ew,Pke),kr(fr,rw,Uke),kr(fr,Ev,Lke),kr(fr,iw,Kke),kr(fr,tw,Ike),kr(fr,Rv,Ake),kr(fr,zr,Tke),fr);function H2(){var e={};return Ge(Jke,function(t,r){e[r]=t()}),e}function Qh(e){"@babel/helpers - typeof";return Qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qh(e)}function Qke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,t$e(n.key),n)}}function e$e(e,t,r){return t&&Xx(e.prototype,t),r&&Xx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function t$e(e){var t=r$e(e,"string");return Qh(t)==="symbol"?t:String(t)}function r$e(e,t){if(Qh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n$e=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Qke(this,e),this.hot=t,this.predefinedItems=H2(),this.defaultOrderPattern=r}return e$e(e,[{key:"setPredefinedItems",value:function(r){var n=this,o={};this.defaultOrderPattern.length=0,Ge(r,function(i,a){var l="";i.name===Ue?(o[Ue]=i,l=Ue):isNaN(parseInt(a,10))?(i.key=i.key===void 0?a:i.key,o[a]=i,l=i.key):(o[i.key]=i,l=i.key),n.defaultOrderPattern.push(l)}),this.predefinedItems=o}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return o$e(r,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function o$e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],o=e;return o&&o.items?o=o.items:Array.isArray(o)||(o=t),Ye(o)?Ge(o,function(i,a){var l=r[typeof i=="string"?i:a];l||(l=i),Ye(i)?Yt(l,i):typeof l=="string"&&(l={name:l}),l.key===void 0&&(l.key=a),n.push(l)}):I(o,function(i,a){var l=r[i];!l&&Zke.indexOf(i)>=0||(l||(l={name:i,key:"".concat(a)}),Ye(i)&&Yt(l,i),l.key===void 0&&(l.key=a),n.push(l))}),n}const L2=n$e;function ed(e){"@babel/helpers - typeof";return ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ed(e)}function i$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l$e(n.key),n)}}function a$e(e,t,r){return t&&Zx(e.prototype,t),r&&Zx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function l$e(e){var t=s$e(e,"string");return ed(t)==="symbol"?t:String(t)}function s$e(e,t){if(ed(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var u$e=function(){function e(t,r){i$e(this,e);var n=Dc(r),o=us(r),i,a,l,s,u,f;this.rootWindow=r,this.type=this.getSourceType(t),this.type==="literal"?(i=parseInt(t.top,10),l=parseInt(t.left,10),u=t.height||0,f=t.width||0,a=i,s=l,i+=n,l+=o):this.type==="event"&&(i=parseInt(t.pageY,10),l=parseInt(t.pageX,10),u=t.target.clientHeight,f=t.target.clientWidth,a=i-n,s=l-o),this.top=i,this.topRelative=a,this.left=l,this.leftRelative=s,this.scrollTop=n,this.scrollLeft=o,this.cellHeight=u,this.cellWidth=f}return a$e(e,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),e}();const f$e=u$e;function td(e){"@babel/helpers - typeof";return td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},td(e)}function Jx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Qx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Jx(Object(r),!0).forEach(function(n){c$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function c$e(e,t,r){return t=j2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,j2(n.key),n)}}function d$e(e,t,r){return t&&eD(e.prototype,t),r&&eD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function j2(e){var t=v$e(e,"string");return td(t)==="symbol"?t:String(t)}function v$e(e,t){if(td(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tD=215,F2="menu",y$e=F2,B2=function(){function e(t,r){h$e(this,e),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:tD,container:this.hot.rootDocument.documentElement},this.eventManager=new It(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return d$e(e,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(o){return r.onDocumentMouseDown(o)}),this.eventManager.addEventListener(n.document,"contextmenu",function(o){return r.onDocumentContextMenu(o)}),n=Bg(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=VB(function(d){return r.openSubMenu(d)},300),o=this.options.minWidth||tD,i=!1,a=Kr(this.menuItems,function(d){return d.key===Zh&&(i=!0),eke(d,r.hot)});if(a.length<1&&!i)a.push(H2()[Zh]);else if(a.length===0)return;a=nke(a,Ue);var l=!1,s={data:a,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(v){return pe(v)&&v<o?o:v},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(v,g,p,w,S,C){return r.menuItemRenderer(v,g,p,w,S,C)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(v,g){r.isAllSubMenusClosed()?n(g.row):r.openSubMenu(g.row)},rowHeights:function(v){return a[v].name===Ue?1:23},afterOnCellContextMenu:function(v){v.preventDefault(),Z$()&&l&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(v){r.hasSelectedItem()&&(l=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(v))},afterOnCellMouseUp:function(v){(!Z$()||!xa(v))&&l&&r.hasSelectedItem()&&(xn()||BF()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new NT(this.container,s),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var u=this.hotMenu.getShortcutManager(),f=u.addContext(y$e),c={group:F2},h=Qx(Qx({},c),{},{runOnlyIf:function(v){return Ug(v.target)===!1||r.container.contains(v.target)===!1}});u.setActiveContextName("menu"),f.addShortcuts([{keys:[["Escape"]],callback:function(){r.keyEvent=!0,r.close(),r.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectNextCell(v[0],v[1]):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectPrevCell(v[0],v[1]):r.selectLastCell(),r.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var v=r.hotMenu.getSelectedLast();if(r.keyEvent=!0,v){var g=r.openSubMenu(v[0]);g&&g.selectFirstCell()}r.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v&&r.isSubMenu()&&(r.close(),r.parentMenu&&r.parentMenu.hotMenu.listen()),r.keyEvent=!1}},{keys:[["Enter"]],callback:function(v){var g=r.hotMenu.getSelectedLast();r.keyEvent=!0,r.hotMenu.getSourceDataAtRow(g[0]).submenu||(r.executeCommand(v),r.close(!0)),r.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(-r.hotMenu.countVisibleRows(),0):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(r.hotMenu.countVisibleRows(),0):r.selectLastCell(),r.keyEvent=!1}}],h),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!XPe(n))return!1;var o=this.hotMenu.getSourceDataAtRow(r),i=new e(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(o.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[o.key]=i,i}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),o=this.hotSubMenus[n.key];o&&(o.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;I(this.hotMenu.getData(),function(n,o){return r.closeSubMenu(o)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var o=this.hot.getSelectedRange(),i=o?qPe(o):[];this.runLocalHooks("executeCommand",n.key,i,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,o=r.name,i=r.disabled,a=r.submenu,l=i===!0||typeof i=="function"&&i.call(this.hot)===!0;return n===!1||o===Ue||l===!0||a}},{key:"setPosition",value:function(r){var n=new f$e(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),this.hot.isLtr()?this.setHorizontalPositionForLtr(n):this.setHorizontalPositionForRtl(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setHorizontalPositionForRtl",value:function(r){r.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(r):this.setPositionOnRightOfCursor(r)}},{key:"setHorizontalPositionForLtr",value:function(r){r.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(r):this.setPositionOnLeftOfCursor(r)}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n=r.left;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.right;n+=r.cellWidth+i-(r.left+r.cellWidth)}else n+=this.offset.right;this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=this.offset.left+r.left-this.container.offsetWidth;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.left;n-=r.left-i}this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);cy(r)||hy(r)||dy(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);cy(n)||hy(n)||dy(n)?this.selectPrevCell(r,0):(this.hotMenu.selectCell(r,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(r,0,!0,!1))}},{key:"selectNextCell",value:function(r,n){var o=r+1,i=o<this.hotMenu.countRows()?this.hotMenu.getCell(o,n):null;i&&(cy(i)||hy(i)||dy(i)?this.selectNextCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"selectPrevCell",value:function(r,n){var o=r-1,i=o>=0?this.hotMenu.getCell(o,n):null;i&&(cy(i)||hy(i)||dy(i)?this.selectPrevCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"menuItemRenderer",value:function(r,n,o,i,a,l){var s=this,u=r.getSourceDataAtRow(o),f=this.hot.rootDocument.createElement("div"),c=function(w){return Dt(w,"submenu")},h=function(w){return new RegExp(Ue,"i").test(w.name)},d=function(w){return w.disabled===!0||typeof w.disabled=="function"&&w.disabled.call(s.hot)===!0},v=function(w){return w.disableSelection},g=l;typeof g=="function"&&(g=g.call(this.hot)),Hn(n),re(f,"htItemWrapper"),n.appendChild(f),h(u)?re(n,"htSeparator"):typeof u.renderer=="function"?(re(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(r,f,o,i,a,g))):bf(f,g),d(u)?(re(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):v(u)?(re(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):c(u)?(re(n,"htSubmenu"),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)})):(je(n,["htSubmenu","htDisabled"]),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,o=r,i;return o&&(wt(o)&&(o=o.call(this.hot),o===null||pt(o)?o="":o=o.toString()),o=o.replace(/[^A-z0-9]/g,"_"),o="".concat(this.options.className,"Sub_").concat(o),i=n.querySelector(".".concat(this.options.className,".").concat(o))),i||(i=n.createElement("div"),re(i,"htMenu ".concat(this.options.className)),o&&re(i,o),this.options.container.appendChild(i)),i}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view._wt.wtTable,n=this.hotMenu.getSettings().data,o=r.hider.style,i=r.holder.style,a=parseInt(o.width,10),l=ar(n,function(s,u){return s+(u.name===Ue?1:26)},0);i.width="".concat(a+3,"px"),i.height="".concat(l+3,"px"),o.height=i.height}},{key:"onAfterSelection",value:function(r,n,o,i,a){this.keyEvent===!1&&(a.value=!0)}},{key:"onDocumentMouseDown",value:function(r){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!$a(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!$a(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){this.isOpened()&&De(r.target,"htCore")&&$a(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),e}();bt(B2,Pr);const JT=B2;function vu(e){"@babel/helpers - typeof";return vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vu(e)}function g$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p$e(n.key),n)}}function m$e(e,t,r){return t&&rD(e.prototype,t),r&&rD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function p$e(e){var t=b$e(e,"string");return vu(t)==="symbol"?t:String(t)}function b$e(e,t){if(vu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aa(){return typeof Reflect<"u"&&Reflect.get?aa=Reflect.get.bind():aa=function(t,r,n){var o=w$e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},aa.apply(this,arguments)}function w$e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yo(e),e!==null););return e}function S$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bR(e,t)}function bR(e,t){return bR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},bR(e,t)}function C$e(e){var t=O$e();return function(){var n=yo(e),o;if(t){var i=yo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _$e(this,o)}}function _$e(e,t){if(t&&(vu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return V2(e)}function V2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O$e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yo(e){return yo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yo(e)}var gy="contextMenu",R$e=70;be.getSingleton().register("afterContextMenuDefaultOptions");be.getSingleton().register("beforeContextMenuShow");be.getSingleton().register("afterContextMenuShow");be.getSingleton().register("afterContextMenuHide");be.getSingleton().register("afterContextMenuExecute");var W2=function(e){S$e(r,e);var t=C$e(r);function r(n){var o;return g$e(this,r),o=t.call(this,n),o.eventManager=new It(V2(o)),o.commandExecutor=new N2(o.hot),o.itemsFactory=null,o.menu=null,o}return m$e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[gy]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[gy];typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),this.menu=new JT(this.hot,{className:"htContextMenu",keepInViewport:!0,container:i.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var a,l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return(a=o.executeCommand).call.apply(a,[o].concat(s))}),this.addHook("afterOnCellContextMenu",function(a){return o.onAfterOnCellContextMenu(a)}),aa(yo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),aa(yo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),aa(yo(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(o){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,f=s.left;i=u-Dc(o.view),a=f-us(o.view)}else i=-1*Dc(this.menu.hotMenu.rootWindow),a=-1*us(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(o.pageY,10)+i,left:parseInt(o.pageX,10)+a})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(o){var i;this.itemsFactory===null&&this.prepareMenuItems();for(var a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"prepareMenuItems",value:function(){var o=this;this.itemsFactory=new L2(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[gy],a={items:this.itemsFactory.getItems(i)};this.hot.runHooks("afterContextMenuDefaultOptions",a),this.itemsFactory.setPredefinedItems(a.items);var l=this.itemsFactory.getItems(i);this.hot.runHooks("beforeContextMenuSetItems",l),this.menu.setMenuItems(l),I(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})}},{key:"onAfterOnCellContextMenu",value:function(o){var i=this.hot.getSettings(),a=i.rowHeaders,l=i.colHeaders;function s(f){return f.nodeName==="TD"||f.parentNode.nodeName==="TD"}var u=o.target;this.close(),!De(u,"handsontableInput")&&(o.preventDefault(),o.stopPropagation(),!(!(a||l)&&!s(u)&&!(De(u,"current")&&De(u,"wtBorder")))&&this.open(o))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),aa(yo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return gy}},{key:"PLUGIN_PRIORITY",get:function(){return R$e}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[nw,ow,Ue,_v,Ov,Ue,rw,Ev,Ue,iw,tw,Ue,Rv,Ue,zr]}}]),r}(ct);W2.SEPARATOR={name:Ue};function E$e(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(Lp)},callback:function(){e.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function T$e(e){return{key:"copy_column_headers_only",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(Bp,n)},callback:function(){e.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function P$e(e){return{key:"copy_with_column_group_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(Fp,n)},callback:function(){e.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function k$e(e){return{key:"copy_with_column_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(jp,n)},callback:function(){e.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function $$e(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(Vp)},callback:function(){e.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function rd(e){"@babel/helpers - typeof";return rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rd(e)}function A$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,M$e(n.key),n)}}function I$e(e,t,r){return t&&nD(e.prototype,t),r&&nD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function M$e(e){var t=x$e(e,"string");return rd(t)==="symbol"?t:String(t)}function x$e(e,t){if(rd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var D$e=function(){function e(){A$e(this,e),this.data={}}return I$e(e,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),e}();function nd(e){"@babel/helpers - typeof";return nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nd(e)}function oD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,H$e(n.key),n)}}function N$e(e,t,r){return t&&oD(e.prototype,t),r&&oD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function H$e(e){var t=L$e(e,"string");return nd(t)==="symbol"?t:String(t)}function L$e(e,t){if(nd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function j$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var F$e=N$e(function e(){j$e(this,e),this.clipboardData=new D$e});function od(e){"@babel/helpers - typeof";return od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},od(e)}function B$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,W$e(n.key),n)}}function V$e(e,t,r){return t&&iD(e.prototype,t),r&&iD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function W$e(e){var t=U$e(e,"string");return od(t)==="symbol"?t:String(t)}function U$e(e,t){if(od(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QT=function(){function e(t){B$e(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new It(this),this.listenersCount=new WeakSet,this.container=t}return V$e(e,[{key:"useSecondaryElement",value:function(){var r=G$e(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),aD(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),aD(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",xn()||bie(this.mainElement)}}]),e}();bt(QT,Pr);var Pm=new WeakMap;function z$e(e){var t=new QT(e),r=Pm.get(e);return r=isNaN(r)?0:r,Pm.set(e,r+1),t}function Y$e(e){e.eventManager.clear()}var rC=function(t,r){return function(n){return r.runLocalHooks(t,n)}};function aD(e,t,r){e.addEventListener(t,"copy",rC("copy",r)),e.addEventListener(t,"cut",rC("cut",r)),e.addEventListener(t,"paste",rC("paste",r))}var km=new WeakMap;function G$e(e){var t=km.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=e.defaultView?e:e.ownerDocument,n=r.createElement("textarea");return km.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}function lD(e){if(e instanceof QT){var t=Pm.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),Y$e(e),t<=0){t=0;var r=km.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),km.delete(e.container)),e.mainElement=null}Pm.set(e.container,t)}}function id(e){"@babel/helpers - typeof";return id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},id(e)}function K$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,X$e(n.key),n)}}function q$e(e,t,r){return t&&sD(e.prototype,t),r&&sD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function X$e(e){var t=Z$e(e,"string");return id(t)==="symbol"?t:String(t)}function Z$e(e,t){if(id(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uD(e,t){U2(e,t),t.add(e)}function Cl(e,t,r){U2(e,t),t.set(e,r)}function U2(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function my(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function dr(e,t){var r=z2(e,t,"get");return J$e(e,r)}function J$e(e,t){return t.get?t.get.call(e):t.value}function _l(e,t,r){var n=z2(e,t,"set");return Q$e(e,n,r),r}function z2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Q$e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var qo=new WeakMap,nC=new WeakMap,Yf=new WeakMap,wR=new WeakMap,SR=new WeakMap,Gf=new WeakMap,py=new WeakSet,fD=new WeakSet,e1e=function(){function e(t){var r=t.countRows,n=t.countColumns,o=t.rowsLimit,i=t.columnsLimit,a=t.countColumnHeaders;K$e(this,e),uD(this,fD),uD(this,py),Cl(this,qo,{writable:!0,value:void 0}),Cl(this,nC,{writable:!0,value:void 0}),Cl(this,Yf,{writable:!0,value:void 0}),Cl(this,wR,{writable:!0,value:void 0}),Cl(this,SR,{writable:!0,value:void 0}),Cl(this,Gf,{writable:!0,value:void 0}),_l(this,nC,r),_l(this,Yf,n),_l(this,wR,o),_l(this,SR,i),_l(this,Gf,a)}return q$e(e,[{key:"setSelectedRange",value:function(r){_l(this,qo,r)}},{key:"getCellsRange",value:function(){if(dr(this,nC).call(this)===0||dr(this,Yf).call(this)===0)return null;var r=dr(this,qo).getTopStartCorner(),n=r.row,o=r.col,i=dr(this,qo).getBottomEndCorner(),a=i.row,l=i.col,s=my(this,fD,t1e).call(this,n,a),u=my(this,py,oC).call(this,o,l),f=a!==s||l!==u;return{isRangeTrimmed:f,startRow:n,startCol:o,endRow:s,endCol:u}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(dr(this,Yf).call(this)===0||dr(this,Gf).call(this)===0)return null;var r=dr(this,qo).getTopStartCorner(),n=r.col,o=dr(this,qo).getBottomEndCorner(),i=o.col,a=my(this,py,oC).call(this,n,i),l=i!==a;return{isRangeTrimmed:l,startRow:-1,startCol:n,endRow:-1,endCol:a}}},{key:"getAllColumnHeadersRange",value:function(){if(dr(this,Yf).call(this)===0||dr(this,Gf).call(this)===0)return null;var r=dr(this,qo).getTopStartCorner(),n=r.col,o=dr(this,qo).getBottomEndCorner(),i=o.col,a=my(this,py,oC).call(this,n,i),l=i!==a;return{isRangeTrimmed:l,startRow:-dr(this,Gf).call(this),startCol:n,endRow:-1,endCol:a}}}]),e}();function oC(e,t){return Math.min(t,Math.max(e+dr(this,SR).call(this)-1,e))}function t1e(e,t){return Math.min(t,Math.max(e+dr(this,wR).call(this)-1,e))}function Y2(e){var t=[],r=[];return I(e,function(n){var o=Math.min(n.startRow,n.endRow),i=Math.max(n.startRow,n.endRow);Re(o,i,function(s){t.indexOf(s)===-1&&t.push(s)});var a=Math.min(n.startCol,n.endCol),l=Math.max(n.startCol,n.endCol);Re(a,l,function(s){r.indexOf(s)===-1&&r.push(s)})}),{rows:t,columns:r}}function r1e(e,t){return a1e(e)||i1e(e,t)||o1e(e,t)||n1e()}function n1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o1e(e,t){if(e){if(typeof e=="string")return cD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cD(e,t)}}function cD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i1e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function a1e(e){if(Array.isArray(e))return e}function Ua(e){"@babel/helpers - typeof";return Ua=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ua(e)}function l1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,K2(n.key),n)}}function s1e(e,t,r){return t&&hD(e.prototype,t),r&&hD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function la(){return typeof Reflect<"u"&&Reflect.get?la=Reflect.get.bind():la=function(t,r,n){var o=u1e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},la.apply(this,arguments)}function u1e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=go(e),e!==null););return e}function f1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CR(e,t)}function CR(e,t){return CR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},CR(e,t)}function c1e(e){var t=d1e();return function(){var n=go(e),o;if(t){var i=go(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return h1e(this,o)}}function h1e(e,t){if(t&&(Ua(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hr(e)}function hr(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function go(e){return go=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},go(e)}function v1e(e,t){G2(e,t),t.add(e)}function Wi(e,t,r){G2(e,t),t.set(e,r)}function G2(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ol(e,t,r){return t=K2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K2(e){var t=y1e(e,"string");return Ua(t)==="symbol"?t:String(t)}function y1e(e,t){if(Ua(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ua(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function g1e(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function $r(e,t){var r=q2(e,t,"get");return m1e(e,r)}function m1e(e,t){return t.get?t.get.call(e):t.value}function Kn(e,t,r){var n=q2(e,t,"set");return p1e(e,n,r),r}function q2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function p1e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}be.getSingleton().register("afterCopyLimit");be.getSingleton().register("modifyCopyableRange");be.getSingleton().register("beforeCut");be.getSingleton().register("afterCut");be.getSingleton().register("beforePaste");be.getSingleton().register("afterPaste");be.getSingleton().register("beforeCopy");be.getSingleton().register("afterCopy");var by="copyPaste",b1e=80,w1e=["fragmentSelection"],dD=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),iC=new WeakMap,aC=new WeakMap,lC=new WeakMap,Rl=new WeakMap,wy=new WeakMap,Sy=new WeakMap,El=new WeakMap,vD=new WeakSet,S1e=function(e){f1e(r,e);var t=c1e(r);function r(){var n;l1e(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),v1e(hr(n),vD),Ol(hr(n),"columnsLimit",1/0),Ol(hr(n),"rowsLimit",1/0),Ol(hr(n),"pasteMode","overwrite"),Ol(hr(n),"uiContainer",n.hot.rootDocument.body),Wi(hr(n),iC,{writable:!0,value:!1}),Wi(hr(n),aC,{writable:!0,value:!1}),Wi(hr(n),lC,{writable:!0,value:!1}),Wi(hr(n),Rl,{writable:!0,value:"cells-only"}),Wi(hr(n),wy,{writable:!0,value:!1}),Wi(hr(n),Sy,{writable:!0,value:!1}),Wi(hr(n),El,{writable:!0,value:new e1e({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),Ol(hr(n),"copyableRanges",[]),Ol(hr(n),"focusableElement",void 0),n}return s1e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[by]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i[by];if(Ua(a)==="object"){var l,s;this.pasteMode=(l=a.pasteMode)!==null&&l!==void 0?l:this.pasteMode,this.rowsLimit=isNaN(a.rowsLimit)?this.rowsLimit:a.rowsLimit,this.columnsLimit=isNaN(a.columnsLimit)?this.columnsLimit:a.columnsLimit,Kn(this,iC,!!a.copyColumnHeaders),Kn(this,aC,!!a.copyColumnGroupHeaders),Kn(this,lC,!!a.copyColumnHeadersOnly),this.uiContainer=(s=a.uiContainer)!==null&&s!==void 0?s:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(u){return o.onAfterContextMenuDefaultOptions(u)}),this.addHook("afterOnCellMouseUp",function(){return o.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return o.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return o.onBeforeKeyDown()}),this.focusableElement=z$e(this.uiContainer),this.focusableElement.addLocalHook("copy",function(u){return o.onCopy(u)}).addLocalHook("cut",function(u){return o.onCut(u)}).addLocalHook("paste",function(u){return o.onPaste(u)}),la(go(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),la(go(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&lD(this.focusableElement),la(go(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Kn(this,Rl,o),Kn(this,wy,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){Kn(this,Sy,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(o){return wc(this.getRangedData(o))}},{key:"getRangedData",value:function(o){var i=this,a=[],l=Y2(o),s=l.rows,u=l.columns;return I(s,function(f){var c=[];I(u,function(h){f<0?c.push(i.hot.getColHeader(h,f)):c.push(i.hot.getCopyableData(f,h))}),a.push(c)}),a}},{key:"paste",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o;if(!(!o&&!i)){var a=new F$e;o&&a.clipboardData.setData("text/plain",o),i&&a.clipboardData.setData("text/html",i),this.getOrCreateFocusableElement(),this.onPaste(a)}}},{key:"setCopyableText",value:function(){var o=this.hot.getSelectedRangeLast();if(o){$r(this,El).setSelectedRange(o);var i=new Map([["headers",null],["cells",null]]);$r(this,Rl)==="column-headers-only"?i.set("headers",$r(this,El).getMostBottomColumnHeadersRange()):($r(this,Rl)==="with-column-headers"?i.set("headers",$r(this,El).getMostBottomColumnHeadersRange()):$r(this,Rl)==="with-column-group-headers"&&i.set("headers",$r(this,El).getAllColumnHeadersRange()),i.set("cells",$r(this,El).getCellsRange())),this.copyableRanges=Array.from(i.values()).filter(function(c){return c!==null}).map(function(c){var h=c.startRow,d=c.startCol,v=c.endRow,g=c.endCol;return{startRow:h,startCol:d,endRow:v,endCol:g}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var a=i.get("cells");if(a!==null&&a.isRangeTrimmed){var l=a.startRow,s=a.startCol,u=a.endRow,f=a.endCol;this.hot.runHooks("afterCopyLimit",u-l+1,f-s+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var o,i=(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.TEXTAREA;i?this.focusableElement.setFocusableElement(i):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var o;return(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.isOpened()}},{key:"populateValues",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(o.length){for(var a=o.length,l=o[0].length,s=[],u=i.getTopStartCorner(),f=u.row,c=u.col,h=i.getBottomEndCorner(),d=h.row,v=h.col,g=f,p=c,w=f,S=c;s.length<a||g<=d;){var C=this.hot.getCellMeta(g,c),P=C.skipRowOnPaste,R=C.visualRow;if(g=R+1,P!==!0){w=R,p=c;for(var V=[],U=s.length%a;V.length<l||p<=v;){var X=this.hot.getCellMeta(f,p),Y=X.skipColumnOnPaste,q=X.visualCol;if(p=q+1,Y!==!0){S=q;var Z=V.length%l;V.push(o[U][Z])}}s.push(V)}}return this.hot.populateFromArray(f,c,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[f,c,w,S]}}},{key:"onCopy",value:function(o){if(!(!this.hot.isListening()&&!$r(this,wy)||this.isEditorOpened())){this.setCopyableText(),Kn(this,wy,!1);var i=this.getRangedData(this.copyableRanges),a=g1e(this,vD,C1e).call(this,this.copyableRanges),l=!!this.hot.runHooks("beforeCopy",i,this.copyableRanges,a);if(l){var s=wc(i);if(o&&o.clipboardData){var u=z1(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",s),o.clipboardData.setData("text/html",[dD,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.runHooks("afterCopy",i,this.copyableRanges,a)}Kn(this,Rl,"cells-only"),o.preventDefault()}}},{key:"onCut",value:function(o){if(!(!this.hot.isListening()&&!$r(this,Sy)||this.isEditorOpened())){this.setCopyableText(),Kn(this,Sy,!1);var i=this.getRangedData(this.copyableRanges),a=!!this.hot.runHooks("beforeCut",i,this.copyableRanges);if(a){var l=wc(i);if(o&&o.clipboardData){var s=z1(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",l),o.clipboardData.setData("text/html",[dD,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",i,this.copyableRanges)}o.preventDefault()}}},{key:"onPaste",value:function(o){if(!(!this.hot.isListening()||this.isEditorOpened())){o&&o.preventDefault&&o.preventDefault();var i;if(o&&typeof o.clipboardData<"u"){var a=oT(o.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(a&&/(<table)|(<TABLE)/g.test(a)){var l=dle(a,this.hot.rootDocument);i=l.data}else i=o.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(i=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof i=="string"&&(i=mwe(i)),!(i&&i.length===0)&&this.hot.runHooks("beforePaste",i,this.copyableRanges)!==!1){var s=this.populateValues(i),u=r1e(s,4),f=u[0],c=u[1],h=u[2],d=u[3];this.hot.selectCell(f,c,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",i,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:"---------"},E$e(this)),$r(this,iC)&&o.items.push(k$e(this)),$r(this,aC)&&o.items.push(P$e(this)),$r(this,lC)&&o.items.push(T$e(this)),o.items.push($$e(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&yie())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var o=this.hot.rootDocument.activeElement,i=this.hot.getActiveEditor();!i||o!==this.focusableElement.getFocusableElement()&&o!==i.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(lD(this.focusableElement),this.focusableElement=null),la(go(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return by}},{key:"SETTING_KEYS",get:function(){return[by].concat(w1e)}},{key:"PLUGIN_PRIORITY",get:function(){return b1e}}]),r}(ct);function C1e(e){for(var t=Y2(e),r=t.rows,n=0,o=0;o<r.length&&!(r[o]>=0);o++)n+=1;return{columnHeadersCount:n}}function X2(e,t){return"border_row".concat(e,"col").concat(t)}function uc(){return{width:1,color:"#000"}}function mo(){return{hide:!0}}function _1e(){return{width:1,color:"#000",cornerVisible:!1}}function sC(e){if(pe(e.start)||pe(e.left)){var t;e.start=(t=e.start)!==null&&t!==void 0?t:e.left}if(pe(e.end)||pe(e.right)){var r;e.end=(r=e.end)!==null&&r!==void 0?r:e.right}return delete e.left,delete e.right,e}function Kf(e){return pe(e.start)&&(e.left=e.start),pe(e.end)&&(e.right=e.end),e}function uC(e,t){return{id:X2(e,t),border:_1e(),row:e,col:t,top:mo(),bottom:mo(),start:mo(),end:mo()}}function O1e(e,t){return Dt(t,"border")&&t.border&&(e.border=t.border),Dt(t,"top")&&pe(t.top)&&(t.top?(Ye(t.top)||(t.top=uc()),e.top=t.top):(t.top=mo(),e.top=t.top)),Dt(t,"bottom")&&pe(t.bottom)&&(t.bottom?(Ye(t.bottom)||(t.bottom=uc()),e.bottom=t.bottom):(t.bottom=mo(),e.bottom=t.bottom)),Dt(t,"start")&&pe(t.start)&&(t.start?(Ye(t.start)||(t.start=uc()),e.start=t.start):(t.start=mo(),e.start=t.start)),Dt(t,"end")&&pe(t.end)&&(t.end?(Ye(t.end)||(t.end=uc()),e.end=t.end):(t.end=mo(),e.end=t.end)),e}function Lo(e,t){var r=!1;return I(e.getSelectedRange(),function(n){n.forAll(function(o,i){if(!(o<0||i<0)){var a=e.getCellMeta(o,i).borders;if(a)if(t){if(!Dt(a[t],"hide")||a[t].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function aw(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function R1e(e){return e.some(function(t){return pe(t.left)||pe(t.right)})}function E1e(e){return e.some(function(t){return pe(t.start)||pe(t.end)})}var T1e=new Map([["left","start"],["right","end"]]);function P1e(e){var t;return(t=T1e.get(e))!==null&&t!==void 0?t:e}function k1e(e){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase(sb),n=Lo(this,"bottom");return n&&(r=aw(r)),r},callback:function(r,n){var o=Lo(this,"bottom");e.prepareBorder(n,"bottom",o)}}}function $1e(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(ub),o=Lo(this,t);return o&&(n=aw(n)),n},callback:function(n,o){var i=Lo(this,t);e.prepareBorder(o,t,i)}}}function A1e(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(fb)},callback:function(r,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!Lo(this)}}}function I1e(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(lb),o=Lo(this,t);return o&&(n=aw(n)),n},callback:function(n,o){var i=Lo(this,t);e.prepareBorder(o,t,i)}}}function M1e(e){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(ab),n=Lo(this,"top");return n&&(r=aw(r)),r},callback:function(r,n){var o=Lo(this,"top");e.prepareBorder(n,"top",o)}}}function yu(e){"@babel/helpers - typeof";return yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yu(e)}function yD(e,t){return H1e(e)||N1e(e,t)||D1e(e,t)||x1e()}function x1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function D1e(e,t){if(e){if(typeof e=="string")return gD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gD(e,t)}}function gD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function N1e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function H1e(e){if(Array.isArray(e))return e}function L1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,J2(n.key),n)}}function j1e(e,t,r){return t&&mD(e.prototype,t),r&&mD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sa(){return typeof Reflect<"u"&&Reflect.get?sa=Reflect.get.bind():sa=function(t,r,n){var o=F1e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},sa.apply(this,arguments)}function F1e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=po(e),e!==null););return e}function B1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_R(e,t)}function _R(e,t){return _R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_R(e,t)}function V1e(e){var t=U1e();return function(){var n=po(e),o;if(t){var i=po(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return W1e(this,o)}}function W1e(e,t){if(t&&(yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Z2(e)}function Z2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function po(e){return po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},po(e)}function z1e(e,t,r){return t=J2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J2(e){var t=Y1e(e,"string");return yu(t)==="symbol"?t:String(t)}function Y1e(e,t){if(yu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cy="customBorders",G1e=90,K1e=function(e){B1e(r,e);var t=V1e(r);function r(){var n;L1e(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),z1e(Z2(n),"savedBorders",[]),n}return j1e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Cy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.onAfterContextMenuDefaultOptions(i)}),this.addHook("init",function(){return o.onAfterInit()}),sa(po(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),sa(po(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),sa(po(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(o,i){var a=this,l=["top","bottom","start","end"],s=null;i&&(this.checkSettingsCohesion([i]),l=Object.keys(i),s=sC(i));var u=js(o),f=Mh(u);I(o,function(c){for(var h=f(c),d=yD(h,4),v=d[0],g=d[1],p=d[2],w=d[3],S=function(R){for(var V=function(Y){I(l,function(q){a.prepareBorderFromCustomAdded(R,Y,s,P1e(q))})},U=g;U<=w;U+=1)V(U)},C=v;C<=p;C+=1)S(C)}),this.hot.view.render()}},{key:"getBorders",value:function(o){var i=this;if(!Array.isArray(o))return this.savedBorders;var a=js(o),l=Mh(a),s=[];return I(o,function(u){for(var f=l(u),c=yD(f,4),h=c[0],d=c[1],v=c[2],g=c[3],p=function(C){for(var P=function(U){I(i.savedBorders,function(X){X.row===C&&X.col===U&&s.push(Kf(X))})},R=d;R<=g;R+=1)P(R)},w=h;w<=v;w+=1)p(w)}),s}},{key:"clearBorders",value:function(o){var i=this;o?this.setBorders(o):(I(this.savedBorders,function(a){i.clearBordersFromSelectionSettings(a.id),i.clearNullCellRange(),i.hot.removeCellMeta(a.row,a.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(o,i){var a=this.checkSavedBorders(o);a||this.savedBorders.push(o);var l=this.hot._createCellRange(this.hot._createCellCoords(o.row,o.col)),s=this.checkCustomSelections(o,l,i);s||this.hot.selection.highlight.addCustomSelection({border:o,visualCellRange:l})}},{key:"prepareBorderFromCustomAdded",value:function(o,i,a,l){var s=this.hot.countRows(),u=this.hot.countCols();if(!(o>=s||i>=u)){var f=uC(o,i);a&&(f=O1e(f,a),I(this.hot.selection.highlight.customSelections,function(c){if(f.id===c.settings.id)return Object.assign(c.settings,a),f.id=c.settings.id,f.top=c.settings.top,f.bottom=c.settings.bottom,f.start=c.settings.start,f.end=c.settings.end,!1})),this.hot.setCellMeta(o,i,"borders",Kf(f)),this.insertBorderIntoSettings(f,l)}}},{key:"prepareBorderFromCustomAddedRange",value:function(o,i){var a=this,l=Math.min(o.to.row,this.hot.countRows()-1),s=Math.min(o.to.col,this.hot.countCols()-1);Re(o.from.row,l,function(u){Re(o.from.col,s,function(f){var c=uC(u,f),h=0;u===o.from.row&&Dt(i,"top")&&(h+=1,c.top=i.top),u===o.to.row&&Dt(i,"bottom")&&(h+=1,c.bottom=i.bottom),f===o.from.col&&Dt(i,"start")&&(h+=1,c.start=i.start),f===o.to.col&&Dt(i,"end")&&(h+=1,c.end=i.end),h>0&&(a.hot.setCellMeta(u,f,"borders",Kf(c)),a.insertBorderIntoSettings(c))})})}},{key:"removeAllBorders",value:function(o,i){var a=X2(o,i);this.spliceBorder(a),this.clearBordersFromSelectionSettings(a),this.clearNullCellRange(),this.hot.removeCellMeta(o,i,"borders")}},{key:"setBorder",value:function(o,i,a,l){var s=this.hot.getCellMeta(o,i).borders;if(!s||s.border===void 0?s=uC(o,i):s=sC(s),l){s[a]=mo();var u=this.countHide(s);if(u===4)this.removeAllBorders(o,i);else{var f=this.checkCustomSelectionsFromContextMenu(s,a,l);f||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",Kf(s))}}else{s[a]=uc();var c=this.checkCustomSelectionsFromContextMenu(s,a,l);c||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",Kf(s))}}},{key:"prepareBorder",value:function(o,i,a){var l=this;I(o,function(s){var u=s.start,f=s.end;if(u.row===f.row&&u.col===f.col)i==="noBorders"?l.removeAllBorders(u.row,u.col):l.setBorder(u.row,u.col,i,a);else switch(i){case"noBorders":Re(u.col,f.col,function(c){Re(u.row,f.row,function(h){l.removeAllBorders(h,c)})});break;case"top":Re(u.col,f.col,function(c){l.setBorder(u.row,c,i,a)});break;case"bottom":Re(u.col,f.col,function(c){l.setBorder(f.row,c,i,a)});break;case"start":Re(u.row,f.row,function(c){l.setBorder(c,u.col,i,a)});break;case"end":Re(u.row,f.row,function(c){l.setBorder(c,f.col,i,a)});break}})}},{key:"createCustomBorders",value:function(o){var i=this;I(o,function(a){var l=sC(a);a.range?i.prepareBorderFromCustomAddedRange(a.range,l):i.prepareBorderFromCustomAdded(a.row,a.col,l)})}},{key:"countHide",value:function(o){var i=o.top,a=o.bottom,l=o.start,s=o.end,u=[i,a,l,s];return ar(u,function(f,c){var h=f;return c&&c.hide&&(h+=1),h},0)}},{key:"clearBordersFromSelectionSettings",value:function(o){var i=ze(this.hot.selection.highlight.customSelections,function(a){return a.settings.id}).indexOf(o);i>-1&&this.hot.selection.highlight.customSelections[i].clear()}},{key:"clearNullCellRange",value:function(){var o=this;I(this.hot.selection.highlight.customSelections,function(i,a){if(i.cellRange===null)return o.hot.selection.highlight.customSelections[a].destroy(),o.hot.selection.highlight.customSelections.splice(a,1),!1})}},{key:"hideBorders",value:function(){var o=this;I(this.savedBorders,function(i){o.clearBordersFromSelectionSettings(i.id),o.clearNullCellRange()})}},{key:"spliceBorder",value:function(o){var i=ze(this.savedBorders,function(a){return a.id}).indexOf(o);i>-1&&this.savedBorders.splice(i,1)}},{key:"checkSavedBorders",value:function(o){var i=this,a=!1,l=this.countHide(o);return l===4?(this.spliceBorder(o.id),a=!0):I(this.savedBorders,function(s,u){if(o.id===s.id)return i.savedBorders[u]=o,a=!0,!1}),a}},{key:"checkCustomSelectionsFromContextMenu",value:function(o,i,a){var l=!1;return I(this.hot.selection.highlight.customSelections,function(s){if(o.id===s.settings.id)return Ge(s.instanceBorders,function(u){u.toggleHiddenClass(i,a)}),l=!0,!1}),l}},{key:"checkCustomSelections",value:function(o,i,a){var l=this.countHide(o),s=!1;return l===4?(this.removeAllBorders(o.row,o.col),s=!0):I(this.hot.selection.highlight.customSelections,function(u){if(o.id===u.settings.id)return u.visualCellRange=i,u.commit(),a&&Ge(u.instanceBorders,function(f){f.changeBorderStyle(a,o)}),s=!0,!1}),s}},{key:"changeBorderSettings",value:function(){var o=this.hot.getSettings()[Cy];if(Array.isArray(o)){var i=yr(o);this.checkSettingsCohesion(i),i.length||(this.savedBorders=i),this.createCustomBorders(i)}else o!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(o){var i=R1e(o),a=E1e(o);if(i&&a)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&i)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(o){this.hot.getSettings()[Cy]&&o.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(ib)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[M1e(this),I1e(this),k1e(this),$1e(this),A1e(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){sa(po(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Cy}},{key:"PLUGIN_PRIORITY",get:function(){return G1e}}]),r}(ct);function gu(e){"@babel/helpers - typeof";return gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gu(e)}function q1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Z1e(n.key),n)}}function X1e(e,t,r){return t&&pD(e.prototype,t),r&&pD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Z1e(e){var t=J1e(e,"string");return gu(t)==="symbol"?t:String(t)}function J1e(e,t){if(gu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ua(){return typeof Reflect<"u"&&Reflect.get?ua=Reflect.get.bind():ua=function(t,r,n){var o=Q1e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ua.apply(this,arguments)}function Q1e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bo(e),e!==null););return e}function eAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OR(e,t)}function OR(e,t){return OR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},OR(e,t)}function tAe(e){var t=nAe();return function(){var n=bo(e),o;if(t){var i=bo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return rAe(this,o)}}function rAe(e,t){if(t&&(gu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Q2(e)}function Q2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bo(e){return bo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bo(e)}var bD="dragToScroll",oAe=100,iAe=function(e){eAe(r,e);var t=tAe(r);function r(n){var o;return q1e(this,r),o=t.call(this,n),o.eventManager=new It(Q2(o)),o.boundaries=null,o.callback=null,o.listening=!1,o}return X1e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[bD]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(i){return o.setupListening(i)}),this.addHook("afterOnCellCornerMouseDown",function(i){return o.setupListening(i)}),this.registerEvents(),ua(bo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ua(bo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),ua(bo(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(o){this.boundaries=o}},{key:"setCallback",value:function(o){this.callback=o}},{key:"check",value:function(o,i){var a=0,l=0;i<this.boundaries.top?l=i-this.boundaries.top:i>this.boundaries.bottom&&(l=i-this.boundaries.bottom),o<this.boundaries.left?a=o-this.boundaries.left:o>this.boundaries.right&&(a=o-this.boundaries.right),this.callback(a,l)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var o=this,i=this.hot.rootWindow,a=i;a;)this.eventManager.addEventListener(a.document,"contextmenu",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mouseup",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mousemove",function(l){return o.onMouseMove(l)}),a=Bg(a)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(o){if(!xa(o)){var i=this.hot.view._wt.wtTable.holder;i!==this.hot.rootWindow&&(this.setBoundaries(i.getBoundingClientRect()),this.setCallback(function(a,l){a<0?i.scrollLeft-=50:a>0&&(i.scrollLeft+=50),l<0?i.scrollTop-=20:l>0&&(i.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(o){this.isListening()&&this.check(o.clientX,o.clientY)}},{key:"destroy",value:function(){ua(bo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return bD}},{key:"PLUGIN_PRIORITY",get:function(){return oAe}}]),r}(ct);function mu(e){"@babel/helpers - typeof";return mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mu(e)}function aAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sAe(n.key),n)}}function lAe(e,t,r){return t&&wD(e.prototype,t),r&&wD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sAe(e){var t=uAe(e,"string");return mu(t)==="symbol"?t:String(t)}function uAe(e,t){if(mu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fa(){return typeof Reflect<"u"&&Reflect.get?fa=Reflect.get.bind():fa=function(t,r,n){var o=fAe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},fa.apply(this,arguments)}function fAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wo(e),e!==null););return e}function cAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RR(e,t)}function RR(e,t){return RR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},RR(e,t)}function hAe(e){var t=vAe();return function(){var n=wo(e),o;if(t){var i=wo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return dAe(this,o)}}function dAe(e,t){if(t&&(mu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eU(e)}function eU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wo(e){return wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wo(e)}be.getSingleton().register("afterDropdownMenuDefaultOptions");be.getSingleton().register("beforeDropdownMenuShow");be.getSingleton().register("afterDropdownMenuShow");be.getSingleton().register("afterDropdownMenuHide");be.getSingleton().register("afterDropdownMenuExecute");var fC="dropdownMenu",yAe=230,cC="changeType",tU=function(e){cAe(r,e);var t=hAe(r);function r(n){var o;return aAe(this,r),o=t.call(this,n),o.eventManager=new It(eU(o)),o.commandExecutor=new N2(o.hot),o.itemsFactory=null,o.menu=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return lAe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[fC]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.itemsFactory=new L2(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[fC],a={items:this.itemsFactory.getItems(i)};this.registerEvents(),typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),fa(wo(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){o.hot.runHooks("afterDropdownMenuDefaultOptions",a),o.itemsFactory.setPredefinedItems(a.items);var l=o.itemsFactory.getItems(i);o.menu&&o.menu.destroy(),o.menu=new JT(o.hot,{className:"htDropdownMenu",keepInViewport:!0,container:i.uiContainer||o.hot.rootDocument.body}),o.hot.runHooks("beforeDropdownMenuSetItems",l),o.menu.setMenuItems(l),o.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),o.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),o.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),o.menu.addLocalHook("executeCommand",function(){for(var s,u=arguments.length,f=new Array(u),c=0;c<u;c++)f[c]=arguments[c];return(s=o.executeCommand).call.apply(s,[o].concat(f))}),I(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),fa(wo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),fa(wo(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(i){return o.onTableClick(i)})}},{key:"open",value:function(o){this.menu&&(this.menu.open(),o.width&&this.menu.setOffset("left",o.width),this.menu.setPosition(o))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"setListening",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(o?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(o){if(o.stopPropagation(),De(o.target,cC)&&!this.menu.isOpened()){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,f=s.left;i=u,a=f}var c=o.target.getBoundingClientRect();this.open({left:c.left+a,top:c.top+o.target.offsetHeight+3+i,width:c.width,height:c.height})}}},{key:"onAfterGetColHeader",value:function(o,i){var a=i.parentNode;if(a){var l=a.parentNode.childNodes,s=Array.prototype.indexOf.call(l,a);if(!(o<0||s!==l.length-1)){var u=i.querySelector(".".concat(cC));if(!(this.enabled&&u)){if(!this.enabled){u&&u.parentNode.removeChild(u);return}var f=this.hot.rootDocument.createElement("button");f.className=cC,f.type="button",f.onclick=function(){return!1},i.firstChild.insertBefore(f,i.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),fa(wo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return fC}},{key:"PLUGIN_PRIORITY",get:function(){return yAe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[_v,Ov,Ue,Ev,Ue,ew,Ue,Rv,Ue,zr]}}]),r}(ct);tU.SEPARATOR={name:Ue};function ad(e){"@babel/helpers - typeof";return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ad(e)}function gAe(e,t){return wAe(e)||bAe(e,t)||pAe(e,t)||mAe()}function mAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pAe(e,t){if(e){if(typeof e=="string")return SD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SD(e,t)}}function SD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function wAe(e){if(Array.isArray(e))return e}function SAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Ae(n.key),n)}}function CAe(e,t,r){return t&&CD(e.prototype,t),r&&CD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Ae(e){var t=OAe(e,"string");return ad(t)==="symbol"?t:String(t)}function OAe(e,t){if(ad(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RAe=function(){function e(t){SAe(this,e),this.hot=t,this.options={}}return CAe(e,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),o=n.startRow,i=n.startCol,a=n.endRow,l=n.endCol,s=this.options,u=[];return Re(o,a,function(f){var c=[];!s.exportHiddenRows&&r._isHiddenRow(f)||(Re(i,l,function(h){!s.exportHiddenColumns&&r._isHiddenColumn(h)||c.push(r.hot.getDataAtCell(f,h))}),u.push(c))}),u}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var o=this._getDataRange(),i=o.startRow,a=o.endRow,l=this.hot.getRowHeader();Re(i,a,function(s){!r.options.exportHiddenRows&&r._isHiddenRow(s)||n.push(l[s])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var o=this._getDataRange(),i=o.startCol,a=o.endCol,l=this.hot.getColHeader();Re(i,a,function(s){!r.options.exportHiddenColumns&&r._isHiddenColumn(s)||n.push(l[s])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,o=gAe(this.options.range,4),i=o[0],a=i===void 0?0:i,l=o[1],s=l===void 0?0:l,u=o[2],f=u===void 0?n:u,c=o[3],h=c===void 0?r:c;return a=Math.max(a,0),s=Math.max(s,0),f=Math.min(f,n),h=Math.min(h,r),{startRow:a,startCol:s,endRow:f,endCol:h}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),e}();const EAe=RAe;function ld(e){"@babel/helpers - typeof";return ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ld(e)}function TAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kAe(n.key),n)}}function PAe(e,t,r){return t&&_D(e.prototype,t),r&&_D(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kAe(e){var t=$Ae(e,"string");return ld(t)==="symbol"?t:String(t)}function $Ae(e,t){if(ld(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ld(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AAe=function(){function e(t,r){TAe(this,e),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return PAe(e,[{key:"_mergeOptions",value:function(r){var n=Rr(this.constructor.DEFAULT_OPTIONS),o=new Date;return n=Yt(Rr(e.DEFAULT_OPTIONS),n),n=Yt(n,r),n.filename=LB(n.filename,{YYYY:o.getFullYear(),MM:"".concat(o.getMonth()+1).padStart(2,"0"),DD:"".concat(o.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}();const IAe=AAe;function pu(e){"@babel/helpers - typeof";return pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pu(e)}function MAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DAe(n.key),n)}}function xAe(e,t,r){return t&&OD(e.prototype,t),r&&OD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DAe(e){var t=NAe(e,"string");return pu(t)==="symbol"?t:String(t)}function NAe(e,t){if(pu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ER(e,t)}function ER(e,t){return ER=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ER(e,t)}function LAe(e){var t=BAe();return function(){var n=$m(e),o;if(t){var i=$m(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return jAe(this,o)}}function jAe(e,t){if(t&&(pu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FAe(e)}function FAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $m(e){return $m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$m(e)}var VAe=String.fromCharCode(13),WAe=String.fromCharCode(34),UAe=String.fromCharCode(10),zAe=function(e){HAe(r,e);var t=LAe(r);function r(){return MAe(this,r),t.apply(this,arguments)}return xAe(r,[{key:"export",value:function(){var o=this,i=this.options,a=this.dataProvider.getData(),l=this.dataProvider.getColumnHeaders(),s=l.length>0,u=this.dataProvider.getRowHeaders(),f=u.length>0,c=i.bom?String.fromCharCode(65279):"";return s&&(l=ze(l,function(h){return o._escapeCell(h,!0)}),f&&(c+=i.columnDelimiter),c+=l.join(i.columnDelimiter),c+=i.rowDelimiter),I(a,function(h,d){d>0&&(c+=i.rowDelimiter),f&&(c+=o._escapeCell(u[d])+i.columnDelimiter),c+=h.map(function(v){return o._escapeCell(v)}).join(i.columnDelimiter)}),c}},{key:"_escapeCell",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=Bt(o);return a!==""&&(i||a.indexOf(VAe)>=0||a.indexOf(WAe)>=0||a.indexOf(UAe)>=0||a.indexOf(this.options.columnDelimiter)>=0)&&(a=a.replace(new RegExp('"',"g"),'""'),a='"'.concat(a,'"')),a}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(IAe);const YAe=zAe;function sd(e){"@babel/helpers - typeof";return sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sd(e)}function GAe(e,t,r){return t=KAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KAe(e){var t=qAe(e,"string");return sd(t)==="symbol"?t:String(t)}function qAe(e,t){if(sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XAe="csv",TR=GAe({},XAe,YAe);function ZAe(e,t,r){return typeof TR[e]=="function"?new TR[e](t,r):null}function bu(e){"@babel/helpers - typeof";return bu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bu(e)}function JAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eIe(n.key),n)}}function QAe(e,t,r){return t&&RD(e.prototype,t),r&&RD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eIe(e){var t=tIe(e,"string");return bu(t)==="symbol"?t:String(t)}function tIe(e,t){if(bu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PR(e,t)}function PR(e,t){return PR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},PR(e,t)}function nIe(e){var t=aIe();return function(){var n=Am(e),o;if(t){var i=Am(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return oIe(this,o)}}function oIe(e,t){if(t&&(bu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iIe(e)}function iIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Am(e){return Am=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Am(e)}var lIe="exportFile",sIe=240,uIe=function(e){rIe(r,e);var t=nIe(r);function r(){return JAe(this,r),t.apply(this,arguments)}return QAe(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(o,i).export()}},{key:"exportAsBlob",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(o,i))}},{key:"downloadFile",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.hot,l=a.rootDocument,s=a.rootWindow,u=this._createTypeFormatter(o,i),f=this._createBlob(u),c=s.URL||s.webkitURL,h=l.createElement("a"),d="".concat(u.options.filename,".").concat(u.options.fileExtension);if(h.download!==void 0){var v=c.createObjectURL(f);h.style.display="none",h.setAttribute("href",v),h.setAttribute("download",d),l.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),l.body.removeChild(h),setTimeout(function(){c.revokeObjectURL(v)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(f,d)}},{key:"_createTypeFormatter",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!TR[o])throw new Error('Export format type "'.concat(o,'" is not supported.'));return ZAe(o,new EAe(this.hot),i)}},{key:"_createBlob",value:function(o){var i=null;return typeof Blob<"u"&&(i=new Blob([o.export()],{type:"".concat(o.options.mimeType,";charset=").concat(o.options.encoding)})),i}}],[{key:"PLUGIN_KEY",get:function(){return lIe}},{key:"PLUGIN_PRIORITY",get:function(){return sIe}}]),r}(ct);function ud(e){"@babel/helpers - typeof";return ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ud(e)}function fIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ED(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hIe(n.key),n)}}function cIe(e,t,r){return t&&ED(e.prototype,t),r&&ED(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hIe(e){var t=dIe(e,"string");return ud(t)==="symbol"?t:String(t)}function dIe(e,t){if(ud(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ud(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rU=function(){function e(t,r){var n=r.id,o=r.stateless,i=o===void 0?!0:o;fIe(this,e),this.hot=t,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Tp)}return cIe(e,[{key:"reset",value:function(){I(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),I(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),e}();bt(rU,Pr);const lw=rU;var fd={};function _i(e,t){if(!fd[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var r=fd[e],n=r.condition,o=r.descriptor,i=t;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(a){return n.apply(a.meta.instance,[].concat([a],[i]))}}function ca(e){if(!fd[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return fd[e].descriptor}function Ut(e,t,r){r.key=e,fd[e]={condition:t,descriptor:r}}var Jt="none";function vIe(){return!0}Ut(Jt,vIe,{name:pv,inputsCount:0,showOperators:!1});var Oc="empty";function yIe(e){return qt(e.value)}Ut(Oc,yIe,{name:mb,inputsCount:0,showOperators:!0});var vg="not_empty";function gIe(e,t){return!_i(Oc,t)(e)}Ut(vg,gIe,{name:pb,inputsCount:0,showOperators:!0});function mIe(e,t){return SIe(e)||wIe(e,t)||bIe(e,t)||pIe()}function pIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bIe(e,t){if(e){if(typeof e=="string")return TD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TD(e,t)}}function TD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function SIe(e){if(Array.isArray(e))return e}var Rc="eq";function CIe(e,t){var r=mIe(t,1),n=r[0];return Bt(e.value).toLocaleLowerCase(e.meta.locale)===Bt(n)}Ut(Rc,CIe,{name:bb,inputsCount:1,showOperators:!0});var yg="neq";function _Ie(e,t){return!_i(Rc,t)(e)}Ut(yg,_Ie,{name:wb,inputsCount:1,showOperators:!0});function OIe(e,t){return PIe(e)||TIe(e,t)||EIe(e,t)||RIe()}function RIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EIe(e,t){if(e){if(typeof e=="string")return PD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PD(e,t)}}function PD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function TIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function PIe(e){if(Array.isArray(e))return e}var nU="gt";function kIe(e,t){var r=OIe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>o}Ut(nU,kIe,{name:Rb,inputsCount:1,showOperators:!0});function $Ie(e,t){return xIe(e)||MIe(e,t)||IIe(e,t)||AIe()}function AIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IIe(e,t){if(e){if(typeof e=="string")return kD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kD(e,t)}}function kD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function MIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function xIe(e){if(Array.isArray(e))return e}var oU="gte";function DIe(e,t){var r=$Ie(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>=o}Ut(oU,DIe,{name:Eb,inputsCount:1,showOperators:!0});function NIe(e,t){return FIe(e)||jIe(e,t)||LIe(e,t)||HIe()}function HIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LIe(e,t){if(e){if(typeof e=="string")return $D(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $D(e,t)}}function $D(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function FIe(e){if(Array.isArray(e))return e}var iU="lt";function BIe(e,t){var r=NIe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<o}Ut(iU,BIe,{name:Tb,inputsCount:1,showOperators:!0});function VIe(e,t){return YIe(e)||zIe(e,t)||UIe(e,t)||WIe()}function WIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UIe(e,t){if(e){if(typeof e=="string")return AD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AD(e,t)}}function AD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function YIe(e){if(Array.isArray(e))return e}var aU="lte";function GIe(e,t){var r=VIe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<=o}Ut(aU,GIe,{name:Pb,inputsCount:1,showOperators:!0});function KIe(e,t){return JIe(e)||ZIe(e,t)||XIe(e,t)||qIe()}function qIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XIe(e,t){if(e){if(typeof e=="string")return ID(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ID(e,t)}}function ID(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ZIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function JIe(e){if(Array.isArray(e))return e}var eP="date_after";function QIe(e,t){var r=KIe(t,1),n=r[0],o=te(e.value,e.meta.dateFormat),i=te(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)>=0}Ut(eP,QIe,{name:Ab,inputsCount:1,showOperators:!0});function eMe(e,t){return oMe(e)||nMe(e,t)||rMe(e,t)||tMe()}function tMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rMe(e,t){if(e){if(typeof e=="string")return MD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MD(e,t)}}function MD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function oMe(e){if(Array.isArray(e))return e}var tP="date_before";function iMe(e,t){var r=eMe(t,1),n=r[0],o=te(e.value,e.meta.dateFormat),i=te(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)<=0}Ut(tP,iMe,{name:Ib,inputsCount:1,showOperators:!0});function aMe(e,t){return fMe(e)||uMe(e,t)||sMe(e,t)||lMe()}function lMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sMe(e,t){if(e){if(typeof e=="string")return xD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xD(e,t)}}function xD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function uMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function fMe(e){if(Array.isArray(e))return e}var Im="between";function cMe(e,t){var r=aMe(t,2),n=r[0],o=r[1],i=n,a=o;if(e.meta.type==="numeric"){var l=parseFloat(i,10),s=parseFloat(a,10);i=Math.min(l,s),a=Math.max(l,s)}else if(e.meta.type==="date"){var u=_i(tP,[a]),f=_i(eP,[i]);return u(e)&&f(e)}return e.value>=i&&e.value<=a}Ut(Im,cMe,{name:kb,inputsCount:2,showOperators:!0});var lU="not_between";function hMe(e,t){return!_i(Im,t)(e)}Ut(lU,hMe,{name:$b,inputsCount:2,showOperators:!0});function dMe(e,t){return mMe(e)||gMe(e,t)||yMe(e,t)||vMe()}function vMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yMe(e,t){if(e){if(typeof e=="string")return DD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DD(e,t)}}function DD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function mMe(e){if(Array.isArray(e))return e}var sU="begins_with";function pMe(e,t){var r=dMe(t,1),n=r[0];return Bt(e.value).toLocaleLowerCase(e.meta.locale).startsWith(Bt(n))}Ut(sU,pMe,{name:Sb,inputsCount:1,showOperators:!0});var bMe=Me,wMe=Kd,SMe=jn.f,CMe=Xa,ND=Wt,_Me=k0,OMe=Er,RMe=$0,EMe=wMe("".slice),TMe=Math.min,uU=RMe("endsWith"),PMe=!uU&&!!function(){var e=SMe(String.prototype,"endsWith");return e&&!e.writable}();bMe({target:"String",proto:!0,forced:!PMe&&!uU},{endsWith:function(t){var r=ND(OMe(this));_Me(t);var n=arguments.length>1?arguments[1]:void 0,o=r.length,i=n===void 0?o:TMe(CMe(n),o),a=ND(t);return EMe(r,i-a.length,i)===a}});function kMe(e,t){return MMe(e)||IMe(e,t)||AMe(e,t)||$Me()}function $Me(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AMe(e,t){if(e){if(typeof e=="string")return HD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HD(e,t)}}function HD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function IMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function MMe(e){if(Array.isArray(e))return e}var fU="ends_with";function xMe(e,t){var r=kMe(t,1),n=r[0];return Bt(e.value).toLocaleLowerCase(e.meta.locale).endsWith(Bt(n))}Ut(fU,xMe,{name:Cb,inputsCount:1,showOperators:!0});function DMe(e,t){return jMe(e)||LMe(e,t)||HMe(e,t)||NMe()}function NMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HMe(e,t){if(e){if(typeof e=="string")return LD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LD(e,t)}}function LD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function LMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function jMe(e){if(Array.isArray(e))return e}var rP="contains";function FMe(e,t){var r=DMe(t,1),n=r[0];return Bt(e.value).toLocaleLowerCase(e.meta.locale).indexOf(Bt(n))>=0}Ut(rP,FMe,{name:_b,inputsCount:1,showOperators:!0});var cU="not_contains";function BMe(e,t){return!_i(rP,t)(e)}Ut(cU,BMe,{name:Ob,inputsCount:1,showOperators:!0});var hU="date_tomorrow";function VMe(e){var t=te(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(te().subtract(-1,"days").startOf("day"),"d"):!1}Ut(hU,VMe,{name:xb,inputsCount:0});var dU="date_today";function WMe(e){var t=te(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(te().startOf("day"),"d"):!1}Ut(dU,WMe,{name:Mb,inputsCount:0});var vU="date_yesterday";function UMe(e){var t=te(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(te().subtract(1,"days").startOf("day"),"d"):!1}Ut(vU,UMe,{name:Db,inputsCount:0});vQ();function zMe(e,t){var r=e;return r===""&&(r="(".concat(t,")")),r}var kR=new Set([1]).has(1),YMe=kR&&typeof Array.from=="function";function Tv(e){var t=e;return kR&&(t=new Set(t)),function(r){var n;return kR?n=t.has(r):n=!!~t.indexOf(r),n}}function yU(e){return e??""}function $R(e){var t=e;return YMe?t=Array.from(new Set(t)):t=LF(t),t=t.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),t}function jD(e,t,r,n){var o=[],i=e===t,a;return i||(a=Tv(t)),I(e,function(l){var s=!1;(i||a(l))&&(s=!0);var u={checked:s,value:l,visualValue:zMe(l,r)};n&&n(u),o.push(u)}),o}function gU(e,t){return XMe(e)||qMe(e,t)||KMe(e,t)||GMe()}function GMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KMe(e,t){if(e){if(typeof e=="string")return FD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FD(e,t)}}function FD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function XMe(e){if(Array.isArray(e))return e}var ha="by_value";function ZMe(e,t){var r=gU(t,1),n=r[0];return n(e.value)}Ut(ha,ZMe,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var r=gU(t,1),n=r[0];return[Tv(n)]},showOperators:!1});var cd={};function JMe(e){if(!cd[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=cd[e].func;return function(r,n){return t(r,n)}}function QMe(e){return cd[e].name}function nP(e,t,r){cd[e]={name:t,func:r}}var yi="conjunction",exe=Lb;function txe(e,t){return e.every(function(r){return r.func(t)})}nP(yi,exe,txe);var Mm="disjunction",rxe=bv;function nxe(e,t){return e.some(function(r){return r.func(t)})}nP(Mm,rxe,nxe);var oP="disjunctionWithExtraCondition",oxe=bv;function ixe(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(function(r){return r.func(t)})&&e[e.length-1].func(t)}nP(oP,oxe,ixe);function hd(e){"@babel/helpers - typeof";return hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hd(e)}var qf;function hC(e,t,r){return t=axe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function axe(e){var t=lxe(e,"string");return hd(t)==="symbol"?t:String(t)}function lxe(e,t){if(hd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sxe="numeric",mU="text",uxe="date",BD=(qf={},hC(qf,sxe,[Jt,Ue,Oc,vg,Ue,Rc,yg,Ue,nU,oU,iU,aU,Im,lU]),hC(qf,mU,[Jt,Ue,Oc,vg,Ue,Rc,yg,Ue,sU,fU,Ue,rP,cU]),hC(qf,uxe,[Jt,Ue,Oc,vg,Ue,Rc,yg,Ue,tP,eP,Im,Ue,hU,dU,vU]),qf);function fxe(e){var t=[],r=e;return BD[r]||(r=mU),I(BD[r],function(n){var o;n===Ue?o={name:Ue}:o=Rr(ca(n)),t.push(o)}),t}function dd(e){"@babel/helpers - typeof";return dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dd(e)}function cxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dxe(n.key),n)}}function hxe(e,t,r){return t&&VD(e.prototype,t),r&&VD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dxe(e){var t=vxe(e,"string");return dd(t)==="symbol"?t:String(t)}function vxe(e,t){if(dd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dC="built",vC="building",WD=["click","input","keydown","keypress","keyup","focus","blur","change"],pU=function(){function e(t,r){cxe(this,e),this.hot=t,this.eventManager=new It(this),this.options=Yt(e.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return hxe(e,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===vC?this._element:this.buildState===dC?(this.update(),this._element):(this.buildState=vC,this.build(),this.buildState=dC,this._element)}},{key:"isBuilt",value:function(){return this.buildState===dC}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(pr)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(a,l){r.eventManager.addEventListener(a,l,function(s){return r.runLocalHooks(l,s,r)})};if(this.buildState||(this.buildState=vC),this.options.className&&re(this._element,this.options.className),this.options.children.length)I(this.options.children,function(i){return r._element.appendChild(i.element)});else if(this.options.wrapIt){var o=this.hot.rootDocument.createElement(this.options.tagName);Ge(this.options,function(i,a){o[a]!==void 0&&a!=="className"&&a!=="tagName"&&a!=="children"&&(o[a]=r.translateIfPossible(i))}),this._element.appendChild(o),I(WD,function(i){return n(o,i)})}else I(WD,function(i){return n(r._element,i)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return Rr({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();bt(pU,Pr);const gi=pU;function wu(e){"@babel/helpers - typeof";return wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wu(e)}function yxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mxe(n.key),n)}}function gxe(e,t,r){return t&&UD(e.prototype,t),r&&UD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mxe(e){var t=pxe(e,"string");return wu(t)==="symbol"?t:String(t)}function pxe(e,t){if(wu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gg(){return typeof Reflect<"u"&&Reflect.get?gg=Reflect.get.bind():gg=function(t,r,n){var o=bxe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},gg.apply(this,arguments)}function bxe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Su(e),e!==null););return e}function wxe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AR(e,t)}function AR(e,t){return AR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},AR(e,t)}function Sxe(e){var t=_xe();return function(){var n=Su(e),o;if(t){var i=Su(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Cxe(this,o)}}function Cxe(e,t){if(t&&(wu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bU(e)}function bU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _xe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Su(e){return Su=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Su(e)}var _y=new WeakMap,Oxe=function(e){wxe(r,e);var t=Sxe(r);function r(n,o){var i;return yxe(this,r),i=t.call(this,n,Yt(r.DEFAULTS,o)),_y.set(bU(i),{}),i.registerHooks(),i}return gxe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()}),this.addLocalHook("keyup",function(i){return o.onKeyup(i)})}},{key:"build",value:function(){gg(Su(r.prototype),"build",this).call(this);var o=_y.get(this),i=this.hot.rootDocument.createElement("div");o.input=this._element.firstChild,re(this._element,"htUIInput"),re(i,"htUIInputIcon"),this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=_y.get(this).input;o.type=this.options.type,o.placeholder=this.translateIfPossible(this.options.placeholder),o.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&_y.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(o){this.options.value=o.target.value}}],[{key:"DEFAULTS",get:function(){return Rr({placeholder:"",type:"text",tagName:"input"})}}]),r}(gi);const Jl=Oxe;function Cu(e){"@babel/helpers - typeof";return Cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cu(e)}function Rxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Txe(n.key),n)}}function Exe(e,t,r){return t&&zD(e.prototype,t),r&&zD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Txe(e){var t=Pxe(e,"string");return Cu(t)==="symbol"?t:String(t)}function Pxe(e,t){if(Cu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ql(){return typeof Reflect<"u"&&Reflect.get?Ql=Reflect.get.bind():Ql=function(t,r,n){var o=kxe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ql.apply(this,arguments)}function kxe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mi(e),e!==null););return e}function $xe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IR(e,t)}function IR(e,t){return IR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},IR(e,t)}function Axe(e){var t=Mxe();return function(){var n=mi(e),o;if(t){var i=mi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ixe(this,o)}}function Ixe(e,t){if(t&&(Cu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wU(e)}function wU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mxe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mi(e){return mi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mi(e)}var Oy=new WeakMap,xxe=function(e){$xe(r,e);var t=Axe(r);function r(n,o){var i;return Rxe(this,r),i=t.call(this,n,Yt(r.DEFAULTS,o)),Oy.set(wU(i),{}),i.menu=null,i.items=[],i.registerHooks(),i}return Exe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()})}},{key:"setItems",value:function(o){this.items=this.translateNames(o),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(o){var i=this;return I(o,function(a){a.name=i.translateIfPossible(a.name)}),o}},{key:"build",value:function(){var o=this;Ql(mi(r.prototype),"build",this).call(this),this.menu=new JT(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var i=new gi(this.hot,{className:"htUISelectCaption"}),a=new gi(this.hot,{className:"htUISelectDropdown"}),l=Oy.get(this);l.caption=i,l.captionElement=i.element,l.dropdown=a,I([i,a],function(s){return o._element.appendChild(s.element)}),this.menu.addLocalHook("select",function(s){return o.onMenuSelect(s)}),this.menu.addLocalHook("afterClose",function(){return o.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o;this.options.value?o=this.options.value.name:o=this.menu.hot.getTranslatedPhrase(pv),Oy.get(this).captionElement.textContent=o,Ql(mi(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var o=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?o.left-5:o.left-31,top:o.top-1,width:o.width,height:o.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(o){o.name!==Ue&&(this.options.value=o,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var o=Oy.get(this),i=o.caption,a=o.dropdown;i&&i.destroy(),a&&a.destroy(),Ql(mi(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return Rr({className:"htUISelect",wrapIt:!1})}}]),r}(gi);const YD=xxe;function _u(e){"@babel/helpers - typeof";return _u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_u(e)}function Dxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hxe(n.key),n)}}function Nxe(e,t,r){return t&&GD(e.prototype,t),r&&GD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hxe(e){var t=Lxe(e,"string");return _u(t)==="symbol"?t:String(t)}function Lxe(e,t){if(_u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mg(){return typeof Reflect<"u"&&Reflect.get?mg=Reflect.get.bind():mg=function(t,r,n){var o=jxe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},mg.apply(this,arguments)}function jxe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ou(e),e!==null););return e}function Fxe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MR(e,t)}function MR(e,t){return MR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},MR(e,t)}function Bxe(e){var t=Uxe();return function(){var n=Ou(e),o;if(t){var i=Ou(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Vxe(this,o)}}function Vxe(e,t){if(t&&(_u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wxe(e)}function Wxe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Uxe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ou(e){return Ou=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ou(e)}var zxe=function(e){Fxe(r,e);var t=Bxe(r);function r(n,o){var i;return Dxe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.addSeparator=o.addSeparator,i.elements.push(new YD(i.hot,{menuContainer:o.menuContainer})),i.elements.push(new Jl(i.hot,{placeholder:Ub})),i.elements.push(new Jl(i.hot,{placeholder:zb})),i.registerHooks(),i}return Nxe(r,[{key:"registerHooks",value:function(){var o=this;this.getSelectElement().addLocalHook("select",function(i){return o.onConditionSelect(i)}),this.getSelectElement().addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),I(this.getInputElements(),function(i){i.addLocalHook("keydown",function(a){return o.onInputKeyDown(a)})})}},{key:"setState",value:function(o){var i=this;if(this.reset(),!!o){var a=Rr(o.command);a.name.startsWith(Mt)&&(a.name=this.hot.getTranslatedPhrase(a.name)),this.getSelectElement().setValue(a),I(o.args,function(l,s){if(s>a.inputsCount-1)return!1;var u=i.getInputElement(s);u.setValue(l),u[a.inputsCount>s?"show":"hide"](),s||setTimeout(function(){return u.focus()},10)})}}},{key:"getState",value:function(){var o=this.getSelectElement().getValue()||ca(Jt),i=[];return I(this.getInputElements(),function(a,l){o.inputsCount>l&&i.push(a.getValue())}),{command:o,args:i}}},{key:"updateState",value:function(o,i){var a=ca(o?o.name:Jt);this.state.setValueAtIndex(i,{command:a,args:o?o.args:[]}),o||I(this.getInputElements(),function(l){return l.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof YD})[0]}},{key:"getInputElement",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[o]}},{key:"getInputElements",value:function(){return this.elements.filter(function(o){return o instanceof Jl})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,f,c){re(l.parentNode,"htFiltersMenuCondition"),o.addSeparator&&re(l.parentNode,"border");var h=o.hot.rootDocument.createElement("div");return re(h,"htFiltersMenuLabel"),h.textContent=c,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||I(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn(),i=[ca(Jt)];if(o!==null){var a=o.visualIndex;i=fxe(this.hot.getDataType(0,a,this.hot.countRows(),a))}I(this.getInputElements(),function(l){return l.hide()}),this.getSelectElement().setItems(i),mg(Ou(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(i[0])}},{key:"onConditionSelect",value:function(o){I(this.getInputElements(),function(i,a){i[o.inputsCount>a?"show":"hide"](),a===0&&setTimeout(function(){return i.focus()},10)}),this.runLocalHooks("change",o)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(o){Hc(o.keyCode,"ENTER")?(this.runLocalHooks("accept"),Ln(o)):Hc(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ln(o))}}]),r}(lw);const yC=zxe;function Ru(e){"@babel/helpers - typeof";return Ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ru(e)}function Yxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kxe(n.key),n)}}function Gxe(e,t,r){return t&&KD(e.prototype,t),r&&KD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kxe(e){var t=qxe(e,"string");return Ru(t)==="symbol"?t:String(t)}function qxe(e,t){if(Ru(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ru(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pg(){return typeof Reflect<"u"&&Reflect.get?pg=Reflect.get.bind():pg=function(t,r,n){var o=Xxe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},pg.apply(this,arguments)}function Xxe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Eu(e),e!==null););return e}function Zxe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xR(e,t)}function xR(e,t){return xR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},xR(e,t)}function Jxe(e){var t=eDe();return function(){var n=Eu(e),o;if(t){var i=Eu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Qxe(this,o)}}function Qxe(e,t){if(t&&(Ru(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SU(e)}function SU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eu(e){return Eu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Eu(e)}var Ry=new WeakMap,tDe=function(e){Zxe(r,e);var t=Jxe(r);function r(n,o){var i;return Yxe(this,r),i=t.call(this,n,Yt(r.DEFAULTS,o)),Ry.set(SU(i),{}),i}return Gxe(r,[{key:"build",value:function(){pg(Eu(r.prototype),"build",this).call(this);var o=Ry.get(this);o.input=this._element.firstChild;var i=this.hot.rootDocument.createElement("label");i.textContent=this.translateIfPossible(this.options.label.textContent),i.htmlFor=this.translateIfPossible(this.options.label.htmlFor),o.label=i,this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=Ry.get(this);o.input.checked=this.options.checked,o.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=o,this.update()}},{key:"focus",value:function(){this.isBuilt()&&Ry.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return Rr({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(gi);const qD=tDe;function Tu(e){"@babel/helpers - typeof";return Tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tu(e)}var XD;function rDe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function nDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iDe(n.key),n)}}function oDe(e,t,r){return t&&ZD(e.prototype,t),r&&ZD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iDe(e){var t=aDe(e,"string");return Tu(t)==="symbol"?t:String(t)}function aDe(e,t){if(Tu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DR(e,t)}function DR(e,t){return DR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},DR(e,t)}function sDe(e){var t=cDe();return function(){var n=xm(e),o;if(t){var i=xm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return uDe(this,o)}}function uDe(e,t){if(t&&(Tu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fDe(e)}function fDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xm(e){return xm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xm(e)}var JD=0,hDe=function(e){lDe(r,e);var t=sDe(r);function r(n,o){var i;return nDe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.buildOperatorsElement(),i}return oDe(r,[{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return re(l.parentNode,"htFiltersMenuOperators"),l.parentNode.hasAttribute("ghost-table")||I(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"buildOperatorsElement",value:function(){var o=this,i=[yi,Mm];I(i,function(a){var l=new qD(o.hot,{name:"operator",label:{htmlFor:a,textContent:QMe(a)},value:a,checked:a===i[JD],id:a});l.addLocalHook("change",function(s){return o.onRadioInputChange(s)}),o.elements.push(l)})}},{key:"setChecked",value:function(o){if(this.elements.length<o)throw Error(ft(XD||(XD=rDe(["Radio button with index "," doesn't exist."])),o));I(this.elements,function(i,a){i.setChecked(a===o)})}},{key:"getActiveOperationId",value:function(){var o=this.elements.find(function(i){return i instanceof qD&&i.isChecked()});return o?o.getValue():yi}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(o){this.reset(),o&&this.getActiveOperationId()!==o&&I(this.elements,function(i){i.setChecked(i.getValue()===o)})}},{key:"updateState",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:yi,i=arguments.length>1?arguments[1]:void 0,a=o;a===oP&&(a=Mm),this.state.setValueAtIndex(i,a)}},{key:"reset",value:function(){this.setChecked(JD)}},{key:"onRadioInputChange",value:function(o){this.setState(o.target.value)}}]),r}(lw);const dDe=hDe;var vDe=Ve,yDe=Er,QD=Wt,gDe=/"/g,mDe=vDe("".replace),pDe=function(e,t,r,n){var o=QD(yDe(e)),i="<"+t;return r!==""&&(i+=" "+r+'="'+mDe(QD(n),gDe,"&quot;")+'"'),i+">"+o+"</"+t+">"},bDe=Fe,wDe=function(e){return bDe(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})},SDe=Me,CDe=pDe,_De=wDe;SDe({target:"String",proto:!0,forced:_De("link")},{link:function(t){return CDe(this,"a","href",t)}});function Pu(e){"@babel/helpers - typeof";return Pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pu(e)}function ODe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EDe(n.key),n)}}function RDe(e,t,r){return t&&eN(e.prototype,t),r&&eN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EDe(e){var t=TDe(e,"string");return Pu(t)==="symbol"?t:String(t)}function TDe(e,t){if(Pu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bg(){return typeof Reflect<"u"&&Reflect.get?bg=Reflect.get.bind():bg=function(t,r,n){var o=PDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},bg.apply(this,arguments)}function PDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ku(e),e!==null););return e}function kDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NR(e,t)}function NR(e,t){return NR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},NR(e,t)}function $De(e){var t=IDe();return function(){var n=ku(e),o;if(t){var i=ku(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ADe(this,o)}}function ADe(e,t){if(t&&(Pu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CU(e)}function CU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ku(e){return ku=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ku(e)}var gC=new WeakMap,MDe=function(e){kDe(r,e);var t=$De(r);function r(n,o){var i;return ODe(this,r),i=t.call(this,n,Yt(r.DEFAULTS,o)),gC.set(CU(i),{}),i}return RDe(r,[{key:"build",value:function(){bg(ku(r.prototype),"build",this).call(this);var o=gC.get(this);o.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(gC.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return Rr({href:"#",tagName:"a"})}}]),r}(gi);const tN=MDe;function $u(e){"@babel/helpers - typeof";return $u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$u(e)}function rN(e){return HDe(e)||NDe(e)||DDe(e)||xDe()}function xDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DDe(e,t){if(e){if(typeof e=="string")return HR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HR(e,t)}}function NDe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function HDe(e){if(Array.isArray(e))return HR(e)}function HR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function LDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FDe(n.key),n)}}function jDe(e,t,r){return t&&nN(e.prototype,t),r&&nN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FDe(e){var t=BDe(e,"string");return $u(t)==="symbol"?t:String(t)}function BDe(e,t){if($u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function es(){return typeof Reflect<"u"&&Reflect.get?es=Reflect.get.bind():es=function(t,r,n){var o=VDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},es.apply(this,arguments)}function VDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=pi(e),e!==null););return e}function WDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LR(e,t)}function LR(e,t){return LR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},LR(e,t)}function UDe(e){var t=YDe();return function(){var n=pi(e),o;if(t){var i=pi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return zDe(this,o)}}function zDe(e,t){if(t&&($u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _U(e)}function _U(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pi(e){return pi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pi(e)}var GDe=new WeakMap,KDe="multipleSelect.itemBox",qDe=function(e){WDe(r,e);var t=UDe(r);function r(n,o){var i;return LDe(this,r),i=t.call(this,n,Yt(r.DEFAULTS,o)),GDe.set(_U(i),{}),i.searchInput=new Jl(i.hot,{placeholder:Wb,className:"htUIMultipleSelectSearch"}),i.selectAllUI=new tN(i.hot,{textContent:jb,className:"htUISelectAll"}),i.clearAllUI=new tN(i.hot,{textContent:Fb,className:"htUIClearAll"}),i.items=[],i.itemsBox=null,i.registerHooks(),i}return jDe(r,[{key:"registerHooks",value:function(){var o=this;this.searchInput.addLocalHook("keydown",function(i){return o.onInputKeyDown(i)}),this.searchInput.addLocalHook("input",function(i){return o.onInput(i)}),this.selectAllUI.addLocalHook("click",function(i){return o.onSelectAllClick(i)}),this.clearAllUI.addLocalHook("click",function(i){return o.onClearAllClick(i)})}},{key:"setItems",value:function(o){this.items=o,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(o){this.locale=o}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return rN(this.items)}},{key:"getValue",value:function(){return ZDe(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var o=this;es(pi(r.prototype),"build",this).call(this);var i=this.hot.rootDocument,a=i.createElement("div"),l=new gi(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(l.element),this._element.appendChild(a);var s=function(f){if(o._element){o.itemsBox&&o.itemsBox.destroy(),re(f,"htUIMultipleSelectHot"),o.itemsBox=new o.hot.constructor(f,{data:o.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(v,g,p,w,S,C){v.title=C.instance.getDataAtRowProp(g,C.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return o.itemsBox.container.scrollWidth-er(i)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:o.hot.isRtl()?"rtl":"ltr"}),o.itemsBox.init();var c=o.itemsBox.getShortcutManager(),h=c.getContext("grid");h.addShortcut({keys:[["Escape"]],callback:function(v){o.runLocalHooks("keydown",v,o)},group:KDe})}};s(a),setTimeout(function(){return s(a)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(XDe(this.items,this.options.value)),es(pi(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,es(pi(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(o){var i=this,a=o.target.value.toLocaleLowerCase(this.getLocale()),l;a===""?l=rN(this.items):l=Kr(this.items,function(s){return"".concat(s.value).toLocaleLowerCase(i.getLocale()).indexOf(a)>=0}),this.itemsBox.loadData(l)}},{key:"onInputKeyDown",value:function(o){this.runLocalHooks("keydown",o,this);var i=WB(Hc,o.keyCode);i("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(Ln(o),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(o){var i=[];o.preventDefault(),I(this.itemsBox.getSourceData(),function(a,l){a.checked=!0,i.push(fI(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}},{key:"onClearAllClick",value:function(o){var i=[];o.preventDefault(),I(this.itemsBox.getSourceData(),function(a,l){a.checked=!1,i.push(fI(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}}],[{key:"DEFAULTS",get:function(){return Rr({className:"htUIMultipleSelect",value:[]})}}]),r}(gi);const oN=qDe;function XDe(e,t){var r=Tv(t);return ze(e,function(n){return n.checked=r(n.value),n})}function ZDe(e){var t=[];return I(e,function(r){r.checked&&t.push(r.value)}),t}function Au(e){"@babel/helpers - typeof";return Au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Au(e)}function JDe(e,t){return rNe(e)||tNe(e,t)||eNe(e,t)||QDe()}function QDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eNe(e,t){if(e){if(typeof e=="string")return iN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iN(e,t)}}function iN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tNe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function rNe(e){if(Array.isArray(e))return e}function nNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iNe(n.key),n)}}function oNe(e,t,r){return t&&aN(e.prototype,t),r&&aN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iNe(e){var t=aNe(e,"string");return Au(t)==="symbol"?t:String(t)}function aNe(e,t){if(Au(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Au(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wg(){return typeof Reflect<"u"&&Reflect.get?wg=Reflect.get.bind():wg=function(t,r,n){var o=lNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},wg.apply(this,arguments)}function lNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Iu(e),e!==null););return e}function sNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jR(e,t)}function jR(e,t){return jR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},jR(e,t)}function uNe(e){var t=hNe();return function(){var n=Iu(e),o;if(t){var i=Iu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fNe(this,o)}}function fNe(e,t){if(t&&(Au(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cNe(e)}function cNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Iu(e){return Iu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Iu(e)}var dNe=function(e){sNe(r,e);var t=uNe(r);function r(n,o){var i;return nNe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.elements.push(new oN(i.hot)),i.registerHooks(),i}return oNe(r,[{key:"registerHooks",value:function(){var o=this;this.getMultipleSelectElement().addLocalHook("keydown",function(i){return o.onInputKeyDown(i)})}},{key:"setState",value:function(o){if(this.reset(),o&&o.command.key===ha){var i=this.getMultipleSelectElement();i.setItems(o.itemsSnapshot),i.setValue(o.args[0]),i.setLocale(o.locale)}}},{key:"getState",value:function(){var o=this.getMultipleSelectElement(),i=o.getItems();return{command:{key:o.isSelectedAllValues()||!i.length?Jt:ha},args:[o.getValue()],itemsSnapshot:i}}},{key:"updateState",value:function(o){var i=this,a=function(s,u,f,c,h){var d=Kr(u,function(V){return V.name===ha}),v=JDe(d,1),g=v[0],p={},w=i.hot.getTranslatedPhrase(wh);if(g){var S=$R(ze(c(s,h),function(V){return V.value}));f&&(g.args[0]=f);var C=[],P=jD(S,g.args[0],w,function(V){V.checked&&C.push(V.value)}),R=o.editedConditionStack.column;p.locale=i.hot.getCellMeta(0,R).locale,p.args=[C],p.command=ca(ha),p.itemsSnapshot=P}else p.args=[],p.command=ca(Jt);i.state.setValueAtIndex(s,p)};a(o.editedConditionStack.column,o.editedConditionStack.conditions,o.conditionArgsChange,o.filteredRowsFactory),o.dependentConditionStacks.length&&a(o.dependentConditionStacks[0].column,o.dependentConditionStacks[0].conditions,o.conditionArgsChange,o.filteredRowsFactory,o.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof oN})[0]}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,f,c){re(l.parentNode,"htFiltersMenuValue");var h=o.hot.rootDocument.createElement("div");return re(h,"htFiltersMenuLabel"),h.textContent=c,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||I(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getTranslatedPhrase(wh),i=$R(this._getColumnVisibleValues()),a=jD(i,i,o);this.getMultipleSelectElement().setItems(a),wg(Iu(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(i);var l=this.hot.getPlugin("filters").getSelectedColumn();l!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,l.visualIndex).locale)}},{key:"onInputKeyDown",value:function(o){Hc(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ln(o))}},{key:"_getColumnVisibleValues",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn();return o===null?[]:ze(this.hot.getDataAtCol(o.visualIndex),function(i){return yU(i)})}}]),r}(lw);const vNe=dNe;function Mu(e){"@babel/helpers - typeof";return Mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mu(e)}function yNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mNe(n.key),n)}}function gNe(e,t,r){return t&&lN(e.prototype,t),r&&lN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mNe(e){var t=pNe(e,"string");return Mu(t)==="symbol"?t:String(t)}function pNe(e,t){if(Mu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FR(e,t)}function FR(e,t){return FR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},FR(e,t)}function wNe(e){var t=_Ne();return function(){var n=Dm(e),o;if(t){var i=Dm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return SNe(this,o)}}function SNe(e,t){if(t&&(Mu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CNe(e)}function CNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _Ne(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Dm(e){return Dm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Dm(e)}var ONe=function(e){bNe(r,e);var t=wNe(r);function r(n,o){var i;return yNe(this,r),i=t.call(this,n,{id:o.id,stateless:!0}),i.name=o.name,i.elements.push(new Jl(i.hot,{type:"button",value:Bb,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),i.elements.push(new Jl(i.hot,{type:"button",value:Vb,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),i.registerHooks(),i}return gNe(r,[{key:"registerHooks",value:function(){var o=this;I(this.elements,function(i){i.addLocalHook("click",function(a,l){return o.onButtonClick(a,l)})})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return re(l.parentNode,"htFiltersMenuActionBar"),l.parentNode.hasAttribute("ghost-table")||I(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(o,i){i.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(lw);const RNe=ONe;function vd(e){"@babel/helpers - typeof";return vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vd(e)}var sN,uN;function fN(e,t){return kNe(e)||PNe(e,t)||TNe(e,t)||ENe()}function ENe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TNe(e,t){if(e){if(typeof e=="string")return cN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cN(e,t)}}function cN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PNe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function kNe(e){if(Array.isArray(e))return e}function hN(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function $Ne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,INe(n.key),n)}}function ANe(e,t,r){return t&&dN(e.prototype,t),r&&dN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function INe(e){var t=MNe(e,"string");return vd(t)==="symbol"?t:String(t)}function MNe(e,t){if(vd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vN="ConditionCollection.filteringStates",OU=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;$Ne(this,e),this.hot=t,this.isMapRegistrable=r,this.filteringStates=new Tp,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(vN,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return ANe(e,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var o,i=this.filteringStates.getValueAtIndex(n),a=(o=i==null?void 0:i.conditions)!==null&&o!==void 0?o:[],l=i==null?void 0:i.operation;return this.isMatchInConditions(a,r,l)}},{key:"isMatchInConditions",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:yi;return r.length?JMe(o)(r,n):!0}},{key:"addCondition",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:yi,i=arguments.length>3?arguments[3]:void 0,a=this.hot.getCellMeta(0,r).locale,l=ze(n.args,function(c){return typeof c=="string"?c.toLocaleLowerCase(a):c}),s=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var u=this.getOperation(r);if(u){if(u!==o)throw Error(ft(sN||(sN=hN(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,u))}else if(pt(cd[o]))throw new Error(ft(uN||(uN=hN(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),o));var f=this.getConditions(r);f.length===0?this.filteringStates.setValueAtIndex(r,{operation:o,conditions:[{name:s,args:l,func:_i(s,l)}]},i):f.push({name:s,args:l,func:_i(s,l)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,o;return(n=(o=this.filteringStates.getValueAtIndex(r))===null||o===void 0?void 0:o.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=fN(r,1),o=n[0];return o})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return ar(this.filteringStates.getEntries(),function(r,n){var o=fN(n,2),i=o[0],a=o[1],l=a.operation,s=a.conditions;return r.push({column:i,operation:l,conditions:ze(s,function(u){var f=u.name,c=u.args;return{name:f,args:c}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),I(r,function(o){I(o.conditions,function(i){return n.addCondition(o.column,i)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var o=this.getConditions(r);return n?o.some(function(i){return i.name===n}):o.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(vN),this.filteringStates=null,this.clearLocalHooks()}}]),e}();bt(OU,Pr);const RU=OU;function yd(e){"@babel/helpers - typeof";return yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yd(e)}function xNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NNe(n.key),n)}}function DNe(e,t,r){return t&&yN(e.prototype,t),r&&yN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NNe(e){var t=HNe(e,"string");return yd(t)==="symbol"?t:String(t)}function HNe(e,t){if(yd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LNe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};xNe(this,e),this.conditionCollection=t,this.columnDataFactory=r}return DNe(e,[{key:"filter",value:function(){var r=this,n=[];return I(this.conditionCollection.getFilteredColumns(),function(o,i){var a=r.columnDataFactory(o);i&&(a=r._getIntersectData(a,n)),n=r.filterByColumn(o,a)}),n}},{key:"filterByColumn",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=[];return I(o,function(a){a!==void 0&&n.conditionCollection.isMatch(a,r)&&i.push(a)}),i}},{key:"_getIntersectData",value:function(r,n){var o=[];return I(n,function(i){var a=i.meta.visualRow;r[a]!==void 0&&(o[a]=r[a])}),o}}]),e}();const EU=LNe;function gd(e){"@babel/helpers - typeof";return gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gd(e)}function jNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BNe(n.key),n)}}function FNe(e,t,r){return t&&gN(e.prototype,t),r&&gN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function BNe(e){var t=VNe(e,"string");return gd(t)==="symbol"?t:String(t)}function VNe(e,t){if(gd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TU=function(){function e(t,r){var n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};jNe(this,e),this.hot=t,this.conditionCollection=r,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(i){return n._onConditionBeforeModify(i)}),this.conditionCollection.addLocalHook("afterRemove",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("afterAdd",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return FNe(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,I(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var o=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var i=this.conditionCollection.exportAllConditions(),a=this.conditionCollection.getColumnStackPosition(r);a===-1&&(a=this.latestEditedColumnPosition);var l=i.slice(0,a),s=i.slice(a);s.length&&s[0].column===r&&s.shift();var u=Sie(function(c,h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],v=new RU(o.hot,!1),g=[].concat(c,d);v.importAllConditions(g);var p=o.columnDataFactory(h),w;v.isEmpty()?w=p:w=new EU(v,function(C){return o.columnDataFactory(C)}).filter(),w=ze(w,function(C){return C.meta.visualRow});var S=Tv(w);return v.destroy(),Kr(p,function(C){return S(C.meta.visualRow)})})(l),f=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:f},dependentConditionStacks:s,filteredRowsFactory:u,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;I(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),Ge(this,function(n,o){r[o]=null})}}]),e}();bt(TU,Pr);const WNe=TU;function xu(e){"@babel/helpers - typeof";return xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xu(e)}var mN;function UNe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function zNe(e,t){return qNe(e)||KNe(e,t)||GNe(e,t)||YNe()}function YNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GNe(e,t){if(e){if(typeof e=="string")return pN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pN(e,t)}}function pN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function KNe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function qNe(e){if(Array.isArray(e))return e}function XNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JNe(n.key),n)}}function ZNe(e,t,r){return t&&bN(e.prototype,t),r&&bN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JNe(e){var t=QNe(e,"string");return xu(t)==="symbol"?t:String(t)}function QNe(e,t){if(xu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ts(){return typeof Reflect<"u"&&Reflect.get?ts=Reflect.get.bind():ts=function(t,r,n){var o=eHe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ts.apply(this,arguments)}function eHe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bi(e),e!==null););return e}function tHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BR(e,t)}function BR(e,t){return BR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},BR(e,t)}function rHe(e){var t=oHe();return function(){var n=bi(e),o;if(t){var i=bi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return nHe(this,o)}}function nHe(e,t){if(t&&(xu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PU(e)}function PU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bi(e){return bi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bi(e)}var wN="filters",iHe=250,aHe=function(e){tHe(r,e);var t=rHe(r);function r(n){var o;return XNe(this,r),o=t.call(this,n),o.eventManager=new It(PU(o)),o.dropdownMenuPlugin=null,o.conditionCollection=null,o.conditionUpdateObserver=null,o.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),o.filtersRowsMap=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return ZNe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[wN]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new mv),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var i=this.hot.getSettings().dropdownMenu,a=i&&i.uiContainer||this.hot.rootDocument.body,l=function(d){return d.addLocalHook("accept",function(){return o.onActionBarSubmit("accept")}),d.addLocalHook("cancel",function(){return o.onActionBarSubmit("cancel")}),d.addLocalHook("change",function(v){return o.onComponentChange(d,v)}),d},s=function(){return"".concat(o.hot.getTranslatedPhrase(Nb),":")},u=function(){return"".concat(o.hot.getTranslatedPhrase(Hb),":")};if(!this.components.get("filter_by_condition")){var f=new yC(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:a});f.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition",l(f))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new dDe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var c=new yC(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:a});c.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition2",l(c))}this.components.get("filter_by_value")||this.components.set("filter_by_value",l(new vNe(this.hot,{id:"filter_by_value",name:u}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",l(new RNe(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new RU(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new WNe(this.hot,this.conditionCollection,function(h){return o.getDataMapAtColumn(h)}),this.conditionUpdateObserver.addLocalHook("update",function(h){return o.updateComponents(h)})),this.components.forEach(function(h){return h.show()}),this.addHook("beforeDropdownMenuSetItems",function(h){return o.onBeforeDropdownMenuSetItems(h)}),this.addHook("afterDropdownMenuDefaultOptions",function(h){return o.onAfterDropdownMenuDefaultOptions(h)}),this.addHook("afterDropdownMenuShow",function(){return o.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return o.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(h){return o.onAfterChange(h)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),ts(bi(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;if(this.enabled){var i;(i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(a,l){a.destroy(),o.components.set(l,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}ts(bi(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(o,i,a){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:yi,s=this.hot.toPhysicalColumn(o);this.conditionCollection.addCondition(s,{command:{key:i},args:a},l)}},{key:"removeConditions",value:function(o){var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}},{key:"clearConditions",value:function(o){if(o===void 0)this.conditionCollection.clean();else{var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}}},{key:"filter",value:function(){var o=this,i=this._createDataFilter(),a=!this.conditionCollection.isEmpty(),l=[],s=this.conditionCollection.exportAllConditions(),u=this.hot.runHooks("beforeFilter",s);if(u!==!1)if(a){var f=[];this.hot.batchExecution(function(){o.filtersRowsMap.clear(),l=ze(i.filter(),function(h){return h.meta.visualRow});var c=Tv(l);Re(o.hot.countSourceRows()-1,function(h){c(h)||f.push(h)}),I(f,function(h){o.filtersRowsMap.setValueAtIndex(h,!0)})},!0),l.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var o,i=(o=this.hot.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight;return i?{visualIndex:i.col,physicalIndex:this.hot.toPhysicalColumn(i.col)}:null}},{key:"clearColumnSelection",value:function(){var o=this.getSelectedColumn();o!==null&&this.hot.selectCell(0,o.visualIndex)}},{key:"getDataMapAtColumn",value:function(o){var i=this,a=this.hot.toVisualColumn(o),l=[];return I(this.hot.getSourceDataAtCol(a),function(s,u){var f,c=i.hot.getCellMeta(u,a),h=c.row,d=c.col,v=c.visualCol,g=c.visualRow,p=c.type,w=c.instance,S=c.dateFormat,C=c.locale,P=(f=i.hot.getDataAtCell(i.hot.toVisualRow(u),a))!==null&&f!==void 0?f:s;l.push({meta:{row:h,col:d,visualCol:v,visualRow:g,type:p,instance:w,dateFormat:S,locale:C},value:yU(P)})}),l}},{key:"onAfterChange",value:function(o){var i=this;o&&I(o,function(a){var l=zNe(a,2),s=l[1],u=i.hot.propToCol(s);i.conditionCollection.hasConditions(u)&&i.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(o){var i=this.hot.getDataAtCol(o),a=$R(i);this.conditionUpdateObserver.updateStatesAtColumn(o,a)}},{key:"restoreComponents",value:function(o){var i,a=(i=this.getSelectedColumn())===null||i===void 0?void 0:i.physicalIndex;o.forEach(function(l){l.isHidden()||l.restoreState(a)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var o=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){o.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(o){o.items.push({name:Ue}),this.components.forEach(function(i){o.items.push(i.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(o,i,a,l){var s=o;return s===Mm&&i.command.key!==Jt&&a.command.key!==Jt&&l.command.key!==Jt?s=oP:l.command.key!==Jt&&(i.command.key===Jt||a.command.key===Jt)&&(s=yi),s}},{key:"onActionBarSubmit",value:function(o){var i;if(o==="accept"){var a=this.getSelectedColumn();if(a===null){var l;(l=this.dropdownMenuPlugin)===null||l===void 0||l.close();return}var s=a.physicalIndex,u=this.components.get("filter_by_condition").getState(),f=this.components.get("filter_by_condition2").getState(),c=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),u,f,c);this.conditionUpdateObserver.groupChanges();var d=this.conditionCollection.getColumnStackPosition(s);d===-1&&(d=void 0),this.conditionCollection.removeConditions(s),u.command.key!==Jt&&(this.conditionCollection.addCondition(s,u,h,d),f.command.key!==Jt&&this.conditionCollection.addCondition(s,f,h,d)),c.command.key!==Jt&&this.conditionCollection.addCondition(s,c,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(function(v){return v.saveState(s)}),this.filtersRowsMap.clear(),this.filter()}(i=this.dropdownMenuPlugin)===null||i===void 0||i.close()}},{key:"onComponentChange",value:function(o,i){this.updateDependentComponentsVisibility(),o.constructor===yC&&!i.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var o=this.components.get("filter_by_condition"),i=o.getState(),a=i.command,l=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];a.showOperators?this.showComponents.apply(this,l):this.hideComponents.apply(this,l)}},{key:"onAfterGetColHeader",value:function(o,i){var a=this.hot.toPhysicalColumn(o);this.enabled&&this.conditionCollection.hasConditions(a)?re(i,"htFiltersActive"):je(i,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new EU(i,function(a){return o.getDataMapAtColumn(a)})}},{key:"updateComponents",value:function(o){var i;if((i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled){var a=o.editedConditionStack,l=a.conditions,s=a.column,u=l.filter(function(h){return h.name===ha}),f=l.filter(function(h){return h.name!==ha});if(u.length>=2||f.length>=3)dt(ft(mN||(mN=UNe([`The filter conditions have been applied properly, but couldn’t be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldn’t be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var c=this.conditionCollection.getOperation(s);this.components.get("filter_by_condition").updateState(f[0],s),this.components.get("filter_by_condition2").updateState(f[1],s),this.components.get("filter_operators").updateState(c,s),this.components.get("filter_by_value").updateState(o)}}}},{key:"getIndexesOfComponents",value:function(){var o=[];if(!this.dropdownMenuPlugin)return o;for(var i=this.dropdownMenuPlugin.menu,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return I(l,function(u){I(i.menuItems,function(f,c){f.key===u.getMenuItemDescriptor().key&&o.push(c)})}),o}},{key:"changeComponentsVisibility",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.dropdownMenuPlugin){for(var i=this.dropdownMenuPlugin.menu,a=i.hotMenu,l=a.getPlugin("hiddenRows"),s=arguments.length,u=new Array(s>1?s-1:0),f=1;f<s;f++)u[f-1]=arguments[f];var c=this.getIndexesOfComponents.apply(this,u);o?l.showRows(c):l.hideRows(c),a.render()}}},{key:"hideComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!1].concat(i))}},{key:"showComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!0].concat(i))}},{key:"destroy",value:function(){var o=this;this.enabled&&(this.components.forEach(function(i,a){i!==null&&(i.destroy(),o.components.set(a,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),ts(bi(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return wN}},{key:"PLUGIN_PRIORITY",get:function(){return iHe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(ct);function md(e){"@babel/helpers - typeof";return md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},md(e)}function SN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Ec(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SN(Object(r),!0).forEach(function(n){lHe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lHe(e,t,r){return t=sHe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sHe(e){var t=uHe(e,"string");return md(t)==="symbol"?t:String(t)}function uHe(e,t){if(md(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kU="internal-use-in-handsontable",VR={licenseKey:kU,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function $U(e){var t,r;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[nr])===null||t===void 0||(r=t.language)===null||r===void 0?void 0:r.langCode}}function AU(e){return Object.keys(e).reduce(function(t,r){return r!=="hyperformula"&&(t[r]=e[r]),t},{})}function fHe(e){var t,r=e[nr],n=AU(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=$U(e);return Ec(Ec(Ec({},VR),n),o)}function cHe(e){var t,r=e[nr],n=AU(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=$U(e);return Ec(Ec({},n),o)}function hHe(e,t){return Object.keys(t).some(function(r){return t[r]!==void 0&&t[r]!==e[r]})}var CN;function dHe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function WR(e){"@babel/helpers - typeof";return WR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},WR(e)}function sw(){var e="engine_relationship",t=Qr(nr);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function iP(){var e="shared_engine_usage",t=Qr(nr);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function vHe(e){var t=e.getSettings(),r=t[nr],n=r==null?void 0:r.engine;if(r===!0||pt(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var o;return yHe((o=n.hyperformula)!==null&&o!==void 0?o:n,t,e)}else if(WR(n)==="object"&&pt(n.hyperformula)){var i=sw(),a=iP().get(n);return i.has(n)||i.set(n,[]),i.get(n).push(e),a&&a.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:kU}),(n.getConfig().leapYear1900!==VR.leapYear1900||D0(n.getConfig().nullDate,VR.nullDate)===!1)&&dt(ft(CN||(CN=dHe(["If you use HyperFormula with Handsontable, keep the default `leapYear1900` and `nullDate` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."],["If you use HyperFormula with Handsontable, keep the default \\`leapYear1900\\` and \\`nullDate\\` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."])))),n}return null}function yHe(e,t,r){var n=t[nr],o=fHe(t),i=sw(),a=iP();gHe(e,n.functions),mHe(e,n.language);var l=e.buildEmpty(o);return i.set(l,[r]),a.set(l,[r.guid]),pHe(l,n.namedExpressions),l.on("sheetAdded",function(){l.rebuildAndRecalculate()}),l.on("sheetRemoved",function(){l.rebuildAndRecalculate()}),l}function _N(e){var t,r=sw(),n=r.size===0?[]:Array.from((t=r.get(e))!==null&&t!==void 0?t:[]);return new Map(n.map(function(o){return[o.getPlugin("formulas").sheetId,o]}))}function ON(e,t){if(e){var r=sw(),n=r.get(e),o=iP(),i=o.get(e);n&&n.includes(t)&&(n.splice(n.indexOf(t),1),n.length===0&&r.delete(e)),i&&i.includes(t.guid)&&(i.splice(i.indexOf(t.guid),1),i.length===0&&(o.delete(e),e.destroy()))}}function gHe(e,t){t&&t.forEach(function(r){var n=r.name,o=r.plugin,i=r.translations;try{e.registerFunction(n,o,i)}catch(a){dt(a.message)}})}function mHe(e,t){if(t){var r=t.langCode;try{e.registerLanguage(r,t)}catch(n){dt(n.message)}}}function pHe(e,t){t&&(e.suspendEvaluation(),t.forEach(function(r){var n=r.name,o=r.expression,i=r.scope,a=r.options;try{e.addNamedExpression(n,o,i,a)}catch(l){dt(l.message)}}),e.resumeEvaluation())}function bHe(e,t){return(pt(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}var IU="DD/MM/YYYY";function MU(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function wHe(e){return MU(e)?e.substr(1):e}function SHe(e){return typeof e=="string"&&e.startsWith("=")}function mC(e,t){return typeof e=="string"&&t==="date"}function RN(e,t){return te(e,t,!0).isValid()}function EN(e,t){return te(e,t,!0).format(IU)}function CHe(e,t){return te(e,IU,!0).format(t)}function TN(e,t){var r=-1,n=new Date(Date.UTC(0,0,e+r));return te(n).format(t)}function pd(e){"@babel/helpers - typeof";return pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pd(e)}function _He(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RHe(n.key),n)}}function OHe(e,t,r){return t&&PN(e.prototype,t),r&&PN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RHe(e){var t=EHe(e,"string");return pd(t)==="symbol"?t:String(t)}function EHe(e,t){if(pd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ui(e,t,r){THe(e,t),t.set(e,r)}function THe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ct(e,t){var r=xU(e,t,"get");return PHe(e,r)}function PHe(e,t){return t.get?t.get.call(e):t.value}function Xo(e,t,r){var n=xU(e,t,"set");return kHe(e,n,r),r}function xU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function kHe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Xf=new WeakMap,Zo=new WeakMap,Ar=new WeakMap,Ey=new WeakMap,pC=new WeakMap,bC=new WeakMap,Ty=new WeakMap,$He=function(){function e(t,r,n){_He(this,e),Ui(this,Xf,{writable:!0,value:void 0}),Ui(this,Zo,{writable:!0,value:void 0}),Ui(this,Ar,{writable:!0,value:void 0}),Ui(this,Ey,{writable:!0,value:[]}),Ui(this,pC,{writable:!0,value:[]}),Ui(this,bC,{writable:!0,value:void 0}),Ui(this,Ty,{writable:!0,value:[]}),Xo(this,Xf,t),Xo(this,Zo,r),Xo(this,Ar,n)}return OHe(e,[{key:"setRemovedHfIndexes",value:function(r){var n=this;return Xo(this,Ty,r.map(function(o){var i=Ct(n,Zo).getVisualFromPhysicalIndex(o);return n.getHfIndexFromVisualIndex(i)})),Ct(this,Ty)}},{key:"getRemovedHfIndexes",value:function(){return Ct(this,Ty)}},{key:"getHfIndexFromVisualIndex",value:function(r){var n=Ct(this,Zo).getIndexesSequence(),o=Ct(this,Zo).getNotTrimmedIndexes();return n.indexOf(o[r])}},{key:"syncMoves",value:function(r){var n=this,o=1,i="move".concat(fn(Ct(this,Xf)),"s");Ct(this,Ar).getEngine().batch(function(){r.forEach(function(a){var l=a.from!==a.to,s=a.from+1!==a.to;l&&s&&Ct(n,Ar).getEngine()[i](Ct(n,Ar).getSheetId(),a.from,o,a.to)})})}},{key:"storeMovesInformation",value:function(r,n,o){var i=this;o!==!1&&(Xo(this,pC,r.map(function(a){return i.getHfIndexFromVisualIndex(a)})),Xo(this,bC,this.getHfIndexFromVisualIndex(n)))}},{key:"getMoveLine",value:function(r,n){var o=Ct(this,Zo).getNumberOfIndexes(),i=Array.from(Array(o).keys()).filter(function(l){return r.includes(l)===!1});if(n===0){var a;return(a=i[n])!==null&&a!==void 0?a:0}return i[n-1]+1}},{key:"getInitiallyCalculatedMoves",value:function(r,n){var o=this.getMoveLine(r,n),i=[];return r.forEach(function(a){var l={from:a,to:o};i.forEach(function(s){var u=s.from>s.to,f=s.to<=l.from,c=s.from>l.from;c&&f&&u&&(l.from+=1)}),l.from>=o&&(o+=1),i.push(l)}),i}},{key:"adjustedCalculatedMoves",value:function(r){return r.forEach(function(n,o){var i=r.slice(o+1);i.forEach(function(a){var l=a.from<a.to;a.from>n.from&&l&&(a.from-=1)})}),r}},{key:"calculateAndSyncMoves",value:function(r,n){var o=this;if(!Ct(this,Ar).isPerformingUndoRedo()&&!(r===!1||n===!1)){var i=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(Ct(this,pC),Ct(this,bC)));Ct(this,Ar).getSheetId()===null?Ct(this,Ar).getPostponeAction(function(){return o.syncMoves(i)}):this.syncMoves(i)}}},{key:"getIndexesChangeSyncMethod",value:function(){var r=this,n="set".concat(fn(Ct(this,Xf)),"Order");return function(o){if(!Ct(r,Ar).isPerformingUndoRedo()){var i=Ct(r,Zo).getIndexesSequence();if(o==="update"){var a=Ct(r,Ey).map(function(c){return i.indexOf(c)}),l=Ct(r,Ar).getEngine().getSheetDimensions(Ct(r,Ar).getSheetId()),s;Ct(r,Xf)==="row"?s=l.height:s=l.width;for(var u=a.length,f=u;f<s;f+=1)a.push(f);Ct(r,Ar).getEngine()[n](Ct(r,Ar).getSheetId(),a)}Xo(r,Ey,i)}}}},{key:"init",value:function(){Xo(this,Ey,Ct(this,Zo).getIndexesSequence())}}]),e}();const kN=$He;function bd(e){"@babel/helpers - typeof";return bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bd(e)}function AHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MHe(n.key),n)}}function IHe(e,t,r){return t&&$N(e.prototype,t),r&&$N(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MHe(e){var t=xHe(e,"string");return bd(t)==="symbol"?t:String(t)}function xHe(e,t){if(bd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zi(e,t,r){DHe(e,t),t.set(e,r)}function DHe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qn(e,t){var r=DU(e,t,"get");return NHe(e,r)}function NHe(e,t){return t.get?t.get.call(e):t.value}function Yi(e,t,r){var n=DU(e,t,"set");return HHe(e,n,r),r}function DU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function HHe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Py=new WeakMap,ky=new WeakMap,wC=new WeakMap,SC=new WeakMap,CC=new WeakMap,_C=new WeakMap,OC=new WeakMap,LHe=function(){function e(t,r,n){AHe(this,e),zi(this,Py,{writable:!0,value:void 0}),zi(this,ky,{writable:!0,value:void 0}),zi(this,wC,{writable:!0,value:void 0}),zi(this,SC,{writable:!0,value:!1}),zi(this,CC,{writable:!0,value:!1}),zi(this,_C,{writable:!0,value:null}),zi(this,OC,{writable:!0,value:null}),Yi(this,Py,new kN("row",t,this)),Yi(this,ky,new kN("column",r,this)),Yi(this,wC,n)}return IHe(e,[{key:"getForAxis",value:function(r){return r==="row"?qn(this,Py):qn(this,ky)}},{key:"setPerformUndo",value:function(r){Yi(this,SC,r)}},{key:"setPerformRedo",value:function(r){Yi(this,CC,r)}},{key:"isPerformingUndoRedo",value:function(){return qn(this,SC)||qn(this,CC)}},{key:"getSheetId",value:function(){return qn(this,OC)}},{key:"getEngine",value:function(){return qn(this,_C)}},{key:"getPostponeAction",value:function(){return qn(this,wC)}},{key:"setupSyncEndpoint",value:function(r,n){Yi(this,_C,r),Yi(this,OC,n),qn(this,Py).init(),qn(this,ky).init()}}]),e}();const jHe=LHe;function FHe(e){return WHe(e)||VHe(e)||NU(e)||BHe()}function BHe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VHe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function WHe(e){if(Array.isArray(e))return UR(e)}function Oi(e){"@babel/helpers - typeof";return Oi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oi(e)}function Tl(e,t){return YHe(e)||zHe(e,t)||NU(e,t)||UHe()}function UHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NU(e,t){if(e){if(typeof e=="string")return UR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UR(e,t)}}function UR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function YHe(e){if(Array.isArray(e))return e}function GHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HU(n.key),n)}}function KHe(e,t,r){return t&&AN(e.prototype,t),r&&AN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function da(){return typeof Reflect<"u"&&Reflect.get?da=Reflect.get.bind():da=function(t,r,n){var o=qHe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},da.apply(this,arguments)}function qHe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=So(e),e!==null););return e}function XHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zR(e,t)}function zR(e,t){return zR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},zR(e,t)}function ZHe(e){var t=QHe();return function(){var n=So(e),o;if(t){var i=So(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return JHe(this,o)}}function JHe(e,t){if(t&&(Oi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pn(e)}function Pn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function So(e){return So=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},So(e)}function Pl(e,t,r){return t=HU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HU(e){var t=eLe(e,"string");return Oi(t)==="symbol"?t:String(t)}function eLe(e,t){if(Oi(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Oi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RC(e,t,r){tLe(e,t),t.set(e,r)}function tLe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jo(e,t,r){var n=LU(e,t,"set");return rLe(e,n,r),r}function rLe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function kl(e,t){var r=LU(e,t,"get");return nLe(e,r)}function LU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function nLe(e,t){return t.get?t.get.call(e):t.value}var nr="formulas",oLe=["maxRows","maxColumns","language"],iLe=260;be.getSingleton().register("afterNamedExpressionAdded");be.getSingleton().register("afterNamedExpressionRemoved");be.getSingleton().register("afterSheetAdded");be.getSingleton().register("afterSheetRemoved");be.getSingleton().register("afterSheetRenamed");be.getSingleton().register("afterFormulasValuesUpdate");var $l=function(t){return t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto"},Xn=new WeakMap,EC=new WeakMap,Zf=new WeakMap,aLe=function(e){XHe(r,e);var t=ZHe(r);function r(){var n;GHe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),RC(Pn(n),Xn,{writable:!0,value:!1}),RC(Pn(n),EC,{writable:!0,value:!1}),RC(Pn(n),Zf,{writable:!0,value:[["valuesUpdated",function(){var l;return(l=n).onEngineValuesUpdated.apply(l,arguments)}],["namedExpressionAdded",function(){var l;return(l=n).onEngineNamedExpressionsAdded.apply(l,arguments)}],["namedExpressionRemoved",function(){var l;return(l=n).onEngineNamedExpressionsRemoved.apply(l,arguments)}],["sheetAdded",function(){var l;return(l=n).onEngineSheetAdded.apply(l,arguments)}],["sheetRenamed",function(){var l;return(l=n).onEngineSheetRenamed.apply(l,arguments)}],["sheetRemoved",function(){var l;return(l=n).onEngineSheetRemoved.apply(l,arguments)}]]}),Pl(Pn(n),"staticRegister",Qr("formulas")),Pl(Pn(n),"engine",null),Pl(Pn(n),"sheetName",null),Pl(Pn(n),"indexSyncer",null),Pl(Pn(n),"rowAxisSyncer",null),Pl(Pn(n),"columnAxisSyncer",null),n}return KHe(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[nr]}},{key:"enablePlugin",value:function(){var o,i=this;if(!this.enabled){if(this.engine=(o=vHe(this.hot))!==null&&o!==void 0?o:this.engine,!this.engine){dt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var a=this.addSheet(this.sheetName,this.hot.getSourceDataArray());a!==!1&&(this.sheetName=a)}this.addHook("beforeLoadData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeUpdateData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterUpdateData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("modifyData",function(){return i.onModifyData.apply(i,arguments)}),this.addHook("modifySourceData",function(){return i.onModifySourceData.apply(i,arguments)}),this.addHook("beforeValidate",function(){return i.onBeforeValidate.apply(i,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return i.onAfterSetSourceDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtCell",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("beforeCreateRow",function(){return i.onBeforeCreateRow.apply(i,arguments)}),this.addHook("beforeCreateCol",function(){return i.onBeforeCreateCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("beforeRemoveCol",function(){return i.onBeforeRemoveCol.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.indexSyncer=new jHe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,function(l){i.hot.addHookOnce("init",function(){l()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",function(l,s,u,f){i.rowAxisSyncer.storeMovesInformation(l,s,f)}),this.hot.addHook("beforeColumnMove",function(l,s,u,f){i.columnAxisSyncer.storeMovesInformation(l,s,f)}),this.hot.addHook("afterRowMove",function(l,s,u,f,c){i.rowAxisSyncer.calculateAndSyncMoves(f,c)}),this.hot.addHook("afterColumnMove",function(l,s,u,f,c){i.columnAxisSyncer.calculateAndSyncMoves(f,c)}),this.hot.addHook("beforeColumnFreeze",function(l,s){i.columnAxisSyncer.storeMovesInformation([l],i.hot.getSettings().fixedColumnsStart,s)}),this.hot.addHook("afterColumnFreeze",function(l,s){i.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.hot.addHook("beforeColumnUnfreeze",function(l,s){i.columnAxisSyncer.storeMovesInformation([l],i.hot.getSettings().fixedColumnsStart-1,s)}),this.hot.addHook("afterColumnUnfreeze",function(l,s){i.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.addHook("afterCellMetaReset",function(){return i.onAfterCellMetaReset.apply(i,arguments)}),this.addHook("beforeUndo",function(){i.indexSyncer.setPerformUndo(!0),i.engine.undo()}),this.addHook("beforeRedo",function(){i.indexSyncer.setPerformRedo(!0),i.engine.redo()}),this.addHook("afterUndo",function(){i.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",function(){i.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("beforeAutofill",function(){return i.onBeforeAutofill.apply(i,arguments)}),kl(this,Zf).forEach(function(l){var s=Tl(l,2),u=s[0],f=s[1];return i.engine.on(u,f)}),da(So(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;kl(this,Zf).forEach(function(i){var a=Tl(i,2),l=a[0],s=a[1];return o.engine.off(l,s)}),ON(this.engine,this.hot),this.engine=null,da(So(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(o){var i=cHe(this.hot.getSettings());hHe(this.engine.getConfig(),i)&&this.engine.updateConfig(i);var a=this.hot.getSettings()[nr];if(pe(a)&&pe(a.sheetName)&&a.sheetName!==this.sheetName&&this.switchSheet(a.sheetName),!o.data&&this.sheetName===null){var l=this.hot.getSettings()[nr].sheetName;l&&this.engine.doesSheetExist(l)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(l??void 0,this.hot.getSourceDataArray())}da(So(r.prototype),"updatePlugin",this).call(this,o)}},{key:"destroy",value:function(){var o=this;kl(this,Zf).forEach(function(i){var a,l=Tl(i,2),s=l[0],u=l[1];return(a=o.engine)===null||a===void 0?void 0:a.off(s,u)}),Jo(this,Zf,null),ON(this.engine,this.hot),this.engine=null,da(So(r.prototype),"destroy",this).call(this)}},{key:"addSheet",value:function(o,i){if(pe(i)&&!Sye(i))return dt("The provided data should be an array of arrays."),!1;if(o!=null&&this.engine.doesSheetExist(o))return dt("Sheet with the provided name already exists."),!1;try{var a=this.engine.addSheet(o??void 0);return i&&this.engine.setSheetContent(this.engine.getSheetId(a),i),a}catch(l){return dt(l.message),!1}}},{key:"switchSheet",value:function(o){if(!this.engine.doesSheetExist(o)){lT("The sheet named `".concat(o,"` does not exist, switch aborted."));return}this.sheetName=o;var i=this.engine.getSheetSerialized(this.sheetId);i.length>0&&this.hot.loadData(i,"".concat(fn(nr),".switchSheet"))}},{key:"getCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,l=this.hot.toPhysicalRow(o),s=this.hot.toPhysicalColumn(i);return l!==null&&s!==null?this.engine.getCellType({sheet:a,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i)}):"EMPTY"}},{key:"isFormulaCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:a,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i)})}},{key:"renderDependentSheets",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=new Set;o.forEach(function(s){var u,f=s==null||(u=s.address)===null||u===void 0?void 0:u.sheet;f!==void 0&&(l.has(f)||l.add(f))}),_N(this.engine).forEach(function(s,u){if((a||u!==i.sheetId)&&l.has(u)){var f;s.render(),(f=s.view)===null||f===void 0||f.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=function(f){var c,h=(c=f==null?void 0:f.address)!==null&&c!==void 0?c:{},d=h.row,v=h.col,g=h.sheet;return pe(g)?"".concat(g,":").concat(d,"x").concat(v):""},s=new Set(a.map(function(u){return l(u)}));o.forEach(function(u){var f,c,h=(f=u.address)!==null&&f!==void 0?f:{},d=h.row,v=h.col;if(!(pe(d)===!1||pe(v)===!1||d>=i.hot.countRows()||v>=i.hot.countCols())){var g=u==null||(c=u.address)===null||c===void 0?void 0:c.sheet,p=l(u);if(g!==void 0&&!s.has(p)){var w=_N(i.engine).get(g);if(!w)return;w.validateCell(w.getDataAtCell(d,v),w.getCellMeta(d,v),function(){})}}})}},{key:"syncChangeWithEngine",value:function(o,i,a){var l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(l)){dt("Not possible to set cell data at ".concat(JSON.stringify(l)));return}var s=this.hot.getCellMeta(o,i);return mC(a,s.type)&&(RN(a,s.dateFormat)?a=EN(a,s.dateFormat):SHe(a)===!1&&(a="'".concat(a))),this.engine.setCellContents(l,a)}},{key:"onBeforeValidate",value:function(o,i,a){var l=this.hot.propToCol(a);if(this.isFormulaCellType(i,l)){var s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},u=this.hot.getCellMeta(i,l),f=this.engine.getCellValue(s);return u.type==="date"&&Or(f)&&(f=TN(f,u.dateFormat)),Oi(f)==="object"&&f!==null?f.value:f}return o}},{key:"onBeforeAutofill",value:function(o,i,a){var l=i.getTopStartCorner(),s=l.row,u=l.col,f=i.getBottomEndCorner(),c=f.row,h=f.col,d=a.getTopStartCorner(),v=d.row,g=d.col,p=a.getBottomEndCorner(),w=p.row,S=p.col,C={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId}},P={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(v),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(g),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(w),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(S),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(P)===!1)return!1;for(var R=this.engine.getFillRangeData(C,P),V=C.start,U=V.row,X=V.col,Y=C.end,q=Y.row,Z=Y.col,ie=q-U+1,J=Z-X+1,le=0;le<R.length;le+=1)for(var Ce=0;Ce<R[le].length;Ce+=1){var we=R[le][Ce],_e=le%ie,k=Ce%J,y=this.hot.getCellMeta(_e,k);mC(we,y.type)&&(we.startsWith("'")?R[le][Ce]=we.slice(1):this.isFormulaCellType(_e,k,this.sheetId)===!1&&(R[le][Ce]=CHe(we,y.dateFormat)))}return R}},{key:"onBeforeLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";a.includes(fn(nr))||Jo(this,EC,pt(this.hot.getSettings().data))}},{key:"onAfterCellMetaReset",value:function(){var o=this,i=this.hot.getSourceDataArray(),a=!1;i.forEach(function(l,s){l.forEach(function(u,f){var c=o.hot.getCellMeta(s,f),h=c.dateFormat;mC(u,c.type)&&(a=!0,RN(u,h)?i[s][f]=EN(u,h):o.isFormulaCellType(s,f)===!1&&(i[s][f]="'".concat(u)))})}),a===!0&&(Jo(this,Xn,!0),this.engine.setSheetContent(this.sheetId,i),Jo(this,Xn,!1))}},{key:"onAfterLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!a.includes(fn(nr)))if(this.sheetName=bHe(this.engine,this.hot.getSettings()[nr].sheetName),kl(this,EC))this.switchSheet(this.sheetName);else{var l=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,l)){Jo(this,Xn,!0);var s=this.engine.setSheetContent(this.sheetId,l);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),Jo(this,Xn,!1)}}}},{key:"onModifyData",value:function(o,i,a,l){if(!(l!=="get"||kl(this,Xn)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o);if(!(s===null||i===null)){var u=this.isFormulaCellType(s,i);if(!u){var f=this.getCellType(s,i);if(f!=="ARRAY"){MU(a.value)&&(a.value=wHe(a.value));return}}var c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},h=this.engine.getCellValue(c),d=this.hot.getCellMeta(s,i);d.type==="date"&&Or(h)&&(h=TN(h,d.dateFormat));var v=Oi(h)==="object"&&h!==null?h.value:h;a.value=v}}}},{key:"onModifySourceData",value:function(o,i,a,l){if(!(l!=="get"||kl(this,Xn)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o),u=this.hot.propToCol(i);if(!(s===null||u===null)){var f=this.isFormulaCellType(s,u);if(!f){var c=this.getCellType(s,u);if(c!=="ARRAY")return}var h=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(h.width===0&&h.height===0)){var d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};a.value=this.engine.getCellSerialized(d)}}}}},{key:"onAfterSetDataAtCell",value:function(o,i){var a=this;if(!$l(i)){var l=[],s=[],u=this.engine.batch(function(){o.forEach(function(f){var c=Tl(f,4),h=c[0],d=c[1],v=c[3],g=a.hot.propToCol(d),p=a.hot.toPhysicalRow(h),w=a.hot.toPhysicalColumn(g),S={row:a.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:a.columnAxisSyncer.getHfIndexFromVisualIndex(g),sheet:a.sheetId};p!==null&&w!==null?a.syncChangeWithEngine(h,g,v):l.push([h,g,v]),s.push({address:S})})});l.length&&this.hot.addHookOnce("afterChange",function(){var f=a.engine.batch(function(){l.forEach(function(c){var h=Tl(c,3),d=h[0],v=h[1],g=h[2];a.syncChangeWithEngine(d,v,g)})});a.renderDependentSheets(f,!0)}),this.renderDependentSheets(u),this.validateDependentCells(u,s)}}},{key:"onAfterSetSourceDataAtCell",value:function(o,i){var a=this;if(!$l(i)){var l=[],s=[];o.forEach(function(u){var f=Tl(u,4),c=f[0],h=f[1],d=f[3],v=a.hot.propToCol(h);if(Or(v)){var g={row:a.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:a.columnAxisSyncer.getHfIndexFromVisualIndex(v),sheet:a.sheetId};if(!a.engine.isItPossibleToSetCellContents(g)){dt("Not possible to set source cell data at ".concat(JSON.stringify(g)));return}s.push({address:g}),l.push.apply(l,FHe(a.engine.setCellContents(g,d)))}}),this.renderDependentSheets(l),this.validateDependentCells(l,s)}}},{key:"onBeforeCreateRow",value:function(o,i){var a=this.rowAxisSyncer.getHfIndexFromVisualIndex(o);if(o>=this.hot.countRows()&&(a=o),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[a,i]))return!1}},{key:"onBeforeCreateCol",value:function(o,i){var a=this.columnAxisSyncer.getHfIndexFromVisualIndex(o);if(o>=this.hot.countCols()&&(a=o),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[a,i]))return!1}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=this.rowAxisSyncer.setRemovedHfIndexes(a),u=s.every(function(f){return l.engine.isItPossibleToRemoveRows(l.sheetId,[f,1])});return u===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(o,i,a){var l=this,s=this.columnAxisSyncer.setRemovedHfIndexes(a),u=s.every(function(f){return l.engine.isItPossibleToRemoveColumns(l.sheetId,[f,1])});return u===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(o,i,a){if(!$l(a)){var l=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterCreateCol",value:function(o,i,a){if(!$l(a)){var l=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(!$l(l)){var u=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){s.engine.removeRows(s.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterRemoveCol",value:function(o,i,a,l){var s=this;if(!$l(l)){var u=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){s.engine.removeColumns(s.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterDetachChild",value:function(o,i,a){var l,s=this;Jo(this,Xn,!0);var u=this.hot.getSourceDataArray(a,0,a+(((l=i.__children)===null||l===void 0?void 0:l.length)||0),this.hot.countSourceCols());Jo(this,Xn,!1),u.forEach(function(f,c){f.forEach(function(h,d){s.engine.setCellContents({col:d,row:a+c,sheet:s.sheetId},[[h]])})})}},{key:"onEngineValuesUpdated",value:function(o){this.hot.runHooks("afterFormulasValuesUpdate",o)}},{key:"onEngineNamedExpressionsAdded",value:function(o,i){this.hot.runHooks("afterNamedExpressionAdded",o,i)}},{key:"onEngineNamedExpressionsRemoved",value:function(o,i){this.hot.runHooks("afterNamedExpressionRemoved",o,i)}},{key:"onEngineSheetAdded",value:function(o){this.hot.runHooks("afterSheetAdded",o)}},{key:"onEngineSheetRenamed",value:function(o,i){this.hot.runHooks("afterSheetRenamed",o,i)}},{key:"onEngineSheetRemoved",value:function(o,i){this.hot.runHooks("afterSheetRemoved",o,i)}}],[{key:"PLUGIN_KEY",get:function(){return nr}},{key:"PLUGIN_PRIORITY",get:function(){return iLe}},{key:"SETTING_KEYS",get:function(){return[nr].concat(oLe)}}]),r}(ct);function lLe(e,t){return cLe(e)||fLe(e,t)||uLe(e,t)||sLe()}function sLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uLe(e,t){if(e){if(typeof e=="string")return IN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IN(e,t)}}function IN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function cLe(e){if(Array.isArray(e))return e}function hLe(e){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=lLe(r,4),i=o[1],a=o[3];i-a!==0&&(n=1)}return this.getTranslatedPhrase(db,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.col,o.col),0),a=Math.max(n.col,o.col),l=[],s=i;s<=a;s+=1)l.push(s);e.hideColumns(l);var u=l[l.length-1],f=this.columnIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectColumns(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function $y(e){return gLe(e)||yLe(e)||vLe(e)||dLe()}function dLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vLe(e,t){if(e){if(typeof e=="string")return YR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YR(e,t)}}function yLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gLe(e){if(Array.isArray(e))return YR(e)}function YR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mLe(e){var t=[];return{key:"hidden_columns_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(vb,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.columnIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countCols();l||this.selectColumns(i,a)}},disabled:!1,hidden:function(){var n=this,o=ze(e.getHiddenColumns(),function(S){return n.toPhysicalColumn(S)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().col,l=i.getBottomEndCorner().col,s=this.columnIndexMapper,u=s.getRenderableFromVisualIndex(a),f=s.getRenderableFromVisualIndex(l),c=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=f-u+1;if(d>v){var g=c.slice(a,l+1);h.push.apply(h,$y(g.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,$y(c.slice(0,a)));else if(u===null)h.push.apply(h,$y(c.slice(0,this.countCols())));else{var p=this.countCols()-1,w=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(p,-1));f===w&&p>l&&h.push.apply(h,$y(c.slice(l+1)))}return I(h,function(S){t.push(n.toVisualColumn(S))}),t.length===0}}}function Du(e){"@babel/helpers - typeof";return Du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Du(e)}function pLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wLe(n.key),n)}}function bLe(e,t,r){return t&&MN(e.prototype,t),r&&MN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wLe(e){var t=SLe(e,"string");return Du(t)==="symbol"?t:String(t)}function SLe(e,t){if(Du(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Du(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function va(){return typeof Reflect<"u"&&Reflect.get?va=Reflect.get.bind():va=function(t,r,n){var o=CLe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},va.apply(this,arguments)}function CLe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Co(e),e!==null););return e}function _Le(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GR(e,t)}function GR(e,t){return GR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},GR(e,t)}function OLe(e){var t=ELe();return function(){var n=Co(e),o;if(t){var i=Co(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return RLe(this,o)}}function RLe(e,t){if(t&&(Du(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KR(e)}function KR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ELe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Co(e){return Co=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Co(e)}function xN(e,t,r){TLe(e,t),t.set(e,r)}function TLe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ir(e,t){var r=jU(e,t,"get");return PLe(e,r)}function PLe(e,t){return t.get?t.get.call(e):t.value}function Jf(e,t,r){var n=jU(e,t,"set");return kLe(e,n,r),r}function jU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function kLe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}be.getSingleton().register("beforeHideColumns");be.getSingleton().register("afterHideColumns");be.getSingleton().register("beforeUnhideColumns");be.getSingleton().register("afterUnhideColumns");var TC="hiddenColumns",$Le=310,_n=new WeakMap,On=new WeakMap,ALe=function(e){_Le(r,e);var t=OLe(r);function r(){var n;pLe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),xN(KR(n),_n,{writable:!0,value:{}}),xN(KR(n),On,{writable:!0,value:null}),n}return bLe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[TC]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[TC];Ye(i)&&(Jf(this,_n,i),pt(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),Jf(this,On,new Ep),Ir(this,On).addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,Ir(this,On)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyColWidth",function(a,l){return o.onModifyColWidth(a,l)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),va(Co(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),va(Co(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Jf(this,_n,{}),va(Co(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a,u=Ir(this,On).getValues().slice(),f=o.length>0;if(l&&f){var c=o.map(function(d){return i.hot.toPhysicalColumn(d)});I(c,function(d){u[d]=!1}),s=ar(u,function(d,v,g){return v&&d.push(i.hot.toVisualColumn(g)),d},[])}var h=this.hot.runHooks("beforeUnhideColumns",a,s,l&&f);h!==!1&&(l&&f&&Ir(this,On).setValues(u),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",a,s,l&&f,l&&s.length<a.length))}},{key:"showColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showColumns(i)}},{key:"hideColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideColumns",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){I(o,function(f){Ir(i,On).setValueAtIndex(i.hot.toPhysicalColumn(f),!0)})},!0),this.hot.runHooks("afterHideColumns",a,s,l,l&&s.length>a.length))}},{key:"hideColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideColumns(i)}},{key:"getHiddenColumns",value:function(){var o=this;return ze(Ir(this,On).getHiddenIndexes(),function(i){return o.hot.toVisualColumn(i)})}},{key:"isHidden",value:function(o){return Ir(this,On).getValueAtIndex(this.hot.toPhysicalColumn(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countCols();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){I(this.hot.getCellsMeta(),function(o){o&&(o.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(o,i){if(this.isHidden(i))return 0;if(Ir(this,_n).indicators&&(this.isHidden(i+1)||this.isHidden(i-1))&&typeof o=="number"&&this.hot.hasColHeaders())return o+15}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(Ir(this,_n).copyPasteEnabled===!1&&this.isHidden(i)&&(a.skipColumnOnPaste=!0),this.isHidden(i-1))a.className=a.className||"",a.className.indexOf("afterHiddenColumn")===-1&&(a.className+=" afterHiddenColumn");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenColumn");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(Ir(this,_n).copyPasteEnabled)return o;var a=[],l=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return I(o,function(s){var u=!0,f=0;Re(s.startCol,s.endCol,function(c){i.isHidden(c)?(u||l(s.startRow,s.endRow,f,c-1),u=!0):(u&&(f=c),c===s.endCol&&l(s.startRow,s.endRow,f,c),u=!1)})}),a}},{key:"onAfterGetColHeader",value:function(o,i){if(!(!Ir(this,_n).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenColumn"),o<this.hot.countCols()-1&&this.isHidden(o+1)&&a.push("beforeHiddenColumn"),re(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:Ue},hLe(this),mLe(this))}},{key:"onMapInit",value:function(){Array.isArray(Ir(this,_n).columns)&&this.hideColumns(Ir(this,_n).columns)}},{key:"destroy",value:function(){Jf(this,_n,null),Jf(this,On,null),va(Co(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return TC}},{key:"PLUGIN_PRIORITY",get:function(){return $Le}}]),r}(ct);function ILe(e,t){return NLe(e)||DLe(e,t)||xLe(e,t)||MLe()}function MLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xLe(e,t){if(e){if(typeof e=="string")return DN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DN(e,t)}}function DN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function DLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function NLe(e){if(Array.isArray(e))return e}function HLe(e){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=ILe(r,3),i=o[0],a=o[2];i-a!==0&&(n=1)}return this.getTranslatedPhrase(yb,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.row,o.row),0),a=Math.max(n.row,o.row),l=[],s=i;s<=a;s+=1)l.push(s);e.hideRows(l);var u=l[l.length-1],f=this.rowIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectRows(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Ay(e){return BLe(e)||FLe(e)||jLe(e)||LLe()}function LLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jLe(e,t){if(e){if(typeof e=="string")return qR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qR(e,t)}}function FLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function BLe(e){if(Array.isArray(e))return qR(e)}function qR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function VLe(e){var t=[];return{key:"hidden_rows_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(gb,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.rowIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countRows();l||this.selectRows(i,a)}},disabled:!1,hidden:function(){var n=this,o=ze(e.getHiddenRows(),function(S){return n.toPhysicalRow(S)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().row,l=i.getBottomEndCorner().row,s=this.rowIndexMapper,u=s.getRenderableFromVisualIndex(a),f=s.getRenderableFromVisualIndex(l),c=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=f-u+1;if(d>v){var g=c.slice(a,l+1);h.push.apply(h,Ay(g.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,Ay(c.slice(0,a)));else if(u===null)h.push.apply(h,Ay(c.slice(0,this.countRows())));else{var p=this.countRows()-1,w=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(p,-1));f===w&&p>l&&h.push.apply(h,Ay(c.slice(l+1)))}return I(h,function(S){t.push(n.toVisualRow(S))}),t.length===0}}}function Nu(e){"@babel/helpers - typeof";return Nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nu(e)}function WLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zLe(n.key),n)}}function ULe(e,t,r){return t&&NN(e.prototype,t),r&&NN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zLe(e){var t=YLe(e,"string");return Nu(t)==="symbol"?t:String(t)}function YLe(e,t){if(Nu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ya(){return typeof Reflect<"u"&&Reflect.get?ya=Reflect.get.bind():ya=function(t,r,n){var o=GLe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ya.apply(this,arguments)}function GLe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_o(e),e!==null););return e}function KLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XR(e,t)}function XR(e,t){return XR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},XR(e,t)}function qLe(e){var t=ZLe();return function(){var n=_o(e),o;if(t){var i=_o(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return XLe(this,o)}}function XLe(e,t){if(t&&(Nu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZR(e)}function ZR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _o(e){return _o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_o(e)}function HN(e,t,r){JLe(e,t),t.set(e,r)}function JLe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ur(e,t){var r=FU(e,t,"get");return QLe(e,r)}function QLe(e,t){return t.get?t.get.call(e):t.value}function Qf(e,t,r){var n=FU(e,t,"set");return eje(e,n,r),r}function FU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function eje(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}be.getSingleton().register("beforeHideRows");be.getSingleton().register("afterHideRows");be.getSingleton().register("beforeUnhideRows");be.getSingleton().register("afterUnhideRows");var PC="hiddenRows",tje=320,Zn=new WeakMap,Rn=new WeakMap,rje=function(e){KLe(r,e);var t=qLe(r);function r(){var n;WLe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),HN(ZR(n),Zn,{writable:!0,value:{}}),HN(ZR(n),Rn,{writable:!0,value:null}),n}return ULe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PC]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[PC];Ye(i)&&(Qf(this,Zn,i),pt(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),Qf(this,Rn,new Ep),Ur(this,Rn).addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,Ur(this,Rn)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyRowHeight",function(a,l){return o.onModifyRowHeight(a,l)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),ya(_o(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ya(_o(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Qf(this,Zn,{}),ya(_o(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a,u=Ur(this,Rn).getValues().slice(),f=o.length>0;if(l&&f){var c=o.map(function(d){return i.hot.toPhysicalRow(d)});I(c,function(d){u[d]=!1}),s=ar(u,function(d,v,g){return v&&d.push(i.hot.toVisualRow(g)),d},[])}var h=this.hot.runHooks("beforeUnhideRows",a,s,l&&f);h!==!1&&(l&&f&&Ur(this,Rn).setValues(u),this.hot.runHooks("afterUnhideRows",a,s,l&&f,l&&s.length<a.length))}},{key:"showRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showRows(i)}},{key:"hideRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideRows",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){I(o,function(f){Ur(i,Rn).setValueAtIndex(i.hot.toPhysicalRow(f),!0)})},!0),this.hot.runHooks("afterHideRows",a,s,l,l&&s.length>a.length))}},{key:"hideRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideRows(i)}},{key:"getHiddenRows",value:function(){var o=this;return ze(Ur(this,Rn).getHiddenIndexes(),function(i){return o.hot.toVisualRow(i)})}},{key:"isHidden",value:function(o){return Ur(this,Rn).getValueAtIndex(this.hot.toPhysicalRow(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countRows();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){I(this.hot.getCellsMeta(),function(o){o&&(o.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(o,i){return this.isHidden(i)?0:o}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(Ur(this,Zn).copyPasteEnabled===!1&&this.isHidden(o)&&(a.skipRowOnPaste=!0),this.isHidden(o-1))a.className=a.className||"",a.className.indexOf("afterHiddenRow")===-1&&(a.className+=" afterHiddenRow");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenRow");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(Ur(this,Zn).copyPasteEnabled)return o;var a=[],l=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return I(o,function(s){var u=!0,f=0;Re(s.startRow,s.endRow,function(c){i.isHidden(c)?(u||l(f,c-1,s.startCol,s.endCol),u=!0):(u&&(f=c),c===s.endRow&&l(f,c,s.startCol,s.endCol),u=!1)})}),a}},{key:"onAfterGetRowHeader",value:function(o,i){if(!(!Ur(this,Zn).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenRow"),o<this.hot.countRows()-1&&this.isHidden(o+1)&&a.push("beforeHiddenRow"),re(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:Ue},HLe(this),VLe(this))}},{key:"onMapInit",value:function(){Array.isArray(Ur(this,Zn).rows)&&this.hideRows(Ur(this,Zn).rows)}},{key:"destroy",value:function(){Qf(this,Zn,null),Qf(this,Rn,null),ya(_o(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PC}},{key:"PLUGIN_PRIORITY",get:function(){return tje}}]),r}(ct);function nje(e,t){return lje(e)||aje(e,t)||ije(e,t)||oje()}function oje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ije(e,t){if(e){if(typeof e=="string")return LN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LN(e,t)}}function LN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function lje(e){if(Array.isArray(e))return e}function sje(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(Wp)},callback:function(r,n){var o=nje(n,1),i=o[0].start.col;e.freezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function uje(e,t){return dje(e)||hje(e,t)||cje(e,t)||fje()}function fje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cje(e,t){if(e){if(typeof e=="string")return jN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jN(e,t)}}function jN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function dje(e){if(Array.isArray(e))return e}function vje(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(Up)},callback:function(r,n){var o=uje(n,1),i=o[0].start.col;e.unfreezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Hu(e){"@babel/helpers - typeof";return Hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hu(e)}function yje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mje(n.key),n)}}function gje(e,t,r){return t&&FN(e.prototype,t),r&&FN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mje(e){var t=pje(e,"string");return Hu(t)==="symbol"?t:String(t)}function pje(e,t){if(Hu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rs(){return typeof Reflect<"u"&&Reflect.get?rs=Reflect.get.bind():rs=function(t,r,n){var o=bje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},rs.apply(this,arguments)}function bje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wi(e),e!==null););return e}function wje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JR(e,t)}function JR(e,t){return JR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},JR(e,t)}function Sje(e){var t=_je();return function(){var n=wi(e),o;if(t){var i=wi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Cje(this,o)}}function Cje(e,t){if(t&&(Hu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BU(e)}function BU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _je(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wi(e){return wi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wi(e)}be.getSingleton().register("beforeColumnFreeze");be.getSingleton().register("afterColumnFreeze");be.getSingleton().register("beforeColumnUnfreeze");be.getSingleton().register("afterColumnUnfreeze");var BN="manualColumnFreeze",Oje=110,ec=new WeakMap,Rje=function(e){wje(r,e);var t=Sje(r);function r(n){var o;return yje(this,r),o=t.call(this,n),ec.set(BU(o),{afterFirstUse:!1}),o}return gje(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[BN]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.addContextMenuEntry(i)}),this.addHook("beforeColumnMove",function(i,a){return o.onBeforeColumnMove(i,a)}),rs(wi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=ec.get(this);o.afterFirstUse=!1,rs(wi(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),rs(wi(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(o){var i=ec.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart<this.hot.countCols()&&o>a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnFreeze",o,l);s!==!1&&(l&&(this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart),a._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",o,l))}},{key:"unfreezeColumn",value:function(o){var i=ec.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart>0&&o<=a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnUnfreeze",o,l);s!==!1&&(l&&(a._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",o,l))}},{key:"addContextMenuEntry",value:function(o){o.items.push({name:"---------"},sje(this),vje(this))}},{key:"onBeforeColumnMove",value:function(o,i){var a=ec.get(this);if(a.afterFirstUse){var l=this.hot.getSettings().fixedColumnsStart;if(i<l||o.some(function(s){return s<l}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return BN}},{key:"PLUGIN_PRIORITY",get:function(){return Oje}}]),r}(ct);function wd(e){"@babel/helpers - typeof";return wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wd(e)}function Eje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pje(n.key),n)}}function Tje(e,t,r){return t&&VN(e.prototype,t),r&&VN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pje(e){var t=kje(e,"string");return wd(t)==="symbol"?t:String(t)}function kje(e,t){if(wd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kC=0,WN=1,UN=2,Al="px",$je=function(){function e(t){Eje(this,e),this.hot=t,this._element=null,this.state=kC,this.inlineProperty=t.isRtl()?"right":"left"}return Tje(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=UN}},{key:"build",value:function(){this.state===kC&&(this._element=this.hot.rootDocument.createElement("div"),this.state=WN)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=kC}},{key:"isAppended",value:function(){return this.state===UN}},{key:"isBuilt",value:function(){return this.state>=WN}},{key:"setPosition",value:function(r,n){Or(r)&&(this._element.style.top=r+Al),Or(n)&&(this._element.style[this.inlineProperty]=n+Al)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){Or(r)&&(this._element.style.width=r+Al),Or(n)&&(this._element.style.height=n+Al)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){Or(r)&&(this._element.style.marginTop=r+Al),Or(n)&&(this._element.style["margin".concat(fn(this.inlineProperty))]=n+Al)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat(fn(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),e}();const VU=$je;function Lu(e){"@babel/helpers - typeof";return Lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lu(e)}function Aje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mje(n.key),n)}}function Ije(e,t,r){return t&&zN(e.prototype,t),r&&zN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mje(e){var t=xje(e,"string");return Lu(t)==="symbol"?t:String(t)}function xje(e,t){if(Lu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sg(){return typeof Reflect<"u"&&Reflect.get?Sg=Reflect.get.bind():Sg=function(t,r,n){var o=Dje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Sg.apply(this,arguments)}function Dje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ju(e),e!==null););return e}function Nje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QR(e,t)}function QR(e,t){return QR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},QR(e,t)}function Hje(e){var t=Fje();return function(){var n=ju(e),o;if(t){var i=ju(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Lje(this,o)}}function Lje(e,t){if(t&&(Lu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jje(e)}function jje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ju(e){return ju=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ju(e)}var Bje="ht__manualColumnMove--backlight",Vje=function(e){Nje(r,e);var t=Hje(r);function r(){return Aje(this,r),t.apply(this,arguments)}return Ije(r,[{key:"build",value:function(){Sg(ju(r.prototype),"build",this).call(this),re(this._element,Bje)}}]),r}(VU);const Wje=Vje;function Fu(e){"@babel/helpers - typeof";return Fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fu(e)}function Uje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yje(n.key),n)}}function zje(e,t,r){return t&&YN(e.prototype,t),r&&YN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yje(e){var t=Gje(e,"string");return Fu(t)==="symbol"?t:String(t)}function Gje(e,t){if(Fu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cg(){return typeof Reflect<"u"&&Reflect.get?Cg=Reflect.get.bind():Cg=function(t,r,n){var o=Kje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Cg.apply(this,arguments)}function Kje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Bu(e),e!==null););return e}function qje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eE(e,t)}function eE(e,t){return eE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},eE(e,t)}function Xje(e){var t=Qje();return function(){var n=Bu(e),o;if(t){var i=Bu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Zje(this,o)}}function Zje(e,t){if(t&&(Fu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jje(e)}function Jje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bu(e){return Bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bu(e)}var eFe="ht__manualColumnMove--guideline",tFe=function(e){qje(r,e);var t=Xje(r);function r(){return Uje(this,r),t.apply(this,arguments)}return zje(r,[{key:"build",value:function(){Cg(Bu(r.prototype),"build",this).call(this),re(this._element,eFe)}}]),r}(VU);const rFe=tFe;function Vu(e){"@babel/helpers - typeof";return Vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vu(e)}function nFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iFe(n.key),n)}}function oFe(e,t,r){return t&&GN(e.prototype,t),r&&GN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iFe(e){var t=aFe(e,"string");return Vu(t)==="symbol"?t:String(t)}function aFe(e,t){if(Vu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ga(){return typeof Reflect<"u"&&Reflect.get?ga=Reflect.get.bind():ga=function(t,r,n){var o=lFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ga.apply(this,arguments)}function lFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Oo(e),e!==null););return e}function sFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tE(e,t)}function tE(e,t){return tE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},tE(e,t)}function uFe(e){var t=cFe();return function(){var n=Oo(e),o;if(t){var i=Oo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fFe(this,o)}}function fFe(e,t){if(t&&(Vu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rE(e)}function rE(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oo(e){return Oo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Oo(e)}be.getSingleton().register("beforeColumnMove");be.getSingleton().register("afterColumnMove");var $C="manualColumnMove",hFe=120,Qo=new WeakMap,KN="ht__manualColumnMove",Iy="show-ui",AC="on-moving--columns",IC="after-selection--columns",dFe=function(e){sFe(r,e);var t=uFe(r);function r(n){var o;return nFe(this,r),o=t.call(this,n),Qo.set(rE(o),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),o.eventManager=new It(rE(o)),o.backlight=new Wje(n),o.guideline=new rFe(n),o}return oFe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[$C]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollVertically",function(){return o.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),re(this.hot.rootElement,KN),ga(Oo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),ga(Oo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){je(this.hot.rootElement,KN),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),ga(Oo(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(o,i){return this.moveColumns([o],i)}},{key:"moveColumns",value:function(o,i){var a=Qo.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeColumnMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.columnIndexMapper.moveIndexes(o,i);var f=s&&this.isColumnOrderChanged(o,i);return this.hot.runHooks("afterColumnMove",o,i,l,s,f),f}}},{key:"dragColumn",value:function(o,i){return this.dragColumns([o],i)}},{key:"dragColumns",value:function(o,i){var a=this.countFinalIndex(o,i),l=Qo.get(this);return l.cachedDropIndex=i,this.moveColumns(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(l||s||u||f)}},{key:"isColumnOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=ar(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getColumnsWidth",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=0,s=o;s<=i;s+=1){var u=a.getRenderableFromVisualIndex(s);s<0?l+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:u!==null&&(l+=this.hot.view._wt.wtTable.getStretchedColumnWidth(u)||0)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[$C];if(Array.isArray(o))this.moveColumns(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveColumns(i,0)}}},{key:"isFixedColumnsStart",value:function(o){return o<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",o),o.value?o.value:[]}},{key:"prepareColumnsToMoving",value:function(o,i){var a=[];return Re(o,i,function(l){a.push(l)}),a}},{key:"refreshPositions",value:function(){var o=Qo.get(this),i=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(o.hoveredColumn)&&i>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1));var a=this.hot.view._wt.wtTable,l=this.hot.view._wt.wtOverlays.scrollableElement,s=typeof l.scrollX=="number"?l.scrollX:l.scrollLeft,u=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,o.hoveredColumn-1),f=a.hider.offsetWidth,c=a.TBODY.offsetLeft,h=this.backlight.getOffset().start,d=this.backlight.getSize().width,v=0,g=0;if(this.hot.isRtl()){var p=this.hot.rootWindow,w=gt(this.hot.rootElement),S=p.innerWidth-o.rootElementOffset-w;g=p.innerWidth-o.target.eventPageX-S-(l.scrollX===void 0?s:0)}else g=o.target.eventPageX-(o.rootElementOffset-(l.scrollX===void 0?s:0));if(o.hasRowHeaders&&(v=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(o.hoveredColumn)&&(u+=s),u+=v,o.hoveredColumn<0)o.fixedColumnsStart>0?o.target.col=0:o.target.col=i>0?i-1:i;else if(o.target.TD.offsetWidth/2+u<=g){var C=o.hoveredColumn>=o.countCols?o.countCols-1:o.hoveredColumn;o.target.col=C+1,u+=o.target.TD.offsetWidth}else o.target.col=o.hoveredColumn;var P=g,R=u;g+d+h>=f?P=f-d-h:g+h<c+v&&(P=c+v+Math.abs(h)),u>=f-1?R=f-1:R===0?R=1:l.scrollX!==void 0&&o.hoveredColumn<o.fixedColumnsStart&&(R-=o.rootElementOffset<=l.scrollX?o.rootElementOffset:0),this.backlight.setPosition(null,P),this.guideline.setPosition(null,R)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt.wtTable,u=this.hot.selection.isSelectedByColumnHeader(),f=this.hot.getSelectedRangeLast(),c=Qo.get(this),h=De(o.target,"sortAction");if(!f||!u||c.pressed||o.button!==0||h){c.pressed=!1,c.columnsToMove.length=0,je(this.hot.rootElement,[AC,Iy]);return}var d=this.guideline.isBuilt()&&!this.guideline.isAppended(),v=this.backlight.isBuilt()&&!this.backlight.isAppended();d&&v&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));var g=f.from,p=f.to,w=Math.min(g.col,p.col),S=Math.max(g.col,p.col);if(i.row<0&&i.col>=w&&i.col<=S){l.column=!0,c.pressed=!0,c.target.eventPageX=o.pageX,c.target.eventOffsetX=o.offsetX,c.hoveredColumn=i.col,c.target.TD=a,c.target.col=i.col,c.columnsToMove=this.prepareColumnsToMoving(w,S),c.hasRowHeaders=!!this.hot.getSettings().rowHeaders,c.countCols=this.hot.countCols(),c.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,c.rootElementOffset=zt(this.hot.rootElement).left;var C=c.hasRowHeaders?-1:0,P=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,R=i.col<c.fixedColumnsStart,V=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),U=Math.abs(o.offsetX-(this.hot.isRtl()?o.target.offsetWidth:0)),X=this.getColumnsWidth(w,i.col-1)+U,Y=this.getColumnsWidth(C,w-1)+(R?V:0)+X;this.backlight.setPosition(P,Y),this.backlight.setSize(this.getColumnsWidth(w,S),s.hider.offsetHeight-P),this.backlight.setOffset(null,-X),re(this.hot.rootElement,AC)}else je(this.hot.rootElement,IC),c.pressed=!1,c.columnsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=Qo.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(a)})}i.target.eventPageX=o.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=Qo.get(this);!s||!u.pressed||(u.columnsToMove.indexOf(i.col)>-1?je(this.hot.rootElement,Iy):re(this.hot.rootElement,Iy),l.row=!0,l.column=!0,l.cell=!0,u.hoveredColumn=i.col,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=Qo.get(this),i=o.target.col,a=o.columnsToMove.length;if(o.hoveredColumn=void 0,o.pressed=!1,o.backlightWidth=0,je(this.hot.rootElement,[AC,Iy,IC]),this.hot.selection.isSelectedByColumnHeader()&&re(this.hot.rootElement,IC),!(a<1||i===void 0)){var l=o.columnsToMove[0],s=this.hot.toPhysicalColumn(l),u=this.dragColumns(o.columnsToMove,i);if(o.columnsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualColumn(s),c=f+a-1;this.hot.selectColumns(f,c)}}}},{key:"onAfterScrollVertically",value:function(){var o=this.hot.view._wt.wtTable,i=o.getColumnHeaderHeight(0)+1,a=o.holder.scrollTop,l=i+a;this.backlight.setPosition(l),this.backlight.setSize(null,o.hider.offsetHeight-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),ga(Oo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return $C}},{key:"PLUGIN_PRIORITY",get:function(){return hFe}}]),r}(ct);function Wu(e){"@babel/helpers - typeof";return Wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wu(e)}function vFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gFe(n.key),n)}}function yFe(e,t,r){return t&&qN(e.prototype,t),r&&qN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gFe(e){var t=mFe(e,"string");return Wu(t)==="symbol"?t:String(t)}function mFe(e,t){if(Wu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ma(){return typeof Reflect<"u"&&Reflect.get?ma=Reflect.get.bind():ma=function(t,r,n){var o=pFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ma.apply(this,arguments)}function pFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ro(e),e!==null););return e}function bFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nE(e,t)}function nE(e,t){return nE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},nE(e,t)}function wFe(e){var t=CFe();return function(){var n=Ro(e),o;if(t){var i=Ro(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return SFe(this,o)}}function SFe(e,t){if(t&&(Wu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oE(e)}function oE(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ro(e){return Ro=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ro(e)}var My="manualColumnResize",_Fe=130,XN="manualColumnWidths",MC=new WeakMap,OFe=function(e){bFe(r,e);var t=wFe(r);function r(n){var o;vFe(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentCol=null,o.selectedCols=[],o.currentWidth=null,o.newSize=null,o.startY=null,o.startWidth=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new It(oE(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.columnWidthsMap=void 0,MC.set(oE(o),{config:void 0}),re(o.handle,"manualColumnResizer"),re(o.guide,"manualColumnResizerGuide"),o}return yFe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[My]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnWidthsMap=new ki,this.columnWidthsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(i,a){return o.onModifyColWidth(i,a)}),this.addHook("beforeStretchingColumnWidth",function(i,a){return o.onBeforeStretchingColumnWidth(i,a)}),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),this.bindEvents(),ma(Ro(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ma(Ro(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=MC.get(this);o.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),ma(Ro(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",XN,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",XN,o),o.value}},{key:"setManualSize",value:function(o,i){var a=Math.max(i,20),l=this.hot.toPhysicalColumn(o);return this.columnWidthsMap.setValueAtIndex(l,a),a}},{key:"clearManualSize",value:function(o){var i=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(i,null)}},{key:"onMapInit",value:function(){var o=this,i=MC.get(this),a=this.hot.getSettings()[My],l=this.loadManualColumnWidths();typeof l<"u"?this.hot.batchExecution(function(){l.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0):Array.isArray(a)?(this.hot.batchExecution(function(){a.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0),i.config=a):a===!0&&Array.isArray(i.config)&&this.hot.batchExecution(function(){i.config.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0)}},{key:"setupHandlePosition",value:function(o){var i=this;if(o.parentNode){this.currentTH=o;var a=this.hot.view._wt,l=a.wtTable.getCoords(this.currentTH),s=l.col;if(!(s<0)){var u=$t(this.currentTH),f=this.currentTH.getBoundingClientRect(),c=s<a.getSetting("fixedColumnsStart"),h;c&&(h=a.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),h||(h=a.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s),this.selectedCols=[];var d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){var v=this.hot.getSelectedRange();I(v,function(g){var p=g.getTopStartCorner().col,w=g.getBottomEndCorner().col;Re(p,w,function(S){i.selectedCols.includes(S)||i.selectedCols.push(S)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=h.start-6,this.startWidth=parseInt(f.width,10),this.handle.style.top="".concat(h.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt($t(this.handle),10),i=parseInt(this.handle.style.top,10)+o,a=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);re(this.handle,"active"),re(this.guide,"active"),this.guide.style.top="".concat(i,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){je(this.handle,"active"),je(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(o){return!!ka(o,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"onMouseOver",value:function(o){if(!BB(o.target)&&this.checkIfColumnHeader(o.target)){var i=this.getClosestTHParent(o.target);if(!i)return;var a=i.getAttribute("colspan");i&&(a===null||a==="1")&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeColumnResize",o.newSize,u,!0);c!==void 0&&(o.newSize=c),o.hot.getSettings().stretchH==="all"?o.clearManualSize(u):o.setManualSize(u,o.newSize),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!0),f&&i()};if(this.dblclick>=2){var l=this.selectedCols.length;l>1?(I(this.selectedCols,function(s){a(s)}),i()):I(this.selectedCols,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;De(o.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=o.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(o){var i=this;if(this.pressed){var a=(o.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+a,I(this.selectedCols,function(l){i.newSize=i.setManualSize(l,i.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeColumnResize",o.newSize,u,!1),f&&i(),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var l=this.selectedCols.length;l>1?(I(this.selectedCols,function(s){a(s)}),i()):I(this.selectedCols,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootWindow,l=i.rootElement;this.eventManager.addEventListener(l,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(l,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(a,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(a,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyColWidth",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalColumn(i),s=this.columnWidthsMap.getValueAtIndex(l);this.hot.getSettings()[My]&&s&&(a=s)}return a}},{key:"onBeforeStretchingColumnWidth",value:function(o,i){var a=this.columnWidthsMap.getValueAtIndex(i);return a===null&&(a=o),a}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){ma(Ro(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return My}},{key:"PLUGIN_PRIORITY",get:function(){return _Fe}}]),r}(ct);function Sd(e){"@babel/helpers - typeof";return Sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sd(e)}function RFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TFe(n.key),n)}}function EFe(e,t,r){return t&&ZN(e.prototype,t),r&&ZN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function TFe(e){var t=PFe(e,"string");return Sd(t)==="symbol"?t:String(t)}function PFe(e,t){if(Sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xC=0,JN=1,QN=2,Il="px",kFe=function(){function e(t){RFe(this,e),this.hot=t,this._element=null,this.state=xC}return EFe(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=QN}},{key:"build",value:function(){this.state===xC&&(this._element=this.hot.rootDocument.createElement("div"),this.state=JN)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=xC}},{key:"isAppended",value:function(){return this.state===QN}},{key:"isBuilt",value:function(){return this.state>=JN}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+Il),n!==void 0&&(this._element.style.left=n+Il)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+Il),n&&(this._element.style.height=n+Il)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+Il),n&&(this._element.style.marginLeft=n+Il)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();const WU=kFe;function Uu(e){"@babel/helpers - typeof";return Uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uu(e)}function $Fe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IFe(n.key),n)}}function AFe(e,t,r){return t&&eH(e.prototype,t),r&&eH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function IFe(e){var t=MFe(e,"string");return Uu(t)==="symbol"?t:String(t)}function MFe(e,t){if(Uu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _g(){return typeof Reflect<"u"&&Reflect.get?_g=Reflect.get.bind():_g=function(t,r,n){var o=xFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_g.apply(this,arguments)}function xFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=zu(e),e!==null););return e}function DFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iE(e,t)}function iE(e,t){return iE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},iE(e,t)}function NFe(e){var t=jFe();return function(){var n=zu(e),o;if(t){var i=zu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return HFe(this,o)}}function HFe(e,t){if(t&&(Uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LFe(e)}function LFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zu(e){return zu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zu(e)}var FFe="ht__manualRowMove--backlight",BFe=function(e){DFe(r,e);var t=NFe(r);function r(){return $Fe(this,r),t.apply(this,arguments)}return AFe(r,[{key:"build",value:function(){_g(zu(r.prototype),"build",this).call(this),re(this._element,FFe)}}]),r}(WU);const VFe=BFe;function Yu(e){"@babel/helpers - typeof";return Yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yu(e)}function WFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zFe(n.key),n)}}function UFe(e,t,r){return t&&tH(e.prototype,t),r&&tH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zFe(e){var t=YFe(e,"string");return Yu(t)==="symbol"?t:String(t)}function YFe(e,t){if(Yu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Og(){return typeof Reflect<"u"&&Reflect.get?Og=Reflect.get.bind():Og=function(t,r,n){var o=GFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Og.apply(this,arguments)}function GFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Gu(e),e!==null););return e}function KFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aE(e,t)}function aE(e,t){return aE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},aE(e,t)}function qFe(e){var t=JFe();return function(){var n=Gu(e),o;if(t){var i=Gu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return XFe(this,o)}}function XFe(e,t){if(t&&(Yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZFe(e)}function ZFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gu(e){return Gu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gu(e)}var QFe="ht__manualRowMove--guideline",eBe=function(e){KFe(r,e);var t=qFe(r);function r(){return WFe(this,r),t.apply(this,arguments)}return UFe(r,[{key:"build",value:function(){Og(Gu(r.prototype),"build",this).call(this),re(this._element,QFe)}}]),r}(WU);const tBe=eBe;function Ku(e){"@babel/helpers - typeof";return Ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ku(e)}function rBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oBe(n.key),n)}}function nBe(e,t,r){return t&&rH(e.prototype,t),r&&rH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oBe(e){var t=iBe(e,"string");return Ku(t)==="symbol"?t:String(t)}function iBe(e,t){if(Ku(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ku(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pa(){return typeof Reflect<"u"&&Reflect.get?pa=Reflect.get.bind():pa=function(t,r,n){var o=aBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},pa.apply(this,arguments)}function aBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Eo(e),e!==null););return e}function lBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lE(e,t)}function lE(e,t){return lE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},lE(e,t)}function sBe(e){var t=fBe();return function(){var n=Eo(e),o;if(t){var i=Eo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return uBe(this,o)}}function uBe(e,t){if(t&&(Ku(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sE(e)}function sE(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eo(e){return Eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Eo(e)}be.getSingleton().register("beforeRowMove");be.getSingleton().register("afterRowMove");var DC="manualRowMove",cBe=140,ei=new WeakMap,nH="ht__manualRowMove",xy="show-ui",NC="on-moving--rows",HC="after-selection--rows",hBe=function(e){lBe(r,e);var t=sBe(r);function r(n){var o;return rBe(this,r),o=t.call(this,n),ei.set(sE(o),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),o.eventManager=new It(sE(o)),o.backlight=new VFe(n),o.guideline=new tBe(n),o}return nBe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[DC]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollHorizontally",function(){return o.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),re(this.hot.rootElement,nH),pa(Eo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),pa(Eo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){je(this.hot.rootElement,nH),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),pa(Eo(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(o,i){return this.moveRows([o],i)}},{key:"moveRows",value:function(o,i){var a=ei.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeRowMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.rowIndexMapper.moveIndexes(o,i);var f=s&&this.isRowOrderChanged(o,i);return this.hot.runHooks("afterRowMove",o,i,l,s,f),f}}},{key:"dragRow",value:function(o,i){return this.dragRows([o],i)}},{key:"dragRows",value:function(o,i){var a=this.countFinalIndex(o,i),l=ei.get(this);return l.cachedDropIndex=i,this.moveRows(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(l||s||u||f)}},{key:"isRowOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=ar(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getRowsHeight",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=0,s=o;s<=i;s++){var u=a.getRenderableFromVisualIndex(s);u!==null&&(l+=this.hot.view._wt.wtTable.getRowHeight(u)||23)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[DC];if(Array.isArray(o))this.moveRows(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveRows(i,0)}}},{key:"isFixedRowTop",value:function(o){return o<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(o){return o>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualRowMove",o),o.value?o.value:[]}},{key:"prepareRowsToMoving",value:function(){var o=this.hot.getSelectedRangeLast(),i=[];if(!o)return i;var a=o.from,l=o.to,s=Math.min(a.row,l.row),u=Math.max(a.row,l.row);return Re(s,u,function(f){i.push(f)}),i}},{key:"refreshPositions",value:function(){var o=ei.get(this),i=o.target.coords,a=this.hot.view.getFirstFullyVisibleRow(),l=this.hot.view.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(i.row)&&a>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(a-1,-1)),this.isFixedRowBottom(i.row)&&l<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(l+1,1),void 0,!0);var u=this.hot.view._wt.wtTable,f=o.target.TD,c=this.hot.rootElement,h=zt(c),d=fs(c),v=u.holder.scrollTop,g;this.hot.rootWindow===d?g=d.scrollY:g=d.scrollTop;var p=h.top-g,w=o.target.eventPageY-p+v,S=u.hider.offsetHeight,C=u.TBODY.offsetTop,P=this.backlight.getOffset().top,R=this.backlight.getSize().height,V=f.offsetHeight/2,U=f.offsetHeight,X=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,i.row-1),Y=w>=X+V;this.isFixedRowTop(i.row)&&(X+=u.holder.scrollTop),i.row<0?o.target.row=a>0?a-1:a:Y?(o.target.row=i.row+1,X+=i.row===0?U-1:U):o.target.row=i.row;var q=w,Z=X;w+R+P>=S?q=S-R-P:w+P<C&&(q=C+Math.abs(P)),X>=S-1&&(Z=S-1),this.backlight.setPosition(q),this.guideline.setPosition(Z)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt,u=s.wtTable,f=s.wtViewport,c=this.hot.selection.isSelectedByRowHeader(),h=this.hot.getSelectedRangeLast(),d=ei.get(this);if(!h||!c||d.pressed||o.button!==0){d.pressed=!1,d.rowsToMove.length=0,je(this.hot.rootElement,[NC,xy]);return}var v=this.guideline.isBuilt()&&!this.guideline.isAppended(),g=this.backlight.isBuilt()&&!this.backlight.isAppended();v&&g&&(this.guideline.appendTo(u.hider),this.backlight.appendTo(u.hider));var p=h.from,w=h.to,S=Math.min(p.row,w.row),C=Math.max(p.row,w.row);if(i.col<0&&i.row>=S&&i.row<=C){l.row=!0,d.pressed=!0,d.target.eventPageY=o.pageY,d.target.coords=i,d.target.TD=a,d.rowsToMove=this.prepareRowsToMoving();var P=u.holder.scrollLeft+f.getRowHeaderWidth();this.backlight.setPosition(null,P),this.backlight.setSize(u.hider.offsetWidth-P,this.getRowsHeight(S,C)),this.backlight.setOffset((this.getRowsHeight(S,i.row-1)+o.offsetY)*-1,null),re(this.hot.rootElement,NC),this.refreshPositions()}else je(this.hot.rootElement,HC),d.pressed=!1,d.rowsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=ei.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,a)})}i.target.eventPageY=o.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=ei.get(this);!s||!u.pressed||(u.rowsToMove.indexOf(i.row)>-1?je(this.hot.rootElement,xy):re(this.hot.rootElement,xy),l.row=!0,l.column=!0,l.cell=!0,u.target.coords=i,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=ei.get(this),i=o.target.row,a=o.rowsToMove.length;if(o.pressed=!1,o.backlightHeight=0,je(this.hot.rootElement,[NC,xy,HC]),this.hot.selection.isSelectedByRowHeader()&&re(this.hot.rootElement,HC),!(a<1||i===void 0)){var l=o.rowsToMove[0],s=this.hot.toPhysicalRow(l),u=this.dragRows(o.rowsToMove,i);if(o.rowsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualRow(s),c=f+a-1;this.hot.selectRows(f,c)}}}},{key:"onAfterScrollHorizontally",value:function(){var o=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtViewport.getRowHeaderWidth(),a=o.holder.scrollLeft,l=i+a;this.backlight.setPosition(null,l),this.backlight.setSize(o.hider.offsetWidth-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),pa(Eo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return DC}},{key:"PLUGIN_PRIORITY",get:function(){return cBe}}]),r}(ct);function qu(e){"@babel/helpers - typeof";return qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qu(e)}function dBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yBe(n.key),n)}}function vBe(e,t,r){return t&&oH(e.prototype,t),r&&oH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yBe(e){var t=gBe(e,"string");return qu(t)==="symbol"?t:String(t)}function gBe(e,t){if(qu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ba(){return typeof Reflect<"u"&&Reflect.get?ba=Reflect.get.bind():ba=function(t,r,n){var o=mBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ba.apply(this,arguments)}function mBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=To(e),e!==null););return e}function pBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uE(e,t)}function uE(e,t){return uE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},uE(e,t)}function bBe(e){var t=SBe();return function(){var n=To(e),o;if(t){var i=To(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return wBe(this,o)}}function wBe(e,t){if(t&&(qu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fE(e)}function fE(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function To(e){return To=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},To(e)}var Dy="manualRowResize",CBe=30,iH="manualRowHeights",LC=new WeakMap,_Be=function(e){pBe(r,e);var t=bBe(r);function r(n){var o;dBe(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentRow=null,o.selectedRows=[],o.currentHeight=null,o.newSize=null,o.startY=null,o.startHeight=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new It(fE(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.rowHeightsMap=void 0,LC.set(fE(o),{config:void 0}),re(o.handle,"manualRowResizer"),re(o.guide,"manualRowResizerGuide"),o}return vBe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[Dy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.rowHeightsMap=new ki,this.rowHeightsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(i,a){return o.onModifyRowHeight(i,a)}),this.bindEvents(),ba(To(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ba(To(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=LC.get(this);o.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),ba(To(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",iH,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",iH,o),o.value}},{key:"setManualSize",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=Math.max(i,pV.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(a,l),l}},{key:"setupHandlePosition",value:function(o){var i=this;this.currentTH=o;var a=this.hot.view,l=a._wt,s=l.wtTable.getCoords(this.currentTH),u=s.row;if(!(u<0)){var f=gt(this.currentTH),c=this.currentTH.getBoundingClientRect(),h=u<l.getSetting("fixedRowsTop"),d=u>=a.countNotHiddenRowIndexes(0,1)-l.getSetting("fixedRowsBottom"),v;h?v=l.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col):d&&(v=l.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),v||(v=l.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.selectedRows=[];var g=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&g){var p=this.hot.getSelectedRange();I(p,function(w){var S=w.getTopStartCorner().row,C=w.getBottomStartCorner().row;Re(S,C,function(P){i.selectedRows.includes(P)||i.selectedRows.push(P)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=v.top-6,this.startHeight=parseInt(c.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(v.start,"px"),this.handle.style.width="".concat(f,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(gt(this.handle),10),i=parseInt(this.handle.style[this.inlineDir],10)+o,a=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);re(this.handle,"active"),re(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(i,"px"),this.guide.style.width="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){je(this.handle,"active"),je(this.guide,"active")}},{key:"checkIfRowHeader",value:function(o){var i,a,l=ka(o,["TH"],this.hot.rootElement);return l&&((i=o.parentNode)===null||i===void 0||(a=i.parentNode)===null||a===void 0?void 0:a.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"getActualRowHeight",value:function(o){var i=this.hot.view._wt.wtTable.getRowHeight(o);return i!==void 0&&this.newSize<i?i:this.newSize}},{key:"onMouseOver",value:function(o){if(!BB(o.target)&&this.checkIfRowHeader(o.target)){var i=this.getClosestTHParent(o.target);i&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!0);c!==void 0&&(o.newSize=c),o.setManualSize(u,o.newSize),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!0),f&&i()};if(this.dblclick>=2){var l=this.selectedRows.length;l>1?(I(this.selectedRows,function(s){a(s)}),i()):I(this.selectedRows,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;De(o.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=o.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(o){var i=this;this.pressed&&(this.currentHeight=this.startHeight+(o.pageY-this.startY),I(this.selectedRows,function(a){i.newSize=i.setManualSize(a,i.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!1),f&&i(),o.saveManualRowHeights(),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var l=this.selectedRows.length;l>1?(I(this.selectedRows,function(s){a(s)}),i()):I(this.selectedRows,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootElement,l=i.rootWindow;this.eventManager.addEventListener(a,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(a,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(l,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(l,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyRowHeight",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalRow(i),s=this.rowHeightsMap.getValueAtIndex(l);this.hot.getSettings()[Dy]&&s&&(a=s)}return a}},{key:"onMapInit",value:function(){var o=this,i=LC.get(this),a=this.hot.getSettings()[Dy],l=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof l<"u"?l.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}):Array.isArray(a)?(a.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}),i.config=a):a===!0&&Array.isArray(i.config)&&i.config.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)})},!0)}},{key:"destroy",value:function(){ba(To(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Dy}},{key:"PLUGIN_PRIORITY",get:function(){return CBe}}]),r}(ct);function Cd(e){"@babel/helpers - typeof";return Cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cd(e)}var aH,lH,sH,uH;function Ny(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function OBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EBe(n.key),n)}}function RBe(e,t,r){return t&&fH(e.prototype,t),r&&fH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EBe(e){var t=TBe(e,"string");return Cd(t)==="symbol"?t:String(t)}function TBe(e,t){if(Cd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PBe=function(){function e(t,r,n,o,i,a){OBe(this,e),this.row=t,this.col=r,this.rowspan=n,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=a}return RBe(e,[{key:"normalize",value:function(r){var n=r.countRows(),o=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>o-1&&(this.col=o-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>o-1&&(this.colspan=o-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var o=r[0]||r[1],i=n+Math.abs(r[0]||r[1])-1,a=r[0]?"colspan":"rowspan",l=r[0]?"col":"row",s=Math.min(n,i),u=Math.max(n,i),f=this[l],c=this[l]+this[a]-1;if(f>=n&&(this[l]+=o),o>0)n<=c&&n>f&&(this[a]+=o);else if(o<0){if(s<=f&&u>=c)return this.removed=!0,!1;if(f>=s&&f<=u){var h=u-f+1,d=Math.abs(o)-h;this[l]-=d+o,this[a]-=h}else if(f<=s&&c>=u)this[a]+=o;else if(f<=s&&c>=s&&c<u){var v=c-s+1;this[a]-=v}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return ft(aH||(aH=Ny(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return ft(lH||(lH=Ny(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return ft(sH||(sH=Ny(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return ft(uH||(uH=Ny(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,o){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=o||r.col+r.colspan-1>=o}}]),e}();const kn=PBe;function cE(e,t,r,n){t?t.row===r&&t.col===n?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function _d(e){"@babel/helpers - typeof";return _d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_d(e)}var cH;function kBe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function hH(e){return MBe(e)||IBe(e)||ABe(e)||$Be()}function $Be(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ABe(e,t){if(e){if(typeof e=="string")return hE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hE(e,t)}}function IBe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function MBe(e){if(Array.isArray(e))return hE(e)}function hE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NBe(n.key),n)}}function DBe(e,t,r){return t&&dH(e.prototype,t),r&&dH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NBe(e){var t=HBe(e,"string");return _d(t)==="symbol"?t:String(t)}function HBe(e,t){if(_d(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LBe=function(){function e(t){xBe(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return DBe(e,[{key:"get",value:function(r,n){var o=this.mergedCells,i=!1;return I(o,function(a){return a.row<=r&&a.row+a.rowspan-1>=r&&a.col<=n&&a.col+a.colspan-1>=n?(i=a,!1):!0}),i}},{key:"getByRange",value:function(r){var n=this.mergedCells,o=!1;return I(n,function(i){return i.row<=r.from.row&&i.row+i.rowspan-1>=r.to.row&&i.col<=r.from.col&&i.col+i.colspan-1>=r.to.col?(o=i,o):!0}),o}},{key:"getWithinRange",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.mergedCells,a=[],l=r;if(!l.includesRange){var s=this.hot._createCellCoords(l.from.row,l.from.col),u=this.hot._createCellCoords(l.to.row,l.to.col);l=this.hot._createCellRange(s,s,u)}return I(i,function(f){var c=n.hot._createCellCoords(f.row,f.col),h=n.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=n.hot._createCellRange(c,c,h);o?l.overlaps(d)&&a.push(f):l.includesRange(d)&&a.push(f)}),a.length?a:!1}},{key:"add",value:function(r){var n=this.mergedCells,o=r.row,i=r.col,a=r.rowspan,l=r.colspan,s=new kn(o,i,a,l,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(o,i),f=this.isOverlapping(s);return!u&&!f?(this.hot&&s.normalize(this.hot),n.push(s),s):(dt(e.IS_OVERLAPPING_WARNING(s)),!1)}},{key:"remove",value:function(r,n){var o=this.mergedCells,i=this.get(r,n),a=i?this.mergedCells.indexOf(i):-1;return i&&a!==-1?(o.splice(a,1),i):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,o=[],i=[];I(n,function(a){var l=r.hot.getCell(a.row,a.col);l&&o.push([l,r.get(a.row,a.col),a.row,a.col])}),this.mergedCells.length=0,I(o,function(a,l){Re(0,a.rowspan-1,function(s){Re(0,a.colspan-1,function(u){if(u!==0||s!==0){var f=r.hot.getCell(a.row+s,a.col+u);f&&i.push([f,null,null,null])}})}),o[l][1]=null}),I(o,function(a){cE.apply(void 0,hH(a))}),I(i,function(a){cE.apply(void 0,hH(a))})}},{key:"isOverlapping",value:function(r){var n=this,o=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(r.row,r.col),this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1)),i=!1;return I(this.mergedCells,function(a){var l=n.hot._createCellRange(n.hot._createCellCoords(0,0),n.hot._createCellCoords(a.row,a.col),n.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1));return l.overlaps(o)?(i=!0,!1):!0}),i}},{key:"isFirstRenderableMergedCell",value:function(r,n){var o=this.get(r,n);return o&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var o=this.get(r,n);if(!o||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);var i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1),a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1);return this.hot._createCellCoords(i,a)}},{key:"shiftCollections",value:function(r,n,o){var i=this,a=[0,0];switch(r){case"right":a[0]+=o;break;case"left":a[0]-=o;break;case"down":a[1]+=o;break;case"up":a[1]-=o;break}I(this.mergedCells,function(l){l.shift(a,n)}),Y_(this.mergedCells.length-1,0,function(l){var s=i.mergedCells[l];s&&s.removed&&i.mergedCells.splice(i.mergedCells.indexOf(s),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return ft(cH||(cH=kBe(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),e}();const jBe=LBe;function Od(e){"@babel/helpers - typeof";return Od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Od(e)}function Gi(e,t){return WBe(e)||VBe(e,t)||BBe(e,t)||FBe()}function FBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BBe(e,t){if(e){if(typeof e=="string")return vH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vH(e,t)}}function vH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function VBe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function WBe(e){if(Array.isArray(e))return e}function UBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YBe(n.key),n)}}function zBe(e,t,r){return t&&yH(e.prototype,t),r&&yH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YBe(e){var t=GBe(e,"string");return Od(t)==="symbol"?t:String(t)}function GBe(e,t){if(Od(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var KBe=function(){function e(t){UBe(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return zBe(e,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var o=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?o="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?o="up":n[1]===r[1]&&n[2]===r[2]?o="right":o="left",o}},{key:"snapDragArea",value:function(r,n,o,i){var a=n.slice(0),l=this.getAutofillSize(r,n,o),s=Gi(r,4),u=s[0],f=s[1],c=s[2],h=s[3],d=["up","down"].indexOf(o)>-1,v=d?c-u+1:h-f+1,g=Math.floor(l/v)*v,p=l-g,w=this.getFarthestCollection(r,n,o,i);if(w){if(o==="down"){var S=w.row+w.rowspan-u-p,C=a[2]+S;C>=this.plugin.hot.countRows()?a[2]-=p:a[2]+=p?S:0}else if(o==="right"){var P=w.col+w.colspan-f-p,R=a[3]+P;R>=this.plugin.hot.countCols()?a[3]-=p:a[3]+=p?P:0}else if(o==="up"){var V=c-p-w.row+1,U=a[0]+V;U<0?a[0]+=p:a[0]-=p?V:0}else if(o==="left"){var X=h-p-w.col+1,Y=a[1]+X;Y<0?a[1]+=p:a[1]-=p?X:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:o,foundMergedCells:i,fillSize:l,dragArea:a,cycleLength:v}),a}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),Yt(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,o){var i=Gi(r,4),a=i[0],l=i[1],s=i[2],u=i[3],f=Gi(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return a-c;case"down":return d-s;case"left":return l-h;case"right":return v-u;default:return null}}},{key:"getDragArea",value:function(r,n,o){var i=Gi(r,4),a=i[0],l=i[1],s=i[2],u=i[3],f=Gi(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return[c,h,a-1,u];case"down":return[s+1,l,d,u];case"left":return[c,h,s,l-1];case"right":return[a,u+1,d,v];default:return null}}},{key:"getFarthestCollection",value:function(r,n,o,i){var a=Gi(r,4),l=a[0],s=a[1],u=a[2],f=a[3],c=["up","down"].indexOf(o)>-1,h=c?u:f,d=c?l:s,v=this.getAutofillSize(r,n,o),g=c?u-l+1:f-s+1,p=Math.floor(v/g)*g,w=v-p,S=null,C=null,P=null;switch(o){case"up":S="includesVertically",P=h-w+1;break;case"left":S="includesHorizontally",P=h-w+1;break;case"down":S="includesVertically",P=d+w-1;break;case"right":S="includesHorizontally",P=d+w-1;break}return I(i,function(R){R[S](P)&&R.isFarther(C,o)&&(C=R)}),C}},{key:"recreateAfterDataPopulation",value:function(r){if(this.currentFillData){var n=this.getRangeFromChanges(r),o=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,a=function(h,d){switch(i){case"up":return h.row-d>=n.from.row;case"down":return h.row+h.rowspan-1+d<=n.to.row;case"left":return h.col-d>=n.from.column;case"right":return h.col+h.colspan-1+d<=n.to.column;default:return null}},l=0,s=null,u=1;do for(var f=0;f<o.length;f+=1){if(s=o[f],l=u*this.currentFillData.cycleLength,a(s,l))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:s.row-l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-l,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+l,colspan:s.colspan});break}f===o.length-1&&(u+=1)}while(a(s,l));this.currentFillData=null,this.plugin.hot.render(),o.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(r){var n=this,o={min:null,max:null},i={min:null,max:null};return I(r,function(a){var l=a[0],s=n.plugin.hot.propToCol(a[1]);(o.min===null||l<o.min)&&(o.min=l),(o.max===null||l>o.max)&&(o.max=l),(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s)}),{from:{row:o.min,column:i.min},to:{row:o.max,column:i.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,o){var i=this.getDragArea(r,n,o),a=Gi(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.plugin.hot._createCellCoords(l,s),h=this.plugin.hot._createCellCoords(u,f),d=this.plugin.hot._createCellRange(c,c,h);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}]),e}();const qBe=KBe;function Rd(e){"@babel/helpers - typeof";return Rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rd(e)}function XBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JBe(n.key),n)}}function ZBe(e,t,r){return t&&gH(e.prototype,t),r&&gH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JBe(e){var t=QBe(e,"string");return Rd(t)==="symbol"?t:String(t)}function QBe(e,t){if(Rd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eVe=function(){function e(t){XBe(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return ZBe(e,[{key:"snapDelta",value:function(r,n,o){var i=n.to,a=i.row+r.row,l=i.col+r.col;r.row?this.jumpOverMergedCell(r,o,a):r.col&&this.jumpOverMergedCell(r,o,l)}},{key:"jumpOverMergedCell",value:function(r,n,o){var i=r.row||r.col,a=null,l=null,s=null;r.row?(a=n.includesVertically(o),l=n.row,s=n.getLastRow()):r.col&&(a=n.includesHorizontally(o),l=n.col,s=n.getLastColumn()),i!==0&&(i>0?a&&o!==l&&(i+=s-o+1):a&&o!==s&&(i-=o-l+1),r.row?r.row=i:r.col&&(r.col=i))}},{key:"getUpdatedSelectionRange",value:function(r,n){return this.hot._createCellRange(r.highlight,r.from,this.hot._createCellCoords(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,o,i){var a=Math.min(o[0],o[2]),l=Math.min(o[1],o[3]),s=Math.max(o[0],o[2]),u=Math.max(o[1],o[3]);if(i!==void 0){var f=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(f){var c=this.plugin.mergedCellsCollection.get(r,n);if(c){var h=c.getLastRow(),d=c.getLastColumn(),v=a<=c.row&&l<=c.col&&s>=h&&u>=d;if(v)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(i);if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var o=[];if(!n||!r)return!1;for(var i=0;i<r.rowspan;i+=1)for(var a=0;a<r.colspan;a+=1)o.push(this.hot._createCellCoords(r.row+i,r.col+a));for(var l=0;l<o.length;l+=1){for(var s=[],u=0;u<n.length;u+=1)s[u]=n[u].includes(o[l]);if(!s.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),e}();const tVe=eVe;function rVe(e){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=e.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(Yp)}return this.getTranslatedPhrase(zp)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=kn.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function Xu(e){"@babel/helpers - typeof";return Xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xu(e)}function nVe(e,t){return aVe(e)||iVe(e,t)||UU(e,t)||oVe()}function oVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iVe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function aVe(e){if(Array.isArray(e))return e}function lVe(e){return fVe(e)||uVe(e)||UU(e)||sVe()}function sVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UU(e,t){if(e){if(typeof e=="string")return dE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dE(e,t)}}function uVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fVe(e){if(Array.isArray(e))return dE(e)}function dE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dVe(n.key),n)}}function hVe(e,t,r){return t&&mH(e.prototype,t),r&&mH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dVe(e){var t=vVe(e,"string");return Xu(t)==="symbol"?t:String(t)}function vVe(e,t){if(Xu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ns(){return typeof Reflect<"u"&&Reflect.get?ns=Reflect.get.bind():ns=function(t,r,n){var o=yVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ns.apply(this,arguments)}function yVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Si(e),e!==null););return e}function gVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vE(e,t)}function vE(e,t){return vE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},vE(e,t)}function mVe(e){var t=bVe();return function(){var n=Si(e),o;if(t){var i=Si(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return pVe(this,o)}}function pVe(e,t){if(t&&(Xu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zU(e)}function zU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Si(e){return Si=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Si(e)}be.getSingleton().register("beforeMergeCells");be.getSingleton().register("afterMergeCells");be.getSingleton().register("beforeUnmergeCells");be.getSingleton().register("afterUnmergeCells");var fc="mergeCells",wVe=150,pH=new WeakMap,bH=fc,SVe=function(e){gVe(r,e);var t=mVe(r);function r(n){var o;return cVe(this,r),o=t.call(this,n),pH.set(zU(o),{lastDesiredCoords:null}),o.mergedCellsCollection=null,o.autofillCalculations=null,o.selectionCalculations=null,o}return hVe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[fc]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mergedCellsCollection=new jBe(this),this.autofillCalculations=new qBe(this),this.selectionCalculations=new tVe(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("modifyTransformStart",function(){return o.onModifyTransformStart.apply(o,arguments)}),this.addHook("afterModifyTransformStart",function(){return o.onAfterModifyTransformStart.apply(o,arguments)}),this.addHook("modifyTransformEnd",function(){return o.onModifyTransformEnd.apply(o,arguments)}),this.addHook("modifyGetCellCoords",function(){return o.onModifyGetCellCoords.apply(o,arguments)}),this.addHook("beforeSetRangeStart",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeEnd",function(){return o.onBeforeSetRangeEnd.apply(o,arguments)}),this.addHook("afterIsMultipleSelection",function(){return o.onAfterIsMultipleSelection.apply(o,arguments)}),this.addHook("afterRenderer",function(){return o.onAfterRenderer.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.addMergeActionsToContextMenu.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(){return o.onAfterGetCellMeta.apply(o,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return o.onAfterViewportRowCalculatorOverride.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),this.addHook("modifyAutofillRange",function(){return o.onModifyAutofillRange.apply(o,arguments)}),this.addHook("afterCreateCol",function(){return o.onAfterCreateCol.apply(o,arguments)}),this.addHook("afterRemoveCol",function(){return o.onAfterRemoveCol.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeDrawBorders",function(){return o.onBeforeDrawAreaBorders.apply(o,arguments)}),this.addHook("afterDrawSelection",function(){return o.onAfterDrawSelection.apply(o,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return o.onBeforeRemoveCellClassNames.apply(o,arguments)}),this.addHook("beforeUndoStackChange",function(i,a){if(a==="MergeCells")return!1}),this.registerShortcuts(),ns(Si(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),ns(Si(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var o=this.hot.getSettings()[fc];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(o),ns(Si(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var o=this;if(jF()){var i=[],a=[];this.mergedCellsCollection.mergedCells.forEach(function(l){for(var s=l.row,u=l.rowspan,f=s+1;f<s+u;f++)a.push(f)}),a=lVe(new Set(a)),a.forEach(function(l){var s=o.hot.rowIndexMapper.getRenderableFromVisualIndex(l);o.hot.view._wt.wtOverlays.getOverlays(!0).map(function(u){return(u==null?void 0:u.name)==="master"?u:u.clone.wtTable}).forEach(function(u){var f=u.getRow(s);f&&(f.style.background=Nc(f,"backgroundColor").replace(")",", 0.99)"),i.push(f))})}),this.hot._registerTimeout(function(){i.forEach(function(l){l.style.background=Nc(l,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(o){var i=!0;return o?(kn.containsNegativeValues(o)?(dt(kn.NEGATIVE_VALUES_WARNING(o)),i=!1):kn.isOutOfBounds(o,this.hot.countRows(),this.hot.countCols())?(dt(kn.IS_OUT_OF_BOUNDS_WARNING(o)),i=!1):kn.isSingleCell(o)?(dt(kn.IS_SINGLE_CELL(o)),i=!1):kn.containsZeroSpan(o)&&(dt(kn.ZERO_SPAN_WARNING(o)),i=!1),i):!1}},{key:"generateFromSettings",value:function(o){var i=this;if(Array.isArray(o)){var a=[];if(I(o,function(l){if(i.validateSetting(l)){var s=i.hot._createCellCoords(l.row,l.col),u=i.hot._createCellCoords(l.row+l.rowspan-1,l.col+l.colspan-1),f=i.hot._createCellRange(s,s,u);i.mergeRange(f,!0,!0),Re(l.row,l.row+l.rowspan-1,function(c){Re(l.col,l.col+l.colspan-1,function(h){c===l.row&&h===l.col||a.push([c,h,null])})})}}),a.length===0)return;this.hot.setDataAtCell(a)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return i?!0:this.validateSetting(o)}},{key:"toggleMergeOnSelection",value:function(){var o=this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.toggleMerge(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.unmergeRange(o,!0),this.mergeRange(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"unmergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){var i=o.from,a=o.to;this.unmergeRange(o,!0),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=o.getTopStartCorner(),u=o.getBottomEndCorner(),f={row:s.row,col:s.col,rowspan:u.row-s.row+1,colspan:u.col-s.col+1},c=[],h=null;if(!this.canMergeRange(f,a))return!1;this.hot.runHooks("beforeMergeCells",o,a),Re(0,f.rowspan-1,function(v){Re(0,f.colspan-1,function(g){var p=null;c[v]||(c[v]=[]),v===0&&g===0?p=i.hot.getSourceDataAtCell(i.hot.toPhysicalRow(f.row),i.hot.toPhysicalColumn(f.col)):i.hot.setCellMeta(f.row+v,f.col+g,"hidden",!0),c[v][g]=p})}),this.hot.setCellMeta(f.row,f.col,"spanned",!0);var d=this.mergedCellsCollection.add(f);return d?(l?h=[f.row,f.col,c]:this.hot.populateFromArray(f.row,f.col,c,void 0,void 0,this.pluginName),a||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",o,f,a),h):!0}},{key:"unmergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=this.mergedCellsCollection.getWithinRange(o);l&&(this.hot.runHooks("beforeUnmergeCells",o,a),I(l,function(s){i.mergedCellsCollection.remove(s.row,s.col),Re(0,s.rowspan-1,function(u){Re(0,s.colspan-1,function(f){i.hot.removeCellMeta(s.row+u,s.col+f,"hidden")})}),i.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",o,a),this.hot.render())}},{key:"toggleMerge",value:function(o){var i=this.mergedCellsCollection.get(o.from.row,o.from.col),a=i.row===o.from.row&&i.col===o.from.col&&i.row+i.rowspan-1===o.to.row&&i.col+i.colspan-1===o.to.col;a?this.unmergeRange(o):this.mergeSelection(o)}},{key:"merge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.mergeRange(this.hot._createCellRange(s,s,u))}},{key:"unmerge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.unmergeRange(this.hot._createCellRange(s,s,u))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[fc]),this.hot.render()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("grid");a.addShortcut({keys:[["Control","m"]],callback:function(){o.toggleMerge(o.hot.getSelectedRangeLast()),o.hot.render()},runOnlyIf:function(s){return!s.altKey},group:bH})}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("grid");i.removeShortcutsByGroup(bH)}},{key:"onAfterIsMultipleSelection",value:function(o){if(o){for(var i=this.mergedCellsCollection.mergedCells,a=this.hot.getSelectedRangeLast(),l=0;l<i.length;l+=1)if(a.from.row===i[l].row&&a.from.col===i[l].col&&a.to.row===i[l].row+i[l].rowspan-1&&a.to.col===i[l].col+i[l].colspan-1)return!1}return o}},{key:"onModifyTransformStart",value:function(o){var i=pH.get(this),a=this.hot.getSelectedRangeLast(),l={row:o.row,col:o.col},s=null,u=this.hot._createCellCoords(a.highlight.row,a.highlight.col),f=this.mergedCellsCollection.get(u.row,u.col);if(i.lastDesiredCoords||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),f){var c=this.hot._createCellCoords(f.row,f.col),h=this.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=this.hot._createCellRange(c,c,h);d.includes(i.lastDesiredCoords)||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),l.row=i.lastDesiredCoords.row?i.lastDesiredCoords.row-u.row:l.row,l.col=i.lastDesiredCoords.col?i.lastDesiredCoords.col-u.col:l.col,o.row>0?l.row=f.row+f.rowspan-1-u.row+o.row:o.row<0&&(l.row=u.row-f.row+o.row),o.col>0?l.col=f.col+f.colspan-1-u.col+o.col:o.col<0&&(l.col=u.col-f.col+o.col)}s=this.hot._createCellCoords(a.highlight.row+l.row,a.highlight.col+l.col);var v=this.mergedCellsCollection.get(s.row,s.col);if(v){var g=this.mergedCellsCollection.getFirstRenderableCoords(v.row,v.col);i.lastDesiredCoords=s,l={row:g.row-u.row,col:g.col-u.col}}l.row!==0&&(o.row=l.row),l.col!==0&&(o.col=l.col)}},{key:"onModifyTransformEnd",value:function(o){var i=this,a=this.hot.getSelectedRangeLast(),l=Rr(o),s=this.selectionCalculations.getUpdatedSelectionRange(a,o),u=Rr(l),f=this.mergedCellsCollection.getWithinRange(s,!0);do u=Rr(l),this.selectionCalculations.getUpdatedSelectionRange(a,l),I(f,function(c){i.selectionCalculations.snapDelta(l,a,c)});while(l.row!==u.row||l.col!==u.col);o.row=l.row,o.col=l.col}},{key:"onModifyGetCellCoords",value:function(o,i){if(!(o<0||i<0)){var a=this.mergedCellsCollection.get(o,i);if(a){var l=a.row,s=a.col,u=a.colspan,f=a.rowspan;return[l,s,l+f-1,s+u-1]}}}},{key:"addMergeActionsToContextMenu",value:function(o){o.items.push({name:"---------"},rVe(this))}},{key:"onAfterRenderer",value:function(o,i,a){var l=this.mergedCellsCollection.get(i,a),s=Ye(l)?Rr(l):void 0;if(Ye(s)){var u=this.hot,f=u.rowIndexMapper,c=u.columnIndexMapper,h=s.row,d=s.col,v=s.colspan,g=s.rowspan,p=this.translateMergedCellToRenderable(h,g,d,v),w=nVe(p,2),S=w[0],C=w[1],P=f.getRenderableFromVisualIndex(i),R=c.getRenderableFromVisualIndex(a),V=S-P+1,U=C-R+1;s.row=f.getNearestNotHiddenIndex(s.row,1),s.col=c.getNearestNotHiddenIndex(s.col,1),s.rowspan=Math.min(s.rowspan,V),s.colspan=Math.min(s.colspan,U)}cE(o,s,i,a)}},{key:"onBeforeSetRangeStart",value:function(o){if(this.mergedCellsCollection.isFirstRenderableMergedCell(o.row,o.col)){var i=this.mergedCellsCollection.get(o.row,o.col),a=[i.row,i.col];o.row=a[0],o.col=a[1]}}},{key:"onBeforeSetRangeEnd",value:function(o){var i=this.hot.getSelectedRangeLast();i.highlight=this.hot._createCellCoords(i.highlight.row,i.highlight.col),i.to=o;var a=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{a=!1;for(var l=0;l<this.mergedCellsCollection.mergedCells.length;l+=1){var s=this.mergedCellsCollection.mergedCells[l],u=s.getRange();i.expandByRange(u)&&(o.row=i.to.row,o.col=i.to.col,a=!0)}}while(a)}},{key:"onAfterGetCellMeta",value:function(o,i,a){var l=this.mergedCellsCollection.get(o,i);l&&(l.row!==o||l.col!==i?a.copyable=!1:(a.rowspan=l.rowspan,a.colspan=l.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(o){var i=this.hot.countCols();this.modifyViewportRowStart(o,i),this.modifyViewportRowEnd(o,i)}},{key:"modifyViewportRowStart",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.startRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ye(u)){var f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.row,1));if(f<o.startRow){o.startRow=f,this.modifyViewportRowStart(o,i);return}}}}},{key:"modifyViewportRowEnd",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.endRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ye(u)){var f=u.row+u.rowspan-1,c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));if(c>o.endRow){o.endRow=c,this.modifyViewportRowEnd(o,i);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){var i=this.hot.countRows();this.modifyViewportColumnStart(o,i),this.modifyViewportColumnEnd(o,i)}},{key:"modifyViewportColumnStart",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.startColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ye(u)){var f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.col,1));if(f<o.startColumn){o.startColumn=f,this.modifyViewportColumnStart(o,i);return}}}}},{key:"modifyViewportColumnEnd",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.endColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ye(u)){var f=u.col+u.colspan-1,c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));if(c>o.endColumn){o.endColumn=c,this.modifyViewportColumnEnd(o,i);return}}}}},{key:"translateMergedCellToRenderable",value:function(o,i,a,l){var s=this.hot,u=s.rowIndexMapper,f=s.columnIndexMapper,c,h;i===0?c=u.getNearestNotHiddenIndex(o,1):c=u.getNearestNotHiddenIndex(o+i-1,-1),l===0?h=f.getNearestNotHiddenIndex(a,1):h=f.getNearestNotHiddenIndex(a+l-1,-1);var d=o>=0?u.getRenderableFromVisualIndex(c):o,v=a>=0?f.getRenderableFromVisualIndex(h):a;return[d,v]}},{key:"onModifyAutofillRange",value:function(o,i){this.autofillCalculations.correctSelectionAreaSize(i);var a=this.autofillCalculations.getDirection(i,o),l=o;if(this.autofillCalculations.dragAreaOverlapsCollections(i,l,a))return l=i,l;var s=this.mergedCellsCollection.getWithinRange({from:{row:i[0],col:i[1]},to:{row:i[2],col:i[3]}});return s&&(l=this.autofillCalculations.snapDragArea(i,l,a,s)),l}},{key:"onAfterCreateCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("right",o,i)}},{key:"onAfterRemoveCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("left",o,i)}},{key:"onAfterCreateRow",value:function(o,i,a){a!=="auto"&&this.mergedCellsCollection.shiftCollections("down",o,i)}},{key:"onAfterRemoveRow",value:function(o,i){this.mergedCellsCollection.shiftCollections("up",o,i)}},{key:"onAfterChange",value:function(o,i){i==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(o)}},{key:"onBeforeDrawAreaBorders",value:function(o,i){if(i&&i==="area"){var a=this.hot.getSelectedRangeLast(),l=this.mergedCellsCollection.getWithinRange(a);I(l,function(s){a.getBottomEndCorner().row===s.getLastRow()&&a.getBottomEndCorner().col===s.getLastColumn()&&(o[2]=s.row,o[3]=s.col)})}}},{key:"onAfterModifyTransformStart",value:function(o,i,a){if(this.enabled){var l=this.mergedCellsCollection.get(o.row,o.col);if(l){var s=i>0,u=i<0,f=a<0,c=a>0,h=l.row+l.rowspan-1===this.hot.countRows()-1,d=l.row===0,v=l.col+l.colspan-1===this.hot.countCols()-1,g=l.col===0;(s&&h||u&&d||c&&v||f&&g)&&(o.row=l.row,o.col=l.col)}}}},{key:"onAfterDrawSelection",value:function(o,i,a,l){if(a)return this.selectionCalculations.getSelectedMergedCellClassName(o,i,a,l)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return fc}},{key:"PLUGIN_PRIORITY",get:function(){return wVe}}]),r}(ct);function wH(e){return RVe(e)||OVe(e)||_Ve(e)||CVe()}function CVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Ve(e,t){if(e){if(typeof e=="string")return SH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SH(e,t)}}function SH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function OVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function RVe(e){if(Array.isArray(e))return e}function EVe(e,t){return function(r,n){var o=wH(r),i=o.slice(1),a=wH(n),l=a.slice(1);return function s(u){var f=e[u],c=t[u],h=i[u],d=l[u],v=c.multiColumnSorting,g=v.compareFunctionFactory?v.compareFunctionFactory:T2(c.type),p=g(f,c,v)(h,d);if(p===Dn){var w=u+1;if(typeof t[w]<"u")return s(w)}return p}(0)}}var CH;function TVe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _H(){dt(ft(CH||(CH=TVe(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var YU="sort";function PVe(e,t,r){var n=[];return r===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push("".concat(YU,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),n}function kVe(e){var t=e.className.split(" "),r=new RegExp("^".concat(YU,"-[0-9]{1,2}$"));return t.filter(function(n){return r.test(n)})}function Zu(e){"@babel/helpers - typeof";return Zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zu(e)}function $Ve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IVe(n.key),n)}}function AVe(e,t,r){return t&&OH(e.prototype,t),r&&OH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function IVe(e){var t=MVe(e,"string");return Zu(t)==="symbol"?t:String(t)}function MVe(e,t){if(Zu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dr(){return typeof Reflect<"u"&&Reflect.get?Dr=Reflect.get.bind():Dr=function(t,r,n){var o=xVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Dr.apply(this,arguments)}function xVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vr(e),e!==null););return e}function DVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yE(e,t)}function yE(e,t){return yE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},yE(e,t)}function NVe(e){var t=jVe();return function(){var n=vr(e),o;if(t){var i=vr(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return HVe(this,o)}}function HVe(e,t){if(t&&(Zu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LVe(e)}function LVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vr(e){return vr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vr(e)}var gE="multiColumnSorting",FVe=170,BVe="append",RH="columnSorting";E2(gE,EVe);var VVe=function(e){DVe(r,e);var t=NVe(r);function r(n){var o;return $Ve(this,r),o=t.call(this,n),o.pluginKey=gE,o}return AVe(r,[{key:"isEnabled",value:function(){return Dr(vr(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[RH]&&_H(),Dr(vr(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Dr(vr(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){Dr(vr(r.prototype),"sort",this).call(this,o)}},{key:"clearSort",value:function(){Dr(vr(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return Dr(vr(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(o){return Dr(vr(r.prototype),"getSortConfig",this).call(this,o)}},{key:"setSortConfig",value:function(o){Dr(vr(r.prototype),"setSortConfig",this).call(this,o)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o:[o]}},{key:"updateHeaderClasses",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=Dr(vr(r.prototype),"updateHeaderClasses",this)).call.apply(i,[this,o].concat(l)),je(o,kVe(o)),this.enabled!==!1&&re(o,PVe.apply(void 0,l))}},{key:"onUpdateSettings",value:function(o){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[RH]&&_H(),Dr(vr(r.prototype),"onUpdateSettings",this).call(this,o)}},{key:"onAfterOnCellMouseDown",value:function(o,i){hR(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(i.col),this.sort(this.getNextSortConfig(i.col,BVe))):this.sort(this.getColumnNextConfig(i.col)))}}],[{key:"PLUGIN_KEY",get:function(){return gE}},{key:"PLUGIN_PRIORITY",get:function(){return FVe}}]),r}(k2);function Ju(e){"@babel/helpers - typeof";return Ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ju(e)}function WVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zVe(n.key),n)}}function UVe(e,t,r){return t&&EH(e.prototype,t),r&&EH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zVe(e){var t=YVe(e,"string");return Ju(t)==="symbol"?t:String(t)}function YVe(e,t){if(Ju(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ju(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rg(){return typeof Reflect<"u"&&Reflect.get?Rg=Reflect.get.bind():Rg=function(t,r,n){var o=GVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Rg.apply(this,arguments)}function GVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Qu(e),e!==null););return e}function KVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mE(e,t)}function mE(e,t){return mE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},mE(e,t)}function qVe(e){var t=JVe();return function(){var n=Qu(e),o;if(t){var i=Qu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return XVe(this,o)}}function XVe(e,t){if(t&&(Ju(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZVe(e)}function ZVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qu(e){return Qu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qu(e)}var QVe="multipleSelectionHandles",eWe=160,tWe=function(e){KVe(r,e);var t=qVe(r);function r(n){var o;return WVe(this,r),o=t.call(this,n),o.dragged=[],o.eventManager=null,o.lastSetCell=null,o}return UVe(r,[{key:"isEnabled",value:function(){return xn()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new It(this)),this.registerListeners(),Rg(Qu(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var o=this,i=this,a=this.hot.rootElement;function l(s){if(i.dragged.length===1)return i.dragged.splice(0,i.dragged.length),!0;var u=i.dragged.indexOf(s);if(u===-1)return!1;u===0?i.dragged=i.dragged.slice(0,1):u===1&&(i.dragged=i.dragged.slice(-1))}this.eventManager.addEventListener(a,"touchstart",function(s){var u;if(De(s.target,"topSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("top"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1;if(De(s.target,"bottomSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("bottom"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchend",function(s){if(De(s.target,"topSelectionHandle-HitArea"))return l.call(i,"top"),i.touchStartRange=void 0,s.preventDefault(),!1;if(De(s.target,"bottomSelectionHandle-HitArea"))return l.call(i,"bottom"),i.touchStartRange=void 0,s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchmove",function(s){var u=o.hot.rootDocument,f,c,h,d,v,g;if(i.dragged.length!==0){var p=u.elementFromPoint(s.touches[0].clientX,s.touches[0].clientY);!p||p===i.lastSetCell||((p.nodeName==="TD"||p.nodeName==="TH")&&(f=i.hot.getCoords(p),f.col===-1&&(f.col=0),c=i.hot.getSelectedRangeLast(),h=c.getWidth(),d=c.getHeight(),v=c.getDirection(),h===1&&d===1&&i.hot.selection.setRangeEnd(f),g=i.getCurrentRangeCoords(c,f,i.touchStartRange.direction,v,i.dragged[0]),g.start!==null&&i.hot.selection.setRangeStart(g.start),i.hot.selection.setRangeEnd(g.end),i.lastSetCell=p),s.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(o,i,a,l,s){var u=o.getTopStartCorner(),f=o.getBottomEndCorner(),c=o.getBottomStartCorner(),h=o.getTopEndCorner(),d={start:null,end:null};switch(a){case"NE-SW":switch(l){case"NE-SW":case"NW-SE":s==="top"?d={start:this.hot._createCellCoords(i.row,o.highlight.col),end:this.hot._createCellCoords(c.row,i.col)}:d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,u.col)};break;case"SE-NW":s==="bottom"&&(d={start:this.hot._createCellCoords(f.row,i.col),end:this.hot._createCellCoords(i.row,u.col)});break}break;case"NW-SE":switch(l){case"NE-SW":s==="top"?d={start:i,end:c}:d.end=i;break;case"NW-SE":s==="top"?d={start:i,end:f}:d.end=i;break;case"SE-NW":s==="top"?d={start:i,end:u}:d.end=i;break;case"SW-NE":s==="top"?d={start:i,end:h}:d.end=i;break}break;case"SW-NE":switch(l){case"NW-SE":s==="bottom"?d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(c.row,i.col)}:d={start:this.hot._createCellCoords(u.row,i.col),end:this.hot._createCellCoords(i.row,f.col)};break;case"SW-NE":s==="top"?d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,f.col)}:d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(u.row,i.col)};break;case"SE-NW":s==="bottom"?d={start:this.hot._createCellCoords(i.row,h.col),end:this.hot._createCellCoords(u.row,i.col)}:s==="top"&&(d={start:c,end:i});break}break;case"SE-NW":switch(l){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(d.end=i);break;case"SE-NW":s==="top"?d.end=i:d={start:i,end:u};break}break}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return QVe}},{key:"PLUGIN_PRIORITY",get:function(){return eWe}}]),r}(ct);function pE(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.label,r=t===void 0?"":t,n=e.colspan,o=n===void 0?1:n,i=e.origColspan,a=i===void 0?1:i,l=e.collapsible,s=l===void 0?!1:l,u=e.crossHiddenColumns,f=u===void 0?[]:u,c=e.isCollapsed,h=c===void 0?!1:c,d=e.isHidden,v=d===void 0?!1:d,g=e.isRoot,p=g===void 0?!1:g,w=e.isPlaceholder,S=w===void 0?!1:w;return{label:r,colspan:o,origColspan:a,collapsible:s,isCollapsed:h,crossHiddenColumns:f,isHidden:v,isRoot:p,isPlaceholder:S}}function GU(){return{label:"",isPlaceholder:!0}}function TH(e){return iWe(e)||oWe(e)||nWe(e)||rWe()}function rWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nWe(e,t){if(e){if(typeof e=="string")return bE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bE(e,t)}}function oWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function iWe(e){if(Array.isArray(e))return bE(e)}function bE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aWe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(t===0)return r;I(e,function(o){var i=[],a=0;r.push(i),I(o,function(l){var s=pE();if(Ye(l)){var u=l.label,f=l.colspan;s.label=Bt(u),typeof f=="number"&&f>1&&(s.colspan=f,s.origColspan=f)}else s.label=Bt(l);a+=s.origColspan;var c=!1;if(a>=t&&(s.colspan=s.origColspan-(a-t),s.origColspan=s.colspan,c=!0),i.push(s),s.colspan>1)for(var h=0;h<s.colspan-1;h++)i.push(GU());return!c})});var n=Math.max.apply(Math,TH(ze(r,function(o){return o.length})));return I(r,function(o){if(o.length<n){var i=ze(new Array(n-o.length),function(){return pE()});o.splice.apply(o,[o.length,0].concat(TH(i)))}}),r}function Ed(e){"@babel/helpers - typeof";return Ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ed(e)}var lWe=["row","col"];function PH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function sWe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PH(Object(r),!0).forEach(function(n){uWe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uWe(e,t,r){return t=KU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fWe(e,t){if(e==null)return{};var r=cWe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function cWe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function hWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KU(n.key),n)}}function dWe(e,t,r){return t&&kH(e.prototype,t),r&&kH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function KU(e){var t=vWe(e,"string");return Ed(t)==="symbol"?t:String(t)}function vWe(e,t){if(Ed(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jC(e,t,r){yWe(e,t),t.set(e,r)}function yWe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rn(e,t){var r=qU(e,t,"get");return gWe(e,r)}function gWe(e,t){return t.get?t.get.call(e):t.value}function tc(e,t,r){var n=qU(e,t,"set");return mWe(e,n,r),r}function qU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function mWe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var $H=["label","collapsible"],Jn=new WeakMap,Ki=new WeakMap,FC=new WeakMap,pWe=function(){function e(){hWe(this,e),jC(this,Jn,{writable:!0,value:[]}),jC(this,Ki,{writable:!0,value:0}),jC(this,FC,{writable:!0,value:1/0})}return dWe(e,[{key:"setColumnsLimit",value:function(r){tc(this,FC,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];tc(this,Jn,aWe(r,rn(this,FC))),tc(this,Ki,rn(this,Jn).length)}},{key:"getData",value:function(){return rn(this,Jn)}},{key:"mergeWith",value:function(r){var n=this;I(r,function(o){var i=o.row,a=o.col,l=fWe(o,lWe),s=n.getHeaderSettings(i,a);s!==null&&Yt(s,l,$H)})}},{key:"map",value:function(r){I(rn(this,Jn),function(n){I(n,function(o){var i=r(sWe({},o));Ye(i)&&Yt(o,i,$H)})})}},{key:"getHeaderSettings",value:function(r,n){var o;if(r>=rn(this,Ki)||r<0)return null;var i=rn(this,Jn)[r];return n>=i.length?null:(o=i[n])!==null&&o!==void 0?o:null}},{key:"getHeadersSettings",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=[];if(r>=rn(this,Ki)||r<0)return i;for(var a=rn(this,Jn)[r],l=0,s=n;s<a.length;s++){var u=a[s];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(l+=u.colspan,i.push(u),u.colspan>1&&(s+=u.colspan-1),l===o)break;if(l>o)throw new Error("The last column settings cannot overlap the other header layers")}return i}},{key:"getLayersCount",value:function(){return rn(this,Ki)}},{key:"getColumnsCount",value:function(){return rn(this,Ki)>0?rn(this,Jn)[0].length:0}},{key:"clear",value:function(){tc(this,Jn,[]),tc(this,Ki,0)}}]),e}();function Td(e){"@babel/helpers - typeof";return Td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Td(e)}function AH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function IH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AH(Object(r),!0).forEach(function(n){Eg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XU(n.key),n)}}function wWe(e,t,r){return t&&MH(e.prototype,t),r&&MH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Eg(e,t,r){return t=XU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XU(e){var t=SWe(e,"string");return Td(t)==="symbol"?t:String(t)}function SWe(e,t){if(Td(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CWe(e){return EWe(e)||RWe(e)||OWe(e)||_We()}function _We(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OWe(e,t){if(e){if(typeof e=="string")return wE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wE(e,t)}}function RWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function EWe(e){if(Array.isArray(e))return wE(e)}function wE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var TWe="DF-pre-order";function ZU(e,t){for(var r=e.call(t,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=ZU.call(this.childs[n],e,t)}return r}var PWe="DF-post-order";function JU(e,t){for(var r=0;r<this.childs.length;r++){var n=JU.call(this.childs[r],e,t);if(n===!1)return!1}return e.call(t,this)}var QU="BF";function kWe(e,t){var r=[this];function n(){if(r.length!==0){var o=r.shift();r.push.apply(r,CWe(o.childs)),e.call(t,o)!==!1&&n()}}n()}var $We=QU,xH=new Map([[TWe,ZU],[PWe,JU],[QU,kWe]]),DH=function(){function e(t){bWe(this,e),Eg(this,"data",{}),Eg(this,"parent",null),Eg(this,"childs",[]),this.data=t}return wWe(e,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new e(IH({},r.data)),o=0;o<r.childs.length;o++)n.addChild(this.cloneTree(r.childs[o]));return n}},{key:"replaceTreeWith",value:function(r){this.data=IH({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$We;if(!xH.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));xH.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,o=function i(a){var l=r.call(n,a);l!==!1&&a.parent!==null&&i(a.parent)};o(this)}}]),e}();function Pd(e){"@babel/helpers - typeof";return Pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pd(e)}function NH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function HH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NH(Object(r),!0).forEach(function(n){AWe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AWe(e,t,r){return t=ez(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IWe(e,t){return NWe(e)||DWe(e,t)||xWe(e,t)||MWe()}function MWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xWe(e,t){if(e){if(typeof e=="string")return LH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LH(e,t)}}function LH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function DWe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function NWe(e){if(Array.isArray(e))return e}function HWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ez(n.key),n)}}function LWe(e,t,r){return t&&jH(e.prototype,t),r&&jH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ez(e){var t=jWe(e,"string");return Pd(t)==="symbol"?t:String(t)}function jWe(e,t){if(Pd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BC(e,t,r){FWe(e,t),t.set(e,r)}function FWe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cr(e,t){var r=tz(e,t,"get");return BWe(e,r)}function BWe(e,t){return t.get?t.get.call(e):t.value}function VWe(e,t,r){var n=tz(e,t,"set");return WWe(e,n,r),r}function tz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function WWe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Ml=new WeakMap,qi=new WeakMap,xl=new WeakMap,UWe=function(){function e(t){HWe(this,e),BC(this,Ml,{writable:!0,value:new Map}),BC(this,qi,{writable:!0,value:new Map}),BC(this,xl,{writable:!0,value:null}),VWe(this,xl,t)}return LWe(e,[{key:"getRoots",value:function(){return Array.from(cr(this,Ml).values())}},{key:"getRootByColumn",value:function(r){var n;return cr(this,qi).has(r)&&(n=cr(this,Ml).get(cr(this,qi).get(r))),n}},{key:"getNode",value:function(r,n){var o=this.getRootByColumn(n);if(o){var i=n-cr(this,qi).get(n),a=0,l;return o.walkDown(function(s){var u=s.data,f=u.origColspan,c=u.headerLevel;if(r===c){if(i>=a&&i<=a+f-1)return l=s,l.data.isRoot=n===l.data.columnIndex,!1;a+=f}}),l}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;cr(this,qi).clear(),I(cr(this,Ml),function(o){for(var i=IWe(o,2),a=i[1].data.colspan,l=n;l<n+a;l++)cr(r,qi).set(l,n);n+=a})}},{key:"buildTree",value:function(){this.clear();for(var r=cr(this,xl).getColumnsCount(),n=0;n<r;){var o=cr(this,xl).getHeaderSettings(0,n),i=new DH;cr(this,Ml).set(n,i),this.buildLeaves(i,n,0,o.origColspan),n+=o.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,l=cr(this,xl).getHeadersSettings(o,n,a);o+=1,I(l,function(s){var u=HH(HH({},s),{},{headerLevel:o-1,columnIndex:n}),f;o===1?(r.data=u,f=r):(f=new DH(u),r.addChild(f)),o<cr(i,xl).getLayersCount()&&i.buildLeaves(f,n,o,s.origColspan),n+=s.origColspan})}},{key:"clear",value:function(){cr(this,Ml).clear(),cr(this,qi).clear()}}]),e}();function rz(e,t){e.walkDown(function(r){var n=r.data,o=r.childs;if(!n.isHidden&&(t(n.columnIndex),o.length===0))for(var i=1;i<n.colspan;i++)t(n.columnIndex+i)})}function Nm(e,t){var r=e.childs;if(r.length!==0)return r[0].data[t]}function Hm(e){return Nm(e,"origColspan")===e.data.origColspan}function aP(e){var t=e.data,r=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=Hm(e);if(n)return aP(r[0]);t.isCollapsed=!1;var o=r.slice(1),i=new Set,a=0;if(o.length>0)I(o,function(c){c.replaceTreeWith(c.data.clonedTree),c.data.clonedTree=null;var h=c.data;a+=h.colspan,rz(c,function(d){i.add(d)})});else{var l=t.colspan,s=t.origColspan,u=t.columnIndex;a=s-l;for(var f=1;f<s;f++)i.add(u+f)}return e.walkUp(function(c){var h=c.data;h.colspan+=a,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):Hm(c)&&(h.isCollapsed=Nm(c,"isCollapsed"))}),{rollbackModification:function(){return lP(e)},affectedColumns:Array.from(i),colspanCompensation:a}}function lP(e){var t,r=e.data,n=e.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var o=Hm(e);if(o)return lP(n[0]);r.isCollapsed=!0;var i=n.slice(1),a=new Set;if(i.length>0)I(i,function(h){rz(h,function(d){a.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(function(d){var v=d.data;v.isHidden=!0})});else for(var l=r.origColspan,s=r.columnIndex,u=1;u<l;u++){var f=s+u;a.add(f)}var c=r.colspan-((t=Nm(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(function(h){var d=h.data;d.colspan-=c,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):Hm(h)&&(d.isCollapsed=Nm(h,"isCollapsed"))}),{rollbackModification:function(){return aP(e)},affectedColumns:Array.from(a),colspanCompensation:c}}var FH;function zWe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function YWe(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(ft(FH||(FH=zWe([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(!r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.push(t),i.colspan>1?i.colspan-=1:i.isHidden=!0})}}var BH;function GWe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function KWe(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(ft(BH||(BH=GWe([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(t),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}}var VH=new Map([["collapse",lP],["expand",aP],["hide-column",YWe],["show-column",KWe]]);function qWe(e,t,r){if(!VH.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return VH.get(e)(t,r)}var XWe=["crossHiddenColumns"];function ZWe(e,t){if(e==null)return{};var r=JWe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function JWe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Hy(e){var t=[];return I(e,function(r){r.walkDown(function(n){for(var o=n.data,i=o.origColspan,a=o.columnIndex,l=o.headerLevel,s=o.crossHiddenColumns,u=e2e(t,l),f=!1,c=a;c<a+i;c++){var h=s.includes(c);if(h||f)u.push(GU());else{var d=QWe(o);d.isRoot=!0,u.push(d),f=!0}}})}),t}function QWe(e){var t=pE(e);t.crossHiddenColumns;var r=ZWe(t,XWe);return r}function e2e(e,t){var r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}function kd(e){"@babel/helpers - typeof";return kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kd(e)}var t2e=["row"];function WH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function UH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WH(Object(r),!0).forEach(function(n){r2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function r2e(e,t,r){return t=nz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n2e(e,t){if(e==null)return{};var r=o2e(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function o2e(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function i2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nz(n.key),n)}}function a2e(e,t,r){return t&&zH(e.prototype,t),r&&zH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nz(e){var t=l2e(e,"string");return kd(t)==="symbol"?t:String(t)}function l2e(e,t){if(kd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VC(e,t,r){s2e(e,t),t.set(e,r)}function s2e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rc(e,t,r){var n=oz(e,t,"set");return u2e(e,n,r),r}function u2e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function xt(e,t){var r=oz(e,t,"get");return f2e(e,r)}function oz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function f2e(e,t){return t.get?t.get.call(e):t.value}var En=new WeakMap,Mr=new WeakMap,Xi=new WeakMap,c2e=function(){function e(){i2e(this,e),VC(this,En,{writable:!0,value:new pWe}),VC(this,Mr,{writable:!0,value:new UWe(xt(this,En))}),VC(this,Xi,{writable:!0,value:[[]]})}return a2e(e,[{key:"setState",value:function(r){xt(this,En).setData(r);var n=!1;try{xt(this,Mr).buildTree()}catch{xt(this,Mr).clear(),xt(this,En).clear(),n=!0}return rc(this,Xi,Hy(xt(this,Mr).getRoots())),n}},{key:"setColumnsLimit",value:function(r){xt(this,En).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,o=ze(r,function(i){var a=i.row,l=n2e(i,t2e);return UH({row:a<0?n.rowCoordsToLevel(a):a},l)});xt(this,En).mergeWith(o),xt(this,Mr).buildTree(),rc(this,Xi,Hy(xt(this,Mr).getRoots()))}},{key:"mapState",value:function(r){xt(this,En).map(r),xt(this,Mr).buildTree(),rc(this,Xi,Hy(xt(this,Mr).getRoots()))}},{key:"mapNodes",value:function(r){return ar(xt(this,Mr).getRoots(),function(n,o){return o.walkDown(function(i){var a=r(i.data);a!==void 0&&n.push(a)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,o){n<0&&(n=this.rowCoordsToLevel(n));var i=xt(this,Mr).getNode(n,o),a;return i&&(a=qWe(r,i,o),rc(this,Xi,Hy(xt(this,Mr).getRoots()))),a}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){if(r>=0)return null;var n=r+Math.max(this.getLayersCount(),1);return n<0?null:n}},{key:"levelToRowCoords",value:function(r){if(r<0)return null;var n=r-Math.max(this.getLayersCount(),1);return n>=0?null:n}},{key:"getHeaderSettings",value:function(r,n){var o,i;return r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount()?null:(o=(i=xt(this,Xi)[r])===null||i===void 0?void 0:i[n])!==null&&o!==void 0?o:null}},{key:"getHeaderTreeNodeData",value:function(r,n){if(r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount())return null;var o=xt(this,Mr).getNode(r,n);return o?UH({},o.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var o,i=(o=this.getHeaderSettings(r,n))!==null&&o!==void 0?o:{isRoot:!0},a=i.isRoot;if(a)return n;for(var l=n-1;l>=0;){var s,u=(s=this.getHeaderSettings(r,l))!==null&&s!==void 0?s:{isRoot:!0},f=u.isRoot;if(f)break;l-=1}return l}},{key:"getLayersCount",value:function(){return xt(this,En).getLayersCount()}},{key:"getColumnsCount",value:function(){return xt(this,En).getColumnsCount()}},{key:"clear",value:function(){rc(this,Xi,[]),xt(this,En).clear(),xt(this,Mr).clear()}}]),e}();function $d(e){"@babel/helpers - typeof";return $d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$d(e)}function h2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iz(n.key),n)}}function d2e(e,t,r){return t&&YH(e.prototype,t),r&&YH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nc(e,t,r){return t=iz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iz(e){var t=v2e(e,"string");return $d(t)==="symbol"?t:String(t)}function v2e(e,t){if($d(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var y2e=function(){function e(t,r){h2e(this,e),nc(this,"hot",void 0),nc(this,"nestedHeaderSettingsGetter",void 0),nc(this,"layersCount",0),nc(this,"container",void 0),nc(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return d2e(e,[{key:"setLayersCount",value:function(r){return this.layersCount=r,this}},{key:"getWidth",value:function(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(var o=0;o<n;o++){var i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),a=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(a,r[o].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(r){for(var n=this.hot,o=n.rootDocument,i=n.columnIndexMapper,a=o.createDocumentFragment(),l=o.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,u=i.getRenderableIndexesLength(),f=0;f<this.layersCount;f++){for(var c=o.createElement("tr"),h=0;h<u;h++){var d=i.getVisualFromRenderableIndex(h);d===null&&(d=h);var v=o.createElement("th"),g=this.nestedHeaderSettingsGetter(f,d);if(g&&(!g.isPlaceholder||g.isHidden)){var p=g.label;s&&(p+='<button class="changeType"></button>'),bf(v,p),v.colSpan=g.colspan,c.appendChild(v)}}l.appendChild(c)}a.appendChild(l),r.appendChild(a)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),e}();const g2e=y2e;function ef(e){"@babel/helpers - typeof";return ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ef(e)}var GH,KH;function qH(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function m2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,az(n.key),n)}}function p2e(e,t,r){return t&&XH(e.prototype,t),r&&XH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wa(){return typeof Reflect<"u"&&Reflect.get?wa=Reflect.get.bind():wa=function(t,r,n){var o=b2e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},wa.apply(this,arguments)}function b2e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Po(e),e!==null););return e}function w2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SE(e,t)}function SE(e,t){return SE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},SE(e,t)}function S2e(e){var t=_2e();return function(){var n=Po(e),o;if(t){var i=Po(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return C2e(this,o)}}function C2e(e,t){if(t&&(ef(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cc(e)}function cc(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Po(e){return Po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Po(e)}function ZH(e,t,r){return t=az(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function az(e){var t=O2e(e,"string");return ef(t)==="symbol"?t:String(t)}function O2e(e,t){if(ef(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ef(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JH(e,t,r){R2e(e,t),t.set(e,r)}function R2e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ly(e,t,r){var n=lz(e,t,"set");return E2e(e,n,r),r}function E2e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Tt(e,t){var r=lz(e,t,"get");return T2e(e,r)}function lz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function T2e(e,t){return t.get?t.get.call(e):t.value}var QH="nestedHeaders",P2e=280,jt=new WeakMap,ti=new WeakMap,k2e=function(e){w2e(r,e);var t=S2e(r);function r(){var n;m2e(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),JH(cc(n),jt,{writable:!0,value:new c2e}),JH(cc(n),ti,{writable:!0,value:null}),ZH(cc(n),"ghostTable",new g2e(n.hot,function(l,s){return n.getHeaderSettings(l,s)})),ZH(cc(n),"detectedOverlappedHeaders",!1),n}return p2e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[QH]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;(!Array.isArray(a)||!Array.isArray(a[0]))&&dt(ft(GH||(GH=qH([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(){return o.onAfterOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(l){return o.onAfterGetColumnHeaderRenderers(l)}),this.addHook("modifyColWidth",function(){return o.onModifyColWidth.apply(o,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return o.onModifyColumnHeaderValue.apply(o,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return o.onBeforeHighlightingColumnHeader.apply(o,arguments)}),this.addHook("beforeCopy",function(){return o.onBeforeCopy.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),wa(Po(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var o=this;if(this.hot.view){var i=this.hot.getSettings(),a=i.nestedHeaders;Tt(this,jt).setColumnsLimit(this.hot.countCols()),Array.isArray(a)&&(this.detectedOverlappedHeaders=Tt(this,jt).setState(a)),this.detectedOverlappedHeaders&&dt(ft(KH||(KH=qH([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(l,s){var u=l===!0?"hide-column":"show-column";Tt(o,jt).triggerColumnModification(u,s)}),!Tt(this,ti)&&this.enabled&&Ly(this,ti,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(l){l.forEach(function(s){var u=s.op,f=s.index,c=s.newValue;if(u==="replace"){var h=c===!0?"hide-column":"show-column";Tt(o,jt).triggerColumnModification(h,f)}}),o.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),wa(Po(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),Tt(this,jt).clear(),Tt(this,ti).unsubscribe(),Ly(this,ti,null),this.ghostTable.clear(),wa(Po(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return Tt(this,jt)}},{key:"getLayersCount",value:function(){return Tt(this,jt).getLayersCount()}},{key:"getHeaderSettings",value:function(o,i){return Tt(this,jt).getHeaderSettings(o,i)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var o=this.hot.view._wt,i=o.getSetting("columnHeaders").length,a=o.wtTable.THEAD,l=o.wtOverlays.topOverlay.clone.wtTable.THEAD,s=o.wtOverlays.topInlineStartCornerOverlay?o.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,u=0;u<i;u++){var f=a.childNodes[u];if(!f)break;for(var c=l.childNodes[u],h=s?s.childNodes[u]:null,d=0,v=f.childNodes.length;d<v;d++)f.childNodes[d].removeAttribute("colspan"),je(f.childNodes[d],"hiddenHeader"),c&&c.childNodes[d]&&(c.childNodes[d].removeAttribute("colspan"),je(c.childNodes[d],"hiddenHeader")),s&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),je(h.childNodes[d],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(o){var i=this,a=this.hot.view._wt.getSetting("fixedColumnsStart");return function(l,s){var u,f=i.hot,c=f.columnIndexMapper,h=f.view,d=c.getVisualFromRenderableIndex(l);d===null&&(d=l),s.removeAttribute("colspan"),je(s,"hiddenHeader");var v=(u=Tt(i,jt).getHeaderSettings(o,d))!==null&&u!==void 0?u:{label:""},g=v.colspan,p=v.isHidden,w=v.isPlaceholder;if(w||p)re(s,"hiddenHeader");else if(g>1){var S,C,P=h._wt.wtOverlays,R=(S=P.topInlineStartCornerOverlay)===null||S===void 0?void 0:S.clone.wtTable.THEAD.contains(s),V=(C=P.inlineStartOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(s),U=R||V?Math.min(g,a-l):g;U>1&&s.setAttribute("colspan",U)}i.hot.view.appendColHeader(d,s,function(){return i.getColumnHeaderValue.apply(i,arguments)},o)}}},{key:"getColumnHeaderValue",value:function(o,i){var a,l=(a=Tt(this,jt).getHeaderSettings(i,o))!==null&&a!==void 0?a:{},s=l.isHidden,u=l.isPlaceholder;return u||s?"":this.hot.getColHeader(o,i)}},{key:"onBeforeHighlightingColumnHeader",value:function(o,i,a){var l=Tt(this,jt).getHeaderTreeNodeData(i,o);if(!l)return o;var s=a.classNames,u=a.columnCursor,f=a.selectionType,c=a.selectionWidth,h=Tt(this,jt).getHeaderSettings(i,o),d=h.isRoot,v=h.colspan;if(f===wv){if(!d)return l.columnIndex}else f===Gb&&(v>c-u||!d)&&(s.length=0);return o}},{key:"onBeforeCopy",value:function(o,i,a){var l=a.columnHeadersCount;if(l!==0)for(var s=0;s<i.length;s++){var u=i[s],f=u.startRow,c=u.startCol,h=u.endRow,d=u.endCol,v=h-f+1,g=c-d+1;if(f>=0||g===1)break;for(var p=c;p<=d;p++)for(var w=f;w<=h;w++){var S,C=v+w,P=p-c;if(P!==0){var R=(S=Tt(this,jt).getHeaderTreeNodeData(w,p))===null||S===void 0?void 0:S.isRoot;R===!1&&(o[C][P]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this._getHeaderTreeNodeDataByCoords(i);s&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){var a=this._getHeaderTreeNodeDataByCoords(i);if(a){var l=this.hot.selection,s=l.isSelected()?l.getSelectedRange().current():null,u=[],f=a.columnIndex,c=a.origColspan,h=!l.inInSelection(i);o.shiftKey&&s?i.col<s.from.col?u.push(s.getTopEndCorner().col,f,i.row):i.col>s.from.col?u.push(s.getTopStartCorner().col,f+c-1,i.row):u.push(f,f+c-1,i.row):(sT(o)||xa(o)&&h)&&u.push(f,f+c-1,i.row),l.selectColumns.apply(l,u)}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s;if(this.hot.view.isMouseDown()){var u=this._getHeaderTreeNodeDataByCoords(i);if(u){var f=u.columnIndex,c=u.origColspan,h=this.hot.getSelectedRangeLast(),d=h.getTopStartCorner(),v=h.getBottomEndCorner(),g=h.from;l.column=!0,l.cell=!0;var p=[];i.col<g.col?p.push(v.col,f):i.col>g.col?p.push(d.col,f+c-1):p.push(f,f+c-1),(s=this.hot).selectColumns.apply(s,p)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(o){o.length=0;for(var i=0;i<Tt(this,jt).getLayersCount();i++)o.push(this.headerRendererFactory(i))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){for(var i=Tt(this,jt).getLayersCount(),a=o.startColumn,l=!!i,s=0;s<i;s++){var u=Tt(this,jt).findLeftMostColumnIndex(s,o.startColumn),f=this.hot.columnIndexMapper.getRenderableFromVisualIndex(u);if(u>=0&&(l=!1),Or(f)&&f<o.startColumn){a=f;break}}o.startColumn=l?Tt(this,jt).getHeaderTreeNodeData(0,a).columnIndex:a}},{key:"onModifyColWidth",value:function(o,i){var a=this.ghostTable.getWidth(i);return o>a?o:a}},{key:"onModifyColumnHeaderValue",value:function(o,i,a){var l,s=(l=Tt(this,jt).getHeaderTreeNodeData(a,i))!==null&&l!==void 0?l:{label:""},u=s.label;return u}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){Ly(this,jt,null),Tt(this,ti)!==null&&(Tt(this,ti).unsubscribe(),Ly(this,ti,null)),wa(Po(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(o){if(!(o.row>=0||o.col<0))return Tt(this,jt).getHeaderTreeNodeData(o.row,o.col)}}],[{key:"PLUGIN_KEY",get:function(){return QH}},{key:"PLUGIN_PRIORITY",get:function(){return P2e}}]),r}(ct);function eL(e){return M2e(e)||I2e(e)||A2e(e)||$2e()}function $2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function A2e(e,t){if(e){if(typeof e=="string")return CE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CE(e,t)}}function I2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function M2e(e){if(Array.isArray(e))return CE(e)}function CE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tf(e){"@babel/helpers - typeof";return tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tf(e)}function x2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,N2e(n.key),n)}}function D2e(e,t,r){return t&&tL(e.prototype,t),r&&tL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function N2e(e){var t=H2e(e,"string");return tf(t)==="symbol"?t:String(t)}function H2e(e,t){if(tf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var L2e=function(){function e(t,r){x2e(this,e),this.hot=r,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return D2e(e,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Re(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,o){var i=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:o,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&I(r.__children,function(a){i.cacheNode(a,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,o,i){var a=this,l=!1,s=n;if(isNaN(s)&&s.end)return s;var u=r;return u||(u={__children:this.data},l=!0,s-=1),o!=null&&s===o?{result:u,end:!0}:i!=null&&u===i?{result:s,end:!0}:(s+=1,u.__children&&I(u.__children,function(f){if(a.parentReference.set(f,l?null:u),s=a.readTreeNodes(f,s,o,i),isNaN(s)&&s.end)return!1}),s)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return Ge(this.data[0],function(n,o){r[o]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var o=this.getRowParent(r);return o==null?this.data.indexOf(n):o.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,o=0,i=r;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(I(i.__children,function(a){o+=1,a.__children&&(o+=n.countChildren(a))}),o)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||tf(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var o;return((o=r.__children)===null||o===void 0?void 0:o[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,o=r;return isNaN(o)||(o=this.getDataObject(o)),o&&!!o.__children&&((n=o.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var o=n;this.hot.runHooks("beforeAddChild",r,o);var i=null;r&&(i=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(r)+1,1);var a=r;r||(a=this.mockParent()),a.__children||(a.__children=[]),o||(o=this.mockNode()),a.__children.push(o),this.rewriteCache();var l=this.getRowIndex(o);this.hot.rowIndexMapper.insertIndexes(l,1),this.hot.runHooks("afterCreateRow",l,1),this.hot.runHooks("afterAddChild",r,o)}},{key:"addChildAtIndex",value:function(r,n,o){var i=o,a;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",r,i,n),r){var l=this.getRowIndex(r),s=l+n+1;this.hot.runHooks("beforeCreateRow",s,1),r.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(s,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",s,1),a=s}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),a=this.getRowIndex(this.data[n]);i=this.getDataObject(a),this.hot.runHooks("afterAddChild",r,i,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",o=this.translateTrimmedRow(r),i=this.getRowParent(o),a=this.getRowIndexWithinParent(o);switch(n){case"below":this.addChildAtIndex(i,a+1,null);break;case"above":this.addChildAtIndex(i,a,null);break}}},{key:"detachFromParent",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null,a=[];Array.isArray(r)?(Re(r[0],r[2],function(w){var S=n.translateTrimmedRow(w);a.push(n.getDataObject(S))}),Re(0,a.length-2,function(w){n.detachFromParent(a[w],!1)}),i=a[a.length-1]):i=r;var l=this.getRowIndex(i),s=this.countChildren(i),u=this.getRowIndexWithinParent(i),f=this.getRowParent(i),c=this.getRowParent(f),h=this.getRowIndex(c),d=null;if(this.hot.runHooks("beforeDetachChild",f,i),u!=null){var v=Array.from(new Array(l+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",l,s+1,v,this.plugin.pluginName),f.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",l,s+1,v,this.plugin.pluginName),c){d=h+this.countChildren(c);var g=this.getChild(c,this.countChildren(c)-1),p=this.getRowIndex(g);this.hot.runHooks("beforeCreateRow",p+1,s+1,this.plugin.pluginName),c.__children.push(i)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,s+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",f,i,this.getRowIndex(i)),o&&this.hot.render()}},{key:"filterData",value:function(r,n,o){var i=this,a=[];I(o,function(l){a.push(i.getDataObject(l))}),I(a,function(l){var s=i.getRowIndexWithinParent(l),u=i.getRowParent(l);u===null?i.data.splice(s,1):u.__children.splice(s,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,o){var i=this.getDataObject(r-1),a=null,l=r;if(i&&i.__children&&i.__children.length===0?(a=i,l=0):r<this.countAllRows()&&(a=this.getRowParent(r),l=this.getRowIndexWithinParent(r)),a)if(o){var s;(s=a.__children).splice.apply(s,[l,n].concat(eL(o)))}else a.__children.splice(l,n);else if(o){var u;(u=this.data).splice.apply(u,[l,n].concat(eL(o)))}else this.data.splice(l,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,o=null;do o=this.getRowParent(o),o!==null&&(n=o);while(o!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,o,i){var a=n===this.hot.countRows(),l=this.getRowParent(r),s=this.getRowIndexWithinParent(r),u=l.__children.slice(s,s+1),f=r>n,c=a?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);var h=a||o||i?c.__children.length:this.getRowIndexWithinParent(n),d=l===c;c.__children.splice(h,0,u[0]),l.__children.splice(s+(f&&d?1:0),1),this.syncRowWithRawSource(l),d||this.syncRowWithRawSource(c)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),e}();const j2e=L2e;function Ad(e){"@babel/helpers - typeof";return Ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ad(e)}function rL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,B2e(n.key),n)}}function F2e(e,t,r){return t&&rL(e.prototype,t),r&&rL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function B2e(e){var t=V2e(e,"string");return Ad(t)==="symbol"?t:String(t)}function V2e(e,t){if(Ad(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function W2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var U2e=F2e(function e(t,r){W2e(this,e),this.hot=r,this.plugin=t});const sP=U2e;function rf(e){"@babel/helpers - typeof";return rf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rf(e)}function z2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,G2e(n.key),n)}}function Y2e(e,t,r){return t&&nL(e.prototype,t),r&&nL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function G2e(e){var t=K2e(e,"string");return rf(t)==="symbol"?t:String(t)}function K2e(e,t){if(rf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function q2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_E(e,t)}function _E(e,t){return _E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_E(e,t)}function X2e(e){var t=Q2e();return function(){var n=Lm(e),o;if(t){var i=Lm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Z2e(this,o)}}function Z2e(e,t){if(t&&(rf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return J2e(e)}function J2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Lm(e){return Lm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Lm(e)}var eUe=function(e){q2e(r,e);var t=X2e(r);function r(n,o){var i;return z2e(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsingUI=i.plugin.collapsingUI,i.rowHeaderWidthCache=null,i}return Y2e(r,[{key:"appendLevelIndicators",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=this.dataManager.getRowLevel(a),s=this.dataManager.getDataObject(a),u=i.getElementsByTagName("DIV")[0],f=u.querySelector("span.rowHeader"),c=u.querySelectorAll('[class^="ht_nesting"]');if(I(c,function(g){g&&u.removeChild(g)}),re(i,r.CSS_CLASSES.indicatorContainer),l){var h=this.hot.rootDocument,d=f.cloneNode(!0);u.innerHTML="",Re(0,l-1,function(){var g=h.createElement("SPAN");re(g,r.CSS_CLASSES.emptyIndicator),u.appendChild(g)}),u.appendChild(d)}if(this.dataManager.hasChildren(s)){var v=this.hot.rootDocument.createElement("DIV");re(i,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(a)?re(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):re(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),u.appendChild(v)}}},{key:"updateRowHeaderWidth",value:function(o){var i=o;i||(i=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*i+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(sP);const sz=eUe;function nf(e){"@babel/helpers - typeof";return nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nf(e)}function oL(e){return oUe(e)||nUe(e)||rUe(e)||tUe()}function tUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rUe(e,t){if(e){if(typeof e=="string")return OE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OE(e,t)}}function nUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function oUe(e){if(Array.isArray(e))return OE(e)}function OE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function iUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lUe(n.key),n)}}function aUe(e,t,r){return t&&iL(e.prototype,t),r&&iL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lUe(e){var t=sUe(e,"string");return nf(t)==="symbol"?t:String(t)}function sUe(e,t){if(nf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RE(e,t)}function RE(e,t){return RE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},RE(e,t)}function fUe(e){var t=dUe();return function(){var n=jm(e),o;if(t){var i=jm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return cUe(this,o)}}function cUe(e,t){if(t&&(nf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hUe(e)}function hUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jm(e){return jm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jm(e)}var vUe=function(e){uUe(r,e);var t=fUe(r);function r(n,o){var i;return iUe(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsedRows=[],i.collapsedRowsStash={stash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,l)},shiftStash:function(l,s){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),I(i.lastCollapsedRows,function(f,c){f>=l&&f<s&&(i.lastCollapsedRows[c]=f+u)})},applyStash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,l),i.lastCollapsedRows=void 0},trimStash:function(l,s){Re(l,l+s-1,function(u){var f=i.lastCollapsedRows.indexOf(u);f>-1&&i.lastCollapsedRows.splice(f,1)})}},i}return aUe(r,[{key:"collapseChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(u)):(u=this.dataManager.getDataObject(o),f=o),this.dataManager.hasChildren(u)&&I(u.__children,function(h){s.push(i.dataManager.getRowIndex(h))}),c=this.collapseRows(s,!0,!1),l&&this.trimRows(c),a&&this.renderAndAdjust(),this.collapsedRows.indexOf(f)===-1&&this.collapsedRows.push(f),c}},{key:"collapseMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];I(o,function(u){s.push.apply(s,oL(i.collapseChildren(u,!1,!1)))}),l&&this.trimRows(s),a&&this.renderAndAdjust()}},{key:"collapseRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([o],i)}},{key:"collapseRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return I(o,function(u){s.push(u),a&&i.collapseChildRows(u,s)}),l&&this.trimRows(s),s}},{key:"collapseChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);I(s.__children,function(u){var f=i.dataManager.getRowIndex(u);a.push(f),i.collapseChildRows(f,a)})}l&&this.trimRows(a)}},{key:"expandRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([o],i)}},{key:"expandRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return I(o,function(u){s.push(u),a&&i.expandChildRows(u,s)}),l&&this.untrimRows(s),s}},{key:"expandChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);I(s.__children,function(u){if(!i.isAnyParentCollapsed(u)){var f=i.dataManager.getRowIndex(u);a.push(f),i.expandChildRows(f,a)}})}l&&this.untrimRows(a)}},{key:"expandChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(o)):(u=this.dataManager.getDataObject(o),f=o),this.collapsedRows.splice(this.collapsedRows.indexOf(f),1),this.dataManager.hasChildren(u)&&I(u.__children,function(h){var d=i.dataManager.getRowIndex(h);s.push(d)}),c=this.expandRows(s,!0,!1),l&&this.untrimRows(c),a&&this.renderAndAdjust(),c}},{key:"expandMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];I(o,function(u){s.push.apply(s,oL(i.expandChildren(u,!1,!1)))}),l&&this.untrimRows(s),a&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];I(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.collapseMultipleChildren(a),this.renderAndAdjust()}},{key:"expandAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];I(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.expandMultipleChildren(a),this.renderAndAdjust()}},{key:"trimRows",value:function(o){var i=this;this.hot.batchExecution(function(){I(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"untrimRows",value:function(o){var i=this;this.hot.batchExecution(function(){I(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(o){var i=this,a=isNaN(o)?o:this.dataManager.getDataObject(o),l=!0;return a===null&&(a={__children:this.dataManager.data}),this.dataManager.hasChildren(a)&&I(a.__children,function(s){var u=i.dataManager.getRowIndex(s);if(!i.plugin.collapsedRowsMap.getValueAtIndex(u))return l=!1,!1}),l}},{key:"isAnyParentCollapsed",value:function(o){for(var i=o;i!==null;){i=this.dataManager.getRowParent(i);var a=this.dataManager.getRowIndex(i);if(this.collapsedRows.indexOf(a)>-1)return!0}return!1}},{key:"toggleState",value:function(o,i){if(!(i.col>=0)){var a=this.translateTrimmedRow(i.row);De(o.target,sz.CSS_CLASSES.button)&&(this.areChildrenCollapsed(a)?this.expandChildren(a):this.collapseChildren(a),Ln(o))}}},{key:"translateTrimmedRow",value:function(o){return this.hot.toPhysicalRow(o)}},{key:"untranslateTrimmedRow",value:function(o){return this.hot.toVisualRow(o)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(sP);const yUe=vUe;function of(e){"@babel/helpers - typeof";return of=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},of(e)}function gUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pUe(n.key),n)}}function mUe(e,t,r){return t&&aL(e.prototype,t),r&&aL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pUe(e){var t=bUe(e,"string");return of(t)==="symbol"?t:String(t)}function bUe(e,t){if(of(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(of(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&EE(e,t)}function EE(e,t){return EE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},EE(e,t)}function SUe(e){var t=_Ue();return function(){var n=Fm(e),o;if(t){var i=Fm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return CUe(this,o)}}function CUe(e,t){if(t&&(of(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uz(e)}function uz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _Ue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fm(e){return Fm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fm(e)}var lL=new WeakMap,OUe=function(e){wUe(r,e);var t=SUe(r);function r(n,o){var i;return gUe(this,r),i=t.call(this,n,o),lL.set(uz(i),{row_above:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"above")},row_below:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"below")}}),i.dataManager=i.plugin.dataManager,i}return mUe(r,[{key:"appendOptions",value:function(o){var i=this,a=[{key:"add_child",name:function(){return this.getTranslatedPhrase(cb)},callback:function(){var s=i.dataManager.translateTrimmedRow(i.hot.getSelectedLast()[0]),u=i.dataManager.getDataObject(s);i.dataManager.addChild(u)},disabled:function(){var s=i.hot.getSelectedLast();return!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(hb)},callback:function(){i.dataManager.detachFromParent(i.hot.getSelectedLast())},disabled:function(){var s=i.hot.getSelectedLast(),u=i.dataManager.translateTrimmedRow(s[0]),f=i.dataManager.getRowParent(u);return!f||!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{name:"---------"}];return Re(0,o.items.length-1,function(l){if(l===0)return I(a,function(s,u){o.items.splice(l+u,0,s)}),!1}),this.modifyRowInsertingOptions(o)}},{key:"modifyRowInsertingOptions",value:function(o){var i=lL.get(this);return Re(0,o.items.length-1,function(a){var l=i[o.items[a].key];l!=null&&(o.items[a].callback=l)}),o}}]),r}(sP);const RUe=OUe;function Id(e){"@babel/helpers - typeof";return Id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Id(e)}var sL;function uL(e){return kUe(e)||PUe(e)||TUe(e)||EUe()}function EUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TUe(e,t){if(e){if(typeof e=="string")return TE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TE(e,t)}}function PUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kUe(e){if(Array.isArray(e))return TE(e)}function TE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $Ue(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function AUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MUe(n.key),n)}}function IUe(e,t,r){return t&&fL(e.prototype,t),r&&fL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MUe(e){var t=xUe(e,"string");return Id(t)==="symbol"?t:String(t)}function xUe(e,t){if(Id(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DUe=function(){function e(t){AUe(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return IUe(e,[{key:"onBeforeRowMove",value:function(r,n,o,i){var a=this,l=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:o,movePossible:i});if(l)return!1;this.movedToCollapsed=!1;var s=o===this.hot.countRows(),u=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(o),f=!0,c=r.map(function(p){if(!f)return!1;var w=a.dataManager.translateTrimmedRow(p);return f=a.shouldAllowMoving(w,u),w}),h=c.indexOf(u)===-1;if(!f||!h)return!1;var d=this.getBaseParent(c),v=this.getTargetParent(s,u),g=d===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,u,g),this.moveRows(c,u,v),this.dataManager.rewriteCache(),this.moveCellsMeta(c,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,o,i,i&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,o),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,o=r.finalIndex,i=r.dropIndex,a=r.movePossible,l=!1;return pt(i)&&(dt(ft(sL||(sL=$Ue([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,o,i,a,!1),l=!0),l}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var o=this.dataManager.getRowParent(r?n-1:n);return o==null&&(o=this.dataManager.getRowParent(n-1)),o}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,o){o||(Math.max.apply(Math,uL(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,o){var i=this,a=n===this.dataManager.getRowIndex(o)+this.dataManager.countChildren(o)+1;this.hot.batchRender(function(){r.forEach(function(l){i.dataManager.moveRow(l,n,i.movedToCollapsed,a)})})}},{key:"moveCellsMeta",value:function(r,n){var o=this,i,a=[],l=Math.max.apply(Math,uL(r))<n;r.forEach(function(s){a.push(o.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(r[0],r.length),(i=this.hot).spliceCellsMeta.apply(i,[n-(l?a.length:0),0].concat(a))}},{key:"selectCells",value:function(r,n){var o=r.length,i=0,a=0,l=null,s=null;if(this.movedToCollapsed){var u=null;r[o-1]<n?u=this.dataManager.translateTrimmedRow(n-o):u=this.dataManager.translateTrimmedRow(n);var f=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),c=this.dataManager.getRowIndex(f);i=this.dataManager.untranslateTrimmedRow(c),a=i}else r[o-1]<n?(a=n-1,i=a-o+1):(i=n,a=i+o-1);l=this.hot.selection,s=this.hot.countCols()-1,l.setRangeStart(this.hot._createCellCoords(i,0)),l.setRangeEnd(this.hot._createCellCoords(a,s),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(o,i){return o-i!==n})}}]),e}();function af(e){"@babel/helpers - typeof";return af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},af(e)}function NUe(e){return FUe(e)||jUe(e)||LUe(e)||HUe()}function HUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LUe(e,t){if(e){if(typeof e=="string")return PE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PE(e,t)}}function jUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function FUe(e){if(Array.isArray(e))return PE(e)}function PE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WUe(n.key),n)}}function VUe(e,t,r){return t&&cL(e.prototype,t),r&&cL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function WUe(e){var t=UUe(e,"string");return af(t)==="symbol"?t:String(t)}function UUe(e,t){if(af(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(af(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sa(){return typeof Reflect<"u"&&Reflect.get?Sa=Reflect.get.bind():Sa=function(t,r,n){var o=zUe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Sa.apply(this,arguments)}function zUe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ko(e),e!==null););return e}function YUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kE(e,t)}function kE(e,t){return kE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},kE(e,t)}function GUe(e){var t=qUe();return function(){var n=ko(e),o;if(t){var i=ko(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return KUe(this,o)}}function KUe(e,t){if(t&&(af(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fz(e)}function fz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ko(e){return ko=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ko(e)}var WC="nestedRows",XUe=300,Qn=new WeakMap,ZUe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",JUe=function(e){YUe(r,e);var t=GUe(r);function r(n){var o;return BUe(this,r),o=t.call(this,n),o.dataManager=null,o.headersUI=null,o.collapsedRowsMap=null,Qn.set(fz(o),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),o}return VUe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[WC]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new mv),this.dataManager=new j2e(this,this.hot),this.collapsingUI=new yUe(this,this.hot),this.headersUI=new sz(this,this.hot),this.contextMenuUI=new RUe(this,this.hot),this.rowMoveController=new DUe(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("beforeViewRender",function(){return o.onBeforeViewRender.apply(o,arguments)}),this.addHook("modifyRowData",function(){return o.onModifyRowData.apply(o,arguments)}),this.addHook("modifySourceLength",function(){return o.onModifySourceLength.apply(o,arguments)}),this.addHook("beforeDataSplice",function(){return o.onBeforeDataSplice.apply(o,arguments)}),this.addHook("filterData",function(){return o.onFilterData.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeRemoveRow",function(){return o.onBeforeRemoveRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("beforeAddChild",function(){return o.onBeforeAddChild.apply(o,arguments)}),this.addHook("afterAddChild",function(){return o.onAfterAddChild.apply(o,arguments)}),this.addHook("beforeDetachChild",function(){return o.onBeforeDetachChild.apply(o,arguments)}),this.addHook("afterDetachChild",function(){return o.onAfterDetachChild.apply(o,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return o.onModifyRowHeaderWidth.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("beforeRowMove",function(){return o.onBeforeRowMove.apply(o,arguments)}),this.addHook("beforeLoadData",function(i){return o.onBeforeLoadData(i)}),this.addHook("beforeUpdateData",function(i){return o.onBeforeLoadData(i)}),Sa(ko(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),Sa(ko(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var o=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(o),Sa(ko(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(o,i,a,l){return this.rowMoveController.onBeforeRowMove(o,i,a,l)}},{key:"disableCoreAPIModifiers",value:function(){var o=Qn.get(this);o.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var o=Qn.get(this);o.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a){this.collapsingUI.toggleState(o,i,a)}},{key:"onModifyRowData",value:function(o){var i=Qn.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.getDataObject(o)}},{key:"onModifySourceLength",value:function(){var o=Qn.get(this);if(!o.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(o,i,a){var l=Qn.get(this);return l.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(o)?!0:(this.dataManager.spliceData(o,i,a),!1)}},{key:"onFilterData",value:function(o,i,a){var l=Qn.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(a[0],i),this.collapsingUI.collapsedRowsStash.shiftStash(a[0],null,-1*i),this.dataManager.filterData(o,i,a),l.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(o){return this.contextMenuUI.appendOptions(o)}},{key:"onAfterGetRowHeader",value:function(o,i){this.headersUI.appendLevelIndicators(o,i)}},{key:"onModifyRowHeaderWidth",value:function(o){return this.headersUI.rowHeaderWidthCache||o}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(l!==this.pluginName){var u=Qn.get(this);setTimeout(function(){u.skipRender=null,s.headersUI.updateRowHeaderWidth(),s.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=Array.from(a.reduce(function(u,f){if(l.dataManager.isParent(f)){var c=l.dataManager.getDataObject(f).__children;return u.add(f),Array.isArray(c)&&c.forEach(function(h){return u.add(l.dataManager.getRowIndex(h))}),u}return u.add(f)},new Set));a.length=0,a.push.apply(a,s)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(o,i){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(i)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(o,i,a){this.collapsingUI.collapsedRowsStash.shiftStash(a,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var o=Math.max.apply(Math,NUe(this.dataManager.cache.levels));o>0&&this.headersUI.updateRowHeaderWidth(o)}},{key:"onBeforeViewRender",value:function(o,i){var a=Qn.get(this);a.skipRender&&(i.skipRender=!0)}},{key:"destroy",value:function(){Sa(ko(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(o){if(!Cye(o)){lT(ZUe),this.hot.getSettings()[WC]=!1,this.disablePlugin();return}this.dataManager.setData(o),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return WC}},{key:"PLUGIN_PRIORITY",get:function(){return XUe}}]),r}(ct);function Md(e){"@babel/helpers - typeof";return Md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Md(e)}function QUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tze(n.key),n)}}function eze(e,t,r){return t&&hL(e.prototype,t),r&&hL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tze(e){var t=rze(e,"string");return Md(t)==="symbol"?t:String(t)}function rze(e,t){if(Md(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nze=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;QUe(this,e),this.rootWindow=r,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return eze(e,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var o=typeof r>"u"?n:r,i=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(o));return i===null?void 0:JSON.parse(i)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;I(this.savedKeys,function(n,o){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[o]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}();const oze=nze;function lf(e){"@babel/helpers - typeof";return lf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lf(e)}function ize(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lze(n.key),n)}}function aze(e,t,r){return t&&dL(e.prototype,t),r&&dL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lze(e){var t=sze(e,"string");return lf(t)==="symbol"?t:String(t)}function sze(e,t){if(lf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ca(){return typeof Reflect<"u"&&Reflect.get?Ca=Reflect.get.bind():Ca=function(t,r,n){var o=uze(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ca.apply(this,arguments)}function uze(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$o(e),e!==null););return e}function fze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$E(e,t)}function $E(e,t){return $E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},$E(e,t)}function cze(e){var t=vze();return function(){var n=$o(e),o;if(t){var i=$o(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hze(this,o)}}function hze(e,t){if(t&&(lf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dze(e)}function dze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $o(e){return $o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$o(e)}be.getSingleton().register("persistentStateSave");be.getSingleton().register("persistentStateLoad");be.getSingleton().register("persistentStateReset");var vL="persistentState",yze=0,gze=function(e){fze(r,e);var t=cze(r);function r(n){var o;return ize(this,r),o=t.call(this,n),o.storage=void 0,o}return aze(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[vL]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.storage||(this.storage=new oze(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(i,a){return o.saveValue(i,a)}),this.addHook("persistentStateLoad",function(i,a){return o.loadValue(i,a)}),this.addHook("persistentStateReset",function(){return o.resetValue()}),Ca($o(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,Ca($o(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ca($o(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(o,i){i.value=this.storage.loadValue(o)}},{key:"saveValue",value:function(o,i){this.storage.saveValue(o,i)}},{key:"resetValue",value:function(o){typeof o>"u"?this.storage.resetAll():this.storage.reset(o)}},{key:"destroy",value:function(){Ca($o(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return vL}},{key:"PLUGIN_PRIORITY",get:function(){return yze}}]),r}(ct);function sf(e){"@babel/helpers - typeof";return sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sf(e)}function mze(e){return Sze(e)||wze(e)||bze(e)||pze()}function pze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bze(e,t){if(e){if(typeof e=="string")return AE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AE(e,t)}}function wze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Sze(e){if(Array.isArray(e))return AE(e)}function AE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Cze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Oze(n.key),n)}}function _ze(e,t,r){return t&&yL(e.prototype,t),r&&yL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oze(e){var t=Rze(e,"string");return sf(t)==="symbol"?t:String(t)}function Rze(e,t){if(sf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _a(){return typeof Reflect<"u"&&Reflect.get?_a=Reflect.get.bind():_a=function(t,r,n){var o=Eze(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_a.apply(this,arguments)}function Eze(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ao(e),e!==null););return e}function Tze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IE(e,t)}function IE(e,t){return IE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},IE(e,t)}function Pze(e){var t=Aze();return function(){var n=Ao(e),o;if(t){var i=Ao(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return kze(this,o)}}function kze(e,t){if(t&&(sf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $ze(e)}function $ze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Aze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ao(e){return Ao=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ao(e)}var UC="search",Ize=190,Mze="htSearchResult",xze=function(t,r,n,o,i){t.getCellMeta(r,n).isSearchResult=i},Dze=function(t,r,n){return pt(t)||t===null||!t.toLocaleLowerCase||t.length===0||pt(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1},Nze=function(e){Tze(r,e);var t=Pze(r);function r(n){var o;return Cze(this,r),o=t.call(this,n),o.callback=xze,o.queryMethod=Dze,o.searchResultClass=Mze,o}return _ze(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[UC]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[UC];this.updatePluginSettings(i),this.addHook("beforeRenderer",function(){return o.onBeforeRenderer.apply(o,arguments)}),_a(Ao(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this,i=function(){return o.onBeforeRenderer.apply(o,arguments)};this.hot.addHook("beforeRenderer",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("beforeRenderer",i)}),_a(Ao(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_a(Ao(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),s=this.hot.countRows(),u=this.hot.countCols(),f=[],c=this.hot;return Re(0,s-1,function(h){Re(0,u-1,function(d){var v=i.hot.getDataAtCell(h,d),g=i.hot.getCellMeta(h,d),p=g.search.callback||a,w=g.search.queryMethod||l,S=w(o,v,g);if(S){var C={row:h,col:d,data:v};f.push(C)}p&&p(c,h,d,v,S)})}),f}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(o){this.callback=o}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(o){this.queryMethod=o}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(o){this.searchResultClass=o}},{key:"updatePluginSettings",value:function(o){Ye(o)&&(o.searchResultClass&&this.setSearchResultClass(o.searchResultClass),o.queryMethod&&this.setQueryMethod(o.queryMethod),o.callback&&this.setCallback(o.callback))}},{key:"onBeforeRenderer",value:function(o,i,a,l,s,u){var f=u.className||[],c=[];if(typeof f=="string")c=f.split(" ");else{var h;(h=c).push.apply(h,mze(f))}this.isEnabled()&&u.isSearchResult?c.includes(this.searchResultClass)||c.push("".concat(this.searchResultClass)):c.includes(this.searchResultClass)&&c.splice(c.indexOf(this.searchResultClass),1),u.className=c.join(" ")}},{key:"destroy",value:function(){_a(Ao(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return UC}},{key:"PLUGIN_PRIORITY",get:function(){return Ize}}]),r}(ct);function uf(e){"@babel/helpers - typeof";return uf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uf(e)}function Hze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jze(n.key),n)}}function Lze(e,t,r){return t&&gL(e.prototype,t),r&&gL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jze(e){var t=Fze(e,"string");return uf(t)==="symbol"?t:String(t)}function Fze(e,t){if(uf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function os(){return typeof Reflect<"u"&&Reflect.get?os=Reflect.get.bind():os=function(t,r,n){var o=Bze(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},os.apply(this,arguments)}function Bze(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ci(e),e!==null););return e}function Vze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ME(e,t)}function ME(e,t){return ME=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ME(e,t)}function Wze(e){var t=Yze();return function(){var n=Ci(e),o;if(t){var i=Ci(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Uze(this,o)}}function Uze(e,t){if(t&&(uf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zze(e)}function zze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ci(e){return Ci=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ci(e)}var Gze="touchScroll",Kze=200,qze=function(e){Vze(r,e);var t=Wze(r);function r(n){var o;return Hze(this,r),o=t.call(this,n),o.scrollbars=[],o.clones=[],o.lockedCollection=!1,o.freezeOverlays=!1,o}return Lze(r,[{key:"isEnabled",value:function(){return xF()}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterViewRender",function(){return o.onAfterViewRender()}),this.registerEvents(),os(Ci(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,os(Ci(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){os(Ci(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.addHook("beforeTouchScroll",function(){return o.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return o.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var o=this.hot.view._wt.wtOverlays,i=o.topOverlay,a=o.bottomOverlay,l=o.inlineStartOverlay,s=o.topInlineStartCornerOverlay,u=o.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(i),a.clone&&this.scrollbars.push(a),this.scrollbars.push(l),s&&this.scrollbars.push(s),u&&u.clone&&this.scrollbars.push(u),this.clones=[],i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),l.needFullRender&&this.clones.push(l.clone.wtTable.holder.parentNode),s&&this.clones.push(s.clone.wtTable.holder.parentNode),u&&u.clone&&this.clones.push(u.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,I(this.clones,function(o){re(o,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var o=this;this.freezeOverlays=!1,I(this.clones,function(i){je(i,"hide-tween"),re(i,"show-tween")}),this.hot._registerTimeout(function(){I(o.clones,function(i){je(i,"show-tween")})},400),I(this.scrollbars,function(i){i.refresh(),i.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return Gze}},{key:"PLUGIN_PRIORITY",get:function(){return Kze}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(ct);function ff(e){"@babel/helpers - typeof";return ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ff(e)}function Xze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jze(n.key),n)}}function Zze(e,t,r){return t&&mL(e.prototype,t),r&&mL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jze(e){var t=Qze(e,"string");return ff(t)==="symbol"?t:String(t)}function Qze(e,t){if(ff(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ff(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Oa(){return typeof Reflect<"u"&&Reflect.get?Oa=Reflect.get.bind():Oa=function(t,r,n){var o=eYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Oa.apply(this,arguments)}function eYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Io(e),e!==null););return e}function tYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xE(e,t)}function xE(e,t){return xE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},xE(e,t)}function rYe(e){var t=iYe();return function(){var n=Io(e),o;if(t){var i=Io(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return nYe(this,o)}}function nYe(e,t){if(t&&(ff(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oYe(e)}function oYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Io(e){return Io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Io(e)}var jy="trimRows",aYe=330,lYe=function(e){tYe(r,e);var t=rYe(r);function r(n){var o;return Xze(this,r),o=t.call(this,n),o.trimmedRowsMap=null,o}return Zze(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[jy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new mv),this.trimmedRowsMap.addLocalHook("init",function(){return o.onMapInit()}),Oa(Io(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var o=this,i=this.hot.getSettings()[jy];Array.isArray(i)&&this.hot.batchExecution(function(){o.trimmedRowsMap.clear(),I(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),Oa(Io(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),Oa(Io(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(o){var i=this,a=this.getTrimmedRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeTrimRow",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){I(o,function(f){i.trimmedRowsMap.setValueAtIndex(f,!0)})},!0),this.hot.runHooks("afterTrimRow",a,s,l,l&&s.length>a.length))}},{key:"trimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.trimRows(i)}},{key:"untrimRows",value:function(o){var i=this.getTrimmedRows(),a=this.isValidConfig(o),l=i,s=this.trimmedRowsMap.getValues().slice(),u=o.length>0;a&&u&&(I(o,function(c){s[c]=!1}),l=ar(s,function(c,h,d){return h&&c.push(d),c},[]));var f=this.hot.runHooks("beforeUntrimRow",i,l,a&&u);f!==!1&&(a&&u&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",i,l,a&&u,a&&l.length<i.length))}},{key:"untrimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.untrimRows(i)}},{key:"isTrimmed",value:function(o){return this.trimmedRowsMap.getValueAtIndex(o)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(o){var i=this.hot.countSourceRows();return o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i})}},{key:"onMapInit",value:function(){var o=this,i=this.hot.getSettings()[jy];Array.isArray(i)&&this.hot.batchExecution(function(){I(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"destroy",value:function(){Oa(Io(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return jy}},{key:"PLUGIN_PRIORITY",get:function(){return aYe}}]),r}(ct);function cf(e){"@babel/helpers - typeof";return cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cf(e)}function cz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sYe(n.key),n)}}function hz(e,t,r){return t&&pL(e.prototype,t),r&&pL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sYe(e){var t=uYe(e,"string");return cf(t)==="symbol"?t:String(t)}function uYe(e,t){if(cf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dz(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DE(e,t)}function DE(e,t){return DE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},DE(e,t)}function vz(e){var t=hYe();return function(){var n=Bm(e),o;if(t){var i=Bm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fYe(this,o)}}function fYe(e,t){if(t&&(cf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cYe(e)}function cYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bm(e){return Bm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bm(e)}function dYe(e){return gYe(e)||yYe(e)||gz(e)||vYe()}function vYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yYe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gYe(e){if(Array.isArray(e))return NE(e)}function yz(e,t){return bYe(e)||pYe(e,t)||gz(e,t)||mYe()}function mYe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gz(e,t){if(e){if(typeof e=="string")return NE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NE(e,t)}}function NE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pYe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function bYe(e){if(Array.isArray(e))return e}var mz="undoRedo",wYe="undoRedo";function ge(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(r,n){var o=this,i=r&&r.length;if(i){var a=r.find(function(s){var u=yz(s,4),f=u[2],c=u[3];return f!==c});if(a){var l=function(){var u=r.reduce(function(c,h){return c.push(dYe(h)),c},[]);I(u,function(c){c[1]=e.propToCol(c[1])});var f=i>1?o.getSelected():[[u[0][0],u[0][1]]];return new ge.ChangeAction(u,f)};t.done(l,n)}}}),e.addHook("afterCreateRow",function(r,n,o){t.done(function(){return new ge.CreateRowAction(r,n)},o)}),e.addHook("beforeRemoveRow",function(r,n,o,i){var a=function(){var s=e.toPhysicalRow(r),u=yr(t.instance.getSourceData(s,0,s+n-1,t.instance.countSourceCols()-1));return new ge.RemoveRowAction(s,u,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence())};t.done(a,i)}),e.addHook("afterCreateCol",function(r,n,o){t.done(function(){return new ge.CreateColumnAction(r,n)},o)}),e.addHook("beforeRemoveCol",function(r,n,o,i){var a=function(){var s=t.instance.getSourceDataArray(),u=(t.instance.countCols()+r)%t.instance.countCols(),f=[],c=[],h=[];Re(s.length-1,function(g){var p=[],w=s[g];Re(u,u+(n-1),function(S){p.push(w[e.toPhysicalColumn(S)])}),f.push(p)}),Re(n-1,function(g){h.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&Re(n-1,function(g){c.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)});var d=e.columnIndexMapper.getIndexesSequence(),v=e.rowIndexMapper.getIndexesSequence();return new ge.RemoveColumnAction(u,h,f,c,d,v,e.getSettings().fixedColumnsStart)};t.done(a,i)}),e.addHook("beforeCellAlignment",function(r,n,o,i){t.done(function(){return new ge.CellAlignmentAction(r,n,o,i)})}),e.addHook("beforeFilter",function(r){t.done(function(){return new ge.FiltersAction(r)})}),e.addHook("beforeRowMove",function(r,n){r!==!1&&t.done(function(){return new ge.RowMoveAction(r,n)})}),e.addHook("beforeMergeCells",function(r,n){n||t.done(function(){return new ge.MergeCellsAction(e,r)})}),e.addHook("afterUnmergeCells",function(r,n){n||t.done(function(){return new ge.UnmergeCellsAction(e,r)})}),e.addHook("afterInit",function(){t.init()})}ge.prototype.done=function(e,t){if(!this.ignoreNewActions){var r=t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";if(!r){var n=this.doneActions.slice(),o=this.instance.runHooks("beforeUndoStackChange",n,t);if(o!==!1){var i=e(),a=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}};ge.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var r=yr(t),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),t.undo(this.instance,function(){o.ignoreNewActions=!1,o.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};ge.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var r=yr(t),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),t.redo(this.instance,function(){o.ignoreNewActions=!1,o.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};ge.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ge.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ge.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ge.prototype.isEnabled=function(){return this.enabled};ge.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,_Ye(e),this.registerShortcuts(),e.addHook("afterChange",pz)}};ge.prototype.disable=function(){if(this.isEnabled()){var e=this.instance;this.enabled=!1,OYe(e),this.unregisterShortcuts(),e.removeHook("afterChange",pz)}};ge.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ge.Action=function(){};ge.Action.prototype.undo=function(){};ge.Action.prototype.redo=function(){};ge.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"};Pi(ge.ChangeAction,ge.Action);ge.ChangeAction.prototype.undo=function(e,t){for(var r=yr(this.changes),n=e.countEmptyRows(!0),o=e.countEmptyCols(!0),i=0,a=r.length;i<a;i++)r[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var l=0,s=r.length;l<s;l++){var u=yz(r[l],2),f=u[0],c=u[1];e.getSettings().minSpareRows&&f+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(f+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&c+1+e.getSettings().minSpareCols===e.countCols()&&o===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(c+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)};ge.ChangeAction.prototype.redo=function(e,t){for(var r=yr(this.changes),n=0,o=r.length;n<o;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)};ge.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"};Pi(ge.CreateRowAction,ge.Action);ge.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ge.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ge.RemoveRowAction=function(e,t,r,n,o){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=o};Pi(ge.RemoveRowAction,ge.Action);ge.RemoveRowAction.prototype.undo=function(e,t){var r=this,n=e.getSettings(),o=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(i,a){Object.keys(i).forEach(function(l){var s=parseInt(l,10);o.push([r.index+a,isNaN(s)?l:s,i[l]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ge.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ge.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"};Pi(ge.CreateColumnAction,ge.Action);ge.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ge.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ge.RemoveColumnAction=function(e,t,r,n,o,i,a){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a};Pi(ge.RemoveColumnAction,ge.Action);ge.RemoveColumnAction.prototype.undo=function(e,t){var r=this,n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var o=this.indexes.slice(0).sort(),i=function(h,d,v){return v[r.indexes.indexOf(o[d])]},a=this.data.length,l=[],s=0;s<a;s++)l.push(ze(this.data[s],i));var u=ze(this.headers,i),f=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),I(e.getSourceDataArray(),function(c,h){I(o,function(d,v){c[d]=l[h][v],f.push([h,d,c[d]])})}),e.setSourceDataAtCell(f,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&I(u,function(c,h){e.getSettings().colHeaders[o[h]]=c}),e.batchExecution(function(){e.rowIndexMapper.setIndexesSequence(r.rowPositions),e.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()};ge.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ge.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n};ge.CellAlignmentAction.prototype.undo=function(e,t){var r=this;I(this.range,function(n){n.forAll(function(o,i){o>=0&&i>=0&&e.setCellMeta(o,i,"className",r.stateBefore[o][i]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()};ge.CellAlignmentAction.prototype.redo=function(e,t){ri(this.range,this.type,this.alignment,function(r,n){return e.getCellMeta(r,n)},function(r,n,o,i){return e.setCellMeta(r,n,o,i)}),e.addHookOnce("afterViewRender",t),e.render()};ge.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"};Pi(ge.FiltersAction,ge.Action);ge.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};ge.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var SYe=function(e){dz(r,e);var t=vz(r);function r(n,o){var i;cz(this,r),i=t.call(this),i.cellRange=o;var a=i.cellRange.getTopStartCorner(),l=i.cellRange.getBottomEndCorner();return i.rangeData=n.getData(a.row,a.col,l.row,l.col),i}return hz(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0);var l=this.cellRange.getTopStartCorner();o.populateFromArray(l.row,l.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange)}}]),r}(ge.Action);ge.MergeCellsAction=SYe;var CYe=function(e){dz(r,e);var t=vz(r);function r(n,o){var i;return cz(this,r),i=t.call(this),i.cellRange=o,i}return hz(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0),o.render()}}]),r}(ge.Action);ge.UnmergeCellsAction=CYe;ge.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"};Pi(ge.RowMoveAction,ge.Action);ge.RowMoveAction.prototype.undo=function(e,t){var r=this,n=e.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter(function(f){return f>r.finalIndex}),a=o.filter(function(f){return f<=r.finalIndex}),l=i.sort(function(f,c){return c-f}).concat(a.sort(function(f,c){return f-c}));e.addHookOnce("afterViewRender",t);for(var s=0;s<l.length;s+=1){var u=e.toVisualRow(l[s]);n.moveRow(u,l[s])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ge.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ge.prototype.init=function(){var e=this.instance.getSettings().undo,t=typeof e>"u"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ge.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager(),r=t.getContext("grid"),n=function(a){return!a.altKey},o={runOnlyIf:n,group:mz};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],o)};ge.prototype.unregisterShortcuts=function(){var e=this.instance.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(mz)};function pz(e,t){var r=this;if(t==="loadData")return r.undoRedo.clear()}function _Ye(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function OYe(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var Pv=be.getSingleton();Pv.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()});Pv.register("beforeUndo");Pv.register("afterUndo");Pv.register("beforeRedo");Pv.register("afterRedo");ge.PLUGIN_KEY=wYe;ge.SETTING_KEYS=!0;function RYe(){ot(vEe),ot(jEe),ot(n0e),ot(X0e),ot(yTe),ot(k2),ot(BPe),ot(wke),ot(W2),ot(S1e),ot(K1e),ot(iAe),ot(tU),ot(uIe),ot(aHe),ot(aLe),ot(ALe),ot(rje),ot(Rje),ot(dFe),ot(OFe),ot(hBe),ot(_Be),ot(SVe),ot(VVe),ot(tWe),ot(k2e),ot(JUe),ot(gze),ot(Nze),ot(qze),ot(lYe),ot(ge)}function EYe(){TOe(),VOe(),oRe(),SRe(),RYe()}function xd(e){"@babel/helpers - typeof";return xd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xd(e)}var fe;function he(e,t,r){return t=TYe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TYe(e){var t=PYe(e,"string");return xd(t)==="symbol"?t:String(t)}function PYe(e,t){if(xd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kYe=(fe={languageCode:"zh-CN"},he(fe,Pp,"上方插入行"),he(fe,kp,"下方插入行"),he(fe,$p,"左方插入列"),he(fe,Ap,"右方插入列"),he(fe,Ip,["移除该行","移除多行"]),he(fe,Mp,["移除该列","移除多列"]),he(fe,xp,"撤销"),he(fe,Dp,"恢复"),he(fe,Np,"只读"),he(fe,Hp,"清空该列"),he(fe,Zp,"对齐"),he(fe,Jp,"左对齐"),he(fe,Qp,"水平居中"),he(fe,eb,"右对齐"),he(fe,tb,"两端对齐"),he(fe,rb,"顶端对齐"),he(fe,nb,"垂直居中"),he(fe,ob,"底端对齐"),he(fe,Wp,"冻结该列"),he(fe,Up,"取消冻结"),he(fe,ib,"边框"),he(fe,ab,"上"),he(fe,lb,"右"),he(fe,sb,"下"),he(fe,ub,"左"),he(fe,fb,"移除边框"),he(fe,Gp,"插入批注"),he(fe,Kp,"编辑批注"),he(fe,qp,"删除批注"),he(fe,Xp,"只读批注"),he(fe,zp,"合并"),he(fe,Yp,"取消合并"),he(fe,Lp,"复制"),he(fe,jp,"带标题的复制"),he(fe,Fp,"带标题组的复制"),he(fe,Bp,"仅复制标题"),he(fe,Vp,"剪切"),he(fe,cb,"插入子行"),he(fe,hb,"与母行分离"),he(fe,db,["隐藏该列","隐藏多列"]),he(fe,vb,["显示该列","显示多列"]),he(fe,yb,["隐藏该行","隐藏多行"]),he(fe,gb,["显示该行","显示多行"]),he(fe,pv,"无"),he(fe,mb,"为空"),he(fe,pb,"不为空"),he(fe,bb,"等于"),he(fe,wb,"不等于"),he(fe,Sb,"开头是"),he(fe,Cb,"结尾是"),he(fe,_b,"包含"),he(fe,Ob,"不包含"),he(fe,Rb,"大于"),he(fe,Eb,"大于或等于"),he(fe,Tb,"小于"),he(fe,Pb,"小于或等于"),he(fe,kb,"在此范围"),he(fe,$b,"不在此范围"),he(fe,Ab,"之后"),he(fe,Ib,"之前"),he(fe,Mb,"今天"),he(fe,xb,"明天"),he(fe,Db,"昨天"),he(fe,wh,"空白单元格"),he(fe,Nb,"按条件过滤"),he(fe,Hb,"按值过滤"),he(fe,Lb,"且"),he(fe,bv,"或"),he(fe,jb,"全选"),he(fe,Fb,"清除"),he(fe,Bb,"确认"),he(fe,Vb,"取消"),he(fe,Wb,"搜索"),he(fe,Ub,"值"),he(fe,zb,"第二值"),fe);const $Ye=kYe;const AYe={class:"hot-table-container"},IYe="zh-CN",MYe={__name:"handsontable",setup(e){EYe(),AT($Ye);const t=$v(""),r=$v([]),n=$v(null),o=$v(null),i={licenseKey:"non-commercial-and-evaluation",width:"auto",height:"auto",mergeCells:!0,rowHeights:36,colWidths:120,contextMenu:{callback(s,u,f){console.log(s,u)},items:["row_above","row_below","remove_row","col_left","col_right","clear_column","cut","copy","mergeCells"]},colHeaders:!0,manualColumnResize:!0,manualRowResize:!0,autoColumnSize:!0};r.value=[["John","Smith","123 Main St."],["Jane","Doe","456 Maple Ave."],["Bob","Johnson","789 Broadway"]];const a=()=>{const s=[];for(let u=1;u<=6;u++){const f=[];for(let c=1;c<=5;c++)f.push(`${u}-${c}`);s.push(f)}n.value.hotInstance.loadData(s)},l=()=>{const f=n.value.hotInstance.table.cloneNode(!0);f.className="";const c=document.createElement("div");c.appendChild(f),document.body.appendChild(c),console.log(c.outerHTML);let h=c.outerHTML,d='<table  border="1" cellpadding="0" cellspacing="0" width="100%">',v=h.replace(/<table[^>]*>/,d);document.body.removeChild(c),o.value.innerHTML=v};return(s,u)=>(LE(),HE("div",AYe,[An("div",null,[An("button",{onClick:a},"Generate Table Data"),An("button",{onClick:l},"Export Table HTML")]),wL(Rz(HT),{ref_key:"hotTableRef",ref:n,settings:i,data:r.value,language:IYe,class:"hot-table"},null,8,["data"]),An("div",{ref_key:"tableRef",ref:o,class:"table-wrap"},null,512),An("code",null,Ez(t.value),1)]))}},xYe=Oz(MYe,[["__scopeId","data-v-8ab2abdc"]]),DYe=An("h1",{id:"docs",tabindex:"-1"},[SL("Docs "),An("a",{class:"header-anchor",href:"#docs","aria-hidden":"true"},"#")],-1),NYe=An("h2",{id:"在线表格生成",tabindex:"-1"},[SL("在线表格生成 "),An("a",{class:"header-anchor",href:"#在线表格生成","aria-hidden":"true"},"#")],-1),HYe=An("p",null,"This is a .md using a custom component",-1),BYe=JSON.parse('{"title":"Docs","description":"","frontmatter":{},"headers":[{"level":2,"title":"在线表格生成","slug":"在线表格生成","link":"#在线表格生成","children":[]}],"relativePath":"tool/handsontable/handsontable.md","lastUpdated":1682488245000}'),LYe={name:"tool/handsontable/handsontable.md"},VYe=Object.assign(LYe,{setup(e){return(t,r)=>(LE(),HE("div",null,[DYe,NYe,HYe,wL(xYe)]))}});export{BYe as __pageData,VYe as default};
